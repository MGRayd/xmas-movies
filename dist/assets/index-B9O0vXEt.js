function kw(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function Sw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Aw={exports:{}},r0={},Iw={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mu=Symbol.for("react.element"),kI=Symbol.for("react.portal"),SI=Symbol.for("react.fragment"),AI=Symbol.for("react.strict_mode"),II=Symbol.for("react.profiler"),CI=Symbol.for("react.provider"),RI=Symbol.for("react.context"),NI=Symbol.for("react.forward_ref"),PI=Symbol.for("react.suspense"),FI=Symbol.for("react.memo"),DI=Symbol.for("react.lazy"),S1=Symbol.iterator;function bI(t){return t===null||typeof t!="object"?null:(t=S1&&t[S1]||t["@@iterator"],typeof t=="function"?t:null)}var Cw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Rw=Object.assign,Nw={};function dl(t,e,r){this.props=t,this.context=e,this.refs=Nw,this.updater=r||Cw}dl.prototype.isReactComponent={};dl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};dl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Pw(){}Pw.prototype=dl.prototype;function Nm(t,e,r){this.props=t,this.context=e,this.refs=Nw,this.updater=r||Cw}var Pm=Nm.prototype=new Pw;Pm.constructor=Nm;Rw(Pm,dl.prototype);Pm.isPureReactComponent=!0;var A1=Array.isArray,Fw=Object.prototype.hasOwnProperty,Fm={current:null},Dw={key:!0,ref:!0,__self:!0,__source:!0};function bw(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Fw.call(e,n)&&!Dw.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:mu,type:t,key:s,ref:a,props:i,_owner:Fm.current}}function OI(t,e){return{$$typeof:mu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Dm(t){return typeof t=="object"&&t!==null&&t.$$typeof===mu}function LI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var I1=/\/+/g;function ed(t,e){return typeof t=="object"&&t!==null&&t.key!=null?LI(""+t.key):e.toString(36)}function Ff(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case mu:case kI:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+ed(a,0):n,A1(i)?(r="",t!=null&&(r=t.replace(I1,"$&/")+"/"),Ff(i,e,r,"",function(c){return c})):i!=null&&(Dm(i)&&(i=OI(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(I1,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",A1(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+ed(s,o);a+=Ff(s,e,r,l,i)}else if(l=bI(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+ed(s,o++),a+=Ff(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Ju(t,e,r){if(t==null)return t;var n=[],i=0;return Ff(t,n,"","",function(s){return e.call(r,s,i++)}),n}function MI(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Jr={current:null},Df={transition:null},VI={ReactCurrentDispatcher:Jr,ReactCurrentBatchConfig:Df,ReactCurrentOwner:Fm};function Ow(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:Ju,forEach:function(t,e,r){Ju(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ju(t,function(){e++}),e},toArray:function(t){return Ju(t,function(e){return e})||[]},only:function(t){if(!Dm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qe.Component=dl;qe.Fragment=SI;qe.Profiler=II;qe.PureComponent=Nm;qe.StrictMode=AI;qe.Suspense=PI;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VI;qe.act=Ow;qe.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Rw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Fm.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)Fw.call(e,l)&&!Dw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:mu,type:t.type,key:i,ref:s,props:n,_owner:a}};qe.createContext=function(t){return t={$$typeof:RI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:CI,_context:t},t.Consumer=t};qe.createElement=bw;qe.createFactory=function(t){var e=bw.bind(null,t);return e.type=t,e};qe.createRef=function(){return{current:null}};qe.forwardRef=function(t){return{$$typeof:NI,render:t}};qe.isValidElement=Dm;qe.lazy=function(t){return{$$typeof:DI,_payload:{_status:-1,_result:t},_init:MI}};qe.memo=function(t,e){return{$$typeof:FI,type:t,compare:e===void 0?null:e}};qe.startTransition=function(t){var e=Df.transition;Df.transition={};try{t()}finally{Df.transition=e}};qe.unstable_act=Ow;qe.useCallback=function(t,e){return Jr.current.useCallback(t,e)};qe.useContext=function(t){return Jr.current.useContext(t)};qe.useDebugValue=function(){};qe.useDeferredValue=function(t){return Jr.current.useDeferredValue(t)};qe.useEffect=function(t,e){return Jr.current.useEffect(t,e)};qe.useId=function(){return Jr.current.useId()};qe.useImperativeHandle=function(t,e,r){return Jr.current.useImperativeHandle(t,e,r)};qe.useInsertionEffect=function(t,e){return Jr.current.useInsertionEffect(t,e)};qe.useLayoutEffect=function(t,e){return Jr.current.useLayoutEffect(t,e)};qe.useMemo=function(t,e){return Jr.current.useMemo(t,e)};qe.useReducer=function(t,e,r){return Jr.current.useReducer(t,e,r)};qe.useRef=function(t){return Jr.current.useRef(t)};qe.useState=function(t){return Jr.current.useState(t)};qe.useSyncExternalStore=function(t,e,r){return Jr.current.useSyncExternalStore(t,e,r)};qe.useTransition=function(){return Jr.current.useTransition()};qe.version="18.3.1";Iw.exports=qe;var ee=Iw.exports;const Lw=Sw(ee),UI=kw({__proto__:null,default:Lw},[ee]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BI=ee,jI=Symbol.for("react.element"),zI=Symbol.for("react.fragment"),HI=Object.prototype.hasOwnProperty,$I=BI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,WI={key:!0,ref:!0,__self:!0,__source:!0};function Mw(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)HI.call(e,n)&&!WI.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:jI,type:t,key:s,ref:a,props:i,_owner:$I.current}}r0.Fragment=zI;r0.jsx=Mw;r0.jsxs=Mw;Aw.exports=r0;var _=Aw.exports,Qd={},Vw={exports:{}},Tn={},Uw={exports:{}},Bw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ie,G){var ue=ie.length;ie.push(G);e:for(;0<ue;){var Ee=ue-1>>>1,B=ie[Ee];if(0<i(B,G))ie[Ee]=G,ie[ue]=B,ue=Ee;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var G=ie[0],ue=ie.pop();if(ue!==G){ie[0]=ue;e:for(var Ee=0,B=ie.length,X=B>>>1;Ee<X;){var q=2*(Ee+1)-1,W=ie[q],ae=q+1,xe=ie[ae];if(0>i(W,ue))ae<B&&0>i(xe,W)?(ie[Ee]=xe,ie[ae]=ue,Ee=ae):(ie[Ee]=W,ie[q]=ue,Ee=q);else if(ae<B&&0>i(xe,ue))ie[Ee]=xe,ie[ae]=ue,Ee=ae;else break e}}return G}function i(ie,G){var ue=ie.sortIndex-G.sortIndex;return ue!==0?ue:ie.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],f=1,h=null,d=3,p=!1,v=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ie){for(var G=r(c);G!==null;){if(G.callback===null)n(c);else if(G.startTime<=ie)n(c),G.sortIndex=G.expirationTime,e(l,G);else break;G=r(c)}}function N(ie){if(m=!1,y(ie),!v)if(r(l)!==null)v=!0,Ie(j);else{var G=r(c);G!==null&&oe(N,G.startTime-ie)}}function j(ie,G){v=!1,m&&(m=!1,T(k),k=-1),p=!0;var ue=d;try{for(y(G),h=r(l);h!==null&&(!(h.expirationTime>G)||ie&&!P());){var Ee=h.callback;if(typeof Ee=="function"){h.callback=null,d=h.priorityLevel;var B=Ee(h.expirationTime<=G);G=t.unstable_now(),typeof B=="function"?h.callback=B:h===r(l)&&n(l),y(G)}else n(l);h=r(l)}if(h!==null)var X=!0;else{var q=r(c);q!==null&&oe(N,q.startTime-G),X=!1}return X}finally{h=null,d=ue,p=!1}}var U=!1,g=null,k=-1,S=5,C=-1;function P(){return!(t.unstable_now()-C<S)}function F(){if(g!==null){var ie=t.unstable_now();C=ie;var G=!0;try{G=g(!0,ie)}finally{G?O():(U=!1,g=null)}}else U=!1}var O;if(typeof E=="function")O=function(){E(F)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,ve=de.port2;de.port1.onmessage=F,O=function(){ve.postMessage(null)}}else O=function(){w(F,0)};function Ie(ie){g=ie,U||(U=!0,O())}function oe(ie,G){k=w(function(){ie(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,Ie(j))},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ie){switch(d){case 1:case 2:case 3:var G=3;break;default:G=d}var ue=d;d=G;try{return ie()}finally{d=ue}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ie,G){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ue=d;d=ie;try{return G()}finally{d=ue}},t.unstable_scheduleCallback=function(ie,G,ue){var Ee=t.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?Ee+ue:Ee):ue=Ee,ie){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=ue+B,ie={id:f++,callback:G,priorityLevel:ie,startTime:ue,expirationTime:B,sortIndex:-1},ue>Ee?(ie.sortIndex=ue,e(c,ie),r(l)===null&&ie===r(c)&&(m?(T(k),k=-1):m=!0,oe(N,ue-Ee))):(ie.sortIndex=B,e(l,ie),v||p||(v=!0,Ie(j))),ie},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(ie){var G=d;return function(){var ue=d;d=G;try{return ie.apply(this,arguments)}finally{d=ue}}}})(Bw);Uw.exports=Bw;var GI=Uw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KI=ee,wn=GI;function _e(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jw=new Set,Pc={};function $a(t,e){Ko(t,e),Ko(t+"Capture",e)}function Ko(t,e){for(Pc[t]=e,t=0;t<e.length;t++)jw.add(e[t])}var Zi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jd=Object.prototype.hasOwnProperty,qI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,C1={},R1={};function XI(t){return Jd.call(R1,t)?!0:Jd.call(C1,t)?!1:qI.test(t)?R1[t]=!0:(C1[t]=!0,!1)}function YI(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function QI(t,e,r,n){if(e===null||typeof e>"u"||YI(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Zr(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var kr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kr[t]=new Zr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];kr[e]=new Zr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kr[t]=new Zr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kr[t]=new Zr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kr[t]=new Zr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kr[t]=new Zr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kr[t]=new Zr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kr[t]=new Zr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kr[t]=new Zr(t,5,!1,t.toLowerCase(),null,!1,!1)});var bm=/[\-:]([a-z])/g;function Om(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(bm,Om);kr[e]=new Zr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(bm,Om);kr[e]=new Zr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(bm,Om);kr[e]=new Zr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kr[t]=new Zr(t,1,!1,t.toLowerCase(),null,!1,!1)});kr.xlinkHref=new Zr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kr[t]=new Zr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Lm(t,e,r,n){var i=kr.hasOwnProperty(e)?kr[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(QI(e,r,i,n)&&(r=null),n||i===null?XI(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var us=KI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zu=Symbol.for("react.element"),yo=Symbol.for("react.portal"),wo=Symbol.for("react.fragment"),Mm=Symbol.for("react.strict_mode"),Zd=Symbol.for("react.profiler"),zw=Symbol.for("react.provider"),Hw=Symbol.for("react.context"),Vm=Symbol.for("react.forward_ref"),ep=Symbol.for("react.suspense"),tp=Symbol.for("react.suspense_list"),Um=Symbol.for("react.memo"),ws=Symbol.for("react.lazy"),$w=Symbol.for("react.offscreen"),N1=Symbol.iterator;function bl(t){return t===null||typeof t!="object"?null:(t=N1&&t[N1]||t["@@iterator"],typeof t=="function"?t:null)}var Ot=Object.assign,td;function Gl(t){if(td===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);td=e&&e[1]||""}return`
`+td+t}var rd=!1;function nd(t,e){if(!t||rd)return"";rd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{rd=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Gl(t):""}function JI(t){switch(t.tag){case 5:return Gl(t.type);case 16:return Gl("Lazy");case 13:return Gl("Suspense");case 19:return Gl("SuspenseList");case 0:case 2:case 15:return t=nd(t.type,!1),t;case 11:return t=nd(t.type.render,!1),t;case 1:return t=nd(t.type,!0),t;default:return""}}function rp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case wo:return"Fragment";case yo:return"Portal";case Zd:return"Profiler";case Mm:return"StrictMode";case ep:return"Suspense";case tp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Hw:return(t.displayName||"Context")+".Consumer";case zw:return(t._context.displayName||"Context")+".Provider";case Vm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Um:return e=t.displayName||null,e!==null?e:rp(t.type)||"Memo";case ws:e=t._payload,t=t._init;try{return rp(t(e))}catch{}}return null}function ZI(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rp(e);case 8:return e===Mm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ks(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ww(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function eC(t){var e=Ww(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ef(t){t._valueTracker||(t._valueTracker=eC(t))}function Gw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Ww(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function eh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function np(t,e){var r=e.checked;return Ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function P1(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ks(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Kw(t,e){e=e.checked,e!=null&&Lm(t,"checked",e,!1)}function ip(t,e){Kw(t,e);var r=Ks(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?sp(t,e.type,r):e.hasOwnProperty("defaultValue")&&sp(t,e.type,Ks(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function F1(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function sp(t,e,r){(e!=="number"||eh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Kl=Array.isArray;function Do(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ks(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function ap(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(_e(91));return Ot({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function D1(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(_e(92));if(Kl(r)){if(1<r.length)throw Error(_e(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ks(r)}}function qw(t,e){var r=Ks(e.value),n=Ks(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function b1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Xw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function op(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Xw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var tf,Yw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(tf=tf||document.createElement("div"),tf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=tf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Fc(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var ac={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tC=["Webkit","ms","Moz","O"];Object.keys(ac).forEach(function(t){tC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ac[e]=ac[t]})});function Qw(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||ac.hasOwnProperty(t)&&ac[t]?(""+e).trim():e+"px"}function Jw(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Qw(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var rC=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lp(t,e){if(e){if(rC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(_e(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(_e(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(_e(61))}if(e.style!=null&&typeof e.style!="object")throw Error(_e(62))}}function cp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var up=null;function Bm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fp=null,bo=null,Oo=null;function O1(t){if(t=xu(t)){if(typeof fp!="function")throw Error(_e(280));var e=t.stateNode;e&&(e=o0(e),fp(t.stateNode,t.type,e))}}function Zw(t){bo?Oo?Oo.push(t):Oo=[t]:bo=t}function eE(){if(bo){var t=bo,e=Oo;if(Oo=bo=null,O1(t),e)for(t=0;t<e.length;t++)O1(e[t])}}function tE(t,e){return t(e)}function rE(){}var id=!1;function nE(t,e,r){if(id)return t(e,r);id=!0;try{return tE(t,e,r)}finally{id=!1,(bo!==null||Oo!==null)&&(rE(),eE())}}function Dc(t,e){var r=t.stateNode;if(r===null)return null;var n=o0(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(_e(231,e,typeof r));return r}var hp=!1;if(Zi)try{var Ol={};Object.defineProperty(Ol,"passive",{get:function(){hp=!0}}),window.addEventListener("test",Ol,Ol),window.removeEventListener("test",Ol,Ol)}catch{hp=!1}function nC(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(f){this.onError(f)}}var oc=!1,th=null,rh=!1,dp=null,iC={onError:function(t){oc=!0,th=t}};function sC(t,e,r,n,i,s,a,o,l){oc=!1,th=null,nC.apply(iC,arguments)}function aC(t,e,r,n,i,s,a,o,l){if(sC.apply(this,arguments),oc){if(oc){var c=th;oc=!1,th=null}else throw Error(_e(198));rh||(rh=!0,dp=c)}}function Wa(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function iE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function L1(t){if(Wa(t)!==t)throw Error(_e(188))}function oC(t){var e=t.alternate;if(!e){if(e=Wa(t),e===null)throw Error(_e(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return L1(i),t;if(s===n)return L1(i),e;s=s.sibling}throw Error(_e(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(_e(189))}}if(r.alternate!==n)throw Error(_e(190))}if(r.tag!==3)throw Error(_e(188));return r.stateNode.current===r?t:e}function sE(t){return t=oC(t),t!==null?aE(t):null}function aE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=aE(t);if(e!==null)return e;t=t.sibling}return null}var oE=wn.unstable_scheduleCallback,M1=wn.unstable_cancelCallback,lC=wn.unstable_shouldYield,cC=wn.unstable_requestPaint,Ht=wn.unstable_now,uC=wn.unstable_getCurrentPriorityLevel,jm=wn.unstable_ImmediatePriority,lE=wn.unstable_UserBlockingPriority,nh=wn.unstable_NormalPriority,fC=wn.unstable_LowPriority,cE=wn.unstable_IdlePriority,n0=null,vi=null;function hC(t){if(vi&&typeof vi.onCommitFiberRoot=="function")try{vi.onCommitFiberRoot(n0,t,void 0,(t.current.flags&128)===128)}catch{}}var ti=Math.clz32?Math.clz32:mC,dC=Math.log,pC=Math.LN2;function mC(t){return t>>>=0,t===0?32:31-(dC(t)/pC|0)|0}var rf=64,nf=4194304;function ql(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ih(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=ql(o):(s&=a,s!==0&&(n=ql(s)))}else a=r&~i,a!==0?n=ql(a):s!==0&&(n=ql(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ti(e),i=1<<r,n|=t[r],e&=~i;return n}function gC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-ti(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=gC(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function pp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function uE(){var t=rf;return rf<<=1,!(rf&4194240)&&(rf=64),t}function sd(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function gu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ti(e),t[e]=r}function xC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-ti(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function zm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ti(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var pt=0;function fE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var hE,Hm,dE,pE,mE,mp=!1,sf=[],Os=null,Ls=null,Ms=null,bc=new Map,Oc=new Map,Ts=[],_C="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function V1(t,e){switch(t){case"focusin":case"focusout":Os=null;break;case"dragenter":case"dragleave":Ls=null;break;case"mouseover":case"mouseout":Ms=null;break;case"pointerover":case"pointerout":bc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oc.delete(e.pointerId)}}function Ll(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=xu(e),e!==null&&Hm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function yC(t,e,r,n,i){switch(e){case"focusin":return Os=Ll(Os,t,e,r,n,i),!0;case"dragenter":return Ls=Ll(Ls,t,e,r,n,i),!0;case"mouseover":return Ms=Ll(Ms,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return bc.set(s,Ll(bc.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Oc.set(s,Ll(Oc.get(s)||null,t,e,r,n,i)),!0}return!1}function gE(t){var e=ga(t.target);if(e!==null){var r=Wa(e);if(r!==null){if(e=r.tag,e===13){if(e=iE(r),e!==null){t.blockedOn=e,mE(t.priority,function(){dE(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function bf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=gp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);up=n,r.target.dispatchEvent(n),up=null}else return e=xu(r),e!==null&&Hm(e),t.blockedOn=r,!1;e.shift()}return!0}function U1(t,e,r){bf(t)&&r.delete(e)}function wC(){mp=!1,Os!==null&&bf(Os)&&(Os=null),Ls!==null&&bf(Ls)&&(Ls=null),Ms!==null&&bf(Ms)&&(Ms=null),bc.forEach(U1),Oc.forEach(U1)}function Ml(t,e){t.blockedOn===e&&(t.blockedOn=null,mp||(mp=!0,wn.unstable_scheduleCallback(wn.unstable_NormalPriority,wC)))}function Lc(t){function e(i){return Ml(i,t)}if(0<sf.length){Ml(sf[0],t);for(var r=1;r<sf.length;r++){var n=sf[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Os!==null&&Ml(Os,t),Ls!==null&&Ml(Ls,t),Ms!==null&&Ml(Ms,t),bc.forEach(e),Oc.forEach(e),r=0;r<Ts.length;r++)n=Ts[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Ts.length&&(r=Ts[0],r.blockedOn===null);)gE(r),r.blockedOn===null&&Ts.shift()}var Lo=us.ReactCurrentBatchConfig,sh=!0;function EC(t,e,r,n){var i=pt,s=Lo.transition;Lo.transition=null;try{pt=1,$m(t,e,r,n)}finally{pt=i,Lo.transition=s}}function TC(t,e,r,n){var i=pt,s=Lo.transition;Lo.transition=null;try{pt=4,$m(t,e,r,n)}finally{pt=i,Lo.transition=s}}function $m(t,e,r,n){if(sh){var i=gp(t,e,r,n);if(i===null)md(t,e,n,ah,r),V1(t,n);else if(yC(i,t,e,r,n))n.stopPropagation();else if(V1(t,n),e&4&&-1<_C.indexOf(t)){for(;i!==null;){var s=xu(i);if(s!==null&&hE(s),s=gp(t,e,r,n),s===null&&md(t,e,n,ah,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else md(t,e,n,null,r)}}var ah=null;function gp(t,e,r,n){if(ah=null,t=Bm(n),t=ga(t),t!==null)if(e=Wa(t),e===null)t=null;else if(r=e.tag,r===13){if(t=iE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ah=t,null}function vE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(uC()){case jm:return 1;case lE:return 4;case nh:case fC:return 16;case cE:return 536870912;default:return 16}default:return 16}}var Rs=null,Wm=null,Of=null;function xE(){if(Of)return Of;var t,e=Wm,r=e.length,n,i="value"in Rs?Rs.value:Rs.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return Of=i.slice(t,1<n?1-n:void 0)}function Lf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function af(){return!0}function B1(){return!1}function kn(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?af:B1,this.isPropagationStopped=B1,this}return Ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=af)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=af)},persist:function(){},isPersistent:af}),e}var pl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gm=kn(pl),vu=Ot({},pl,{view:0,detail:0}),kC=kn(vu),ad,od,Vl,i0=Ot({},vu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Km,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Vl&&(Vl&&t.type==="mousemove"?(ad=t.screenX-Vl.screenX,od=t.screenY-Vl.screenY):od=ad=0,Vl=t),ad)},movementY:function(t){return"movementY"in t?t.movementY:od}}),j1=kn(i0),SC=Ot({},i0,{dataTransfer:0}),AC=kn(SC),IC=Ot({},vu,{relatedTarget:0}),ld=kn(IC),CC=Ot({},pl,{animationName:0,elapsedTime:0,pseudoElement:0}),RC=kn(CC),NC=Ot({},pl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),PC=kn(NC),FC=Ot({},pl,{data:0}),z1=kn(FC),DC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=OC[t])?!!e[t]:!1}function Km(){return LC}var MC=Ot({},vu,{key:function(t){if(t.key){var e=DC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Lf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?bC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Km,charCode:function(t){return t.type==="keypress"?Lf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Lf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),VC=kn(MC),UC=Ot({},i0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),H1=kn(UC),BC=Ot({},vu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Km}),jC=kn(BC),zC=Ot({},pl,{propertyName:0,elapsedTime:0,pseudoElement:0}),HC=kn(zC),$C=Ot({},i0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),WC=kn($C),GC=[9,13,27,32],qm=Zi&&"CompositionEvent"in window,lc=null;Zi&&"documentMode"in document&&(lc=document.documentMode);var KC=Zi&&"TextEvent"in window&&!lc,_E=Zi&&(!qm||lc&&8<lc&&11>=lc),$1=" ",W1=!1;function yE(t,e){switch(t){case"keyup":return GC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Eo=!1;function qC(t,e){switch(t){case"compositionend":return wE(e);case"keypress":return e.which!==32?null:(W1=!0,$1);case"textInput":return t=e.data,t===$1&&W1?null:t;default:return null}}function XC(t,e){if(Eo)return t==="compositionend"||!qm&&yE(t,e)?(t=xE(),Of=Wm=Rs=null,Eo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return _E&&e.locale!=="ko"?null:e.data;default:return null}}var YC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function G1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!YC[t.type]:e==="textarea"}function EE(t,e,r,n){Zw(n),e=oh(e,"onChange"),0<e.length&&(r=new Gm("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var cc=null,Mc=null;function QC(t){DE(t,0)}function s0(t){var e=So(t);if(Gw(e))return t}function JC(t,e){if(t==="change")return e}var TE=!1;if(Zi){var cd;if(Zi){var ud="oninput"in document;if(!ud){var K1=document.createElement("div");K1.setAttribute("oninput","return;"),ud=typeof K1.oninput=="function"}cd=ud}else cd=!1;TE=cd&&(!document.documentMode||9<document.documentMode)}function q1(){cc&&(cc.detachEvent("onpropertychange",kE),Mc=cc=null)}function kE(t){if(t.propertyName==="value"&&s0(Mc)){var e=[];EE(e,Mc,t,Bm(t)),nE(QC,e)}}function ZC(t,e,r){t==="focusin"?(q1(),cc=e,Mc=r,cc.attachEvent("onpropertychange",kE)):t==="focusout"&&q1()}function e4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return s0(Mc)}function t4(t,e){if(t==="click")return s0(e)}function r4(t,e){if(t==="input"||t==="change")return s0(e)}function n4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var si=typeof Object.is=="function"?Object.is:n4;function Vc(t,e){if(si(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Jd.call(e,i)||!si(t[i],e[i]))return!1}return!0}function X1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Y1(t,e){var r=X1(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=X1(r)}}function SE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?SE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function AE(){for(var t=window,e=eh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=eh(t.document)}return e}function Xm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function i4(t){var e=AE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&SE(r.ownerDocument.documentElement,r)){if(n!==null&&Xm(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Y1(r,s);var a=Y1(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var s4=Zi&&"documentMode"in document&&11>=document.documentMode,To=null,vp=null,uc=null,xp=!1;function Q1(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;xp||To==null||To!==eh(n)||(n=To,"selectionStart"in n&&Xm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),uc&&Vc(uc,n)||(uc=n,n=oh(vp,"onSelect"),0<n.length&&(e=new Gm("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=To)))}function of(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var ko={animationend:of("Animation","AnimationEnd"),animationiteration:of("Animation","AnimationIteration"),animationstart:of("Animation","AnimationStart"),transitionend:of("Transition","TransitionEnd")},fd={},IE={};Zi&&(IE=document.createElement("div").style,"AnimationEvent"in window||(delete ko.animationend.animation,delete ko.animationiteration.animation,delete ko.animationstart.animation),"TransitionEvent"in window||delete ko.transitionend.transition);function a0(t){if(fd[t])return fd[t];if(!ko[t])return t;var e=ko[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in IE)return fd[t]=e[r];return t}var CE=a0("animationend"),RE=a0("animationiteration"),NE=a0("animationstart"),PE=a0("transitionend"),FE=new Map,J1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ra(t,e){FE.set(t,e),$a(e,[t])}for(var hd=0;hd<J1.length;hd++){var dd=J1[hd],a4=dd.toLowerCase(),o4=dd[0].toUpperCase()+dd.slice(1);ra(a4,"on"+o4)}ra(CE,"onAnimationEnd");ra(RE,"onAnimationIteration");ra(NE,"onAnimationStart");ra("dblclick","onDoubleClick");ra("focusin","onFocus");ra("focusout","onBlur");ra(PE,"onTransitionEnd");Ko("onMouseEnter",["mouseout","mouseover"]);Ko("onMouseLeave",["mouseout","mouseover"]);Ko("onPointerEnter",["pointerout","pointerover"]);Ko("onPointerLeave",["pointerout","pointerover"]);$a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$a("onBeforeInput",["compositionend","keypress","textInput","paste"]);$a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),l4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xl));function Z1(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,aC(n,e,void 0,t),t.currentTarget=null}function DE(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Z1(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Z1(i,o,c),s=l}}}if(rh)throw t=dp,rh=!1,dp=null,t}function At(t,e){var r=e[Tp];r===void 0&&(r=e[Tp]=new Set);var n=t+"__bubble";r.has(n)||(bE(e,t,2,!1),r.add(n))}function pd(t,e,r){var n=0;e&&(n|=4),bE(r,t,n,e)}var lf="_reactListening"+Math.random().toString(36).slice(2);function Uc(t){if(!t[lf]){t[lf]=!0,jw.forEach(function(r){r!=="selectionchange"&&(l4.has(r)||pd(r,!1,t),pd(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[lf]||(e[lf]=!0,pd("selectionchange",!1,e))}}function bE(t,e,r,n){switch(vE(e)){case 1:var i=EC;break;case 4:i=TC;break;default:i=$m}r=i.bind(null,e,r,t),i=void 0,!hp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function md(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=ga(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}nE(function(){var c=s,f=Bm(r),h=[];e:{var d=FE.get(t);if(d!==void 0){var p=Gm,v=t;switch(t){case"keypress":if(Lf(r)===0)break e;case"keydown":case"keyup":p=VC;break;case"focusin":v="focus",p=ld;break;case"focusout":v="blur",p=ld;break;case"beforeblur":case"afterblur":p=ld;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=j1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=AC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=jC;break;case CE:case RE:case NE:p=RC;break;case PE:p=HC;break;case"scroll":p=kC;break;case"wheel":p=WC;break;case"copy":case"cut":case"paste":p=PC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=H1}var m=(e&4)!==0,w=!m&&t==="scroll",T=m?d!==null?d+"Capture":null:d;m=[];for(var E=c,y;E!==null;){y=E;var N=y.stateNode;if(y.tag===5&&N!==null&&(y=N,T!==null&&(N=Dc(E,T),N!=null&&m.push(Bc(E,N,y)))),w)break;E=E.return}0<m.length&&(d=new p(d,v,null,r,f),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&r!==up&&(v=r.relatedTarget||r.fromElement)&&(ga(v)||v[es]))break e;if((p||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,p?(v=r.relatedTarget||r.toElement,p=c,v=v?ga(v):null,v!==null&&(w=Wa(v),v!==w||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=c),p!==v)){if(m=j1,N="onMouseLeave",T="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(m=H1,N="onPointerLeave",T="onPointerEnter",E="pointer"),w=p==null?d:So(p),y=v==null?d:So(v),d=new m(N,E+"leave",p,r,f),d.target=w,d.relatedTarget=y,N=null,ga(f)===c&&(m=new m(T,E+"enter",v,r,f),m.target=y,m.relatedTarget=w,N=m),w=N,p&&v)t:{for(m=p,T=v,E=0,y=m;y;y=fo(y))E++;for(y=0,N=T;N;N=fo(N))y++;for(;0<E-y;)m=fo(m),E--;for(;0<y-E;)T=fo(T),y--;for(;E--;){if(m===T||T!==null&&m===T.alternate)break t;m=fo(m),T=fo(T)}m=null}else m=null;p!==null&&ex(h,d,p,m,!1),v!==null&&w!==null&&ex(h,w,v,m,!0)}}e:{if(d=c?So(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var j=JC;else if(G1(d))if(TE)j=r4;else{j=e4;var U=ZC}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(j=t4);if(j&&(j=j(t,c))){EE(h,j,r,f);break e}U&&U(t,d,c),t==="focusout"&&(U=d._wrapperState)&&U.controlled&&d.type==="number"&&sp(d,"number",d.value)}switch(U=c?So(c):window,t){case"focusin":(G1(U)||U.contentEditable==="true")&&(To=U,vp=c,uc=null);break;case"focusout":uc=vp=To=null;break;case"mousedown":xp=!0;break;case"contextmenu":case"mouseup":case"dragend":xp=!1,Q1(h,r,f);break;case"selectionchange":if(s4)break;case"keydown":case"keyup":Q1(h,r,f)}var g;if(qm)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Eo?yE(t,r)&&(k="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(_E&&r.locale!=="ko"&&(Eo||k!=="onCompositionStart"?k==="onCompositionEnd"&&Eo&&(g=xE()):(Rs=f,Wm="value"in Rs?Rs.value:Rs.textContent,Eo=!0)),U=oh(c,k),0<U.length&&(k=new z1(k,t,null,r,f),h.push({event:k,listeners:U}),g?k.data=g:(g=wE(r),g!==null&&(k.data=g)))),(g=KC?qC(t,r):XC(t,r))&&(c=oh(c,"onBeforeInput"),0<c.length&&(f=new z1("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:c}),f.data=g))}DE(h,e)})}function Bc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function oh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Dc(t,r),s!=null&&n.unshift(Bc(t,s,i)),s=Dc(t,e),s!=null&&n.push(Bc(t,s,i))),t=t.return}return n}function fo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ex(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Dc(r,s),l!=null&&a.unshift(Bc(r,l,o))):i||(l=Dc(r,s),l!=null&&a.push(Bc(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var c4=/\r\n?/g,u4=/\u0000|\uFFFD/g;function tx(t){return(typeof t=="string"?t:""+t).replace(c4,`
`).replace(u4,"")}function cf(t,e,r){if(e=tx(e),tx(t)!==e&&r)throw Error(_e(425))}function lh(){}var _p=null,yp=null;function wp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ep=typeof setTimeout=="function"?setTimeout:void 0,f4=typeof clearTimeout=="function"?clearTimeout:void 0,rx=typeof Promise=="function"?Promise:void 0,h4=typeof queueMicrotask=="function"?queueMicrotask:typeof rx<"u"?function(t){return rx.resolve(null).then(t).catch(d4)}:Ep;function d4(t){setTimeout(function(){throw t})}function gd(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Lc(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Lc(e)}function Vs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ml=Math.random().toString(36).slice(2),mi="__reactFiber$"+ml,jc="__reactProps$"+ml,es="__reactContainer$"+ml,Tp="__reactEvents$"+ml,p4="__reactListeners$"+ml,m4="__reactHandles$"+ml;function ga(t){var e=t[mi];if(e)return e;for(var r=t.parentNode;r;){if(e=r[es]||r[mi]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=nx(t);t!==null;){if(r=t[mi])return r;t=nx(t)}return e}t=r,r=t.parentNode}return null}function xu(t){return t=t[mi]||t[es],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function So(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(_e(33))}function o0(t){return t[jc]||null}var kp=[],Ao=-1;function na(t){return{current:t}}function Ct(t){0>Ao||(t.current=kp[Ao],kp[Ao]=null,Ao--)}function yt(t,e){Ao++,kp[Ao]=t.current,t.current=e}var qs={},Br=na(qs),cn=na(!1),Ra=qs;function qo(t,e){var r=t.type.contextTypes;if(!r)return qs;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function un(t){return t=t.childContextTypes,t!=null}function ch(){Ct(cn),Ct(Br)}function ix(t,e,r){if(Br.current!==qs)throw Error(_e(168));yt(Br,e),yt(cn,r)}function OE(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(_e(108,ZI(t)||"Unknown",i));return Ot({},r,n)}function uh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qs,Ra=Br.current,yt(Br,t),yt(cn,cn.current),!0}function sx(t,e,r){var n=t.stateNode;if(!n)throw Error(_e(169));r?(t=OE(t,e,Ra),n.__reactInternalMemoizedMergedChildContext=t,Ct(cn),Ct(Br),yt(Br,t)):Ct(cn),yt(cn,r)}var Bi=null,l0=!1,vd=!1;function LE(t){Bi===null?Bi=[t]:Bi.push(t)}function g4(t){l0=!0,LE(t)}function ia(){if(!vd&&Bi!==null){vd=!0;var t=0,e=pt;try{var r=Bi;for(pt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Bi=null,l0=!1}catch(i){throw Bi!==null&&(Bi=Bi.slice(t+1)),oE(jm,ia),i}finally{pt=e,vd=!1}}return null}var Io=[],Co=0,fh=null,hh=0,Pn=[],Fn=0,Na=null,ji=1,zi="";function ua(t,e){Io[Co++]=hh,Io[Co++]=fh,fh=t,hh=e}function ME(t,e,r){Pn[Fn++]=ji,Pn[Fn++]=zi,Pn[Fn++]=Na,Na=t;var n=ji;t=zi;var i=32-ti(n)-1;n&=~(1<<i),r+=1;var s=32-ti(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,ji=1<<32-ti(e)+i|r<<i|n,zi=s+t}else ji=1<<s|r<<i|n,zi=t}function Ym(t){t.return!==null&&(ua(t,1),ME(t,1,0))}function Qm(t){for(;t===fh;)fh=Io[--Co],Io[Co]=null,hh=Io[--Co],Io[Co]=null;for(;t===Na;)Na=Pn[--Fn],Pn[Fn]=null,zi=Pn[--Fn],Pn[Fn]=null,ji=Pn[--Fn],Pn[Fn]=null}var yn=null,xn=null,Pt=!1,Xn=null;function VE(t,e){var r=Dn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function ax(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,yn=t,xn=Vs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,yn=t,xn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Na!==null?{id:ji,overflow:zi}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Dn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,yn=t,xn=null,!0):!1;default:return!1}}function Sp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ap(t){if(Pt){var e=xn;if(e){var r=e;if(!ax(t,e)){if(Sp(t))throw Error(_e(418));e=Vs(r.nextSibling);var n=yn;e&&ax(t,e)?VE(n,r):(t.flags=t.flags&-4097|2,Pt=!1,yn=t)}}else{if(Sp(t))throw Error(_e(418));t.flags=t.flags&-4097|2,Pt=!1,yn=t}}}function ox(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;yn=t}function uf(t){if(t!==yn)return!1;if(!Pt)return ox(t),Pt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!wp(t.type,t.memoizedProps)),e&&(e=xn)){if(Sp(t))throw UE(),Error(_e(418));for(;e;)VE(t,e),e=Vs(e.nextSibling)}if(ox(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(_e(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){xn=Vs(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}xn=null}}else xn=yn?Vs(t.stateNode.nextSibling):null;return!0}function UE(){for(var t=xn;t;)t=Vs(t.nextSibling)}function Xo(){xn=yn=null,Pt=!1}function Jm(t){Xn===null?Xn=[t]:Xn.push(t)}var v4=us.ReactCurrentBatchConfig;function Ul(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(_e(309));var n=r.stateNode}if(!n)throw Error(_e(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(_e(284));if(!r._owner)throw Error(_e(290,t))}return t}function ff(t,e){throw t=Object.prototype.toString.call(e),Error(_e(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lx(t){var e=t._init;return e(t._payload)}function BE(t){function e(T,E){if(t){var y=T.deletions;y===null?(T.deletions=[E],T.flags|=16):y.push(E)}}function r(T,E){if(!t)return null;for(;E!==null;)e(T,E),E=E.sibling;return null}function n(T,E){for(T=new Map;E!==null;)E.key!==null?T.set(E.key,E):T.set(E.index,E),E=E.sibling;return T}function i(T,E){return T=zs(T,E),T.index=0,T.sibling=null,T}function s(T,E,y){return T.index=y,t?(y=T.alternate,y!==null?(y=y.index,y<E?(T.flags|=2,E):y):(T.flags|=2,E)):(T.flags|=1048576,E)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,E,y,N){return E===null||E.tag!==6?(E=kd(y,T.mode,N),E.return=T,E):(E=i(E,y),E.return=T,E)}function l(T,E,y,N){var j=y.type;return j===wo?f(T,E,y.props.children,N,y.key):E!==null&&(E.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===ws&&lx(j)===E.type)?(N=i(E,y.props),N.ref=Ul(T,E,y),N.return=T,N):(N=Hf(y.type,y.key,y.props,null,T.mode,N),N.ref=Ul(T,E,y),N.return=T,N)}function c(T,E,y,N){return E===null||E.tag!==4||E.stateNode.containerInfo!==y.containerInfo||E.stateNode.implementation!==y.implementation?(E=Sd(y,T.mode,N),E.return=T,E):(E=i(E,y.children||[]),E.return=T,E)}function f(T,E,y,N,j){return E===null||E.tag!==7?(E=ka(y,T.mode,N,j),E.return=T,E):(E=i(E,y),E.return=T,E)}function h(T,E,y){if(typeof E=="string"&&E!==""||typeof E=="number")return E=kd(""+E,T.mode,y),E.return=T,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Zu:return y=Hf(E.type,E.key,E.props,null,T.mode,y),y.ref=Ul(T,null,E),y.return=T,y;case yo:return E=Sd(E,T.mode,y),E.return=T,E;case ws:var N=E._init;return h(T,N(E._payload),y)}if(Kl(E)||bl(E))return E=ka(E,T.mode,y,null),E.return=T,E;ff(T,E)}return null}function d(T,E,y,N){var j=E!==null?E.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return j!==null?null:o(T,E,""+y,N);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Zu:return y.key===j?l(T,E,y,N):null;case yo:return y.key===j?c(T,E,y,N):null;case ws:return j=y._init,d(T,E,j(y._payload),N)}if(Kl(y)||bl(y))return j!==null?null:f(T,E,y,N,null);ff(T,y)}return null}function p(T,E,y,N,j){if(typeof N=="string"&&N!==""||typeof N=="number")return T=T.get(y)||null,o(E,T,""+N,j);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Zu:return T=T.get(N.key===null?y:N.key)||null,l(E,T,N,j);case yo:return T=T.get(N.key===null?y:N.key)||null,c(E,T,N,j);case ws:var U=N._init;return p(T,E,y,U(N._payload),j)}if(Kl(N)||bl(N))return T=T.get(y)||null,f(E,T,N,j,null);ff(E,N)}return null}function v(T,E,y,N){for(var j=null,U=null,g=E,k=E=0,S=null;g!==null&&k<y.length;k++){g.index>k?(S=g,g=null):S=g.sibling;var C=d(T,g,y[k],N);if(C===null){g===null&&(g=S);break}t&&g&&C.alternate===null&&e(T,g),E=s(C,E,k),U===null?j=C:U.sibling=C,U=C,g=S}if(k===y.length)return r(T,g),Pt&&ua(T,k),j;if(g===null){for(;k<y.length;k++)g=h(T,y[k],N),g!==null&&(E=s(g,E,k),U===null?j=g:U.sibling=g,U=g);return Pt&&ua(T,k),j}for(g=n(T,g);k<y.length;k++)S=p(g,T,k,y[k],N),S!==null&&(t&&S.alternate!==null&&g.delete(S.key===null?k:S.key),E=s(S,E,k),U===null?j=S:U.sibling=S,U=S);return t&&g.forEach(function(P){return e(T,P)}),Pt&&ua(T,k),j}function m(T,E,y,N){var j=bl(y);if(typeof j!="function")throw Error(_e(150));if(y=j.call(y),y==null)throw Error(_e(151));for(var U=j=null,g=E,k=E=0,S=null,C=y.next();g!==null&&!C.done;k++,C=y.next()){g.index>k?(S=g,g=null):S=g.sibling;var P=d(T,g,C.value,N);if(P===null){g===null&&(g=S);break}t&&g&&P.alternate===null&&e(T,g),E=s(P,E,k),U===null?j=P:U.sibling=P,U=P,g=S}if(C.done)return r(T,g),Pt&&ua(T,k),j;if(g===null){for(;!C.done;k++,C=y.next())C=h(T,C.value,N),C!==null&&(E=s(C,E,k),U===null?j=C:U.sibling=C,U=C);return Pt&&ua(T,k),j}for(g=n(T,g);!C.done;k++,C=y.next())C=p(g,T,k,C.value,N),C!==null&&(t&&C.alternate!==null&&g.delete(C.key===null?k:C.key),E=s(C,E,k),U===null?j=C:U.sibling=C,U=C);return t&&g.forEach(function(F){return e(T,F)}),Pt&&ua(T,k),j}function w(T,E,y,N){if(typeof y=="object"&&y!==null&&y.type===wo&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Zu:e:{for(var j=y.key,U=E;U!==null;){if(U.key===j){if(j=y.type,j===wo){if(U.tag===7){r(T,U.sibling),E=i(U,y.props.children),E.return=T,T=E;break e}}else if(U.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===ws&&lx(j)===U.type){r(T,U.sibling),E=i(U,y.props),E.ref=Ul(T,U,y),E.return=T,T=E;break e}r(T,U);break}else e(T,U);U=U.sibling}y.type===wo?(E=ka(y.props.children,T.mode,N,y.key),E.return=T,T=E):(N=Hf(y.type,y.key,y.props,null,T.mode,N),N.ref=Ul(T,E,y),N.return=T,T=N)}return a(T);case yo:e:{for(U=y.key;E!==null;){if(E.key===U)if(E.tag===4&&E.stateNode.containerInfo===y.containerInfo&&E.stateNode.implementation===y.implementation){r(T,E.sibling),E=i(E,y.children||[]),E.return=T,T=E;break e}else{r(T,E);break}else e(T,E);E=E.sibling}E=Sd(y,T.mode,N),E.return=T,T=E}return a(T);case ws:return U=y._init,w(T,E,U(y._payload),N)}if(Kl(y))return v(T,E,y,N);if(bl(y))return m(T,E,y,N);ff(T,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,E!==null&&E.tag===6?(r(T,E.sibling),E=i(E,y),E.return=T,T=E):(r(T,E),E=kd(y,T.mode,N),E.return=T,T=E),a(T)):r(T,E)}return w}var Yo=BE(!0),jE=BE(!1),dh=na(null),ph=null,Ro=null,Zm=null;function eg(){Zm=Ro=ph=null}function tg(t){var e=dh.current;Ct(dh),t._currentValue=e}function Ip(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Mo(t,e){ph=t,Zm=Ro=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ln=!0),t.firstContext=null)}function Mn(t){var e=t._currentValue;if(Zm!==t)if(t={context:t,memoizedValue:e,next:null},Ro===null){if(ph===null)throw Error(_e(308));Ro=t,ph.dependencies={lanes:0,firstContext:t}}else Ro=Ro.next=t;return e}var va=null;function rg(t){va===null?va=[t]:va.push(t)}function zE(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,rg(e)):(r.next=i.next,i.next=r),e.interleaved=r,ts(t,n)}function ts(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Es=!1;function ng(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function HE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Us(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,it&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,ts(t,r)}return i=n.interleaved,i===null?(e.next=e,rg(n)):(e.next=i.next,i.next=e),n.interleaved=e,ts(t,r)}function Mf(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,zm(t,r)}}function cx(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function mh(t,e,r,n){var i=t.updateQueue;Es=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,f=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=t,m=o;switch(d=e,p=r,m.tag){case 1:if(v=m.payload,typeof v=="function"){h=v.call(p,h,d);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=m.payload,d=typeof v=="function"?v.call(p,h,d):v,d==null)break e;h=Ot({},h,d);break e;case 2:Es=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=p,l=h):f=f.next=p,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(f===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Fa|=a,t.lanes=a,t.memoizedState=h}}function ux(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(_e(191,i));i.call(n)}}}var _u={},xi=na(_u),zc=na(_u),Hc=na(_u);function xa(t){if(t===_u)throw Error(_e(174));return t}function ig(t,e){switch(yt(Hc,e),yt(zc,t),yt(xi,_u),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:op(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=op(e,t)}Ct(xi),yt(xi,e)}function Qo(){Ct(xi),Ct(zc),Ct(Hc)}function $E(t){xa(Hc.current);var e=xa(xi.current),r=op(e,t.type);e!==r&&(yt(zc,t),yt(xi,r))}function sg(t){zc.current===t&&(Ct(xi),Ct(zc))}var Dt=na(0);function gh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xd=[];function ag(){for(var t=0;t<xd.length;t++)xd[t]._workInProgressVersionPrimary=null;xd.length=0}var Vf=us.ReactCurrentDispatcher,_d=us.ReactCurrentBatchConfig,Pa=0,bt=null,tr=null,ur=null,vh=!1,fc=!1,$c=0,x4=0;function Rr(){throw Error(_e(321))}function og(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!si(t[r],e[r]))return!1;return!0}function lg(t,e,r,n,i,s){if(Pa=s,bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Vf.current=t===null||t.memoizedState===null?E4:T4,t=r(n,i),fc){s=0;do{if(fc=!1,$c=0,25<=s)throw Error(_e(301));s+=1,ur=tr=null,e.updateQueue=null,Vf.current=k4,t=r(n,i)}while(fc)}if(Vf.current=xh,e=tr!==null&&tr.next!==null,Pa=0,ur=tr=bt=null,vh=!1,e)throw Error(_e(300));return t}function cg(){var t=$c!==0;return $c=0,t}function pi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ur===null?bt.memoizedState=ur=t:ur=ur.next=t,ur}function Vn(){if(tr===null){var t=bt.alternate;t=t!==null?t.memoizedState:null}else t=tr.next;var e=ur===null?bt.memoizedState:ur.next;if(e!==null)ur=e,tr=t;else{if(t===null)throw Error(_e(310));tr=t,t={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},ur===null?bt.memoizedState=ur=t:ur=ur.next=t}return ur}function Wc(t,e){return typeof e=="function"?e(t):e}function yd(t){var e=Vn(),r=e.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=t;var n=tr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var f=c.lane;if((Pa&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,bt.lanes|=f,Fa|=f}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,si(n,e.memoizedState)||(ln=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,bt.lanes|=s,Fa|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function wd(t){var e=Vn(),r=e.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);si(s,e.memoizedState)||(ln=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function WE(){}function GE(t,e){var r=bt,n=Vn(),i=e(),s=!si(n.memoizedState,i);if(s&&(n.memoizedState=i,ln=!0),n=n.queue,ug(XE.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||ur!==null&&ur.memoizedState.tag&1){if(r.flags|=2048,Gc(9,qE.bind(null,r,n,i,e),void 0,null),hr===null)throw Error(_e(349));Pa&30||KE(r,e,i)}return i}function KE(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function qE(t,e,r,n){e.value=r,e.getSnapshot=n,YE(e)&&QE(t)}function XE(t,e,r){return r(function(){YE(e)&&QE(t)})}function YE(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!si(t,r)}catch{return!0}}function QE(t){var e=ts(t,1);e!==null&&ri(e,t,1,-1)}function fx(t){var e=pi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wc,lastRenderedState:t},e.queue=t,t=t.dispatch=w4.bind(null,bt,t),[e.memoizedState,t]}function Gc(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function JE(){return Vn().memoizedState}function Uf(t,e,r,n){var i=pi();bt.flags|=t,i.memoizedState=Gc(1|e,r,void 0,n===void 0?null:n)}function c0(t,e,r,n){var i=Vn();n=n===void 0?null:n;var s=void 0;if(tr!==null){var a=tr.memoizedState;if(s=a.destroy,n!==null&&og(n,a.deps)){i.memoizedState=Gc(e,r,s,n);return}}bt.flags|=t,i.memoizedState=Gc(1|e,r,s,n)}function hx(t,e){return Uf(8390656,8,t,e)}function ug(t,e){return c0(2048,8,t,e)}function ZE(t,e){return c0(4,2,t,e)}function e2(t,e){return c0(4,4,t,e)}function t2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function r2(t,e,r){return r=r!=null?r.concat([t]):null,c0(4,4,t2.bind(null,e,t),r)}function fg(){}function n2(t,e){var r=Vn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&og(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function i2(t,e){var r=Vn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&og(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function s2(t,e,r){return Pa&21?(si(r,e)||(r=uE(),bt.lanes|=r,Fa|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ln=!0),t.memoizedState=r)}function _4(t,e){var r=pt;pt=r!==0&&4>r?r:4,t(!0);var n=_d.transition;_d.transition={};try{t(!1),e()}finally{pt=r,_d.transition=n}}function a2(){return Vn().memoizedState}function y4(t,e,r){var n=js(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},o2(t))l2(e,r);else if(r=zE(t,e,r,n),r!==null){var i=qr();ri(r,t,n,i),c2(r,e,n)}}function w4(t,e,r){var n=js(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(o2(t))l2(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,si(o,a)){var l=e.interleaved;l===null?(i.next=i,rg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=zE(t,e,i,n),r!==null&&(i=qr(),ri(r,t,n,i),c2(r,e,n))}}function o2(t){var e=t.alternate;return t===bt||e!==null&&e===bt}function l2(t,e){fc=vh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function c2(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,zm(t,r)}}var xh={readContext:Mn,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useInsertionEffect:Rr,useLayoutEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useMutableSource:Rr,useSyncExternalStore:Rr,useId:Rr,unstable_isNewReconciler:!1},E4={readContext:Mn,useCallback:function(t,e){return pi().memoizedState=[t,e===void 0?null:e],t},useContext:Mn,useEffect:hx,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Uf(4194308,4,t2.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Uf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Uf(4,2,t,e)},useMemo:function(t,e){var r=pi();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=pi();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=y4.bind(null,bt,t),[n.memoizedState,t]},useRef:function(t){var e=pi();return t={current:t},e.memoizedState=t},useState:fx,useDebugValue:fg,useDeferredValue:function(t){return pi().memoizedState=t},useTransition:function(){var t=fx(!1),e=t[0];return t=_4.bind(null,t[1]),pi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=bt,i=pi();if(Pt){if(r===void 0)throw Error(_e(407));r=r()}else{if(r=e(),hr===null)throw Error(_e(349));Pa&30||KE(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,hx(XE.bind(null,n,s,t),[t]),n.flags|=2048,Gc(9,qE.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=pi(),e=hr.identifierPrefix;if(Pt){var r=zi,n=ji;r=(n&~(1<<32-ti(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=$c++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=x4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},T4={readContext:Mn,useCallback:n2,useContext:Mn,useEffect:ug,useImperativeHandle:r2,useInsertionEffect:ZE,useLayoutEffect:e2,useMemo:i2,useReducer:yd,useRef:JE,useState:function(){return yd(Wc)},useDebugValue:fg,useDeferredValue:function(t){var e=Vn();return s2(e,tr.memoizedState,t)},useTransition:function(){var t=yd(Wc)[0],e=Vn().memoizedState;return[t,e]},useMutableSource:WE,useSyncExternalStore:GE,useId:a2,unstable_isNewReconciler:!1},k4={readContext:Mn,useCallback:n2,useContext:Mn,useEffect:ug,useImperativeHandle:r2,useInsertionEffect:ZE,useLayoutEffect:e2,useMemo:i2,useReducer:wd,useRef:JE,useState:function(){return wd(Wc)},useDebugValue:fg,useDeferredValue:function(t){var e=Vn();return tr===null?e.memoizedState=t:s2(e,tr.memoizedState,t)},useTransition:function(){var t=wd(Wc)[0],e=Vn().memoizedState;return[t,e]},useMutableSource:WE,useSyncExternalStore:GE,useId:a2,unstable_isNewReconciler:!1};function Gn(t,e){if(t&&t.defaultProps){e=Ot({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Cp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ot({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var u0={isMounted:function(t){return(t=t._reactInternals)?Wa(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=qr(),i=js(t),s=qi(n,i);s.payload=e,r!=null&&(s.callback=r),e=Us(t,s,i),e!==null&&(ri(e,t,i,n),Mf(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=qr(),i=js(t),s=qi(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Us(t,s,i),e!==null&&(ri(e,t,i,n),Mf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=qr(),n=js(t),i=qi(r,n);i.tag=2,e!=null&&(i.callback=e),e=Us(t,i,n),e!==null&&(ri(e,t,n,r),Mf(e,t,n))}};function dx(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Vc(r,n)||!Vc(i,s):!0}function u2(t,e,r){var n=!1,i=qs,s=e.contextType;return typeof s=="object"&&s!==null?s=Mn(s):(i=un(e)?Ra:Br.current,n=e.contextTypes,s=(n=n!=null)?qo(t,i):qs),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=u0,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function px(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&u0.enqueueReplaceState(e,e.state,null)}function Rp(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},ng(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Mn(s):(s=un(e)?Ra:Br.current,i.context=qo(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Cp(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&u0.enqueueReplaceState(i,i.state,null),mh(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Jo(t,e){try{var r="",n=e;do r+=JI(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ed(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Np(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var S4=typeof WeakMap=="function"?WeakMap:Map;function f2(t,e,r){r=qi(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){yh||(yh=!0,Bp=n),Np(t,e)},r}function h2(t,e,r){r=qi(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Np(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Np(t,e),typeof n!="function"&&(Bs===null?Bs=new Set([this]):Bs.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function mx(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new S4;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=U4.bind(null,t,e,r),e.then(t,t))}function gx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function vx(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=qi(-1,1),e.tag=2,Us(r,e,1))),r.lanes|=1),t)}var A4=us.ReactCurrentOwner,ln=!1;function $r(t,e,r,n){e.child=t===null?jE(e,null,r,n):Yo(e,t.child,r,n)}function xx(t,e,r,n,i){r=r.render;var s=e.ref;return Mo(e,i),n=lg(t,e,r,n,s,i),r=cg(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,rs(t,e,i)):(Pt&&r&&Ym(e),e.flags|=1,$r(t,e,n,i),e.child)}function _x(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!_g(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,d2(t,e,s,n,i)):(t=Hf(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Vc,r(a,n)&&t.ref===e.ref)return rs(t,e,i)}return e.flags|=1,t=zs(s,n),t.ref=e.ref,t.return=e,e.child=t}function d2(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Vc(s,n)&&t.ref===e.ref)if(ln=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(ln=!0);else return e.lanes=t.lanes,rs(t,e,i)}return Pp(t,e,r,n,i)}function p2(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},yt(Po,pn),pn|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,yt(Po,pn),pn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,yt(Po,pn),pn|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,yt(Po,pn),pn|=n;return $r(t,e,i,r),e.child}function m2(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Pp(t,e,r,n,i){var s=un(r)?Ra:Br.current;return s=qo(e,s),Mo(e,i),r=lg(t,e,r,n,s,i),n=cg(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,rs(t,e,i)):(Pt&&n&&Ym(e),e.flags|=1,$r(t,e,r,i),e.child)}function yx(t,e,r,n,i){if(un(r)){var s=!0;uh(e)}else s=!1;if(Mo(e,i),e.stateNode===null)Bf(t,e),u2(e,r,n),Rp(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Mn(c):(c=un(r)?Ra:Br.current,c=qo(e,c));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&px(e,a,n,c),Es=!1;var d=e.memoizedState;a.state=d,mh(e,n,a,i),l=e.memoizedState,o!==n||d!==l||cn.current||Es?(typeof f=="function"&&(Cp(e,r,f,n),l=e.memoizedState),(o=Es||dx(e,r,o,n,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,HE(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Gn(e.type,o),a.props=c,h=e.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Mn(l):(l=un(r)?Ra:Br.current,l=qo(e,l));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&px(e,a,n,l),Es=!1,d=e.memoizedState,a.state=d,mh(e,n,a,i);var v=e.memoizedState;o!==h||d!==v||cn.current||Es?(typeof p=="function"&&(Cp(e,r,p,n),v=e.memoizedState),(c=Es||dx(e,r,c,n,d,v,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,v,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,v,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=v),a.props=n,a.state=v,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return Fp(t,e,r,n,s,i)}function Fp(t,e,r,n,i,s){m2(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&sx(e,r,!1),rs(t,e,s);n=e.stateNode,A4.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Yo(e,t.child,null,s),e.child=Yo(e,null,o,s)):$r(t,e,o,s),e.memoizedState=n.state,i&&sx(e,r,!0),e.child}function g2(t){var e=t.stateNode;e.pendingContext?ix(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ix(t,e.context,!1),ig(t,e.containerInfo)}function wx(t,e,r,n,i){return Xo(),Jm(i),e.flags|=256,$r(t,e,r,n),e.child}var Dp={dehydrated:null,treeContext:null,retryLane:0};function bp(t){return{baseLanes:t,cachePool:null,transitions:null}}function v2(t,e,r){var n=e.pendingProps,i=Dt.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),yt(Dt,i&1),t===null)return Ap(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=d0(a,n,0,null),t=ka(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=bp(r),e.memoizedState=Dp,t):hg(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return I4(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=zs(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=zs(o,s):(s=ka(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?bp(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Dp,n}return s=t.child,t=s.sibling,n=zs(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function hg(t,e){return e=d0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function hf(t,e,r,n){return n!==null&&Jm(n),Yo(e,t.child,null,r),t=hg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function I4(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=Ed(Error(_e(422))),hf(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=d0({mode:"visible",children:n.children},i,0,null),s=ka(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Yo(e,t.child,null,a),e.child.memoizedState=bp(a),e.memoizedState=Dp,s);if(!(e.mode&1))return hf(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(_e(419)),n=Ed(s,n,void 0),hf(t,e,a,n)}if(o=(a&t.childLanes)!==0,ln||o){if(n=hr,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ts(t,i),ri(n,t,i,-1))}return xg(),n=Ed(Error(_e(421))),hf(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=B4.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,xn=Vs(i.nextSibling),yn=e,Pt=!0,Xn=null,t!==null&&(Pn[Fn++]=ji,Pn[Fn++]=zi,Pn[Fn++]=Na,ji=t.id,zi=t.overflow,Na=e),e=hg(e,n.children),e.flags|=4096,e)}function Ex(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Ip(t.return,e,r)}function Td(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function x2(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if($r(t,e,n.children,r),n=Dt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ex(t,r,e);else if(t.tag===19)Ex(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(yt(Dt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&gh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Td(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&gh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Td(e,!0,r,null,s);break;case"together":Td(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function rs(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Fa|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(_e(153));if(e.child!==null){for(t=e.child,r=zs(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=zs(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function C4(t,e,r){switch(e.tag){case 3:g2(e),Xo();break;case 5:$E(e);break;case 1:un(e.type)&&uh(e);break;case 4:ig(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;yt(dh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(yt(Dt,Dt.current&1),e.flags|=128,null):r&e.child.childLanes?v2(t,e,r):(yt(Dt,Dt.current&1),t=rs(t,e,r),t!==null?t.sibling:null);yt(Dt,Dt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return x2(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),yt(Dt,Dt.current),n)break;return null;case 22:case 23:return e.lanes=0,p2(t,e,r)}return rs(t,e,r)}var _2,Op,y2,w2;_2=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Op=function(){};y2=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,xa(xi.current);var s=null;switch(r){case"input":i=np(t,i),n=np(t,n),s=[];break;case"select":i=Ot({},i,{value:void 0}),n=Ot({},n,{value:void 0}),s=[];break;case"textarea":i=ap(t,i),n=ap(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=lh)}lp(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Pc.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Pc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&At("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};w2=function(t,e,r,n){r!==n&&(e.flags|=4)};function Bl(t,e){if(!Pt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Nr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function R4(t,e,r){var n=e.pendingProps;switch(Qm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(e),null;case 1:return un(e.type)&&ch(),Nr(e),null;case 3:return n=e.stateNode,Qo(),Ct(cn),Ct(Br),ag(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(uf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xn!==null&&(Hp(Xn),Xn=null))),Op(t,e),Nr(e),null;case 5:sg(e);var i=xa(Hc.current);if(r=e.type,t!==null&&e.stateNode!=null)y2(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(_e(166));return Nr(e),null}if(t=xa(xi.current),uf(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[mi]=e,n[jc]=s,t=(e.mode&1)!==0,r){case"dialog":At("cancel",n),At("close",n);break;case"iframe":case"object":case"embed":At("load",n);break;case"video":case"audio":for(i=0;i<Xl.length;i++)At(Xl[i],n);break;case"source":At("error",n);break;case"img":case"image":case"link":At("error",n),At("load",n);break;case"details":At("toggle",n);break;case"input":P1(n,s),At("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},At("invalid",n);break;case"textarea":D1(n,s),At("invalid",n)}lp(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&cf(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&cf(n.textContent,o,t),i=["children",""+o]):Pc.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&At("scroll",n)}switch(r){case"input":ef(n),F1(n,s,!0);break;case"textarea":ef(n),b1(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=lh)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Xw(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[mi]=e,t[jc]=n,_2(t,e,!1,!1),e.stateNode=t;e:{switch(a=cp(r,n),r){case"dialog":At("cancel",t),At("close",t),i=n;break;case"iframe":case"object":case"embed":At("load",t),i=n;break;case"video":case"audio":for(i=0;i<Xl.length;i++)At(Xl[i],t);i=n;break;case"source":At("error",t),i=n;break;case"img":case"image":case"link":At("error",t),At("load",t),i=n;break;case"details":At("toggle",t),i=n;break;case"input":P1(t,n),i=np(t,n),At("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Ot({},n,{value:void 0}),At("invalid",t);break;case"textarea":D1(t,n),i=ap(t,n),At("invalid",t);break;default:i=n}lp(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Jw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Yw(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Fc(t,l):typeof l=="number"&&Fc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Pc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&At("scroll",t):l!=null&&Lm(t,s,l,a))}switch(r){case"input":ef(t),F1(t,n,!1);break;case"textarea":ef(t),b1(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ks(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Do(t,!!n.multiple,s,!1):n.defaultValue!=null&&Do(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=lh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Nr(e),null;case 6:if(t&&e.stateNode!=null)w2(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(_e(166));if(r=xa(Hc.current),xa(xi.current),uf(e)){if(n=e.stateNode,r=e.memoizedProps,n[mi]=e,(s=n.nodeValue!==r)&&(t=yn,t!==null))switch(t.tag){case 3:cf(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cf(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[mi]=e,e.stateNode=n}return Nr(e),null;case 13:if(Ct(Dt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Pt&&xn!==null&&e.mode&1&&!(e.flags&128))UE(),Xo(),e.flags|=98560,s=!1;else if(s=uf(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(_e(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(_e(317));s[mi]=e}else Xo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Nr(e),s=!1}else Xn!==null&&(Hp(Xn),Xn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Dt.current&1?rr===0&&(rr=3):xg())),e.updateQueue!==null&&(e.flags|=4),Nr(e),null);case 4:return Qo(),Op(t,e),t===null&&Uc(e.stateNode.containerInfo),Nr(e),null;case 10:return tg(e.type._context),Nr(e),null;case 17:return un(e.type)&&ch(),Nr(e),null;case 19:if(Ct(Dt),s=e.memoizedState,s===null)return Nr(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Bl(s,!1);else{if(rr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=gh(t),a!==null){for(e.flags|=128,Bl(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return yt(Dt,Dt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ht()>Zo&&(e.flags|=128,n=!0,Bl(s,!1),e.lanes=4194304)}else{if(!n)if(t=gh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Bl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Pt)return Nr(e),null}else 2*Ht()-s.renderingStartTime>Zo&&r!==1073741824&&(e.flags|=128,n=!0,Bl(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ht(),e.sibling=null,r=Dt.current,yt(Dt,n?r&1|2:r&1),e):(Nr(e),null);case 22:case 23:return vg(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?pn&1073741824&&(Nr(e),e.subtreeFlags&6&&(e.flags|=8192)):Nr(e),null;case 24:return null;case 25:return null}throw Error(_e(156,e.tag))}function N4(t,e){switch(Qm(e),e.tag){case 1:return un(e.type)&&ch(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Qo(),Ct(cn),Ct(Br),ag(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return sg(e),null;case 13:if(Ct(Dt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(_e(340));Xo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ct(Dt),null;case 4:return Qo(),null;case 10:return tg(e.type._context),null;case 22:case 23:return vg(),null;case 24:return null;default:return null}}var df=!1,Or=!1,P4=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function No(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Vt(t,e,n)}else r.current=null}function Lp(t,e,r){try{r()}catch(n){Vt(t,e,n)}}var Tx=!1;function F4(t,e){if(_p=sh,t=AE(),Xm(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,f=0,h=t,d=null;t:for(;;){for(var p;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===t)break t;if(d===r&&++c===i&&(o=a),d===s&&++f===n&&(l=a),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(yp={focusedElem:t,selectionRange:r},sh=!1,Ne=e;Ne!==null;)if(e=Ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ne=t;else for(;Ne!==null;){e=Ne;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var m=v.memoizedProps,w=v.memoizedState,T=e.stateNode,E=T.getSnapshotBeforeUpdate(e.elementType===e.type?m:Gn(e.type,m),w);T.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_e(163))}}catch(N){Vt(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,Ne=t;break}Ne=e.return}return v=Tx,Tx=!1,v}function hc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Lp(e,r,s)}i=i.next}while(i!==n)}}function f0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Mp(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function E2(t){var e=t.alternate;e!==null&&(t.alternate=null,E2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[mi],delete e[jc],delete e[Tp],delete e[p4],delete e[m4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function T2(t){return t.tag===5||t.tag===3||t.tag===4}function kx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||T2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Vp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=lh));else if(n!==4&&(t=t.child,t!==null))for(Vp(t,e,r),t=t.sibling;t!==null;)Vp(t,e,r),t=t.sibling}function Up(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Up(t,e,r),t=t.sibling;t!==null;)Up(t,e,r),t=t.sibling}var gr=null,Kn=!1;function vs(t,e,r){for(r=r.child;r!==null;)k2(t,e,r),r=r.sibling}function k2(t,e,r){if(vi&&typeof vi.onCommitFiberUnmount=="function")try{vi.onCommitFiberUnmount(n0,r)}catch{}switch(r.tag){case 5:Or||No(r,e);case 6:var n=gr,i=Kn;gr=null,vs(t,e,r),gr=n,Kn=i,gr!==null&&(Kn?(t=gr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):gr.removeChild(r.stateNode));break;case 18:gr!==null&&(Kn?(t=gr,r=r.stateNode,t.nodeType===8?gd(t.parentNode,r):t.nodeType===1&&gd(t,r),Lc(t)):gd(gr,r.stateNode));break;case 4:n=gr,i=Kn,gr=r.stateNode.containerInfo,Kn=!0,vs(t,e,r),gr=n,Kn=i;break;case 0:case 11:case 14:case 15:if(!Or&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Lp(r,e,a),i=i.next}while(i!==n)}vs(t,e,r);break;case 1:if(!Or&&(No(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Vt(r,e,o)}vs(t,e,r);break;case 21:vs(t,e,r);break;case 22:r.mode&1?(Or=(n=Or)||r.memoizedState!==null,vs(t,e,r),Or=n):vs(t,e,r);break;default:vs(t,e,r)}}function Sx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new P4),e.forEach(function(n){var i=j4.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Hn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:gr=o.stateNode,Kn=!1;break e;case 3:gr=o.stateNode.containerInfo,Kn=!0;break e;case 4:gr=o.stateNode.containerInfo,Kn=!0;break e}o=o.return}if(gr===null)throw Error(_e(160));k2(s,a,i),gr=null,Kn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Vt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)S2(e,t),e=e.sibling}function S2(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Hn(e,t),fi(t),n&4){try{hc(3,t,t.return),f0(3,t)}catch(m){Vt(t,t.return,m)}try{hc(5,t,t.return)}catch(m){Vt(t,t.return,m)}}break;case 1:Hn(e,t),fi(t),n&512&&r!==null&&No(r,r.return);break;case 5:if(Hn(e,t),fi(t),n&512&&r!==null&&No(r,r.return),t.flags&32){var i=t.stateNode;try{Fc(i,"")}catch(m){Vt(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Kw(i,s),cp(o,a);var c=cp(o,s);for(a=0;a<l.length;a+=2){var f=l[a],h=l[a+1];f==="style"?Jw(i,h):f==="dangerouslySetInnerHTML"?Yw(i,h):f==="children"?Fc(i,h):Lm(i,f,h,c)}switch(o){case"input":ip(i,s);break;case"textarea":qw(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Do(i,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?Do(i,!!s.multiple,s.defaultValue,!0):Do(i,!!s.multiple,s.multiple?[]:"",!1))}i[jc]=s}catch(m){Vt(t,t.return,m)}}break;case 6:if(Hn(e,t),fi(t),n&4){if(t.stateNode===null)throw Error(_e(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){Vt(t,t.return,m)}}break;case 3:if(Hn(e,t),fi(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Lc(e.containerInfo)}catch(m){Vt(t,t.return,m)}break;case 4:Hn(e,t),fi(t);break;case 13:Hn(e,t),fi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(mg=Ht())),n&4&&Sx(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(Or=(c=Or)||f,Hn(e,t),Or=c):Hn(e,t),fi(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!f&&t.mode&1)for(Ne=t,f=t.child;f!==null;){for(h=Ne=f;Ne!==null;){switch(d=Ne,p=d.child,d.tag){case 0:case 11:case 14:case 15:hc(4,d,d.return);break;case 1:No(d,d.return);var v=d.stateNode;if(typeof v.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(m){Vt(n,r,m)}}break;case 5:No(d,d.return);break;case 22:if(d.memoizedState!==null){Ix(h);continue}}p!==null?(p.return=d,Ne=p):Ix(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Qw("display",a))}catch(m){Vt(t,t.return,m)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){Vt(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Hn(e,t),fi(t),n&4&&Sx(t);break;case 21:break;default:Hn(e,t),fi(t)}}function fi(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(T2(r)){var n=r;break e}r=r.return}throw Error(_e(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Fc(i,""),n.flags&=-33);var s=kx(t);Up(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=kx(t);Vp(t,o,a);break;default:throw Error(_e(161))}}catch(l){Vt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function D4(t,e,r){Ne=t,A2(t)}function A2(t,e,r){for(var n=(t.mode&1)!==0;Ne!==null;){var i=Ne,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||df;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Or;o=df;var c=Or;if(df=a,(Or=l)&&!c)for(Ne=i;Ne!==null;)a=Ne,l=a.child,a.tag===22&&a.memoizedState!==null?Cx(i):l!==null?(l.return=a,Ne=l):Cx(i);for(;s!==null;)Ne=s,A2(s),s=s.sibling;Ne=i,df=o,Or=c}Ax(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ne=s):Ax(t)}}function Ax(t){for(;Ne!==null;){var e=Ne;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Or||f0(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Or)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Gn(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&ux(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}ux(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Lc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_e(163))}Or||e.flags&512&&Mp(e)}catch(d){Vt(e,e.return,d)}}if(e===t){Ne=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function Ix(t){for(;Ne!==null;){var e=Ne;if(e===t){Ne=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function Cx(t){for(;Ne!==null;){var e=Ne;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{f0(4,e)}catch(l){Vt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Vt(e,i,l)}}var s=e.return;try{Mp(e)}catch(l){Vt(e,s,l)}break;case 5:var a=e.return;try{Mp(e)}catch(l){Vt(e,a,l)}}}catch(l){Vt(e,e.return,l)}if(e===t){Ne=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ne=o;break}Ne=e.return}}var b4=Math.ceil,_h=us.ReactCurrentDispatcher,dg=us.ReactCurrentOwner,bn=us.ReactCurrentBatchConfig,it=0,hr=null,Yt=null,yr=0,pn=0,Po=na(0),rr=0,Kc=null,Fa=0,h0=0,pg=0,dc=null,an=null,mg=0,Zo=1/0,Ui=null,yh=!1,Bp=null,Bs=null,pf=!1,Ns=null,wh=0,pc=0,jp=null,jf=-1,zf=0;function qr(){return it&6?Ht():jf!==-1?jf:jf=Ht()}function js(t){return t.mode&1?it&2&&yr!==0?yr&-yr:v4.transition!==null?(zf===0&&(zf=uE()),zf):(t=pt,t!==0||(t=window.event,t=t===void 0?16:vE(t.type)),t):1}function ri(t,e,r,n){if(50<pc)throw pc=0,jp=null,Error(_e(185));gu(t,r,n),(!(it&2)||t!==hr)&&(t===hr&&(!(it&2)&&(h0|=r),rr===4&&ks(t,yr)),fn(t,n),r===1&&it===0&&!(e.mode&1)&&(Zo=Ht()+500,l0&&ia()))}function fn(t,e){var r=t.callbackNode;vC(t,e);var n=ih(t,t===hr?yr:0);if(n===0)r!==null&&M1(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&M1(r),e===1)t.tag===0?g4(Rx.bind(null,t)):LE(Rx.bind(null,t)),h4(function(){!(it&6)&&ia()}),r=null;else{switch(fE(n)){case 1:r=jm;break;case 4:r=lE;break;case 16:r=nh;break;case 536870912:r=cE;break;default:r=nh}r=b2(r,I2.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function I2(t,e){if(jf=-1,zf=0,it&6)throw Error(_e(327));var r=t.callbackNode;if(Vo()&&t.callbackNode!==r)return null;var n=ih(t,t===hr?yr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Eh(t,n);else{e=n;var i=it;it|=2;var s=R2();(hr!==t||yr!==e)&&(Ui=null,Zo=Ht()+500,Ta(t,e));do try{M4();break}catch(o){C2(t,o)}while(!0);eg(),_h.current=s,it=i,Yt!==null?e=0:(hr=null,yr=0,e=rr)}if(e!==0){if(e===2&&(i=pp(t),i!==0&&(n=i,e=zp(t,i))),e===1)throw r=Kc,Ta(t,0),ks(t,n),fn(t,Ht()),r;if(e===6)ks(t,n);else{if(i=t.current.alternate,!(n&30)&&!O4(i)&&(e=Eh(t,n),e===2&&(s=pp(t),s!==0&&(n=s,e=zp(t,s))),e===1))throw r=Kc,Ta(t,0),ks(t,n),fn(t,Ht()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(_e(345));case 2:fa(t,an,Ui);break;case 3:if(ks(t,n),(n&130023424)===n&&(e=mg+500-Ht(),10<e)){if(ih(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){qr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Ep(fa.bind(null,t,an,Ui),e);break}fa(t,an,Ui);break;case 4:if(ks(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-ti(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Ht()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*b4(n/1960))-n,10<n){t.timeoutHandle=Ep(fa.bind(null,t,an,Ui),n);break}fa(t,an,Ui);break;case 5:fa(t,an,Ui);break;default:throw Error(_e(329))}}}return fn(t,Ht()),t.callbackNode===r?I2.bind(null,t):null}function zp(t,e){var r=dc;return t.current.memoizedState.isDehydrated&&(Ta(t,e).flags|=256),t=Eh(t,e),t!==2&&(e=an,an=r,e!==null&&Hp(e)),t}function Hp(t){an===null?an=t:an.push.apply(an,t)}function O4(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!si(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ks(t,e){for(e&=~pg,e&=~h0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ti(e),n=1<<r;t[r]=-1,e&=~n}}function Rx(t){if(it&6)throw Error(_e(327));Vo();var e=ih(t,0);if(!(e&1))return fn(t,Ht()),null;var r=Eh(t,e);if(t.tag!==0&&r===2){var n=pp(t);n!==0&&(e=n,r=zp(t,n))}if(r===1)throw r=Kc,Ta(t,0),ks(t,e),fn(t,Ht()),r;if(r===6)throw Error(_e(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fa(t,an,Ui),fn(t,Ht()),null}function gg(t,e){var r=it;it|=1;try{return t(e)}finally{it=r,it===0&&(Zo=Ht()+500,l0&&ia())}}function Da(t){Ns!==null&&Ns.tag===0&&!(it&6)&&Vo();var e=it;it|=1;var r=bn.transition,n=pt;try{if(bn.transition=null,pt=1,t)return t()}finally{pt=n,bn.transition=r,it=e,!(it&6)&&ia()}}function vg(){pn=Po.current,Ct(Po)}function Ta(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,f4(r)),Yt!==null)for(r=Yt.return;r!==null;){var n=r;switch(Qm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ch();break;case 3:Qo(),Ct(cn),Ct(Br),ag();break;case 5:sg(n);break;case 4:Qo();break;case 13:Ct(Dt);break;case 19:Ct(Dt);break;case 10:tg(n.type._context);break;case 22:case 23:vg()}r=r.return}if(hr=t,Yt=t=zs(t.current,null),yr=pn=e,rr=0,Kc=null,pg=h0=Fa=0,an=dc=null,va!==null){for(e=0;e<va.length;e++)if(r=va[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}va=null}return t}function C2(t,e){do{var r=Yt;try{if(eg(),Vf.current=xh,vh){for(var n=bt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}vh=!1}if(Pa=0,ur=tr=bt=null,fc=!1,$c=0,dg.current=null,r===null||r.return===null){rr=1,Kc=e,Yt=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=yr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=gx(a);if(p!==null){p.flags&=-257,vx(p,a,o,s,e),p.mode&1&&mx(s,c,e),e=p,l=c;var v=e.updateQueue;if(v===null){var m=new Set;m.add(l),e.updateQueue=m}else v.add(l);break e}else{if(!(e&1)){mx(s,c,e),xg();break e}l=Error(_e(426))}}else if(Pt&&o.mode&1){var w=gx(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),vx(w,a,o,s,e),Jm(Jo(l,o));break e}}s=l=Jo(l,o),rr!==4&&(rr=2),dc===null?dc=[s]:dc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var T=f2(s,l,e);cx(s,T);break e;case 1:o=l;var E=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof E.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Bs===null||!Bs.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var N=h2(s,o,e);cx(s,N);break e}}s=s.return}while(s!==null)}P2(r)}catch(j){e=j,Yt===r&&r!==null&&(Yt=r=r.return);continue}break}while(!0)}function R2(){var t=_h.current;return _h.current=xh,t===null?xh:t}function xg(){(rr===0||rr===3||rr===2)&&(rr=4),hr===null||!(Fa&268435455)&&!(h0&268435455)||ks(hr,yr)}function Eh(t,e){var r=it;it|=2;var n=R2();(hr!==t||yr!==e)&&(Ui=null,Ta(t,e));do try{L4();break}catch(i){C2(t,i)}while(!0);if(eg(),it=r,_h.current=n,Yt!==null)throw Error(_e(261));return hr=null,yr=0,rr}function L4(){for(;Yt!==null;)N2(Yt)}function M4(){for(;Yt!==null&&!lC();)N2(Yt)}function N2(t){var e=D2(t.alternate,t,pn);t.memoizedProps=t.pendingProps,e===null?P2(t):Yt=e,dg.current=null}function P2(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=N4(r,e),r!==null){r.flags&=32767,Yt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{rr=6,Yt=null;return}}else if(r=R4(r,e,pn),r!==null){Yt=r;return}if(e=e.sibling,e!==null){Yt=e;return}Yt=e=t}while(e!==null);rr===0&&(rr=5)}function fa(t,e,r){var n=pt,i=bn.transition;try{bn.transition=null,pt=1,V4(t,e,r,n)}finally{bn.transition=i,pt=n}return null}function V4(t,e,r,n){do Vo();while(Ns!==null);if(it&6)throw Error(_e(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(_e(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(xC(t,s),t===hr&&(Yt=hr=null,yr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||pf||(pf=!0,b2(nh,function(){return Vo(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=bn.transition,bn.transition=null;var a=pt;pt=1;var o=it;it|=4,dg.current=null,F4(t,r),S2(r,t),i4(yp),sh=!!_p,yp=_p=null,t.current=r,D4(r),cC(),it=o,pt=a,bn.transition=s}else t.current=r;if(pf&&(pf=!1,Ns=t,wh=i),s=t.pendingLanes,s===0&&(Bs=null),hC(r.stateNode),fn(t,Ht()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(yh)throw yh=!1,t=Bp,Bp=null,t;return wh&1&&t.tag!==0&&Vo(),s=t.pendingLanes,s&1?t===jp?pc++:(pc=0,jp=t):pc=0,ia(),null}function Vo(){if(Ns!==null){var t=fE(wh),e=bn.transition,r=pt;try{if(bn.transition=null,pt=16>t?16:t,Ns===null)var n=!1;else{if(t=Ns,Ns=null,wh=0,it&6)throw Error(_e(331));var i=it;for(it|=4,Ne=t.current;Ne!==null;){var s=Ne,a=s.child;if(Ne.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ne=c;Ne!==null;){var f=Ne;switch(f.tag){case 0:case 11:case 15:hc(8,f,s)}var h=f.child;if(h!==null)h.return=f,Ne=h;else for(;Ne!==null;){f=Ne;var d=f.sibling,p=f.return;if(E2(f),f===c){Ne=null;break}if(d!==null){d.return=p,Ne=d;break}Ne=p}}}var v=s.alternate;if(v!==null){var m=v.child;if(m!==null){v.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}Ne=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Ne=a;else e:for(;Ne!==null;){if(s=Ne,s.flags&2048)switch(s.tag){case 0:case 11:case 15:hc(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,Ne=T;break e}Ne=s.return}}var E=t.current;for(Ne=E;Ne!==null;){a=Ne;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,Ne=y;else e:for(a=E;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:f0(9,o)}}catch(j){Vt(o,o.return,j)}if(o===a){Ne=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,Ne=N;break e}Ne=o.return}}if(it=i,ia(),vi&&typeof vi.onPostCommitFiberRoot=="function")try{vi.onPostCommitFiberRoot(n0,t)}catch{}n=!0}return n}finally{pt=r,bn.transition=e}}return!1}function Nx(t,e,r){e=Jo(r,e),e=f2(t,e,1),t=Us(t,e,1),e=qr(),t!==null&&(gu(t,1,e),fn(t,e))}function Vt(t,e,r){if(t.tag===3)Nx(t,t,r);else for(;e!==null;){if(e.tag===3){Nx(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Bs===null||!Bs.has(n))){t=Jo(r,t),t=h2(e,t,1),e=Us(e,t,1),t=qr(),e!==null&&(gu(e,1,t),fn(e,t));break}}e=e.return}}function U4(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=qr(),t.pingedLanes|=t.suspendedLanes&r,hr===t&&(yr&r)===r&&(rr===4||rr===3&&(yr&130023424)===yr&&500>Ht()-mg?Ta(t,0):pg|=r),fn(t,e)}function F2(t,e){e===0&&(t.mode&1?(e=nf,nf<<=1,!(nf&130023424)&&(nf=4194304)):e=1);var r=qr();t=ts(t,e),t!==null&&(gu(t,e,r),fn(t,r))}function B4(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),F2(t,r)}function j4(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(_e(314))}n!==null&&n.delete(e),F2(t,r)}var D2;D2=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||cn.current)ln=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return ln=!1,C4(t,e,r);ln=!!(t.flags&131072)}else ln=!1,Pt&&e.flags&1048576&&ME(e,hh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Bf(t,e),t=e.pendingProps;var i=qo(e,Br.current);Mo(e,r),i=lg(null,e,n,t,i,r);var s=cg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,un(n)?(s=!0,uh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ng(e),i.updater=u0,e.stateNode=i,i._reactInternals=e,Rp(e,n,t,r),e=Fp(null,e,n,!0,s,r)):(e.tag=0,Pt&&s&&Ym(e),$r(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Bf(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=H4(n),t=Gn(n,t),i){case 0:e=Pp(null,e,n,t,r);break e;case 1:e=yx(null,e,n,t,r);break e;case 11:e=xx(null,e,n,t,r);break e;case 14:e=_x(null,e,n,Gn(n.type,t),r);break e}throw Error(_e(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Gn(n,i),Pp(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Gn(n,i),yx(t,e,n,i,r);case 3:e:{if(g2(e),t===null)throw Error(_e(387));n=e.pendingProps,s=e.memoizedState,i=s.element,HE(t,e),mh(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Jo(Error(_e(423)),e),e=wx(t,e,n,r,i);break e}else if(n!==i){i=Jo(Error(_e(424)),e),e=wx(t,e,n,r,i);break e}else for(xn=Vs(e.stateNode.containerInfo.firstChild),yn=e,Pt=!0,Xn=null,r=jE(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Xo(),n===i){e=rs(t,e,r);break e}$r(t,e,n,r)}e=e.child}return e;case 5:return $E(e),t===null&&Ap(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,wp(n,i)?a=null:s!==null&&wp(n,s)&&(e.flags|=32),m2(t,e),$r(t,e,a,r),e.child;case 6:return t===null&&Ap(e),null;case 13:return v2(t,e,r);case 4:return ig(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Yo(e,null,n,r):$r(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Gn(n,i),xx(t,e,n,i,r);case 7:return $r(t,e,e.pendingProps,r),e.child;case 8:return $r(t,e,e.pendingProps.children,r),e.child;case 12:return $r(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,yt(dh,n._currentValue),n._currentValue=a,s!==null)if(si(s.value,a)){if(s.children===i.children&&!cn.current){e=rs(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=qi(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Ip(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(_e(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Ip(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}$r(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Mo(e,r),i=Mn(i),n=n(i),e.flags|=1,$r(t,e,n,r),e.child;case 14:return n=e.type,i=Gn(n,e.pendingProps),i=Gn(n.type,i),_x(t,e,n,i,r);case 15:return d2(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Gn(n,i),Bf(t,e),e.tag=1,un(n)?(t=!0,uh(e)):t=!1,Mo(e,r),u2(e,n,i),Rp(e,n,i,r),Fp(null,e,n,!0,t,r);case 19:return x2(t,e,r);case 22:return p2(t,e,r)}throw Error(_e(156,e.tag))};function b2(t,e){return oE(t,e)}function z4(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dn(t,e,r,n){return new z4(t,e,r,n)}function _g(t){return t=t.prototype,!(!t||!t.isReactComponent)}function H4(t){if(typeof t=="function")return _g(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Vm)return 11;if(t===Um)return 14}return 2}function zs(t,e){var r=t.alternate;return r===null?(r=Dn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Hf(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")_g(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case wo:return ka(r.children,i,s,e);case Mm:a=8,i|=8;break;case Zd:return t=Dn(12,r,e,i|2),t.elementType=Zd,t.lanes=s,t;case ep:return t=Dn(13,r,e,i),t.elementType=ep,t.lanes=s,t;case tp:return t=Dn(19,r,e,i),t.elementType=tp,t.lanes=s,t;case $w:return d0(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case zw:a=10;break e;case Hw:a=9;break e;case Vm:a=11;break e;case Um:a=14;break e;case ws:a=16,n=null;break e}throw Error(_e(130,t==null?t:typeof t,""))}return e=Dn(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function ka(t,e,r,n){return t=Dn(7,t,n,e),t.lanes=r,t}function d0(t,e,r,n){return t=Dn(22,t,n,e),t.elementType=$w,t.lanes=r,t.stateNode={isHidden:!1},t}function kd(t,e,r){return t=Dn(6,t,null,e),t.lanes=r,t}function Sd(t,e,r){return e=Dn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function $4(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sd(0),this.expirationTimes=sd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sd(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function yg(t,e,r,n,i,s,a,o,l){return t=new $4(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Dn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ng(s),t}function W4(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yo,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function O2(t){if(!t)return qs;t=t._reactInternals;e:{if(Wa(t)!==t||t.tag!==1)throw Error(_e(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(un(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(_e(171))}if(t.tag===1){var r=t.type;if(un(r))return OE(t,r,e)}return e}function L2(t,e,r,n,i,s,a,o,l){return t=yg(r,n,!0,t,i,s,a,o,l),t.context=O2(null),r=t.current,n=qr(),i=js(r),s=qi(n,i),s.callback=e??null,Us(r,s,i),t.current.lanes=i,gu(t,i,n),fn(t,n),t}function p0(t,e,r,n){var i=e.current,s=qr(),a=js(i);return r=O2(r),e.context===null?e.context=r:e.pendingContext=r,e=qi(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Us(i,e,a),t!==null&&(ri(t,i,a,s),Mf(t,i,a)),a}function Th(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Px(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function wg(t,e){Px(t,e),(t=t.alternate)&&Px(t,e)}function G4(){return null}var M2=typeof reportError=="function"?reportError:function(t){console.error(t)};function Eg(t){this._internalRoot=t}m0.prototype.render=Eg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(_e(409));p0(t,e,null,null)};m0.prototype.unmount=Eg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Da(function(){p0(null,t,null,null)}),e[es]=null}};function m0(t){this._internalRoot=t}m0.prototype.unstable_scheduleHydration=function(t){if(t){var e=pE();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Ts.length&&e!==0&&e<Ts[r].priority;r++);Ts.splice(r,0,t),r===0&&gE(t)}};function Tg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function g0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Fx(){}function K4(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Th(a);s.call(c)}}var a=L2(e,n,t,0,null,!1,!1,"",Fx);return t._reactRootContainer=a,t[es]=a.current,Uc(t.nodeType===8?t.parentNode:t),Da(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Th(l);o.call(c)}}var l=yg(t,0,!1,null,null,!1,!1,"",Fx);return t._reactRootContainer=l,t[es]=l.current,Uc(t.nodeType===8?t.parentNode:t),Da(function(){p0(e,l,r,n)}),l}function v0(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Th(a);o.call(l)}}p0(e,a,t,i)}else a=K4(r,e,t,i,n);return Th(a)}hE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=ql(e.pendingLanes);r!==0&&(zm(e,r|1),fn(e,Ht()),!(it&6)&&(Zo=Ht()+500,ia()))}break;case 13:Da(function(){var n=ts(t,1);if(n!==null){var i=qr();ri(n,t,1,i)}}),wg(t,1)}};Hm=function(t){if(t.tag===13){var e=ts(t,134217728);if(e!==null){var r=qr();ri(e,t,134217728,r)}wg(t,134217728)}};dE=function(t){if(t.tag===13){var e=js(t),r=ts(t,e);if(r!==null){var n=qr();ri(r,t,e,n)}wg(t,e)}};pE=function(){return pt};mE=function(t,e){var r=pt;try{return pt=t,e()}finally{pt=r}};fp=function(t,e,r){switch(e){case"input":if(ip(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=o0(n);if(!i)throw Error(_e(90));Gw(n),ip(n,i)}}}break;case"textarea":qw(t,r);break;case"select":e=r.value,e!=null&&Do(t,!!r.multiple,e,!1)}};tE=gg;rE=Da;var q4={usingClientEntryPoint:!1,Events:[xu,So,o0,Zw,eE,gg]},jl={findFiberByHostInstance:ga,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},X4={bundleType:jl.bundleType,version:jl.version,rendererPackageName:jl.rendererPackageName,rendererConfig:jl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:us.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=sE(t),t===null?null:t.stateNode},findFiberByHostInstance:jl.findFiberByHostInstance||G4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mf.isDisabled&&mf.supportsFiber)try{n0=mf.inject(X4),vi=mf}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=q4;Tn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tg(e))throw Error(_e(200));return W4(t,e,null,r)};Tn.createRoot=function(t,e){if(!Tg(t))throw Error(_e(299));var r=!1,n="",i=M2;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=yg(t,1,!1,null,null,r,!1,n,i),t[es]=e.current,Uc(t.nodeType===8?t.parentNode:t),new Eg(e)};Tn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(_e(188)):(t=Object.keys(t).join(","),Error(_e(268,t)));return t=sE(e),t=t===null?null:t.stateNode,t};Tn.flushSync=function(t){return Da(t)};Tn.hydrate=function(t,e,r){if(!g0(e))throw Error(_e(200));return v0(null,t,e,!0,r)};Tn.hydrateRoot=function(t,e,r){if(!Tg(t))throw Error(_e(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=M2;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=L2(e,null,t,1,r??null,i,!1,s,a),t[es]=e.current,Uc(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new m0(e)};Tn.render=function(t,e,r){if(!g0(e))throw Error(_e(200));return v0(null,t,e,!1,r)};Tn.unmountComponentAtNode=function(t){if(!g0(t))throw Error(_e(40));return t._reactRootContainer?(Da(function(){v0(null,null,t,!1,function(){t._reactRootContainer=null,t[es]=null})}),!0):!1};Tn.unstable_batchedUpdates=gg;Tn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!g0(r))throw Error(_e(200));if(t==null||t._reactInternals===void 0)throw Error(_e(38));return v0(t,e,r,!1,n)};Tn.version="18.3.1-next-f1338f8080-20240426";function V2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(V2)}catch(t){console.error(t)}}V2(),Vw.exports=Tn;var kg=Vw.exports;const Y4=Sw(kg),Q4=kw({__proto__:null,default:Y4},[kg]);var Dx=kg;Qd.createRoot=Dx.createRoot,Qd.hydrateRoot=Dx.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rt(){return Rt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Rt.apply(this,arguments)}var Xt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Xt||(Xt={}));const bx="popstate";function J4(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:a,hash:o}=n.location;return qc("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:ba(i)}return eR(e,r,null,t)}function Ge(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function el(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Z4(){return Math.random().toString(36).substr(2,8)}function Ox(t,e){return{usr:t.state,key:t.key,idx:e}}function qc(t,e,r,n){return r===void 0&&(r=null),Rt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?sa(e):e,{state:r,key:e&&e.key||n||Z4()})}function ba(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function sa(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function eR(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=Xt.Pop,l=null,c=f();c==null&&(c=0,a.replaceState(Rt({},a.state,{idx:c}),""));function f(){return(a.state||{idx:null}).idx}function h(){o=Xt.Pop;let w=f(),T=w==null?null:w-c;c=w,l&&l({action:o,location:m.location,delta:T})}function d(w,T){o=Xt.Push;let E=qc(m.location,w,T);c=f()+1;let y=Ox(E,c),N=m.createHref(E);try{a.pushState(y,"",N)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;i.location.assign(N)}s&&l&&l({action:o,location:m.location,delta:1})}function p(w,T){o=Xt.Replace;let E=qc(m.location,w,T);c=f();let y=Ox(E,c),N=m.createHref(E);a.replaceState(y,"",N),s&&l&&l({action:o,location:m.location,delta:0})}function v(w){let T=i.location.origin!=="null"?i.location.origin:i.location.href,E=typeof w=="string"?w:ba(w);return E=E.replace(/ $/,"%20"),Ge(T,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,T)}let m={get action(){return o},get location(){return t(i,a)},listen(w){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(bx,h),l=w,()=>{i.removeEventListener(bx,h),l=null}},createHref(w){return e(i,w)},createURL:v,encodeLocation(w){let T=v(w);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:d,replace:p,go(w){return a.go(w)}};return m}var dt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(dt||(dt={}));const tR=new Set(["lazy","caseSensitive","path","id","index","children"]);function rR(t){return t.index===!0}function kh(t,e,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),t.map((i,s)=>{let a=[...r,String(s)],o=typeof i.id=="string"?i.id:a.join("-");if(Ge(i.index!==!0||!i.children,"Cannot specify children on an index route"),Ge(!n[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),rR(i)){let l=Rt({},i,e(i),{id:o});return n[o]=l,l}else{let l=Rt({},i,e(i),{id:o,children:void 0});return n[o]=l,i.children&&(l.children=kh(i.children,e,a,n)),l}})}function da(t,e,r){return r===void 0&&(r="/"),$f(t,e,r,!1)}function $f(t,e,r,n){let i=typeof e=="string"?sa(e):e,s=ns(i.pathname||"/",r);if(s==null)return null;let a=U2(t);iR(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=mR(s);o=dR(a[l],c,n)}return o}function nR(t,e){let{route:r,pathname:n,params:i}=t;return{id:r.id,pathname:n,params:i,data:e[r.id],handle:r.handle}}function U2(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Ge(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Xi([n,l.relativePath]),f=r.concat(l);s.children&&s.children.length>0&&(Ge(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),U2(s.children,e,f,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:fR(c,s.index),routesMeta:f})};return t.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of B2(s.path))i(s,a,l)}),e}function B2(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=B2(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function iR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:hR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const sR=/^:[\w-]+$/,aR=3,oR=2,lR=1,cR=10,uR=-2,Lx=t=>t==="*";function fR(t,e){let r=t.split("/"),n=r.length;return r.some(Lx)&&(n+=uR),e&&(n+=oR),r.filter(i=>!Lx(i)).reduce((i,s)=>i+(sR.test(s)?aR:s===""?lR:cR),n)}function hR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function dR(t,e,r){r===void 0&&(r=!1);let{routesMeta:n}=t,i={},s="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,f=s==="/"?e:e.slice(s.length)||"/",h=Sh({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},f),d=l.route;if(!h&&c&&r&&!n[n.length-1].route.index&&(h=Sh({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},f)),!h)return null;Object.assign(i,h.params),a.push({params:i,pathname:Xi([s,h.pathname]),pathnameBase:xR(Xi([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=Xi([s,h.pathnameBase]))}return a}function Sh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=pR(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((c,f,h)=>{let{paramName:d,isOptional:p}=f;if(d==="*"){let m=o[h]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const v=o[h];return p&&!v?c[d]=void 0:c[d]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:a,pattern:t}}function pR(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),el(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function mR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return el(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ns(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function gR(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?sa(t):t;return{pathname:r?r.startsWith("/")?r:vR(r,e):e,search:_R(n),hash:yR(i)}}function vR(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Ad(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function j2(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function x0(t,e){let r=j2(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function _0(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=sa(t):(i=Rt({},t),Ge(!i.pathname||!i.pathname.includes("?"),Ad("?","pathname","search",i)),Ge(!i.pathname||!i.pathname.includes("#"),Ad("#","pathname","hash",i)),Ge(!i.search||!i.search.includes("#"),Ad("#","search","hash",i)));let s=t===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=r;else{let h=e.length-1;if(!n&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}o=h>=0?e[h]:"/"}let l=gR(i,o),c=a&&a!=="/"&&a.endsWith("/"),f=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}const Xi=t=>t.join("/").replace(/\/\/+/g,"/"),xR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),_R=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,yR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Ah{constructor(e,r,n,i){i===void 0&&(i=!1),this.status=e,this.statusText=r||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function Xc(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const z2=["post","put","patch","delete"],wR=new Set(z2),ER=["get",...z2],TR=new Set(ER),kR=new Set([301,302,303,307,308]),SR=new Set([307,308]),Id={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},AR={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},zl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Sg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,IR=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),H2="remix-router-transitions";function CR(t){const e=t.window?t.window:typeof window<"u"?window:void 0,r=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",n=!r;Ge(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let H=t.detectErrorBoundary;i=Q=>({hasErrorBoundary:H(Q)})}else i=IR;let s={},a=kh(t.routes,i,void 0,s),o,l=t.basename||"/",c=t.dataStrategy||FR,f=t.patchRoutesOnNavigation,h=Rt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),d=null,p=new Set,v=null,m=null,w=null,T=t.hydrationData!=null,E=da(a,t.history.location,l),y=!1,N=null;if(E==null&&!f){let H=nn(404,{pathname:t.history.location.pathname}),{matches:Q,route:ne}=Kx(a);E=Q,N={[ne.id]:H}}E&&!t.hydrationData&&Li(E,a,t.history.location.pathname).active&&(E=null);let j;if(E)if(E.some(H=>H.route.lazy))j=!1;else if(!E.some(H=>H.route.loader))j=!0;else if(h.v7_partialHydration){let H=t.hydrationData?t.hydrationData.loaderData:null,Q=t.hydrationData?t.hydrationData.errors:null;if(Q){let ne=E.findIndex(fe=>Q[fe.route.id]!==void 0);j=E.slice(0,ne+1).every(fe=>!Wp(fe.route,H,Q))}else j=E.every(ne=>!Wp(ne.route,H,Q))}else j=t.hydrationData!=null;else if(j=!1,E=[],h.v7_partialHydration){let H=Li(null,a,t.history.location.pathname);H.active&&H.matches&&(y=!0,E=H.matches)}let U,g={historyAction:t.history.action,location:t.history.location,matches:E,initialized:j,navigation:Id,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||N,fetchers:new Map,blockers:new Map},k=Xt.Pop,S=!1,C,P=!1,F=new Map,O=null,de=!1,ve=!1,Ie=[],oe=new Set,ie=new Map,G=0,ue=-1,Ee=new Map,B=new Set,X=new Map,q=new Map,W=new Set,ae=new Map,xe=new Map,Ae;function he(){if(d=t.history.listen(H=>{let{action:Q,location:ne,delta:fe}=H;if(Ae){Ae(),Ae=void 0;return}el(xe.size===0||fe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ke=ps({currentLocation:g.location,nextLocation:ne,historyAction:Q});if(ke&&fe!=null){let I=new Promise(M=>{Ae=M});t.history.go(fe*-1),li(ke,{state:"blocked",location:ne,proceed(){li(ke,{state:"proceeding",proceed:void 0,reset:void 0,location:ne}),I.then(()=>t.history.go(fe))},reset(){let M=new Map(g.blockers);M.set(ke,zl),z({blockers:M})}});return}return be(Q,ne)}),r){GR(e,F);let H=()=>KR(e,F);e.addEventListener("pagehide",H),O=()=>e.removeEventListener("pagehide",H)}return g.initialized||be(Xt.Pop,g.location,{initialHydration:!0}),U}function ge(){d&&d(),O&&O(),p.clear(),C&&C.abort(),g.fetchers.forEach((H,Q)=>vt(Q)),g.blockers.forEach((H,Q)=>Di(Q))}function He(H){return p.add(H),()=>p.delete(H)}function z(H,Q){Q===void 0&&(Q={}),g=Rt({},g,H);let ne=[],fe=[];h.v7_fetcherPersist&&g.fetchers.forEach((ke,I)=>{ke.state==="idle"&&(W.has(I)?fe.push(I):ne.push(I))}),W.forEach(ke=>{!g.fetchers.has(ke)&&!ie.has(ke)&&fe.push(ke)}),[...p].forEach(ke=>ke(g,{deletedFetchers:fe,viewTransitionOpts:Q.viewTransitionOpts,flushSync:Q.flushSync===!0})),h.v7_fetcherPersist?(ne.forEach(ke=>g.fetchers.delete(ke)),fe.forEach(ke=>vt(ke))):fe.forEach(ke=>W.delete(ke))}function at(H,Q,ne){var fe,ke;let{flushSync:I}=ne===void 0?{}:ne,M=g.actionData!=null&&g.navigation.formMethod!=null&&qn(g.navigation.formMethod)&&g.navigation.state==="loading"&&((fe=H.state)==null?void 0:fe._isRedirect)!==!0,R;Q.actionData?Object.keys(Q.actionData).length>0?R=Q.actionData:R=null:M?R=g.actionData:R=null;let D=Q.loaderData?Wx(g.loaderData,Q.loaderData,Q.matches||[],Q.errors):g.loaderData,b=g.blockers;b.size>0&&(b=new Map(b),b.forEach((te,Z)=>b.set(Z,zl)));let L=S===!0||g.navigation.formMethod!=null&&qn(g.navigation.formMethod)&&((ke=H.state)==null?void 0:ke._isRedirect)!==!0;o&&(a=o,o=void 0),de||k===Xt.Pop||(k===Xt.Push?t.history.push(H,H.state):k===Xt.Replace&&t.history.replace(H,H.state));let K;if(k===Xt.Pop){let te=F.get(g.location.pathname);te&&te.has(H.pathname)?K={currentLocation:g.location,nextLocation:H}:F.has(H.pathname)&&(K={currentLocation:H,nextLocation:g.location})}else if(P){let te=F.get(g.location.pathname);te?te.add(H.pathname):(te=new Set([H.pathname]),F.set(g.location.pathname,te)),K={currentLocation:g.location,nextLocation:H}}z(Rt({},Q,{actionData:R,loaderData:D,historyAction:k,location:H,initialized:!0,navigation:Id,revalidation:"idle",restoreScrollPosition:Oi(H,Q.matches||g.matches),preventScrollReset:L,blockers:b}),{viewTransitionOpts:K,flushSync:I===!0}),k=Xt.Pop,S=!1,P=!1,de=!1,ve=!1,Ie=[]}async function We(H,Q){if(typeof H=="number"){t.history.go(H);return}let ne=$p(g.location,g.matches,l,h.v7_prependBasename,H,h.v7_relativeSplatPath,Q==null?void 0:Q.fromRouteId,Q==null?void 0:Q.relative),{path:fe,submission:ke,error:I}=Mx(h.v7_normalizeFormMethod,!1,ne,Q),M=g.location,R=qc(g.location,fe,Q&&Q.state);R=Rt({},R,t.history.encodeLocation(R));let D=Q&&Q.replace!=null?Q.replace:void 0,b=Xt.Push;D===!0?b=Xt.Replace:D===!1||ke!=null&&qn(ke.formMethod)&&ke.formAction===g.location.pathname+g.location.search&&(b=Xt.Replace);let L=Q&&"preventScrollReset"in Q?Q.preventScrollReset===!0:void 0,K=(Q&&Q.flushSync)===!0,te=ps({currentLocation:M,nextLocation:R,historyAction:b});if(te){li(te,{state:"blocked",location:R,proceed(){li(te,{state:"proceeding",proceed:void 0,reset:void 0,location:R}),We(H,Q)},reset(){let Z=new Map(g.blockers);Z.set(te,zl),z({blockers:Z})}});return}return await be(b,R,{submission:ke,pendingError:I,preventScrollReset:L,replace:Q&&Q.replace,enableViewTransition:Q&&Q.viewTransition,flushSync:K})}function rt(){if(kt(),z({revalidation:"loading"}),g.navigation.state!=="submitting"){if(g.navigation.state==="idle"){be(g.historyAction,g.location,{startUninterruptedRevalidation:!0});return}be(k||g.historyAction,g.navigation.location,{overrideNavigation:g.navigation,enableViewTransition:P===!0})}}async function be(H,Q,ne){C&&C.abort(),C=null,k=H,de=(ne&&ne.startUninterruptedRevalidation)===!0,ao(g.location,g.matches),S=(ne&&ne.preventScrollReset)===!0,P=(ne&&ne.enableViewTransition)===!0;let fe=o||a,ke=ne&&ne.overrideNavigation,I=ne!=null&&ne.initialHydration&&g.matches&&g.matches.length>0&&!y?g.matches:da(fe,Q,l),M=(ne&&ne.flushSync)===!0;if(I&&g.initialized&&!ve&&VR(g.location,Q)&&!(ne&&ne.submission&&qn(ne.submission.formMethod))){at(Q,{matches:I},{flushSync:M});return}let R=Li(I,fe,Q.pathname);if(R.active&&R.matches&&(I=R.matches),!I){let{error:J,notFoundMatches:Y,route:le}=jn(Q.pathname);at(Q,{matches:Y,loaderData:{},errors:{[le.id]:J}},{flushSync:M});return}C=new AbortController;let D=ho(t.history,Q,C.signal,ne&&ne.submission),b;if(ne&&ne.pendingError)b=[pa(I).route.id,{type:dt.error,error:ne.pendingError}];else if(ne&&ne.submission&&qn(ne.submission.formMethod)){let J=await Se(D,Q,ne.submission,I,R.active,{replace:ne.replace,flushSync:M});if(J.shortCircuited)return;if(J.pendingActionResult){let[Y,le]=J.pendingActionResult;if(mn(le)&&Xc(le.error)&&le.error.status===404){C=null,at(Q,{matches:J.matches,loaderData:{},errors:{[Y]:le.error}});return}}I=J.matches||I,b=J.pendingActionResult,ke=Cd(Q,ne.submission),M=!1,R.active=!1,D=ho(t.history,D.url,D.signal)}let{shortCircuited:L,matches:K,loaderData:te,errors:Z}=await Et(D,Q,I,R.active,ke,ne&&ne.submission,ne&&ne.fetcherSubmission,ne&&ne.replace,ne&&ne.initialHydration===!0,M,b);L||(C=null,at(Q,Rt({matches:K||I},Gx(b),{loaderData:te,errors:Z})))}async function Se(H,Q,ne,fe,ke,I){I===void 0&&(I={}),kt();let M=$R(Q,ne);if(z({navigation:M},{flushSync:I.flushSync===!0}),ke){let b=await An(fe,Q.pathname,H.signal);if(b.type==="aborted")return{shortCircuited:!0};if(b.type==="error"){let L=pa(b.partialMatches).route.id;return{matches:b.partialMatches,pendingActionResult:[L,{type:dt.error,error:b.error}]}}else if(b.matches)fe=b.matches;else{let{notFoundMatches:L,error:K,route:te}=jn(Q.pathname);return{matches:L,pendingActionResult:[te.id,{type:dt.error,error:K}]}}}let R,D=Yl(fe,Q);if(!D.route.action&&!D.route.lazy)R={type:dt.error,error:nn(405,{method:H.method,pathname:Q.pathname,routeId:D.route.id})};else if(R=(await or("action",g,H,[D],fe,null))[D.route.id],H.signal.aborted)return{shortCircuited:!0};if(_a(R)){let b;return I&&I.replace!=null?b=I.replace:b=zx(R.response.headers.get("Location"),new URL(H.url),l)===g.location.pathname+g.location.search,await Tt(H,R,!0,{submission:ne,replace:b}),{shortCircuited:!0}}if(Ps(R))throw nn(400,{type:"defer-action"});if(mn(R)){let b=pa(fe,D.route.id);return(I&&I.replace)!==!0&&(k=Xt.Push),{matches:fe,pendingActionResult:[b.route.id,R]}}return{matches:fe,pendingActionResult:[D.route.id,R]}}async function Et(H,Q,ne,fe,ke,I,M,R,D,b,L){let K=ke||Cd(Q,I),te=I||M||Xx(K),Z=!de&&(!h.v7_partialHydration||!D);if(fe){if(Z){let ut=ar(L);z(Rt({navigation:K},ut!==void 0?{actionData:ut}:{}),{flushSync:b})}let $e=await An(ne,Q.pathname,H.signal);if($e.type==="aborted")return{shortCircuited:!0};if($e.type==="error"){let ut=pa($e.partialMatches).route.id;return{matches:$e.partialMatches,loaderData:{},errors:{[ut]:$e.error}}}else if($e.matches)ne=$e.matches;else{let{error:ut,notFoundMatches:pr,route:In}=jn(Q.pathname);return{matches:pr,loaderData:{},errors:{[In.id]:ut}}}}let J=o||a,[Y,le]=Ux(t.history,g,ne,te,Q,h.v7_partialHydration&&D===!0,h.v7_skipActionErrorRevalidation,ve,Ie,oe,W,X,B,J,l,L);if(bi($e=>!(ne&&ne.some(ut=>ut.route.id===$e))||Y&&Y.some(ut=>ut.route.id===$e)),ue=++G,Y.length===0&&le.length===0){let $e=Fi();return at(Q,Rt({matches:ne,loaderData:{},errors:L&&mn(L[1])?{[L[0]]:L[1].error}:null},Gx(L),$e?{fetchers:new Map(g.fetchers)}:{}),{flushSync:b}),{shortCircuited:!0}}if(Z){let $e={};if(!fe){$e.navigation=K;let ut=ar(L);ut!==void 0&&($e.actionData=ut)}le.length>0&&($e.fetchers=Ar(le)),z($e,{flushSync:b})}le.forEach($e=>{ct($e.key),$e.controller&&ie.set($e.key,$e.controller)});let ye=()=>le.forEach($e=>ct($e.key));C&&C.signal.addEventListener("abort",ye);let{loaderResults:Ce,fetcherResults:pe}=await gt(g,ne,Y,le,H);if(H.signal.aborted)return{shortCircuited:!0};C&&C.signal.removeEventListener("abort",ye),le.forEach($e=>ie.delete($e.key));let we=gf(Ce);if(we)return await Tt(H,we.result,!0,{replace:R}),{shortCircuited:!0};if(we=gf(pe),we)return B.add(we.key),await Tt(H,we.result,!0,{replace:R}),{shortCircuited:!0};let{loaderData:De,errors:nt}=$x(g,ne,Ce,L,le,pe,ae);ae.forEach(($e,ut)=>{$e.subscribe(pr=>{(pr||$e.done)&&ae.delete(ut)})}),h.v7_partialHydration&&D&&g.errors&&(nt=Rt({},g.errors,nt));let Ke=Fi(),ht=so(ue),rn=Ke||ht||le.length>0;return Rt({matches:ne,loaderData:De,errors:nt},rn?{fetchers:new Map(g.fetchers)}:{})}function ar(H){if(H&&!mn(H[1]))return{[H[0]]:H[1].data};if(g.actionData)return Object.keys(g.actionData).length===0?null:g.actionData}function Ar(H){return H.forEach(Q=>{let ne=g.fetchers.get(Q.key),fe=Hl(void 0,ne?ne.data:void 0);g.fetchers.set(Q.key,fe)}),new Map(g.fetchers)}function en(H,Q,ne,fe){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ct(H);let ke=(fe&&fe.flushSync)===!0,I=o||a,M=$p(g.location,g.matches,l,h.v7_prependBasename,ne,h.v7_relativeSplatPath,Q,fe==null?void 0:fe.relative),R=da(I,M,l),D=Li(R,I,M);if(D.active&&D.matches&&(R=D.matches),!R){Ft(H,Q,nn(404,{pathname:M}),{flushSync:ke});return}let{path:b,submission:L,error:K}=Mx(h.v7_normalizeFormMethod,!0,M,fe);if(K){Ft(H,Q,K,{flushSync:ke});return}let te=Yl(R,b),Z=(fe&&fe.preventScrollReset)===!0;if(L&&qn(L.formMethod)){Pi(H,Q,b,te,R,D.active,ke,Z,L);return}X.set(H,{routeId:Q,path:b}),tn(H,Q,b,te,R,D.active,ke,Z,L)}async function Pi(H,Q,ne,fe,ke,I,M,R,D){kt(),X.delete(H);function b(Je){if(!Je.route.action&&!Je.route.lazy){let ui=nn(405,{method:D.formMethod,pathname:ne,routeId:Q});return Ft(H,Q,ui,{flushSync:M}),!0}return!1}if(!I&&b(fe))return;let L=g.fetchers.get(H);ft(H,WR(D,L),{flushSync:M});let K=new AbortController,te=ho(t.history,ne,K.signal,D);if(I){let Je=await An(ke,new URL(te.url).pathname,te.signal,H);if(Je.type==="aborted")return;if(Je.type==="error"){Ft(H,Q,Je.error,{flushSync:M});return}else if(Je.matches){if(ke=Je.matches,fe=Yl(ke,ne),b(fe))return}else{Ft(H,Q,nn(404,{pathname:ne}),{flushSync:M});return}}ie.set(H,K);let Z=G,Y=(await or("action",g,te,[fe],ke,H))[fe.route.id];if(te.signal.aborted){ie.get(H)===K&&ie.delete(H);return}if(h.v7_fetcherPersist&&W.has(H)){if(_a(Y)||mn(Y)){ft(H,ys(void 0));return}}else{if(_a(Y))if(ie.delete(H),ue>Z){ft(H,ys(void 0));return}else return B.add(H),ft(H,Hl(D)),Tt(te,Y,!1,{fetcherSubmission:D,preventScrollReset:R});if(mn(Y)){Ft(H,Q,Y.error);return}}if(Ps(Y))throw nn(400,{type:"defer-action"});let le=g.navigation.location||g.location,ye=ho(t.history,le,K.signal),Ce=o||a,pe=g.navigation.state!=="idle"?da(Ce,g.navigation.location,l):g.matches;Ge(pe,"Didn't find any matches after fetcher action");let we=++G;Ee.set(H,we);let De=Hl(D,Y.data);g.fetchers.set(H,De);let[nt,Ke]=Ux(t.history,g,pe,D,le,!1,h.v7_skipActionErrorRevalidation,ve,Ie,oe,W,X,B,Ce,l,[fe.route.id,Y]);Ke.filter(Je=>Je.key!==H).forEach(Je=>{let ui=Je.key,Al=g.fetchers.get(ui),Bu=Hl(void 0,Al?Al.data:void 0);g.fetchers.set(ui,Bu),ct(ui),Je.controller&&ie.set(ui,Je.controller)}),z({fetchers:new Map(g.fetchers)});let ht=()=>Ke.forEach(Je=>ct(Je.key));K.signal.addEventListener("abort",ht);let{loaderResults:rn,fetcherResults:$e}=await gt(g,pe,nt,Ke,ye);if(K.signal.aborted)return;K.signal.removeEventListener("abort",ht),Ee.delete(H),ie.delete(H),Ke.forEach(Je=>ie.delete(Je.key));let ut=gf(rn);if(ut)return Tt(ye,ut.result,!1,{preventScrollReset:R});if(ut=gf($e),ut)return B.add(ut.key),Tt(ye,ut.result,!1,{preventScrollReset:R});let{loaderData:pr,errors:In}=$x(g,pe,rn,void 0,Ke,$e,ae);if(g.fetchers.has(H)){let Je=ys(Y.data);g.fetchers.set(H,Je)}so(we),g.navigation.state==="loading"&&we>ue?(Ge(k,"Expected pending action"),C&&C.abort(),at(g.navigation.location,{matches:pe,loaderData:pr,errors:In,fetchers:new Map(g.fetchers)})):(z({errors:In,loaderData:Wx(g.loaderData,pr,pe,In),fetchers:new Map(g.fetchers)}),ve=!1)}async function tn(H,Q,ne,fe,ke,I,M,R,D){let b=g.fetchers.get(H);ft(H,Hl(D,b?b.data:void 0),{flushSync:M});let L=new AbortController,K=ho(t.history,ne,L.signal);if(I){let Y=await An(ke,new URL(K.url).pathname,K.signal,H);if(Y.type==="aborted")return;if(Y.type==="error"){Ft(H,Q,Y.error,{flushSync:M});return}else if(Y.matches)ke=Y.matches,fe=Yl(ke,ne);else{Ft(H,Q,nn(404,{pathname:ne}),{flushSync:M});return}}ie.set(H,L);let te=G,J=(await or("loader",g,K,[fe],ke,H))[fe.route.id];if(Ps(J)&&(J=await Ag(J,K.signal,!0)||J),ie.get(H)===L&&ie.delete(H),!K.signal.aborted){if(W.has(H)){ft(H,ys(void 0));return}if(_a(J))if(ue>te){ft(H,ys(void 0));return}else{B.add(H),await Tt(K,J,!1,{preventScrollReset:R});return}if(mn(J)){Ft(H,Q,J.error);return}Ge(!Ps(J),"Unhandled fetcher deferred data"),ft(H,ys(J.data))}}async function Tt(H,Q,ne,fe){let{submission:ke,fetcherSubmission:I,preventScrollReset:M,replace:R}=fe===void 0?{}:fe;Q.response.headers.has("X-Remix-Revalidate")&&(ve=!0);let D=Q.response.headers.get("Location");Ge(D,"Expected a Location header on the redirect Response"),D=zx(D,new URL(H.url),l);let b=qc(g.location,D,{_isRedirect:!0});if(r){let Y=!1;if(Q.response.headers.has("X-Remix-Reload-Document"))Y=!0;else if(Sg.test(D)){const le=t.history.createURL(D);Y=le.origin!==e.location.origin||ns(le.pathname,l)==null}if(Y){R?e.location.replace(D):e.location.assign(D);return}}C=null;let L=R===!0||Q.response.headers.has("X-Remix-Replace")?Xt.Replace:Xt.Push,{formMethod:K,formAction:te,formEncType:Z}=g.navigation;!ke&&!I&&K&&te&&Z&&(ke=Xx(g.navigation));let J=ke||I;if(SR.has(Q.response.status)&&J&&qn(J.formMethod))await be(L,b,{submission:Rt({},J,{formAction:D}),preventScrollReset:M||S,enableViewTransition:ne?P:void 0});else{let Y=Cd(b,ke);await be(L,b,{overrideNavigation:Y,fetcherSubmission:I,preventScrollReset:M||S,enableViewTransition:ne?P:void 0})}}async function or(H,Q,ne,fe,ke,I){let M,R={};try{M=await DR(c,H,Q,ne,fe,ke,I,s,i)}catch(D){return fe.forEach(b=>{R[b.route.id]={type:dt.error,error:D}}),R}for(let[D,b]of Object.entries(M))if(UR(b)){let L=b.result;R[D]={type:dt.redirect,response:LR(L,ne,D,ke,l,h.v7_relativeSplatPath)}}else R[D]=await OR(b);return R}async function gt(H,Q,ne,fe,ke){let I=H.matches,M=or("loader",H,ke,ne,Q,null),R=Promise.all(fe.map(async L=>{if(L.matches&&L.match&&L.controller){let te=(await or("loader",H,ho(t.history,L.path,L.controller.signal),[L.match],L.matches,L.key))[L.match.route.id];return{[L.key]:te}}else return Promise.resolve({[L.key]:{type:dt.error,error:nn(404,{pathname:L.path})}})})),D=await M,b=(await R).reduce((L,K)=>Object.assign(L,K),{});return await Promise.all([zR(Q,D,ke.signal,I,H.loaderData),HR(Q,b,fe)]),{loaderResults:D,fetcherResults:b}}function kt(){ve=!0,Ie.push(...bi()),X.forEach((H,Q)=>{ie.has(Q)&&oe.add(Q),ct(Q)})}function ft(H,Q,ne){ne===void 0&&(ne={}),g.fetchers.set(H,Q),z({fetchers:new Map(g.fetchers)},{flushSync:(ne&&ne.flushSync)===!0})}function Ft(H,Q,ne,fe){fe===void 0&&(fe={});let ke=pa(g.matches,Q);vt(H),z({errors:{[ke.route.id]:ne},fetchers:new Map(g.fetchers)},{flushSync:(fe&&fe.flushSync)===!0})}function Ve(H){return q.set(H,(q.get(H)||0)+1),W.has(H)&&W.delete(H),g.fetchers.get(H)||AR}function vt(H){let Q=g.fetchers.get(H);ie.has(H)&&!(Q&&Q.state==="loading"&&Ee.has(H))&&ct(H),X.delete(H),Ee.delete(H),B.delete(H),h.v7_fetcherPersist&&W.delete(H),oe.delete(H),g.fetchers.delete(H)}function $t(H){let Q=(q.get(H)||0)-1;Q<=0?(q.delete(H),W.add(H),h.v7_fetcherPersist||vt(H)):q.set(H,Q),z({fetchers:new Map(g.fetchers)})}function ct(H){let Q=ie.get(H);Q&&(Q.abort(),ie.delete(H))}function hn(H){for(let Q of H){let ne=Ve(Q),fe=ys(ne.data);g.fetchers.set(Q,fe)}}function Fi(){let H=[],Q=!1;for(let ne of B){let fe=g.fetchers.get(ne);Ge(fe,"Expected fetcher: "+ne),fe.state==="loading"&&(B.delete(ne),H.push(ne),Q=!0)}return hn(H),Q}function so(H){let Q=[];for(let[ne,fe]of Ee)if(fe<H){let ke=g.fetchers.get(ne);Ge(ke,"Expected fetcher: "+ne),ke.state==="loading"&&(ct(ne),Ee.delete(ne),Q.push(ne))}return hn(Q),Q.length>0}function Sl(H,Q){let ne=g.blockers.get(H)||zl;return xe.get(H)!==Q&&xe.set(H,Q),ne}function Di(H){g.blockers.delete(H),xe.delete(H)}function li(H,Q){let ne=g.blockers.get(H)||zl;Ge(ne.state==="unblocked"&&Q.state==="blocked"||ne.state==="blocked"&&Q.state==="blocked"||ne.state==="blocked"&&Q.state==="proceeding"||ne.state==="blocked"&&Q.state==="unblocked"||ne.state==="proceeding"&&Q.state==="unblocked","Invalid blocker state transition: "+ne.state+" -> "+Q.state);let fe=new Map(g.blockers);fe.set(H,Q),z({blockers:fe})}function ps(H){let{currentLocation:Q,nextLocation:ne,historyAction:fe}=H;if(xe.size===0)return;xe.size>1&&el(!1,"A router only supports one blocker at a time");let ke=Array.from(xe.entries()),[I,M]=ke[ke.length-1],R=g.blockers.get(I);if(!(R&&R.state==="proceeding")&&M({currentLocation:Q,nextLocation:ne,historyAction:fe}))return I}function jn(H){let Q=nn(404,{pathname:H}),ne=o||a,{matches:fe,route:ke}=Kx(ne);return bi(),{notFoundMatches:fe,route:ke,error:Q}}function bi(H){let Q=[];return ae.forEach((ne,fe)=>{(!H||H(fe))&&(ne.cancel(),Q.push(fe),ae.delete(fe))}),Q}function ci(H,Q,ne){if(v=H,w=Q,m=ne||null,!T&&g.navigation===Id){T=!0;let fe=Oi(g.location,g.matches);fe!=null&&z({restoreScrollPosition:fe})}return()=>{v=null,w=null,m=null}}function Sn(H,Q){return m&&m(H,Q.map(fe=>nR(fe,g.loaderData)))||H.key}function ao(H,Q){if(v&&w){let ne=Sn(H,Q);v[ne]=w()}}function Oi(H,Q){if(v){let ne=Sn(H,Q),fe=v[ne];if(typeof fe=="number")return fe}return null}function Li(H,Q,ne){if(f)if(H){if(Object.keys(H[0].params).length>0)return{active:!0,matches:$f(Q,ne,l,!0)}}else return{active:!0,matches:$f(Q,ne,l,!0)||[]};return{active:!1,matches:null}}async function An(H,Q,ne,fe){if(!f)return{type:"success",matches:H};let ke=H;for(;;){let I=o==null,M=o||a,R=s;try{await f({signal:ne,path:Q,matches:ke,fetcherKey:fe,patch:(L,K)=>{ne.aborted||jx(L,K,M,R,i)}})}catch(L){return{type:"error",error:L,partialMatches:ke}}finally{I&&!ne.aborted&&(a=[...a])}if(ne.aborted)return{type:"aborted"};let D=da(M,Q,l);if(D)return{type:"success",matches:D};let b=$f(M,Q,l,!0);if(!b||ke.length===b.length&&ke.every((L,K)=>L.route.id===b[K].route.id))return{type:"success",matches:null};ke=b}}function oo(H){s={},o=kh(H,i,void 0,s)}function Zt(H,Q){let ne=o==null;jx(H,Q,o||a,s,i),ne&&(a=[...a],z({}))}return U={get basename(){return l},get future(){return h},get state(){return g},get routes(){return a},get window(){return e},initialize:he,subscribe:He,enableScrollRestoration:ci,navigate:We,fetch:en,revalidate:rt,createHref:H=>t.history.createHref(H),encodeLocation:H=>t.history.encodeLocation(H),getFetcher:Ve,deleteFetcher:$t,dispose:ge,getBlocker:Sl,deleteBlocker:Di,patchRoutes:Zt,_internalFetchControllers:ie,_internalActiveDeferreds:ae,_internalSetRoutes:oo},U}function RR(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function $p(t,e,r,n,i,s,a,o){let l,c;if(a){l=[];for(let h of e)if(l.push(h),h.route.id===a){c=h;break}}else l=e,c=e[e.length-1];let f=_0(i||".",x0(l,s),ns(t.pathname,r)||t.pathname,o==="path");if(i==null&&(f.search=t.search,f.hash=t.hash),(i==null||i===""||i===".")&&c){let h=Ig(f.search);if(c.route.index&&!h)f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&h){let d=new URLSearchParams(f.search),p=d.getAll("index");d.delete("index"),p.filter(m=>m).forEach(m=>d.append("index",m));let v=d.toString();f.search=v?"?"+v:""}}return n&&r!=="/"&&(f.pathname=f.pathname==="/"?r:Xi([r,f.pathname])),ba(f)}function Mx(t,e,r,n){if(!n||!RR(n))return{path:r};if(n.formMethod&&!jR(n.formMethod))return{path:r,error:nn(405,{method:n.formMethod})};let i=()=>({path:r,error:nn(400,{type:"invalid-body"})}),s=n.formMethod||"get",a=t?s.toUpperCase():s.toLowerCase(),o=G2(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!qn(a))return i();let d=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((p,v)=>{let[m,w]=v;return""+p+m+"="+w+`
`},""):String(n.body);return{path:r,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:d}}}else if(n.formEncType==="application/json"){if(!qn(a))return i();try{let d=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:d,text:void 0}}}catch{return i()}}}Ge(typeof FormData=="function","FormData is not available in this environment");let l,c;if(n.formData)l=Gp(n.formData),c=n.formData;else if(n.body instanceof FormData)l=Gp(n.body),c=n.body;else if(n.body instanceof URLSearchParams)l=n.body,c=Hx(l);else if(n.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(n.body),c=Hx(l)}catch{return i()}let f={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(qn(f.formMethod))return{path:r,submission:f};let h=sa(r);return e&&h.search&&Ig(h.search)&&l.append("index",""),h.search="?"+l,{path:ba(h),submission:f}}function Vx(t,e,r){r===void 0&&(r=!1);let n=t.findIndex(i=>i.route.id===e);return n>=0?t.slice(0,r?n+1:n):t}function Ux(t,e,r,n,i,s,a,o,l,c,f,h,d,p,v,m){let w=m?mn(m[1])?m[1].error:m[1].data:void 0,T=t.createURL(e.location),E=t.createURL(i),y=r;s&&e.errors?y=Vx(r,Object.keys(e.errors)[0],!0):m&&mn(m[1])&&(y=Vx(r,m[0]));let N=m?m[1].statusCode:void 0,j=a&&N&&N>=400,U=y.filter((k,S)=>{let{route:C}=k;if(C.lazy)return!0;if(C.loader==null)return!1;if(s)return Wp(C,e.loaderData,e.errors);if(NR(e.loaderData,e.matches[S],k)||l.some(O=>O===k.route.id))return!0;let P=e.matches[S],F=k;return Bx(k,Rt({currentUrl:T,currentParams:P.params,nextUrl:E,nextParams:F.params},n,{actionResult:w,actionStatus:N,defaultShouldRevalidate:j?!1:o||T.pathname+T.search===E.pathname+E.search||T.search!==E.search||$2(P,F)}))}),g=[];return h.forEach((k,S)=>{if(s||!r.some(de=>de.route.id===k.routeId)||f.has(S))return;let C=da(p,k.path,v);if(!C){g.push({key:S,routeId:k.routeId,path:k.path,matches:null,match:null,controller:null});return}let P=e.fetchers.get(S),F=Yl(C,k.path),O=!1;d.has(S)?O=!1:c.has(S)?(c.delete(S),O=!0):P&&P.state!=="idle"&&P.data===void 0?O=o:O=Bx(F,Rt({currentUrl:T,currentParams:e.matches[e.matches.length-1].params,nextUrl:E,nextParams:r[r.length-1].params},n,{actionResult:w,actionStatus:N,defaultShouldRevalidate:j?!1:o})),O&&g.push({key:S,routeId:k.routeId,path:k.path,matches:C,match:F,controller:new AbortController})}),[U,g]}function Wp(t,e,r){if(t.lazy)return!0;if(!t.loader)return!1;let n=e!=null&&e[t.id]!==void 0,i=r!=null&&r[t.id]!==void 0;return!n&&i?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!n&&!i}function NR(t,e,r){let n=!e||r.route.id!==e.route.id,i=t[r.route.id]===void 0;return n||i}function $2(t,e){let r=t.route.path;return t.pathname!==e.pathname||r!=null&&r.endsWith("*")&&t.params["*"]!==e.params["*"]}function Bx(t,e){if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate(e);if(typeof r=="boolean")return r}return e.defaultShouldRevalidate}function jx(t,e,r,n,i){var s;let a;if(t){let c=n[t];Ge(c,"No route found to patch children into: routeId = "+t),c.children||(c.children=[]),a=c.children}else a=r;let o=e.filter(c=>!a.some(f=>W2(c,f))),l=kh(o,i,[t||"_","patch",String(((s=a)==null?void 0:s.length)||"0")],n);a.push(...l)}function W2(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((r,n)=>{var i;return(i=e.children)==null?void 0:i.some(s=>W2(r,s))}):!1}async function PR(t,e,r){if(!t.lazy)return;let n=await t.lazy();if(!t.lazy)return;let i=r[t.id];Ge(i,"No route found in manifest");let s={};for(let a in n){let l=i[a]!==void 0&&a!=="hasErrorBoundary";el(!l,'Route "'+i.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!l&&!tR.has(a)&&(s[a]=n[a])}Object.assign(i,s),Object.assign(i,Rt({},e(i),{lazy:void 0}))}async function FR(t){let{matches:e}=t,r=e.filter(i=>i.shouldLoad);return(await Promise.all(r.map(i=>i.resolve()))).reduce((i,s,a)=>Object.assign(i,{[r[a].route.id]:s}),{})}async function DR(t,e,r,n,i,s,a,o,l,c){let f=s.map(p=>p.route.lazy?PR(p.route,l,o):void 0),h=s.map((p,v)=>{let m=f[v],w=i.some(E=>E.route.id===p.route.id);return Rt({},p,{shouldLoad:w,resolve:async E=>(E&&n.method==="GET"&&(p.route.lazy||p.route.loader)&&(w=!0),w?bR(e,n,p,m,E,c):Promise.resolve({type:dt.data,result:void 0}))})}),d=await t({matches:h,request:n,params:s[0].params,fetcherKey:a,context:c});try{await Promise.all(f)}catch{}return d}async function bR(t,e,r,n,i,s){let a,o,l=c=>{let f,h=new Promise((v,m)=>f=m);o=()=>f(),e.signal.addEventListener("abort",o);let d=v=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+r.route.id+"]"))):c({request:e,params:r.params,context:s},...v!==void 0?[v]:[]),p=(async()=>{try{return{type:"data",result:await(i?i(m=>d(m)):d())}}catch(v){return{type:"error",result:v}}})();return Promise.race([p,h])};try{let c=r.route[t];if(n)if(c){let f,[h]=await Promise.all([l(c).catch(d=>{f=d}),n]);if(f!==void 0)throw f;a=h}else if(await n,c=r.route[t],c)a=await l(c);else if(t==="action"){let f=new URL(e.url),h=f.pathname+f.search;throw nn(405,{method:e.method,pathname:h,routeId:r.route.id})}else return{type:dt.data,result:void 0};else if(c)a=await l(c);else{let f=new URL(e.url),h=f.pathname+f.search;throw nn(404,{pathname:h})}Ge(a.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:dt.error,result:c}}finally{o&&e.signal.removeEventListener("abort",o)}return a}async function OR(t){let{result:e,type:r}=t;if(K2(e)){let h;try{let d=e.headers.get("Content-Type");d&&/\bapplication\/json\b/.test(d)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(d){return{type:dt.error,error:d}}return r===dt.error?{type:dt.error,error:new Ah(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:dt.data,data:h,statusCode:e.status,headers:e.headers}}if(r===dt.error){if(qx(e)){var n,i;if(e.data instanceof Error){var s,a;return{type:dt.error,error:e.data,statusCode:(s=e.init)==null?void 0:s.status,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}}return{type:dt.error,error:new Ah(((n=e.init)==null?void 0:n.status)||500,void 0,e.data),statusCode:Xc(e)?e.status:void 0,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:dt.error,error:e,statusCode:Xc(e)?e.status:void 0}}if(BR(e)){var o,l;return{type:dt.deferred,deferredData:e,statusCode:(o=e.init)==null?void 0:o.status,headers:((l=e.init)==null?void 0:l.headers)&&new Headers(e.init.headers)}}if(qx(e)){var c,f;return{type:dt.data,data:e.data,statusCode:(c=e.init)==null?void 0:c.status,headers:(f=e.init)!=null&&f.headers?new Headers(e.init.headers):void 0}}return{type:dt.data,data:e}}function LR(t,e,r,n,i,s){let a=t.headers.get("Location");if(Ge(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!Sg.test(a)){let o=n.slice(0,n.findIndex(l=>l.route.id===r)+1);a=$p(new URL(e.url),o,i,!0,a,s),t.headers.set("Location",a)}return t}function zx(t,e,r){if(Sg.test(t)){let n=t,i=n.startsWith("//")?new URL(e.protocol+n):new URL(n),s=ns(i.pathname,r)!=null;if(i.origin===e.origin&&s)return i.pathname+i.search+i.hash}return t}function ho(t,e,r,n){let i=t.createURL(G2(e)).toString(),s={signal:r};if(n&&qn(n.formMethod)){let{formMethod:a,formEncType:o}=n;s.method=a.toUpperCase(),o==="application/json"?(s.headers=new Headers({"Content-Type":o}),s.body=JSON.stringify(n.json)):o==="text/plain"?s.body=n.text:o==="application/x-www-form-urlencoded"&&n.formData?s.body=Gp(n.formData):s.body=n.formData}return new Request(i,s)}function Gp(t){let e=new URLSearchParams;for(let[r,n]of t.entries())e.append(r,typeof n=="string"?n:n.name);return e}function Hx(t){let e=new FormData;for(let[r,n]of t.entries())e.append(r,n);return e}function MR(t,e,r,n,i){let s={},a=null,o,l=!1,c={},f=r&&mn(r[1])?r[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let d=h.route.id,p=e[d];if(Ge(!_a(p),"Cannot handle redirect results in processLoaderData"),mn(p)){let v=p.error;f!==void 0&&(v=f,f=void 0),a=a||{};{let m=pa(t,d);a[m.route.id]==null&&(a[m.route.id]=v)}s[d]=void 0,l||(l=!0,o=Xc(p.error)?p.error.status:500),p.headers&&(c[d]=p.headers)}else Ps(p)?(n.set(d,p.deferredData),s[d]=p.deferredData.data,p.statusCode!=null&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[d]=p.headers)):(s[d]=p.data,p.statusCode&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[d]=p.headers))}),f!==void 0&&r&&(a={[r[0]]:f},s[r[0]]=void 0),{loaderData:s,errors:a,statusCode:o||200,loaderHeaders:c}}function $x(t,e,r,n,i,s,a){let{loaderData:o,errors:l}=MR(e,r,n,a);return i.forEach(c=>{let{key:f,match:h,controller:d}=c,p=s[f];if(Ge(p,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(mn(p)){let v=pa(t.matches,h==null?void 0:h.route.id);l&&l[v.route.id]||(l=Rt({},l,{[v.route.id]:p.error})),t.fetchers.delete(f)}else if(_a(p))Ge(!1,"Unhandled fetcher revalidation redirect");else if(Ps(p))Ge(!1,"Unhandled fetcher deferred data");else{let v=ys(p.data);t.fetchers.set(f,v)}}),{loaderData:o,errors:l}}function Wx(t,e,r,n){let i=Rt({},e);for(let s of r){let a=s.route.id;if(e.hasOwnProperty(a)?e[a]!==void 0&&(i[a]=e[a]):t[a]!==void 0&&s.route.loader&&(i[a]=t[a]),n&&n.hasOwnProperty(a))break}return i}function Gx(t){return t?mn(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function pa(t,e){return(e?t.slice(0,t.findIndex(n=>n.route.id===e)+1):[...t]).reverse().find(n=>n.route.hasErrorBoundary===!0)||t[0]}function Kx(t){let e=t.length===1?t[0]:t.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function nn(t,e){let{pathname:r,routeId:n,method:i,type:s,message:a}=e===void 0?{}:e,o="Unknown Server Error",l="Unknown @remix-run/router error";return t===400?(o="Bad Request",i&&r&&n?l="You made a "+i+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":s==="defer-action"?l="defer() is not supported in actions":s==="invalid-body"&&(l="Unable to encode submission body")):t===403?(o="Forbidden",l='Route "'+n+'" does not match URL "'+r+'"'):t===404?(o="Not Found",l='No route matches URL "'+r+'"'):t===405&&(o="Method Not Allowed",i&&r&&n?l="You made a "+i.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":i&&(l='Invalid request method "'+i.toUpperCase()+'"')),new Ah(t||500,o,new Error(l),!0)}function gf(t){let e=Object.entries(t);for(let r=e.length-1;r>=0;r--){let[n,i]=e[r];if(_a(i))return{key:n,result:i}}}function G2(t){let e=typeof t=="string"?sa(t):t;return ba(Rt({},e,{hash:""}))}function VR(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function UR(t){return K2(t.result)&&kR.has(t.result.status)}function Ps(t){return t.type===dt.deferred}function mn(t){return t.type===dt.error}function _a(t){return(t&&t.type)===dt.redirect}function qx(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function BR(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function K2(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function jR(t){return TR.has(t.toLowerCase())}function qn(t){return wR.has(t.toLowerCase())}async function zR(t,e,r,n,i){let s=Object.entries(e);for(let a=0;a<s.length;a++){let[o,l]=s[a],c=t.find(d=>(d==null?void 0:d.route.id)===o);if(!c)continue;let f=n.find(d=>d.route.id===c.route.id),h=f!=null&&!$2(f,c)&&(i&&i[c.route.id])!==void 0;Ps(l)&&h&&await Ag(l,r,!1).then(d=>{d&&(e[o]=d)})}}async function HR(t,e,r){for(let n=0;n<r.length;n++){let{key:i,routeId:s,controller:a}=r[n],o=e[i];t.find(c=>(c==null?void 0:c.route.id)===s)&&Ps(o)&&(Ge(a,"Expected an AbortController for revalidating fetcher deferred result"),await Ag(o,a.signal,!0).then(c=>{c&&(e[i]=c)}))}}async function Ag(t,e,r){if(r===void 0&&(r=!1),!await t.deferredData.resolveData(e)){if(r)try{return{type:dt.data,data:t.deferredData.unwrappedData}}catch(i){return{type:dt.error,error:i}}return{type:dt.data,data:t.deferredData.data}}}function Ig(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Yl(t,e){let r=typeof e=="string"?sa(e).search:e.search;if(t[t.length-1].route.index&&Ig(r||""))return t[t.length-1];let n=j2(t);return n[n.length-1]}function Xx(t){let{formMethod:e,formAction:r,formEncType:n,text:i,formData:s,json:a}=t;if(!(!e||!r||!n)){if(i!=null)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:e,formAction:r,formEncType:n,formData:s,json:void 0,text:void 0};if(a!==void 0)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:a,text:void 0}}}function Cd(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function $R(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Hl(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function WR(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function ys(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function GR(t,e){try{let r=t.sessionStorage.getItem(H2);if(r){let n=JSON.parse(r);for(let[i,s]of Object.entries(n||{}))s&&Array.isArray(s)&&e.set(i,new Set(s||[]))}}catch{}}function KR(t,e){if(e.size>0){let r={};for(let[n,i]of e)r[n]=[...i];try{t.sessionStorage.setItem(H2,JSON.stringify(r))}catch(n){el(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ih(){return Ih=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ih.apply(this,arguments)}const yu=ee.createContext(null),Cg=ee.createContext(null),fs=ee.createContext(null),Rg=ee.createContext(null),Ai=ee.createContext({outlet:null,matches:[],isDataRoute:!1}),q2=ee.createContext(null);function qR(t,e){let{relative:r}=e===void 0?{}:e;gl()||Ge(!1);let{basename:n,navigator:i}=ee.useContext(fs),{hash:s,pathname:a,search:o}=y0(t,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:Xi([n,a])),i.createHref({pathname:l,search:o,hash:s})}function gl(){return ee.useContext(Rg)!=null}function Ga(){return gl()||Ge(!1),ee.useContext(Rg).location}function X2(t){ee.useContext(fs).static||ee.useLayoutEffect(t)}function Ka(){let{isDataRoute:t}=ee.useContext(Ai);return t?cN():XR()}function XR(){gl()||Ge(!1);let t=ee.useContext(yu),{basename:e,future:r,navigator:n}=ee.useContext(fs),{matches:i}=ee.useContext(Ai),{pathname:s}=Ga(),a=JSON.stringify(x0(i,r.v7_relativeSplatPath)),o=ee.useRef(!1);return X2(()=>{o.current=!0}),ee.useCallback(function(c,f){if(f===void 0&&(f={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=_0(c,JSON.parse(a),s,f.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Xi([e,h.pathname])),(f.replace?n.replace:n.push)(h,f.state,f)},[e,n,a,s,t])}const YR=ee.createContext(null);function QR(t){let e=ee.useContext(Ai).outlet;return e&&ee.createElement(YR.Provider,{value:t},e)}function JR(){let{matches:t}=ee.useContext(Ai),e=t[t.length-1];return e?e.params:{}}function y0(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=ee.useContext(fs),{matches:i}=ee.useContext(Ai),{pathname:s}=Ga(),a=JSON.stringify(x0(i,n.v7_relativeSplatPath));return ee.useMemo(()=>_0(t,JSON.parse(a),s,r==="path"),[t,a,s,r])}function ZR(t,e,r,n){gl()||Ge(!1);let{navigator:i}=ee.useContext(fs),{matches:s}=ee.useContext(Ai),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let c=Ga(),f;f=c;let h=f.pathname||"/",d=h;if(l!=="/"){let m=l.replace(/^\//,"").split("/");d="/"+h.replace(/^\//,"").split("/").slice(m.length).join("/")}let p=da(t,{pathname:d});return iN(p&&p.map(m=>Object.assign({},m,{params:Object.assign({},o,m.params),pathname:Xi([l,i.encodeLocation?i.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?l:Xi([l,i.encodeLocation?i.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),s,r,n)}function eN(){let t=lN(),e=Xc(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ee.createElement(ee.Fragment,null,ee.createElement("h2",null,"Unexpected Application Error!"),ee.createElement("h3",{style:{fontStyle:"italic"}},e),r?ee.createElement("pre",{style:i},r):null,null)}const tN=ee.createElement(eN,null);class rN extends ee.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?ee.createElement(Ai.Provider,{value:this.props.routeContext},ee.createElement(q2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function nN(t){let{routeContext:e,match:r,children:n}=t,i=ee.useContext(yu);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),ee.createElement(Ai.Provider,{value:e},n)}function iN(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=(i=r)==null?void 0:i.errors;if(o!=null){let f=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);f>=0||Ge(!1),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<a.length;f++){let h=a[f];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=f),h.route.id){let{loaderData:d,errors:p}=r,v=h.route.loader&&d[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||v){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((f,h,d)=>{let p,v=!1,m=null,w=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,m=h.route.errorElement||tN,l&&(c<0&&d===0?(uN("route-fallback"),v=!0,w=null):c===d&&(v=!0,w=h.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,d+1)),E=()=>{let y;return p?y=m:v?y=w:h.route.Component?y=ee.createElement(h.route.Component,null):h.route.element?y=h.route.element:y=f,ee.createElement(nN,{match:h,routeContext:{outlet:f,matches:T,isDataRoute:r!=null},children:y})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?ee.createElement(rN,{location:r.location,revalidation:r.revalidation,component:m,error:p,children:E(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):E()},null)}var Y2=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Y2||{}),Q2=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Q2||{});function sN(t){let e=ee.useContext(yu);return e||Ge(!1),e}function aN(t){let e=ee.useContext(Cg);return e||Ge(!1),e}function oN(t){let e=ee.useContext(Ai);return e||Ge(!1),e}function J2(t){let e=oN(),r=e.matches[e.matches.length-1];return r.route.id||Ge(!1),r.route.id}function lN(){var t;let e=ee.useContext(q2),r=aN(Q2.UseRouteError),n=J2();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function cN(){let{router:t}=sN(Y2.UseNavigateStable),e=J2(),r=ee.useRef(!1);return X2(()=>{r.current=!0}),ee.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Ih({fromRouteId:e},s)))},[t,e])}const Yx={};function uN(t,e,r){Yx[t]||(Yx[t]=!0)}function fN(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function hN(t){let{to:e,replace:r,state:n,relative:i}=t;gl()||Ge(!1);let{future:s,static:a}=ee.useContext(fs),{matches:o}=ee.useContext(Ai),{pathname:l}=Ga(),c=Ka(),f=_0(e,x0(o,s.v7_relativeSplatPath),l,i==="path"),h=JSON.stringify(f);return ee.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:i}),[c,h,i,r,n]),null}function Z2(t){return QR(t.context)}function dN(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Xt.Pop,navigator:s,static:a=!1,future:o}=t;gl()&&Ge(!1);let l=e.replace(/^\/*/,"/"),c=ee.useMemo(()=>({basename:l,navigator:s,static:a,future:Ih({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof n=="string"&&(n=sa(n));let{pathname:f="/",search:h="",hash:d="",state:p=null,key:v="default"}=n,m=ee.useMemo(()=>{let w=ns(f,l);return w==null?null:{location:{pathname:w,search:h,hash:d,state:p,key:v},navigationType:i}},[l,f,h,d,p,v,i]);return m==null?null:ee.createElement(fs.Provider,{value:c},ee.createElement(Rg.Provider,{children:r,value:m}))}new Promise(()=>{});function pN(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:ee.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:ee.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:ee.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tl(){return tl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},tl.apply(this,arguments)}function eT(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function mN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function gN(t,e){return t.button===0&&(!e||e==="_self")&&!mN(t)}const vN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],xN=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],_N="6";try{window.__reactRouterVersion=_N}catch{}function yN(t,e){return CR({basename:void 0,future:tl({},void 0,{v7_prependBasename:!0}),history:J4({window:void 0}),hydrationData:wN(),routes:t,mapRouteProperties:pN,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function wN(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=tl({},e,{errors:EN(e.errors)})),e}function EN(t){if(!t)return null;let e=Object.entries(t),r={};for(let[n,i]of e)if(i&&i.__type==="RouteErrorResponse")r[n]=new Ah(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let a=new s(i.message);a.stack="",r[n]=a}catch{}}if(r[n]==null){let s=new Error(i.message);s.stack="",r[n]=s}}else r[n]=i;return r}const tT=ee.createContext({isTransitioning:!1}),TN=ee.createContext(new Map),kN="startTransition",Qx=UI[kN],SN="flushSync",Jx=Q4[SN];function AN(t){Qx?Qx(t):t()}function $l(t){Jx?Jx(t):t()}let IN=class{constructor(){this.status="pending",this.promise=new Promise((e,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}};function CN(t){let{fallbackElement:e,router:r,future:n}=t,[i,s]=ee.useState(r.state),[a,o]=ee.useState(),[l,c]=ee.useState({isTransitioning:!1}),[f,h]=ee.useState(),[d,p]=ee.useState(),[v,m]=ee.useState(),w=ee.useRef(new Map),{v7_startTransition:T}=n||{},E=ee.useCallback(k=>{T?AN(k):k()},[T]),y=ee.useCallback((k,S)=>{let{deletedFetchers:C,flushSync:P,viewTransitionOpts:F}=S;k.fetchers.forEach((de,ve)=>{de.data!==void 0&&w.current.set(ve,de.data)}),C.forEach(de=>w.current.delete(de));let O=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!F||O){P?$l(()=>s(k)):E(()=>s(k));return}if(P){$l(()=>{d&&(f&&f.resolve(),d.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:F.currentLocation,nextLocation:F.nextLocation})});let de=r.window.document.startViewTransition(()=>{$l(()=>s(k))});de.finished.finally(()=>{$l(()=>{h(void 0),p(void 0),o(void 0),c({isTransitioning:!1})})}),$l(()=>p(de));return}d?(f&&f.resolve(),d.skipTransition(),m({state:k,currentLocation:F.currentLocation,nextLocation:F.nextLocation})):(o(k),c({isTransitioning:!0,flushSync:!1,currentLocation:F.currentLocation,nextLocation:F.nextLocation}))},[r.window,d,f,w,E]);ee.useLayoutEffect(()=>r.subscribe(y),[r,y]),ee.useEffect(()=>{l.isTransitioning&&!l.flushSync&&h(new IN)},[l]),ee.useEffect(()=>{if(f&&a&&r.window){let k=a,S=f.promise,C=r.window.document.startViewTransition(async()=>{E(()=>s(k)),await S});C.finished.finally(()=>{h(void 0),p(void 0),o(void 0),c({isTransitioning:!1})}),p(C)}},[E,a,f,r.window]),ee.useEffect(()=>{f&&a&&i.location.key===a.location.key&&f.resolve()},[f,d,i.location,a]),ee.useEffect(()=>{!l.isTransitioning&&v&&(o(v.state),c({isTransitioning:!0,flushSync:!1,currentLocation:v.currentLocation,nextLocation:v.nextLocation}),m(void 0))},[l.isTransitioning,v]),ee.useEffect(()=>{},[]);let N=ee.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:k=>r.navigate(k),push:(k,S,C)=>r.navigate(k,{state:S,preventScrollReset:C==null?void 0:C.preventScrollReset}),replace:(k,S,C)=>r.navigate(k,{replace:!0,state:S,preventScrollReset:C==null?void 0:C.preventScrollReset})}),[r]),j=r.basename||"/",U=ee.useMemo(()=>({router:r,navigator:N,static:!1,basename:j}),[r,N,j]),g=ee.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return ee.useEffect(()=>fN(n,r.future),[n,r.future]),ee.createElement(ee.Fragment,null,ee.createElement(yu.Provider,{value:U},ee.createElement(Cg.Provider,{value:i},ee.createElement(TN.Provider,{value:w.current},ee.createElement(tT.Provider,{value:l},ee.createElement(dN,{basename:j,location:i.location,navigationType:i.historyAction,navigator:N,future:g},i.initialized||r.future.v7_partialHydration?ee.createElement(RN,{routes:r.routes,future:r.future,state:i}):e))))),null)}const RN=ee.memo(NN);function NN(t){let{routes:e,future:r,state:n}=t;return ZR(e,void 0,n,r)}const PN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",FN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xt=ee.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:f,viewTransition:h}=e,d=eT(e,vN),{basename:p}=ee.useContext(fs),v,m=!1;if(typeof c=="string"&&FN.test(c)&&(v=c,PN))try{let y=new URL(window.location.href),N=c.startsWith("//")?new URL(y.protocol+c):new URL(c),j=ns(N.pathname,p);N.origin===y.origin&&j!=null?c=j+N.search+N.hash:m=!0}catch{}let w=qR(c,{relative:i}),T=bN(c,{replace:a,state:o,target:l,preventScrollReset:f,relative:i,viewTransition:h});function E(y){n&&n(y),y.defaultPrevented||T(y)}return ee.createElement("a",tl({},d,{href:v||w,onClick:m||s?n:E,ref:r,target:l}))}),po=ee.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:s="",end:a=!1,style:o,to:l,viewTransition:c,children:f}=e,h=eT(e,xN),d=y0(l,{relative:h.relative}),p=Ga(),v=ee.useContext(Cg),{navigator:m,basename:w}=ee.useContext(fs),T=v!=null&&ON(d)&&c===!0,E=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,y=p.pathname,N=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;i||(y=y.toLowerCase(),N=N?N.toLowerCase():null,E=E.toLowerCase()),N&&w&&(N=ns(N,w)||N);const j=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let U=y===E||!a&&y.startsWith(E)&&y.charAt(j)==="/",g=N!=null&&(N===E||!a&&N.startsWith(E)&&N.charAt(E.length)==="/"),k={isActive:U,isPending:g,isTransitioning:T},S=U?n:void 0,C;typeof s=="function"?C=s(k):C=[s,U?"active":null,g?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let P=typeof o=="function"?o(k):o;return ee.createElement(xt,tl({},h,{"aria-current":S,className:C,ref:r,style:P,to:l,viewTransition:c}),typeof f=="function"?f(k):f)});var Kp;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Kp||(Kp={}));var Zx;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Zx||(Zx={}));function DN(t){let e=ee.useContext(yu);return e||Ge(!1),e}function bN(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,viewTransition:o}=e===void 0?{}:e,l=Ka(),c=Ga(),f=y0(t,{relative:a});return ee.useCallback(h=>{if(gN(h,r)){h.preventDefault();let d=n!==void 0?n:ba(c)===ba(f);l(t,{replace:d,state:i,preventScrollReset:s,relative:a,viewTransition:o})}},[c,l,f,n,i,r,t,s,a,o])}function ON(t,e){e===void 0&&(e={});let r=ee.useContext(tT);r==null&&Ge(!1);let{basename:n}=DN(Kp.useViewTransitionState),i=y0(t,{relative:e.relative});if(!r.isTransitioning)return!1;let s=ns(r.currentLocation.pathname,n)||r.currentLocation.pathname,a=ns(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Sh(i.pathname,a)!=null||Sh(i.pathname,s)!=null}var e_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},LN=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},nT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,f=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(d=64)),n.push(r[f],r[h],r[d],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(rT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):LN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||h==null)throw new MN;const d=s<<2|o>>4;if(n.push(d),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const v=c<<6&192|h;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class MN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const VN=function(t){const e=rT(t);return nT.encodeByteArray(e,!0)},Ch=function(t){return VN(t).replace(/\./g,"")},iT=function(t){try{return nT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BN=()=>UN().__FIREBASE_DEFAULTS__,jN=()=>{if(typeof process>"u"||typeof e_>"u")return;const t=e_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},zN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&iT(t[1]);return e&&JSON.parse(e)},w0=()=>{try{return BN()||jN()||zN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},sT=t=>{var e,r;return(r=(e=w0())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Ng=t=>{const e=sT(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},aT=()=>{var t;return(t=w0())===null||t===void 0?void 0:t.config},oT=t=>{var e;return(e=w0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Ch(JSON.stringify(r)),Ch(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $N(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(jr())}function WN(){var t;const e=(t=w0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function GN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function KN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function qN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function XN(){const t=jr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function YN(){return!WN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function QN(){try{return typeof indexedDB=="object"}catch{return!1}}function JN(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN="FirebaseError";class Ii extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=ZN,Object.setPrototypeOf(this,Ii.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wu.prototype.create)}}class wu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?eP(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Ii(i,o,n)}}function eP(t,e){return t.replace(tP,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const tP=/\{\$([^}]+)}/g;function rP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Rh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(t_(s)&&t_(a)){if(!Rh(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function t_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function nP(t,e){const r=new iP(t,e);return r.subscribe.bind(r)}class iP{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");sP(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Rd),i.error===void 0&&(i.error=Rd),i.complete===void 0&&(i.complete=Rd);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sP(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Rd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jt(t){return t&&t._delegate?t._delegate:t}class is{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new HN;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lP(e))try{this.getOrInitializeService({instanceIdentifier:ha})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=ha){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ha){return this.instances.has(e)}getOptions(e=ha){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:oP(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ha){return this.component?this.component.multipleInstances?e:ha:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function oP(t){return t===ha?void 0:t}function lP(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new aP(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ye||(Ye={}));const uP={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},fP=Ye.INFO,hP={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},dP=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=hP[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Pg{constructor(e){this.name=e,this._logLevel=fP,this._logHandler=dP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?uP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}const pP=(t,e)=>e.some(r=>t instanceof r);let r_,n_;function mP(){return r_||(r_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function gP(){return n_||(n_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cT=new WeakMap,qp=new WeakMap,uT=new WeakMap,Nd=new WeakMap,Fg=new WeakMap;function vP(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Hs(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&cT.set(r,t)}).catch(()=>{}),Fg.set(e,t),e}function xP(t){if(qp.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});qp.set(t,e)}let Xp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return qp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||uT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Hs(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function _P(t){Xp=t(Xp)}function yP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Pd(this),e,...r);return uT.set(n,e.sort?e.sort():[e]),Hs(n)}:gP().includes(t)?function(...e){return t.apply(Pd(this),e),Hs(cT.get(this))}:function(...e){return Hs(t.apply(Pd(this),e))}}function wP(t){return typeof t=="function"?yP(t):(t instanceof IDBTransaction&&xP(t),pP(t,mP())?new Proxy(t,Xp):t)}function Hs(t){if(t instanceof IDBRequest)return vP(t);if(Nd.has(t))return Nd.get(t);const e=wP(t);return e!==t&&(Nd.set(t,e),Fg.set(e,t)),e}const Pd=t=>Fg.get(t);function EP(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=Hs(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Hs(a.result),l.oldVersion,l.newVersion,Hs(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const TP=["get","getKey","getAll","getAllKeys","count"],kP=["put","add","delete","clear"],Fd=new Map;function i_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Fd.get(e))return Fd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=kP.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||TP.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Fd.set(e,s),s}_P(t=>({...t,get:(e,r,n)=>i_(e,r)||t.get(e,r,n),has:(e,r)=>!!i_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(AP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function AP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Yp="@firebase/app",s_="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss=new Pg("@firebase/app"),IP="@firebase/app-compat",CP="@firebase/analytics-compat",RP="@firebase/analytics",NP="@firebase/app-check-compat",PP="@firebase/app-check",FP="@firebase/auth",DP="@firebase/auth-compat",bP="@firebase/database",OP="@firebase/data-connect",LP="@firebase/database-compat",MP="@firebase/functions",VP="@firebase/functions-compat",UP="@firebase/installations",BP="@firebase/installations-compat",jP="@firebase/messaging",zP="@firebase/messaging-compat",HP="@firebase/performance",$P="@firebase/performance-compat",WP="@firebase/remote-config",GP="@firebase/remote-config-compat",KP="@firebase/storage",qP="@firebase/storage-compat",XP="@firebase/firestore",YP="@firebase/vertexai-preview",QP="@firebase/firestore-compat",JP="firebase",ZP="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp="[DEFAULT]",eF={[Yp]:"fire-core",[IP]:"fire-core-compat",[RP]:"fire-analytics",[CP]:"fire-analytics-compat",[PP]:"fire-app-check",[NP]:"fire-app-check-compat",[FP]:"fire-auth",[DP]:"fire-auth-compat",[bP]:"fire-rtdb",[OP]:"fire-data-connect",[LP]:"fire-rtdb-compat",[MP]:"fire-fn",[VP]:"fire-fn-compat",[UP]:"fire-iid",[BP]:"fire-iid-compat",[jP]:"fire-fcm",[zP]:"fire-fcm-compat",[HP]:"fire-perf",[$P]:"fire-perf-compat",[WP]:"fire-rc",[GP]:"fire-rc-compat",[KP]:"fire-gcs",[qP]:"fire-gcs-compat",[XP]:"fire-fst",[QP]:"fire-fst-compat",[YP]:"fire-vertex","fire-js":"fire-js",[JP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nh=new Map,tF=new Map,Jp=new Map;function a_(t,e){try{t.container.addComponent(e)}catch(r){ss.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Xs(t){const e=t.name;if(Jp.has(e))return ss.debug(`There were multiple attempts to register component ${e}.`),!1;Jp.set(e,t);for(const r of Nh.values())a_(r,t);for(const r of tF.values())a_(r,t);return!0}function Tu(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Hi(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},$s=new wu("app","Firebase",rF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new is("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw $s.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa=ZP;function fT(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Qp,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw $s.create("bad-app-name",{appName:String(i)});if(r||(r=aT()),!r)throw $s.create("no-options");const s=Nh.get(i);if(s){if(Rh(r,s.options)&&Rh(n,s.config))return s;throw $s.create("duplicate-app",{appName:i})}const a=new cP(i);for(const l of Jp.values())a.addComponent(l);const o=new nF(r,n,a);return Nh.set(i,o),o}function E0(t=Qp){const e=Nh.get(t);if(!e&&t===Qp&&aT())return fT();if(!e)throw $s.create("no-app",{appName:t});return e}function On(t,e,r){var n;let i=(n=eF[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ss.warn(o.join(" "));return}Xs(new is(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iF="firebase-heartbeat-database",sF=1,Yc="firebase-heartbeat-store";let Dd=null;function hT(){return Dd||(Dd=EP(iF,sF,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yc)}catch(r){console.warn(r)}}}}).catch(t=>{throw $s.create("idb-open",{originalErrorMessage:t.message})})),Dd}async function aF(t){try{const r=(await hT()).transaction(Yc),n=await r.objectStore(Yc).get(dT(t));return await r.done,n}catch(e){if(e instanceof Ii)ss.warn(e.message);else{const r=$s.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ss.warn(r.message)}}}async function o_(t,e){try{const n=(await hT()).transaction(Yc,"readwrite");await n.objectStore(Yc).put(e,dT(t)),await n.done}catch(r){if(r instanceof Ii)ss.warn(r.message);else{const n=$s.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ss.warn(n.message)}}}function dT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=1024,lF=30*24*60*60*1e3;class cF{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new fF(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=l_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=lF}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ss.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=l_(),{heartbeatsToSend:n,unsentEntries:i}=uF(this._heartbeatsCache.heartbeats),s=Ch(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return ss.warn(r),""}}}function l_(){return new Date().toISOString().substring(0,10)}function uF(t,e=oF){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),c_(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),c_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class fF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return QN()?JN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await aF(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return o_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return o_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function c_(t){return Ch(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hF(t){Xs(new is("platform-logger",e=>new SP(e),"PRIVATE")),Xs(new is("heartbeat",e=>new cF(e),"PRIVATE")),On(Yp,s_,t),On(Yp,s_,"esm2017"),On("fire-js","")}hF("");function Dg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function pT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const dF=pT,mT=new wu("auth","Firebase",pT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph=new Pg("@firebase/auth");function pF(t,...e){Ph.logLevel<=Ye.WARN&&Ph.warn(`Auth (${qa}): ${t}`,...e)}function Wf(t,...e){Ph.logLevel<=Ye.ERROR&&Ph.error(`Auth (${qa}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(t,...e){throw Og(t,...e)}function ni(t,...e){return Og(t,...e)}function bg(t,e,r){const n=Object.assign(Object.assign({},dF()),{[e]:r});return new wu("auth","Firebase",n).create(e,{appName:t.name})}function Sa(t){return bg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mF(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Ei(t,"argument-error"),bg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Og(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return mT.create(t,...e)}function Le(t,e,...r){if(!t)throw Og(e,...r)}function $i(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Wf(e),new Error(e)}function as(t,e){t||$i(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zp(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function gF(){return u_()==="http:"||u_()==="https:"}function u_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(gF()||KN()||"connection"in navigator)?navigator.onLine:!0}function xF(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,r){this.shortDelay=e,this.longDelay=r,as(r>e,"Short delay should be less than long delay!"),this.isMobile=$N()||qN()}get(){return vF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lg(t,e){as(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$i("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$i("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$i("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _F={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF=new ku(3e4,6e4);function Mg(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function vl(t,e,r,n,i={}){return vT(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=Eu(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return GN()||(c.referrerPolicy="no-referrer"),gT.fetch()(xT(t,t.config.apiHost,r,o),c)})}async function vT(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},_F),e);try{const i=new EF(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw vf(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw vf(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw vf(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw vf(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw bg(t,f,c);Ei(t,f)}}catch(i){if(i instanceof Ii)throw i;Ei(t,"network-request-failed",{message:String(i)})}}async function wF(t,e,r,n,i={}){const s=await vl(t,e,r,n,i);return"mfaPendingCredential"in s&&Ei(t,"multi-factor-auth-required",{_serverResponse:s}),s}function xT(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Lg(t.config,i):`${t.config.apiScheme}://${i}`}class EF{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ni(this.auth,"network-request-failed")),yF.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function vf(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=ni(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TF(t,e){return vl(t,"POST","/v1/accounts:delete",e)}async function _T(t,e){return vl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function yT(t,e=!1){const r=Jt(t),n=await r.getIdToken(e),i=Vg(n);Le(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:mc(bd(i.auth_time)),issuedAtTime:mc(bd(i.iat)),expirationTime:mc(bd(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function bd(t){return Number(t)*1e3}function Vg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Wf("JWT malformed, contained fewer than 3 sections"),null;try{const i=iT(r);return i?JSON.parse(i):(Wf("Failed to decode base64 JWT payload"),null)}catch(i){return Wf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function f_(t){const e=Vg(t);return Le(e,"internal-error"),Le(typeof e.exp<"u","internal-error"),Le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qc(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ii&&kF(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function kF({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=mc(this.lastLoginAt),this.creationTime=mc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fh(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Qc(t,_T(r,{idToken:n}));Le(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?wT(s.providerUserInfo):[],o=IF(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),f=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new em(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,h)}async function AF(t){const e=Jt(t);await Fh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function IF(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function wT(t){return t.map(e=>{var{providerId:r}=e,n=Dg(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CF(t,e){const r=await vT(t,{},async()=>{const n=Eu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=xT(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",gT.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function RF(t,e){return vl(t,"POST","/v2/accounts:revokeToken",Mg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Le(e.idToken,"internal-error"),Le(typeof e.idToken<"u","internal-error"),Le(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):f_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Le(e.length!==0,"internal-error");const r=f_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await CF(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Uo;return n&&(Le(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(Le(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Le(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Uo,this.toJSON())}_performRefresh(){return $i("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xs(t,e){Le(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Wi{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=Dg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new SF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new em(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Qc(this,this.stsTokenManager.getToken(this.auth,e));return Le(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return yT(this,e)}reload(){return AF(this)}_assign(e){this!==e&&(Le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Wi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Fh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Hi(this.auth.app))return Promise.reject(Sa(this.auth));const e=await this.getIdToken();return await Qc(this,TF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,f;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,p=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,v=(a=r.photoURL)!==null&&a!==void 0?a:void 0,m=(o=r.tenantId)!==null&&o!==void 0?o:void 0,w=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,T=(c=r.createdAt)!==null&&c!==void 0?c:void 0,E=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:y,emailVerified:N,isAnonymous:j,providerData:U,stsTokenManager:g}=r;Le(y&&g,e,"internal-error");const k=Uo.fromJSON(this.name,g);Le(typeof y=="string",e,"internal-error"),xs(h,e.name),xs(d,e.name),Le(typeof N=="boolean",e,"internal-error"),Le(typeof j=="boolean",e,"internal-error"),xs(p,e.name),xs(v,e.name),xs(m,e.name),xs(w,e.name),xs(T,e.name),xs(E,e.name);const S=new Wi({uid:y,auth:e,email:d,emailVerified:N,displayName:h,isAnonymous:j,photoURL:v,phoneNumber:p,tenantId:m,stsTokenManager:k,createdAt:T,lastLoginAt:E});return U&&Array.isArray(U)&&(S.providerData=U.map(C=>Object.assign({},C))),w&&(S._redirectEventId=w),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new Uo;i.updateFromServerResponse(r);const s=new Wi({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Fh(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Le(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?wT(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Uo;o.updateFromIdToken(n);const l=new Wi({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new em(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h_=new Map;function Gi(t){as(t instanceof Function,"Expected a class definition");let e=h_.get(t);return e?(as(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,h_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}ET.type="NONE";const d_=ET;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gf(t,e,r){return`firebase:${t}:${e}:${r}`}class Bo{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Gf(this.userKey,i.apiKey,s),this.fullPersistenceKey=Gf("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Wi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Bo(Gi(d_),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Gi(d_);const a=Gf(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const f=await c._get(a);if(f){const h=Wi._fromJSON(e,f);c!==s&&(o=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Bo(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Bo(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(AT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(TT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(CT(e))return"Blackberry";if(RT(e))return"Webos";if(kT(e))return"Safari";if((e.includes("chrome/")||ST(e))&&!e.includes("edge/"))return"Chrome";if(IT(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function TT(t=jr()){return/firefox\//i.test(t)}function kT(t=jr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ST(t=jr()){return/crios\//i.test(t)}function AT(t=jr()){return/iemobile/i.test(t)}function IT(t=jr()){return/android/i.test(t)}function CT(t=jr()){return/blackberry/i.test(t)}function RT(t=jr()){return/webos/i.test(t)}function Ug(t=jr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function NF(t=jr()){var e;return Ug(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function PF(){return XN()&&document.documentMode===10}function NT(t=jr()){return Ug(t)||IT(t)||RT(t)||CT(t)||/windows phone/i.test(t)||AT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(t,e=[]){let r;switch(t){case"Browser":r=p_(jr());break;case"Worker":r=`${p_(jr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${qa}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DF(t,e={}){return vl(t,"GET","/v2/passwordPolicy",Mg(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bF=6;class OF{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:bF,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new m_(this),this.idTokenSubscription=new m_(this),this.beforeStateQueue=new FF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Gi(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Bo.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await _T(this,{idToken:e}),n=await Wi._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Hi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Fh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=xF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Hi(this.app))return Promise.reject(Sa(this));const r=e?Jt(e):null;return r&&Le(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Hi(this.app)?Promise.reject(Sa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Hi(this.app)?Promise.reject(Sa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await DF(this),r=new OF(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new wu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await RF(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Gi(e)||this._popupRedirectResolver;Le(r,this,"argument-error"),this.redirectPersistenceManager=await Bo.create(this,[Gi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=PT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&pF(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function T0(t){return Jt(t)}class m_{constructor(e){this.auth=e,this.observer=null,this.addObserver=nP(r=>this.observer=r)}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function MF(t){Bg=t}function VF(t){return Bg.loadJS(t)}function UF(){return Bg.gapiScript}function BF(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jF(t,e){const r=Tu(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(Rh(s,e??{}))return i;Ei(i,"already-initialized")}return r.initialize({options:e})}function zF(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Gi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function HF(t,e,r){const n=T0(t);Le(n._canInitEmulator,n,"emulator-config-failed"),Le(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=FT(e),{host:a,port:o}=$F(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),WF()}function FT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function $F(t){const e=FT(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:g_(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:g_(a)}}}function g_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function WF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return $i("not implemented")}_getIdTokenResponse(e){return $i("not implemented")}_linkToIdToken(e,r){return $i("not implemented")}_getReauthenticationResolver(e){return $i("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jo(t,e){return wF(t,"POST","/v1/accounts:signInWithIdp",Mg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF="http://localhost";class Oa extends DT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Oa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Ei("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=Dg(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Oa(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return jo(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,jo(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,jo(e,r)}buildRequest(){const e={requestUri:GF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Eu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su extends jg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends Su{constructor(){super("facebook.com")}static credential(e){return Oa._fromParams({providerId:Ss.PROVIDER_ID,signInMethod:Ss.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ss.credentialFromTaggedObject(e)}static credentialFromError(e){return Ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ss.credential(e.oauthAccessToken)}catch{return null}}}Ss.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ss.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends Su{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Oa._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return gi.credential(r,n)}catch{return null}}}gi.GOOGLE_SIGN_IN_METHOD="google.com";gi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends Su{constructor(){super("github.com")}static credential(e){return Oa._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return As.credential(e.oauthAccessToken)}catch{return null}}}As.GITHUB_SIGN_IN_METHOD="github.com";As.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends Su{constructor(){super("twitter.com")}static credential(e,r){return Oa._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Is.credential(r,n)}catch{return null}}}Is.TWITTER_SIGN_IN_METHOD="twitter.com";Is.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await Wi._fromIdTokenResponse(e,n,i),a=v_(n);return new rl({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=v_(n);return new rl({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function v_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh extends Ii{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Dh.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Dh(e,r,n,i)}}function bT(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Dh._fromErrorAndOperation(t,s,e,n):s})}async function KF(t,e,r=!1){const n=await Qc(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return rl._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qF(t,e,r=!1){const{auth:n}=t;if(Hi(n.app))return Promise.reject(Sa(n));const i="reauthenticate";try{const s=await Qc(t,bT(n,i,e,t),r);Le(s.idToken,n,"internal-error");const a=Vg(s.idToken);Le(a,n,"internal-error");const{sub:o}=a;return Le(t.uid===o,n,"user-mismatch"),rl._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ei(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XF(t,e,r=!1){if(Hi(t.app))return Promise.reject(Sa(t));const n="signIn",i=await bT(t,n,e),s=await rl._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function YF(t,e,r,n){return Jt(t).onIdTokenChanged(e,r,n)}function QF(t,e,r){return Jt(t).beforeAuthStateChanged(e,r)}function OT(t,e,r,n){return Jt(t).onAuthStateChanged(e,r,n)}function JF(t){return Jt(t).signOut()}const bh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(bh,"1"),this.storage.removeItem(bh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF=1e3,eD=10;class MT extends LT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=NT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);PF()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,eD):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},ZF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}MT.type="LOCAL";const tD=MT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT extends LT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}VT.type="SESSION";const UT=VT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rD(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new k0(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await rD(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}k0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=zg("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _i(){return window}function iD(t){_i().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BT(){return typeof _i().WorkerGlobalScope<"u"&&typeof _i().importScripts=="function"}async function sD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function aD(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function oD(){return BT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT="firebaseLocalStorageDb",lD=1,Oh="firebaseLocalStorage",zT="fbase_key";class Au{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function S0(t,e){return t.transaction([Oh],e?"readwrite":"readonly").objectStore(Oh)}function cD(){const t=indexedDB.deleteDatabase(jT);return new Au(t).toPromise()}function tm(){const t=indexedDB.open(jT,lD);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Oh,{keyPath:zT})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Oh)?e(n):(n.close(),await cD(),e(await tm()))})})}async function x_(t,e,r){const n=S0(t,!0).put({[zT]:e,value:r});return new Au(n).toPromise()}async function uD(t,e){const r=S0(t,!1).get(e),n=await new Au(r).toPromise();return n===void 0?null:n.value}function __(t,e){const r=S0(t,!0).delete(e);return new Au(r).toPromise()}const fD=800,hD=3;class HT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await tm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>hD)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return BT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=k0._getInstance(oD()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await sD(),!this.activeServiceWorker)return;this.sender=new nD(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||aD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await tm();return await x_(e,bh,"1"),await __(e,bh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>x_(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>uD(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>__(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=S0(i,!1).getAll();return new Au(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),fD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}HT.type="LOCAL";const dD=HT;new ku(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(t,e){return e?Gi(e):(Le(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg extends DT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return jo(e,this._buildIdpRequest())}_linkToIdToken(e,r){return jo(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return jo(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function pD(t){return XF(t.auth,new Hg(t),t.bypassAuthState)}function mD(t){const{auth:e,user:r}=t;return Le(r,e,"internal-error"),qF(r,new Hg(t),t.bypassAuthState)}async function gD(t){const{auth:e,user:r}=t;return Le(r,e,"internal-error"),KF(r,new Hg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return pD;case"linkViaPopup":case"linkViaRedirect":return gD;case"reauthViaPopup":case"reauthViaRedirect":return mD;default:Ei(this.auth,"internal-error")}}resolve(e){as(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){as(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=new ku(2e3,1e4);async function GT(t,e,r){if(Hi(t.app))return Promise.reject(ni(t,"operation-not-supported-in-this-environment"));const n=T0(t);mF(t,e,jg);const i=$T(n,r);return new ya(n,"signInViaPopup",e,i).executeNotNull()}class ya extends WT{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,ya.currentPopupAction&&ya.currentPopupAction.cancel(),ya.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Le(e,this.auth,"internal-error"),e}async onExecution(){as(this.filter.length===1,"Popup operations only handle one event");const e=zg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ni(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ni(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ya.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ni(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,vD.get())};e()}}ya.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD="pendingRedirect",Kf=new Map;class _D extends WT{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Kf.get(this.auth._key());if(!e){try{const n=await yD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Kf.set(this.auth._key(),e)}return this.bypassAuthState||Kf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function yD(t,e){const r=TD(e),n=ED(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function wD(t,e){Kf.set(t._key(),e)}function ED(t){return Gi(t._redirectPersistence)}function TD(t){return Gf(xD,t.config.apiKey,t.name)}async function kD(t,e,r=!1){if(Hi(t.app))return Promise.reject(Sa(t));const n=T0(t),i=$T(n,e),a=await new _D(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD=10*60*1e3;class AD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ID(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!KT(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ni(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=SD&&this.cachedEventUids.clear(),this.cachedEventUids.has(y_(e))}saveEventToCache(e){this.cachedEventUids.add(y_(e)),this.lastProcessedEventTime=Date.now()}}function y_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function KT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function ID(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return KT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CD(t,e={}){return vl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ND=/^https?/;async function PD(t){if(t.config.emulator)return;const{authorizedDomains:e}=await CD(t);for(const r of e)try{if(FD(r))return}catch{}Ei(t,"unauthorized-domain")}function FD(t){const e=Zp(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!ND.test(r))return!1;if(RD.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD=new ku(3e4,6e4);function w_(){const t=_i().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function bD(t){return new Promise((e,r)=>{var n,i,s;function a(){w_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{w_(),r(ni(t,"network-request-failed"))},timeout:DD.get()})}if(!((i=(n=_i().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=_i().gapi)===null||s===void 0)&&s.load)a();else{const o=BF("iframefcb");return _i()[o]=()=>{gapi.load?a():r(ni(t,"network-request-failed"))},VF(`${UF()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw qf=null,e})}let qf=null;function OD(t){return qf=qf||bD(t),qf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LD=new ku(5e3,15e3),MD="__/auth/iframe",VD="emulator/auth/iframe",UD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},BD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function jD(t){const e=t.config;Le(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Lg(e,VD):`https://${t.config.authDomain}/${MD}`,n={apiKey:e.apiKey,appName:t.name,v:qa},i=BD.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Eu(n).slice(1)}`}async function zD(t){const e=await OD(t),r=_i().gapi;return Le(r,t,"internal-error"),e.open({where:document.body,url:jD(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:UD,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=ni(t,"network-request-failed"),o=_i().setTimeout(()=>{s(a)},LD.get());function l(){_i().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$D=500,WD=600,GD="_blank",KD="http://localhost";class E_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function qD(t,e,r,n=$D,i=WD){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},HD),{width:n.toString(),height:i.toString(),top:s,left:a}),c=jr().toLowerCase();r&&(o=ST(c)?GD:r),TT(c)&&(e=e||KD,l.scrollbars="yes");const f=Object.entries(l).reduce((d,[p,v])=>`${d}${p}=${v},`,"");if(NF(c)&&o!=="_self")return XD(e||"",o),new E_(null);const h=window.open(e||"",o,f);Le(h,t,"popup-blocked");try{h.focus()}catch{}return new E_(h)}function XD(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD="__/auth/handler",QD="emulator/auth/handler",JD=encodeURIComponent("fac");async function T_(t,e,r,n,i,s){Le(t.config.authDomain,t,"auth-domain-config-required"),Le(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:qa,eventId:i};if(e instanceof jg){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",rP(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries({}))a[f]=h}if(e instanceof Su){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),c=l?`#${JD}=${encodeURIComponent(l)}`:"";return`${ZD(t)}?${Eu(o).slice(1)}${c}`}function ZD({config:t}){return t.emulator?Lg(t,QD):`https://${t.authDomain}/${YD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od="webStorageSupport";class e3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=UT,this._completeRedirectFn=kD,this._overrideRedirectResult=wD}async _openPopup(e,r,n,i){var s;as((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await T_(e,r,n,Zp(),i);return qD(e,a,zg())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await T_(e,r,n,Zp(),i);return iD(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(as(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await zD(e),n=new AD(e);return r.register("authEvent",i=>(Le(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Od,{type:Od},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Od];a!==void 0&&r(!!a),Ei(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=PD(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return NT()||kT()||Ug()}}const t3=e3;var k_="@firebase/auth",S_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n3(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function i3(t){Xs(new is("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Le(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:PT(t)},c=new LF(n,i,s,l);return zF(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Xs(new is("auth-internal",e=>{const r=T0(e.getProvider("auth").getImmediate());return(n=>new r3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),On(k_,S_,n3(t)),On(k_,S_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s3=5*60,a3=oT("authIdTokenMaxAge")||s3;let A_=null;const o3=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>a3)return;const i=r==null?void 0:r.token;A_!==i&&(A_=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function l3(t=E0()){const e=Tu(t,"auth");if(e.isInitialized())return e.getImmediate();const r=jF(t,{popupRedirectResolver:t3,persistence:[dD,tD,UT]}),n=oT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=o3(s.toString());QF(r,a,()=>a(r.currentUser)),YF(r,o=>a(o))}}const i=sT("auth");return i&&HF(r,`http://${i}`),r}function c3(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}MF({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=ni("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",c3().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});i3("Browser");var I_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Aa,qT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(g,k){function S(){}S.prototype=k.prototype,g.D=k.prototype,g.prototype=new S,g.prototype.constructor=g,g.C=function(C,P,F){for(var O=Array(arguments.length-2),de=2;de<arguments.length;de++)O[de-2]=arguments[de];return k.prototype[P].apply(C,O)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(g,k,S){S||(S=0);var C=Array(16);if(typeof k=="string")for(var P=0;16>P;++P)C[P]=k.charCodeAt(S++)|k.charCodeAt(S++)<<8|k.charCodeAt(S++)<<16|k.charCodeAt(S++)<<24;else for(P=0;16>P;++P)C[P]=k[S++]|k[S++]<<8|k[S++]<<16|k[S++]<<24;k=g.g[0],S=g.g[1],P=g.g[2];var F=g.g[3],O=k+(F^S&(P^F))+C[0]+3614090360&4294967295;k=S+(O<<7&4294967295|O>>>25),O=F+(P^k&(S^P))+C[1]+3905402710&4294967295,F=k+(O<<12&4294967295|O>>>20),O=P+(S^F&(k^S))+C[2]+606105819&4294967295,P=F+(O<<17&4294967295|O>>>15),O=S+(k^P&(F^k))+C[3]+3250441966&4294967295,S=P+(O<<22&4294967295|O>>>10),O=k+(F^S&(P^F))+C[4]+4118548399&4294967295,k=S+(O<<7&4294967295|O>>>25),O=F+(P^k&(S^P))+C[5]+1200080426&4294967295,F=k+(O<<12&4294967295|O>>>20),O=P+(S^F&(k^S))+C[6]+2821735955&4294967295,P=F+(O<<17&4294967295|O>>>15),O=S+(k^P&(F^k))+C[7]+4249261313&4294967295,S=P+(O<<22&4294967295|O>>>10),O=k+(F^S&(P^F))+C[8]+1770035416&4294967295,k=S+(O<<7&4294967295|O>>>25),O=F+(P^k&(S^P))+C[9]+2336552879&4294967295,F=k+(O<<12&4294967295|O>>>20),O=P+(S^F&(k^S))+C[10]+4294925233&4294967295,P=F+(O<<17&4294967295|O>>>15),O=S+(k^P&(F^k))+C[11]+2304563134&4294967295,S=P+(O<<22&4294967295|O>>>10),O=k+(F^S&(P^F))+C[12]+1804603682&4294967295,k=S+(O<<7&4294967295|O>>>25),O=F+(P^k&(S^P))+C[13]+4254626195&4294967295,F=k+(O<<12&4294967295|O>>>20),O=P+(S^F&(k^S))+C[14]+2792965006&4294967295,P=F+(O<<17&4294967295|O>>>15),O=S+(k^P&(F^k))+C[15]+1236535329&4294967295,S=P+(O<<22&4294967295|O>>>10),O=k+(P^F&(S^P))+C[1]+4129170786&4294967295,k=S+(O<<5&4294967295|O>>>27),O=F+(S^P&(k^S))+C[6]+3225465664&4294967295,F=k+(O<<9&4294967295|O>>>23),O=P+(k^S&(F^k))+C[11]+643717713&4294967295,P=F+(O<<14&4294967295|O>>>18),O=S+(F^k&(P^F))+C[0]+3921069994&4294967295,S=P+(O<<20&4294967295|O>>>12),O=k+(P^F&(S^P))+C[5]+3593408605&4294967295,k=S+(O<<5&4294967295|O>>>27),O=F+(S^P&(k^S))+C[10]+38016083&4294967295,F=k+(O<<9&4294967295|O>>>23),O=P+(k^S&(F^k))+C[15]+3634488961&4294967295,P=F+(O<<14&4294967295|O>>>18),O=S+(F^k&(P^F))+C[4]+3889429448&4294967295,S=P+(O<<20&4294967295|O>>>12),O=k+(P^F&(S^P))+C[9]+568446438&4294967295,k=S+(O<<5&4294967295|O>>>27),O=F+(S^P&(k^S))+C[14]+3275163606&4294967295,F=k+(O<<9&4294967295|O>>>23),O=P+(k^S&(F^k))+C[3]+4107603335&4294967295,P=F+(O<<14&4294967295|O>>>18),O=S+(F^k&(P^F))+C[8]+1163531501&4294967295,S=P+(O<<20&4294967295|O>>>12),O=k+(P^F&(S^P))+C[13]+2850285829&4294967295,k=S+(O<<5&4294967295|O>>>27),O=F+(S^P&(k^S))+C[2]+4243563512&4294967295,F=k+(O<<9&4294967295|O>>>23),O=P+(k^S&(F^k))+C[7]+1735328473&4294967295,P=F+(O<<14&4294967295|O>>>18),O=S+(F^k&(P^F))+C[12]+2368359562&4294967295,S=P+(O<<20&4294967295|O>>>12),O=k+(S^P^F)+C[5]+4294588738&4294967295,k=S+(O<<4&4294967295|O>>>28),O=F+(k^S^P)+C[8]+2272392833&4294967295,F=k+(O<<11&4294967295|O>>>21),O=P+(F^k^S)+C[11]+1839030562&4294967295,P=F+(O<<16&4294967295|O>>>16),O=S+(P^F^k)+C[14]+4259657740&4294967295,S=P+(O<<23&4294967295|O>>>9),O=k+(S^P^F)+C[1]+2763975236&4294967295,k=S+(O<<4&4294967295|O>>>28),O=F+(k^S^P)+C[4]+1272893353&4294967295,F=k+(O<<11&4294967295|O>>>21),O=P+(F^k^S)+C[7]+4139469664&4294967295,P=F+(O<<16&4294967295|O>>>16),O=S+(P^F^k)+C[10]+3200236656&4294967295,S=P+(O<<23&4294967295|O>>>9),O=k+(S^P^F)+C[13]+681279174&4294967295,k=S+(O<<4&4294967295|O>>>28),O=F+(k^S^P)+C[0]+3936430074&4294967295,F=k+(O<<11&4294967295|O>>>21),O=P+(F^k^S)+C[3]+3572445317&4294967295,P=F+(O<<16&4294967295|O>>>16),O=S+(P^F^k)+C[6]+76029189&4294967295,S=P+(O<<23&4294967295|O>>>9),O=k+(S^P^F)+C[9]+3654602809&4294967295,k=S+(O<<4&4294967295|O>>>28),O=F+(k^S^P)+C[12]+3873151461&4294967295,F=k+(O<<11&4294967295|O>>>21),O=P+(F^k^S)+C[15]+530742520&4294967295,P=F+(O<<16&4294967295|O>>>16),O=S+(P^F^k)+C[2]+3299628645&4294967295,S=P+(O<<23&4294967295|O>>>9),O=k+(P^(S|~F))+C[0]+4096336452&4294967295,k=S+(O<<6&4294967295|O>>>26),O=F+(S^(k|~P))+C[7]+1126891415&4294967295,F=k+(O<<10&4294967295|O>>>22),O=P+(k^(F|~S))+C[14]+2878612391&4294967295,P=F+(O<<15&4294967295|O>>>17),O=S+(F^(P|~k))+C[5]+4237533241&4294967295,S=P+(O<<21&4294967295|O>>>11),O=k+(P^(S|~F))+C[12]+1700485571&4294967295,k=S+(O<<6&4294967295|O>>>26),O=F+(S^(k|~P))+C[3]+2399980690&4294967295,F=k+(O<<10&4294967295|O>>>22),O=P+(k^(F|~S))+C[10]+4293915773&4294967295,P=F+(O<<15&4294967295|O>>>17),O=S+(F^(P|~k))+C[1]+2240044497&4294967295,S=P+(O<<21&4294967295|O>>>11),O=k+(P^(S|~F))+C[8]+1873313359&4294967295,k=S+(O<<6&4294967295|O>>>26),O=F+(S^(k|~P))+C[15]+4264355552&4294967295,F=k+(O<<10&4294967295|O>>>22),O=P+(k^(F|~S))+C[6]+2734768916&4294967295,P=F+(O<<15&4294967295|O>>>17),O=S+(F^(P|~k))+C[13]+1309151649&4294967295,S=P+(O<<21&4294967295|O>>>11),O=k+(P^(S|~F))+C[4]+4149444226&4294967295,k=S+(O<<6&4294967295|O>>>26),O=F+(S^(k|~P))+C[11]+3174756917&4294967295,F=k+(O<<10&4294967295|O>>>22),O=P+(k^(F|~S))+C[2]+718787259&4294967295,P=F+(O<<15&4294967295|O>>>17),O=S+(F^(P|~k))+C[9]+3951481745&4294967295,g.g[0]=g.g[0]+k&4294967295,g.g[1]=g.g[1]+(P+(O<<21&4294967295|O>>>11))&4294967295,g.g[2]=g.g[2]+P&4294967295,g.g[3]=g.g[3]+F&4294967295}n.prototype.u=function(g,k){k===void 0&&(k=g.length);for(var S=k-this.blockSize,C=this.B,P=this.h,F=0;F<k;){if(P==0)for(;F<=S;)i(this,g,F),F+=this.blockSize;if(typeof g=="string"){for(;F<k;)if(C[P++]=g.charCodeAt(F++),P==this.blockSize){i(this,C),P=0;break}}else for(;F<k;)if(C[P++]=g[F++],P==this.blockSize){i(this,C),P=0;break}}this.h=P,this.o+=k},n.prototype.v=function(){var g=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);g[0]=128;for(var k=1;k<g.length-8;++k)g[k]=0;var S=8*this.o;for(k=g.length-8;k<g.length;++k)g[k]=S&255,S/=256;for(this.u(g),g=Array(16),k=S=0;4>k;++k)for(var C=0;32>C;C+=8)g[S++]=this.g[k]>>>C&255;return g};function s(g,k){var S=o;return Object.prototype.hasOwnProperty.call(S,g)?S[g]:S[g]=k(g)}function a(g,k){this.h=k;for(var S=[],C=!0,P=g.length-1;0<=P;P--){var F=g[P]|0;C&&F==k||(S[P]=F,C=!1)}this.g=S}var o={};function l(g){return-128<=g&&128>g?s(g,function(k){return new a([k|0],0>k?-1:0)}):new a([g|0],0>g?-1:0)}function c(g){if(isNaN(g)||!isFinite(g))return h;if(0>g)return w(c(-g));for(var k=[],S=1,C=0;g>=S;C++)k[C]=g/S|0,S*=4294967296;return new a(k,0)}function f(g,k){if(g.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(g.charAt(0)=="-")return w(f(g.substring(1),k));if(0<=g.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(k,8)),C=h,P=0;P<g.length;P+=8){var F=Math.min(8,g.length-P),O=parseInt(g.substring(P,P+F),k);8>F?(F=c(Math.pow(k,F)),C=C.j(F).add(c(O))):(C=C.j(S),C=C.add(c(O)))}return C}var h=l(0),d=l(1),p=l(16777216);t=a.prototype,t.m=function(){if(m(this))return-w(this).m();for(var g=0,k=1,S=0;S<this.g.length;S++){var C=this.i(S);g+=(0<=C?C:4294967296+C)*k,k*=4294967296}return g},t.toString=function(g){if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(v(this))return"0";if(m(this))return"-"+w(this).toString(g);for(var k=c(Math.pow(g,6)),S=this,C="";;){var P=N(S,k).g;S=T(S,P.j(k));var F=((0<S.g.length?S.g[0]:S.h)>>>0).toString(g);if(S=P,v(S))return F+C;for(;6>F.length;)F="0"+F;C=F+C}},t.i=function(g){return 0>g?0:g<this.g.length?this.g[g]:this.h};function v(g){if(g.h!=0)return!1;for(var k=0;k<g.g.length;k++)if(g.g[k]!=0)return!1;return!0}function m(g){return g.h==-1}t.l=function(g){return g=T(this,g),m(g)?-1:v(g)?0:1};function w(g){for(var k=g.g.length,S=[],C=0;C<k;C++)S[C]=~g.g[C];return new a(S,~g.h).add(d)}t.abs=function(){return m(this)?w(this):this},t.add=function(g){for(var k=Math.max(this.g.length,g.g.length),S=[],C=0,P=0;P<=k;P++){var F=C+(this.i(P)&65535)+(g.i(P)&65535),O=(F>>>16)+(this.i(P)>>>16)+(g.i(P)>>>16);C=O>>>16,F&=65535,O&=65535,S[P]=O<<16|F}return new a(S,S[S.length-1]&-2147483648?-1:0)};function T(g,k){return g.add(w(k))}t.j=function(g){if(v(this)||v(g))return h;if(m(this))return m(g)?w(this).j(w(g)):w(w(this).j(g));if(m(g))return w(this.j(w(g)));if(0>this.l(p)&&0>g.l(p))return c(this.m()*g.m());for(var k=this.g.length+g.g.length,S=[],C=0;C<2*k;C++)S[C]=0;for(C=0;C<this.g.length;C++)for(var P=0;P<g.g.length;P++){var F=this.i(C)>>>16,O=this.i(C)&65535,de=g.i(P)>>>16,ve=g.i(P)&65535;S[2*C+2*P]+=O*ve,E(S,2*C+2*P),S[2*C+2*P+1]+=F*ve,E(S,2*C+2*P+1),S[2*C+2*P+1]+=O*de,E(S,2*C+2*P+1),S[2*C+2*P+2]+=F*de,E(S,2*C+2*P+2)}for(C=0;C<k;C++)S[C]=S[2*C+1]<<16|S[2*C];for(C=k;C<2*k;C++)S[C]=0;return new a(S,0)};function E(g,k){for(;(g[k]&65535)!=g[k];)g[k+1]+=g[k]>>>16,g[k]&=65535,k++}function y(g,k){this.g=g,this.h=k}function N(g,k){if(v(k))throw Error("division by zero");if(v(g))return new y(h,h);if(m(g))return k=N(w(g),k),new y(w(k.g),w(k.h));if(m(k))return k=N(g,w(k)),new y(w(k.g),k.h);if(30<g.g.length){if(m(g)||m(k))throw Error("slowDivide_ only works with positive integers.");for(var S=d,C=k;0>=C.l(g);)S=j(S),C=j(C);var P=U(S,1),F=U(C,1);for(C=U(C,2),S=U(S,2);!v(C);){var O=F.add(C);0>=O.l(g)&&(P=P.add(S),F=O),C=U(C,1),S=U(S,1)}return k=T(g,P.j(k)),new y(P,k)}for(P=h;0<=g.l(k);){for(S=Math.max(1,Math.floor(g.m()/k.m())),C=Math.ceil(Math.log(S)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),F=c(S),O=F.j(k);m(O)||0<O.l(g);)S-=C,F=c(S),O=F.j(k);v(F)&&(F=d),P=P.add(F),g=T(g,O)}return new y(P,g)}t.A=function(g){return N(this,g).h},t.and=function(g){for(var k=Math.max(this.g.length,g.g.length),S=[],C=0;C<k;C++)S[C]=this.i(C)&g.i(C);return new a(S,this.h&g.h)},t.or=function(g){for(var k=Math.max(this.g.length,g.g.length),S=[],C=0;C<k;C++)S[C]=this.i(C)|g.i(C);return new a(S,this.h|g.h)},t.xor=function(g){for(var k=Math.max(this.g.length,g.g.length),S=[],C=0;C<k;C++)S[C]=this.i(C)^g.i(C);return new a(S,this.h^g.h)};function j(g){for(var k=g.g.length+1,S=[],C=0;C<k;C++)S[C]=g.i(C)<<1|g.i(C-1)>>>31;return new a(S,g.h)}function U(g,k){var S=k>>5;k%=32;for(var C=g.g.length-S,P=[],F=0;F<C;F++)P[F]=0<k?g.i(F+S)>>>k|g.i(F+S+1)<<32-k:g.i(F+S);return new a(P,g.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,qT=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=f,Aa=a}).apply(typeof I_<"u"?I_:typeof self<"u"?self:typeof window<"u"?window:{});var xf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XT,Ql,YT,Xf,rm,QT,JT,ZT;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,x,A){return u==Array.prototype||u==Object.prototype||(u[x]=A.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof xf=="object"&&xf];for(var x=0;x<u.length;++x){var A=u[x];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function i(u,x){if(x)e:{var A=n;u=u.split(".");for(var V=0;V<u.length-1;V++){var re=u[V];if(!(re in A))break e;A=A[re]}u=u[u.length-1],V=A[u],x=x(V),x!=V&&x!=null&&e(A,u,{configurable:!0,writable:!0,value:x})}}function s(u,x){u instanceof String&&(u+="");var A=0,V=!1,re={next:function(){if(!V&&A<u.length){var se=A++;return{value:x(se,u[se]),done:!1}}return V=!0,{done:!0,value:void 0}}};return re[Symbol.iterator]=function(){return re},re}i("Array.prototype.values",function(u){return u||function(){return s(this,function(x,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(u){var x=typeof u;return x=x!="object"?x:u?Array.isArray(u)?"array":x:"null",x=="array"||x=="object"&&typeof u.length=="number"}function c(u){var x=typeof u;return x=="object"&&u!=null||x=="function"}function f(u,x,A){return u.call.apply(u.bind,arguments)}function h(u,x,A){if(!u)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var re=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(re,V),u.apply(x,re)}}return function(){return u.apply(x,arguments)}}function d(u,x,A){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:h,d.apply(null,arguments)}function p(u,x){var A=Array.prototype.slice.call(arguments,1);return function(){var V=A.slice();return V.push.apply(V,arguments),u.apply(this,V)}}function v(u,x){function A(){}A.prototype=x.prototype,u.aa=x.prototype,u.prototype=new A,u.prototype.constructor=u,u.Qb=function(V,re,se){for(var Te=Array(arguments.length-2),_t=2;_t<arguments.length;_t++)Te[_t-2]=arguments[_t];return x.prototype[re].apply(V,Te)}}function m(u){const x=u.length;if(0<x){const A=Array(x);for(let V=0;V<x;V++)A[V]=u[V];return A}return[]}function w(u,x){for(let A=1;A<arguments.length;A++){const V=arguments[A];if(l(V)){const re=u.length||0,se=V.length||0;u.length=re+se;for(let Te=0;Te<se;Te++)u[re+Te]=V[Te]}else u.push(V)}}class T{constructor(x,A){this.i=x,this.j=A,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function E(u){return/^[\s\xa0]*$/.test(u)}function y(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function N(u){return N[" "](u),u}N[" "]=function(){};var j=y().indexOf("Gecko")!=-1&&!(y().toLowerCase().indexOf("webkit")!=-1&&y().indexOf("Edge")==-1)&&!(y().indexOf("Trident")!=-1||y().indexOf("MSIE")!=-1)&&y().indexOf("Edge")==-1;function U(u,x,A){for(const V in u)x.call(A,u[V],V,u)}function g(u,x){for(const A in u)x.call(void 0,u[A],A,u)}function k(u){const x={};for(const A in u)x[A]=u[A];return x}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,x){let A,V;for(let re=1;re<arguments.length;re++){V=arguments[re];for(A in V)u[A]=V[A];for(let se=0;se<S.length;se++)A=S[se],Object.prototype.hasOwnProperty.call(V,A)&&(u[A]=V[A])}}function P(u){var x=1;u=u.split(":");const A=[];for(;0<x&&u.length;)A.push(u.shift()),x--;return u.length&&A.push(u.join(":")),A}function F(u){o.setTimeout(()=>{throw u},0)}function O(){var u=G;let x=null;return u.g&&(x=u.g,u.g=u.g.next,u.g||(u.h=null),x.next=null),x}class de{constructor(){this.h=this.g=null}add(x,A){const V=ve.get();V.set(x,A),this.h?this.h.next=V:this.g=V,this.h=V}}var ve=new T(()=>new Ie,u=>u.reset());class Ie{constructor(){this.next=this.g=this.h=null}set(x,A){this.h=x,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,ie=!1,G=new de,ue=()=>{const u=o.Promise.resolve(void 0);oe=()=>{u.then(Ee)}};var Ee=()=>{for(var u;u=O();){try{u.h.call(u.g)}catch(A){F(A)}var x=ve;x.j(u),100>x.h&&(x.h++,u.next=x.g,x.g=u)}ie=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(u,x){this.type=u,this.g=this.target=x,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,x=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const A=()=>{};o.addEventListener("test",A,x),o.removeEventListener("test",A,x)}catch{}return u}();function W(u,x){if(X.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var A=this.type=u.type,V=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=x,x=u.relatedTarget){if(j){e:{try{N(x.nodeName);var re=!0;break e}catch{}re=!1}re||(x=null)}}else A=="mouseover"?x=u.fromElement:A=="mouseout"&&(x=u.toElement);this.relatedTarget=x,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:ae[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&W.aa.h.call(this)}}v(W,X);var ae={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var xe="closure_listenable_"+(1e6*Math.random()|0),Ae=0;function he(u,x,A,V,re){this.listener=u,this.proxy=null,this.src=x,this.type=A,this.capture=!!V,this.ha=re,this.key=++Ae,this.da=this.fa=!1}function ge(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function He(u){this.src=u,this.g={},this.h=0}He.prototype.add=function(u,x,A,V,re){var se=u.toString();u=this.g[se],u||(u=this.g[se]=[],this.h++);var Te=at(u,x,V,re);return-1<Te?(x=u[Te],A||(x.fa=!1)):(x=new he(x,this.src,se,!!V,re),x.fa=A,u.push(x)),x};function z(u,x){var A=x.type;if(A in u.g){var V=u.g[A],re=Array.prototype.indexOf.call(V,x,void 0),se;(se=0<=re)&&Array.prototype.splice.call(V,re,1),se&&(ge(x),u.g[A].length==0&&(delete u.g[A],u.h--))}}function at(u,x,A,V){for(var re=0;re<u.length;++re){var se=u[re];if(!se.da&&se.listener==x&&se.capture==!!A&&se.ha==V)return re}return-1}var We="closure_lm_"+(1e6*Math.random()|0),rt={};function be(u,x,A,V,re){if(Array.isArray(x)){for(var se=0;se<x.length;se++)be(u,x[se],A,V,re);return null}return A=or(A),u&&u[xe]?u.K(x,A,c(V)?!!V.capture:!1,re):Se(u,x,A,!1,V,re)}function Se(u,x,A,V,re,se){if(!x)throw Error("Invalid event type");var Te=c(re)?!!re.capture:!!re,_t=tn(u);if(_t||(u[We]=_t=new He(u)),A=_t.add(x,A,V,Te,se),A.proxy)return A;if(V=Et(),A.proxy=V,V.src=u,V.listener=A,u.addEventListener)q||(re=Te),re===void 0&&(re=!1),u.addEventListener(x.toString(),V,re);else if(u.attachEvent)u.attachEvent(en(x.toString()),V);else if(u.addListener&&u.removeListener)u.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Et(){function u(A){return x.call(u.src,u.listener,A)}const x=Pi;return u}function ar(u,x,A,V,re){if(Array.isArray(x))for(var se=0;se<x.length;se++)ar(u,x[se],A,V,re);else V=c(V)?!!V.capture:!!V,A=or(A),u&&u[xe]?(u=u.i,x=String(x).toString(),x in u.g&&(se=u.g[x],A=at(se,A,V,re),-1<A&&(ge(se[A]),Array.prototype.splice.call(se,A,1),se.length==0&&(delete u.g[x],u.h--)))):u&&(u=tn(u))&&(x=u.g[x.toString()],u=-1,x&&(u=at(x,A,V,re)),(A=-1<u?x[u]:null)&&Ar(A))}function Ar(u){if(typeof u!="number"&&u&&!u.da){var x=u.src;if(x&&x[xe])z(x.i,u);else{var A=u.type,V=u.proxy;x.removeEventListener?x.removeEventListener(A,V,u.capture):x.detachEvent?x.detachEvent(en(A),V):x.addListener&&x.removeListener&&x.removeListener(V),(A=tn(x))?(z(A,u),A.h==0&&(A.src=null,x[We]=null)):ge(u)}}}function en(u){return u in rt?rt[u]:rt[u]="on"+u}function Pi(u,x){if(u.da)u=!0;else{x=new W(x,this);var A=u.listener,V=u.ha||u.src;u.fa&&Ar(u),u=A.call(V,x)}return u}function tn(u){return u=u[We],u instanceof He?u:null}var Tt="__closure_events_fn_"+(1e9*Math.random()>>>0);function or(u){return typeof u=="function"?u:(u[Tt]||(u[Tt]=function(x){return u.handleEvent(x)}),u[Tt])}function gt(){B.call(this),this.i=new He(this),this.M=this,this.F=null}v(gt,B),gt.prototype[xe]=!0,gt.prototype.removeEventListener=function(u,x,A,V){ar(this,u,x,A,V)};function kt(u,x){var A,V=u.F;if(V)for(A=[];V;V=V.F)A.push(V);if(u=u.M,V=x.type||x,typeof x=="string")x=new X(x,u);else if(x instanceof X)x.target=x.target||u;else{var re=x;x=new X(V,u),C(x,re)}if(re=!0,A)for(var se=A.length-1;0<=se;se--){var Te=x.g=A[se];re=ft(Te,V,!0,x)&&re}if(Te=x.g=u,re=ft(Te,V,!0,x)&&re,re=ft(Te,V,!1,x)&&re,A)for(se=0;se<A.length;se++)Te=x.g=A[se],re=ft(Te,V,!1,x)&&re}gt.prototype.N=function(){if(gt.aa.N.call(this),this.i){var u=this.i,x;for(x in u.g){for(var A=u.g[x],V=0;V<A.length;V++)ge(A[V]);delete u.g[x],u.h--}}this.F=null},gt.prototype.K=function(u,x,A,V){return this.i.add(String(u),x,!1,A,V)},gt.prototype.L=function(u,x,A,V){return this.i.add(String(u),x,!0,A,V)};function ft(u,x,A,V){if(x=u.i.g[String(x)],!x)return!0;x=x.concat();for(var re=!0,se=0;se<x.length;++se){var Te=x[se];if(Te&&!Te.da&&Te.capture==A){var _t=Te.listener,mr=Te.ha||Te.src;Te.fa&&z(u.i,Te),re=_t.call(mr,V)!==!1&&re}}return re&&!V.defaultPrevented}function Ft(u,x,A){if(typeof u=="function")A&&(u=d(u,A));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:o.setTimeout(u,x||0)}function Ve(u){u.g=Ft(()=>{u.g=null,u.i&&(u.i=!1,Ve(u))},u.l);const x=u.h;u.h=null,u.m.apply(null,x)}class vt extends B{constructor(x,A){super(),this.m=x,this.l=A,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:Ve(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $t(u){B.call(this),this.h=u,this.g={}}v($t,B);var ct=[];function hn(u){U(u.g,function(x,A){this.g.hasOwnProperty(A)&&Ar(x)},u),u.g={}}$t.prototype.N=function(){$t.aa.N.call(this),hn(this)},$t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fi=o.JSON.stringify,so=o.JSON.parse,Sl=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function Di(){}Di.prototype.h=null;function li(u){return u.h||(u.h=u.i())}function ps(){}var jn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function bi(){X.call(this,"d")}v(bi,X);function ci(){X.call(this,"c")}v(ci,X);var Sn={},ao=null;function Oi(){return ao=ao||new gt}Sn.La="serverreachability";function Li(u){X.call(this,Sn.La,u)}v(Li,X);function An(u){const x=Oi();kt(x,new Li(x))}Sn.STAT_EVENT="statevent";function oo(u,x){X.call(this,Sn.STAT_EVENT,u),this.stat=x}v(oo,X);function Zt(u){const x=Oi();kt(x,new oo(x,u))}Sn.Ma="timingevent";function H(u,x){X.call(this,Sn.Ma,u),this.size=x}v(H,X);function Q(u,x){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},x)}function ne(){this.g=!0}ne.prototype.xa=function(){this.g=!1};function fe(u,x,A,V,re,se){u.info(function(){if(u.g)if(se)for(var Te="",_t=se.split("&"),mr=0;mr<_t.length;mr++){var ot=_t[mr].split("=");if(1<ot.length){var Ir=ot[0];ot=ot[1];var Cr=Ir.split("_");Te=2<=Cr.length&&Cr[1]=="type"?Te+(Ir+"="+ot+"&"):Te+(Ir+"=redacted&")}}else Te=null;else Te=se;return"XMLHTTP REQ ("+V+") [attempt "+re+"]: "+x+`
`+A+`
`+Te})}function ke(u,x,A,V,re,se,Te){u.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+re+"]: "+x+`
`+A+`
`+se+" "+Te})}function I(u,x,A,V){u.info(function(){return"XMLHTTP TEXT ("+x+"): "+R(u,A)+(V?" "+V:"")})}function M(u,x){u.info(function(){return"TIMEOUT: "+x})}ne.prototype.info=function(){};function R(u,x){if(!u.g)return x;if(!x)return null;try{var A=JSON.parse(x);if(A){for(u=0;u<A.length;u++)if(Array.isArray(A[u])){var V=A[u];if(!(2>V.length)){var re=V[1];if(Array.isArray(re)&&!(1>re.length)){var se=re[0];if(se!="noop"&&se!="stop"&&se!="close")for(var Te=1;Te<re.length;Te++)re[Te]=""}}}}return Fi(A)}catch{return x}}var D={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},b={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},L;function K(){}v(K,Di),K.prototype.g=function(){return new XMLHttpRequest},K.prototype.i=function(){return{}},L=new K;function te(u,x,A,V){this.j=u,this.i=x,this.l=A,this.R=V||1,this.U=new $t(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Z}function Z(){this.i=null,this.g="",this.h=!1}var J={},Y={};function le(u,x,A){u.L=1,u.v=Hu(Mi(x)),u.m=A,u.P=!0,ye(u,null)}function ye(u,x){u.F=Date.now(),we(u),u.A=Mi(u.v);var A=u.A,V=u.R;Array.isArray(V)||(V=[String(V)]),n1(A.i,"t",V),u.C=0,A=u.j.J,u.h=new Z,u.g=w1(u.j,A?x:null,!u.m),0<u.O&&(u.M=new vt(d(u.Y,u,u.g),u.O)),x=u.U,A=u.g,V=u.ca;var re="readystatechange";Array.isArray(re)||(re&&(ct[0]=re.toString()),re=ct);for(var se=0;se<re.length;se++){var Te=be(A,re[se],V||x.handleEvent,!1,x.h||x);if(!Te)break;x.g[Te.key]=Te}x=u.H?k(u.H):{},u.m?(u.u||(u.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,x)):(u.u="GET",u.g.ea(u.A,u.u,null,x)),An(),fe(u.i,u.u,u.A,u.l,u.R,u.m)}te.prototype.ca=function(u){u=u.target;const x=this.M;x&&Vi(u)==3?x.j():this.Y(u)},te.prototype.Y=function(u){try{if(u==this.g)e:{const Cr=Vi(this.g);var x=this.g.Ba();const uo=this.g.Z();if(!(3>Cr)&&(Cr!=3||this.g&&(this.h.h||this.g.oa()||u1(this.g)))){this.J||Cr!=4||x==7||(x==8||0>=uo?An(3):An(2)),nt(this);var A=this.g.Z();this.X=A;t:if(Ce(this)){var V=u1(this.g);u="";var re=V.length,se=Vi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ht(this),Ke(this);var Te="";break t}this.h.i=new o.TextDecoder}for(x=0;x<re;x++)this.h.h=!0,u+=this.h.i.decode(V[x],{stream:!(se&&x==re-1)});V.length=0,this.h.g+=u,this.C=0,Te=this.h.g}else Te=this.g.oa();if(this.o=A==200,ke(this.i,this.u,this.A,this.l,this.R,Cr,A),this.o){if(this.T&&!this.K){t:{if(this.g){var _t,mr=this.g;if((_t=mr.g?mr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(_t)){var ot=_t;break t}}ot=null}if(A=ot)I(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,rn(this,A);else{this.o=!1,this.s=3,Zt(12),ht(this),Ke(this);break e}}if(this.P){A=!0;let zn;for(;!this.J&&this.C<Te.length;)if(zn=pe(this,Te),zn==Y){Cr==4&&(this.s=4,Zt(14),A=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(zn==J){this.s=4,Zt(15),I(this.i,this.l,Te,"[Invalid Chunk]"),A=!1;break}else I(this.i,this.l,zn,null),rn(this,zn);if(Ce(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Cr!=4||Te.length!=0||this.h.h||(this.s=1,Zt(16),A=!1),this.o=this.o&&A,!A)I(this.i,this.l,Te,"[Invalid Chunked Response]"),ht(this),Ke(this);else if(0<Te.length&&!this.W){this.W=!0;var Ir=this.j;Ir.g==this&&Ir.ba&&!Ir.M&&(Ir.j.info("Great, no buffering proxy detected. Bytes received: "+Te.length),J0(Ir),Ir.M=!0,Zt(11))}}else I(this.i,this.l,Te,null),rn(this,Te);Cr==4&&ht(this),this.o&&!this.J&&(Cr==4?v1(this.j,this):(this.o=!1,we(this)))}else EI(this.g),A==400&&0<Te.indexOf("Unknown SID")?(this.s=3,Zt(12)):(this.s=0,Zt(13)),ht(this),Ke(this)}}}catch{}finally{}};function Ce(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function pe(u,x){var A=u.C,V=x.indexOf(`
`,A);return V==-1?Y:(A=Number(x.substring(A,V)),isNaN(A)?J:(V+=1,V+A>x.length?Y:(x=x.slice(V,V+A),u.C=V+A,x)))}te.prototype.cancel=function(){this.J=!0,ht(this)};function we(u){u.S=Date.now()+u.I,De(u,u.I)}function De(u,x){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Q(d(u.ba,u),x)}function nt(u){u.B&&(o.clearTimeout(u.B),u.B=null)}te.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(M(this.i,this.A),this.L!=2&&(An(),Zt(17)),ht(this),this.s=2,Ke(this)):De(this,this.S-u)};function Ke(u){u.j.G==0||u.J||v1(u.j,u)}function ht(u){nt(u);var x=u.M;x&&typeof x.ma=="function"&&x.ma(),u.M=null,hn(u.U),u.g&&(x=u.g,u.g=null,x.abort(),x.ma())}function rn(u,x){try{var A=u.j;if(A.G!=0&&(A.g==u||Je(A.h,u))){if(!u.K&&Je(A.h,u)&&A.G==3){try{var V=A.Da.g.parse(x)}catch{V=null}if(Array.isArray(V)&&V.length==3){var re=V;if(re[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<u.F)Xu(A),Ku(A);else break e;Q0(A),Zt(18)}}else A.za=re[1],0<A.za-A.T&&37500>re[2]&&A.F&&A.v==0&&!A.C&&(A.C=Q(d(A.Za,A),6e3));if(1>=In(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else ca(A,11)}else if((u.K||A.g==u)&&Xu(A),!E(x))for(re=A.Da.g.parse(x),x=0;x<re.length;x++){let ot=re[x];if(A.T=ot[0],ot=ot[1],A.G==2)if(ot[0]=="c"){A.K=ot[1],A.ia=ot[2];const Ir=ot[3];Ir!=null&&(A.la=Ir,A.j.info("VER="+A.la));const Cr=ot[4];Cr!=null&&(A.Aa=Cr,A.j.info("SVER="+A.Aa));const uo=ot[5];uo!=null&&typeof uo=="number"&&0<uo&&(V=1.5*uo,A.L=V,A.j.info("backChannelRequestTimeoutMs_="+V)),V=A;const zn=u.g;if(zn){const Qu=zn.g?zn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qu){var se=V.h;se.g||Qu.indexOf("spdy")==-1&&Qu.indexOf("quic")==-1&&Qu.indexOf("h2")==-1||(se.j=se.l,se.g=new Set,se.h&&(ui(se,se.h),se.h=null))}if(V.D){const Z0=zn.g?zn.g.getResponseHeader("X-HTTP-Session-Id"):null;Z0&&(V.ya=Z0,St(V.I,V.D,Z0))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-u.F,A.j.info("Handshake RTT: "+A.R+"ms")),V=A;var Te=u;if(V.qa=y1(V,V.J?V.ia:null,V.W),Te.K){Al(V.h,Te);var _t=Te,mr=V.L;mr&&(_t.I=mr),_t.B&&(nt(_t),we(_t)),V.g=Te}else m1(V);0<A.i.length&&qu(A)}else ot[0]!="stop"&&ot[0]!="close"||ca(A,7);else A.G==3&&(ot[0]=="stop"||ot[0]=="close"?ot[0]=="stop"?ca(A,7):Y0(A):ot[0]!="noop"&&A.l&&A.l.ta(ot),A.v=0)}}An(4)}catch{}}var $e=class{constructor(u,x){this.g=u,this.map=x}};function ut(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function pr(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function In(u){return u.h?1:u.g?u.g.size:0}function Je(u,x){return u.h?u.h==x:u.g?u.g.has(x):!1}function ui(u,x){u.g?u.g.add(x):u.h=x}function Al(u,x){u.h&&u.h==x?u.h=null:u.g&&u.g.has(x)&&u.g.delete(x)}ut.prototype.cancel=function(){if(this.i=Bu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Bu(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let x=u.i;for(const A of u.g.values())x=x.concat(A.D);return x}return m(u.i)}function oI(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var x=[],A=u.length,V=0;V<A;V++)x.push(u[V]);return x}x=[],A=0;for(V in u)x[A++]=u[V];return x}function lI(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var x=[];u=u.length;for(var A=0;A<u;A++)x.push(A);return x}x=[],A=0;for(const V in u)x[A++]=V;return x}}}function Qv(u,x){if(u.forEach&&typeof u.forEach=="function")u.forEach(x,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,x,void 0);else for(var A=lI(u),V=oI(u),re=V.length,se=0;se<re;se++)x.call(void 0,V[se],A&&A[se],u)}var Jv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function cI(u,x){if(u){u=u.split("&");for(var A=0;A<u.length;A++){var V=u[A].indexOf("="),re=null;if(0<=V){var se=u[A].substring(0,V);re=u[A].substring(V+1)}else se=u[A];x(se,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function la(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof la){this.h=u.h,ju(this,u.j),this.o=u.o,this.g=u.g,zu(this,u.s),this.l=u.l;var x=u.i,A=new Rl;A.i=x.i,x.g&&(A.g=new Map(x.g),A.h=x.h),Zv(this,A),this.m=u.m}else u&&(x=String(u).match(Jv))?(this.h=!1,ju(this,x[1]||"",!0),this.o=Il(x[2]||""),this.g=Il(x[3]||"",!0),zu(this,x[4]),this.l=Il(x[5]||"",!0),Zv(this,x[6]||"",!0),this.m=Il(x[7]||"")):(this.h=!1,this.i=new Rl(null,this.h))}la.prototype.toString=function(){var u=[],x=this.j;x&&u.push(Cl(x,e1,!0),":");var A=this.g;return(A||x=="file")&&(u.push("//"),(x=this.o)&&u.push(Cl(x,e1,!0),"@"),u.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&u.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&u.push("/"),u.push(Cl(A,A.charAt(0)=="/"?hI:fI,!0))),(A=this.i.toString())&&u.push("?",A),(A=this.m)&&u.push("#",Cl(A,pI)),u.join("")};function Mi(u){return new la(u)}function ju(u,x,A){u.j=A?Il(x,!0):x,u.j&&(u.j=u.j.replace(/:$/,""))}function zu(u,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);u.s=x}else u.s=null}function Zv(u,x,A){x instanceof Rl?(u.i=x,mI(u.i,u.h)):(A||(x=Cl(x,dI)),u.i=new Rl(x,u.h))}function St(u,x,A){u.i.set(x,A)}function Hu(u){return St(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Il(u,x){return u?x?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Cl(u,x,A){return typeof u=="string"?(u=encodeURI(u).replace(x,uI),A&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function uI(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var e1=/[#\/\?@]/g,fI=/[#\?:]/g,hI=/[#\?]/g,dI=/[#\?@]/g,pI=/#/g;function Rl(u,x){this.h=this.g=null,this.i=u||null,this.j=!!x}function ms(u){u.g||(u.g=new Map,u.h=0,u.i&&cI(u.i,function(x,A){u.add(decodeURIComponent(x.replace(/\+/g," ")),A)}))}t=Rl.prototype,t.add=function(u,x){ms(this),this.i=null,u=lo(this,u);var A=this.g.get(u);return A||this.g.set(u,A=[]),A.push(x),this.h+=1,this};function t1(u,x){ms(u),x=lo(u,x),u.g.has(x)&&(u.i=null,u.h-=u.g.get(x).length,u.g.delete(x))}function r1(u,x){return ms(u),x=lo(u,x),u.g.has(x)}t.forEach=function(u,x){ms(this),this.g.forEach(function(A,V){A.forEach(function(re){u.call(x,re,V,this)},this)},this)},t.na=function(){ms(this);const u=Array.from(this.g.values()),x=Array.from(this.g.keys()),A=[];for(let V=0;V<x.length;V++){const re=u[V];for(let se=0;se<re.length;se++)A.push(x[V])}return A},t.V=function(u){ms(this);let x=[];if(typeof u=="string")r1(this,u)&&(x=x.concat(this.g.get(lo(this,u))));else{u=Array.from(this.g.values());for(let A=0;A<u.length;A++)x=x.concat(u[A])}return x},t.set=function(u,x){return ms(this),this.i=null,u=lo(this,u),r1(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[x]),this.h+=1,this},t.get=function(u,x){return u?(u=this.V(u),0<u.length?String(u[0]):x):x};function n1(u,x,A){t1(u,x),0<A.length&&(u.i=null,u.g.set(lo(u,x),m(A)),u.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],x=Array.from(this.g.keys());for(var A=0;A<x.length;A++){var V=x[A];const se=encodeURIComponent(String(V)),Te=this.V(V);for(V=0;V<Te.length;V++){var re=se;Te[V]!==""&&(re+="="+encodeURIComponent(String(Te[V]))),u.push(re)}}return this.i=u.join("&")};function lo(u,x){return x=String(x),u.j&&(x=x.toLowerCase()),x}function mI(u,x){x&&!u.j&&(ms(u),u.i=null,u.g.forEach(function(A,V){var re=V.toLowerCase();V!=re&&(t1(this,V),n1(this,re,A))},u)),u.j=x}function gI(u,x){const A=new ne;if(o.Image){const V=new Image;V.onload=p(gs,A,"TestLoadImage: loaded",!0,x,V),V.onerror=p(gs,A,"TestLoadImage: error",!1,x,V),V.onabort=p(gs,A,"TestLoadImage: abort",!1,x,V),V.ontimeout=p(gs,A,"TestLoadImage: timeout",!1,x,V),o.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=u}else x(!1)}function vI(u,x){const A=new ne,V=new AbortController,re=setTimeout(()=>{V.abort(),gs(A,"TestPingServer: timeout",!1,x)},1e4);fetch(u,{signal:V.signal}).then(se=>{clearTimeout(re),se.ok?gs(A,"TestPingServer: ok",!0,x):gs(A,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(re),gs(A,"TestPingServer: error",!1,x)})}function gs(u,x,A,V,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),V(A)}catch{}}function xI(){this.g=new Sl}function _I(u,x,A){const V=A||"";try{Qv(u,function(re,se){let Te=re;c(re)&&(Te=Fi(re)),x.push(V+se+"="+encodeURIComponent(Te))})}catch(re){throw x.push(V+"type="+encodeURIComponent("_badmap")),re}}function $u(u){this.l=u.Ub||null,this.j=u.eb||!1}v($u,Di),$u.prototype.g=function(){return new Wu(this.l,this.j)},$u.prototype.i=function(u){return function(){return u}}({});function Wu(u,x){gt.call(this),this.D=u,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(Wu,gt),t=Wu.prototype,t.open=function(u,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=x,this.readyState=1,Pl(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(x.body=u),(this.D||o).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Nl(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Pl(this)),this.g&&(this.readyState=3,Pl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;i1(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function i1(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var x=u.value?u.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!u.done}))&&(this.response=this.responseText+=x)}u.done?Nl(this):Pl(this),this.readyState==3&&i1(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,Nl(this))},t.Qa=function(u){this.g&&(this.response=u,Nl(this))},t.ga=function(){this.g&&Nl(this)};function Nl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Pl(u)}t.setRequestHeader=function(u,x){this.u.append(u,x)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],x=this.h.entries();for(var A=x.next();!A.done;)A=A.value,u.push(A[0]+": "+A[1]),A=x.next();return u.join(`\r
`)};function Pl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Wu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function s1(u){let x="";return U(u,function(A,V){x+=V,x+=":",x+=A,x+=`\r
`}),x}function X0(u,x,A){e:{for(V in A){var V=!1;break e}V=!0}V||(A=s1(A),typeof u=="string"?A!=null&&encodeURIComponent(String(A)):St(u,x,A))}function Mt(u){gt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(Mt,gt);var yI=/^https?$/i,wI=["POST","PUT"];t=Mt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,x,A,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);x=x?x.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():L.g(),this.v=this.o?li(this.o):li(L),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(x,String(u),!0),this.B=!1}catch(se){a1(this,se);return}if(u=A||"",A=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var re in V)A.set(re,V[re]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const se of V.keys())A.set(se,V.get(se));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(A.keys()).find(se=>se.toLowerCase()=="content-type"),re=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(wI,x,void 0))||V||re||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[se,Te]of A)this.g.setRequestHeader(se,Te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{c1(this),this.u=!0,this.g.send(u),this.u=!1}catch(se){a1(this,se)}};function a1(u,x){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=x,u.m=5,o1(u),Gu(u)}function o1(u){u.A||(u.A=!0,kt(u,"complete"),kt(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,kt(this,"complete"),kt(this,"abort"),Gu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gu(this,!0)),Mt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?l1(this):this.bb())},t.bb=function(){l1(this)};function l1(u){if(u.h&&typeof a<"u"&&(!u.v[1]||Vi(u)!=4||u.Z()!=2)){if(u.u&&Vi(u)==4)Ft(u.Ea,0,u);else if(kt(u,"readystatechange"),Vi(u)==4){u.h=!1;try{const Te=u.Z();e:switch(Te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var A;if(!(A=x)){var V;if(V=Te===0){var re=String(u.D).match(Jv)[1]||null;!re&&o.self&&o.self.location&&(re=o.self.location.protocol.slice(0,-1)),V=!yI.test(re?re.toLowerCase():"")}A=V}if(A)kt(u,"complete"),kt(u,"success");else{u.m=6;try{var se=2<Vi(u)?u.g.statusText:""}catch{se=""}u.l=se+" ["+u.Z()+"]",o1(u)}}finally{Gu(u)}}}}function Gu(u,x){if(u.g){c1(u);const A=u.g,V=u.v[0]?()=>{}:null;u.g=null,u.v=null,x||kt(u,"ready");try{A.onreadystatechange=V}catch{}}}function c1(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Vi(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Vi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var x=this.g.responseText;return u&&x.indexOf(u)==0&&(x=x.substring(u.length)),so(x)}};function u1(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function EI(u){const x={};u=(u.g&&2<=Vi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<u.length;V++){if(E(u[V]))continue;var A=P(u[V]);const re=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const se=x[re]||[];x[re]=se,se.push(A)}g(x,function(V){return V.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fl(u,x,A){return A&&A.internalChannelParams&&A.internalChannelParams[u]||x}function f1(u){this.Aa=0,this.i=[],this.j=new ne,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fl("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fl("baseRetryDelayMs",5e3,u),this.cb=Fl("retryDelaySeedMs",1e4,u),this.Wa=Fl("forwardChannelMaxRetries",2,u),this.wa=Fl("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new ut(u&&u.concurrentRequestLimit),this.Da=new xI,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=f1.prototype,t.la=8,t.G=1,t.connect=function(u,x,A,V){Zt(0),this.W=u,this.H=x||{},A&&V!==void 0&&(this.H.OSID=A,this.H.OAID=V),this.F=this.X,this.I=y1(this,null,this.W),qu(this)};function Y0(u){if(h1(u),u.G==3){var x=u.U++,A=Mi(u.I);if(St(A,"SID",u.K),St(A,"RID",x),St(A,"TYPE","terminate"),Dl(u,A),x=new te(u,u.j,x),x.L=2,x.v=Hu(Mi(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(x.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=x.v,A=!0),A||(x.g=w1(x.j,null),x.g.ea(x.v)),x.F=Date.now(),we(x)}_1(u)}function Ku(u){u.g&&(J0(u),u.g.cancel(),u.g=null)}function h1(u){Ku(u),u.u&&(o.clearTimeout(u.u),u.u=null),Xu(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function qu(u){if(!pr(u.h)&&!u.s){u.s=!0;var x=u.Ga;oe||ue(),ie||(oe(),ie=!0),G.add(x,u),u.B=0}}function TI(u,x){return In(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=x.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Q(d(u.Ga,u,x),x1(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const re=new te(this,this.j,u);let se=this.o;if(this.S&&(se?(se=k(se),C(se,this.S)):se=this.S),this.m!==null||this.O||(re.H=se,se=null),this.P)e:{for(var x=0,A=0;A<this.i.length;A++){t:{var V=this.i[A];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(x+=V,4096<x){x=A;break e}if(x===4096||A===this.i.length-1){x=A+1;break e}}x=1e3}else x=1e3;x=p1(this,re,x),A=Mi(this.I),St(A,"RID",u),St(A,"CVER",22),this.D&&St(A,"X-HTTP-Session-Id",this.D),Dl(this,A),se&&(this.O?x="headers="+encodeURIComponent(String(s1(se)))+"&"+x:this.m&&X0(A,this.m,se)),ui(this.h,re),this.Ua&&St(A,"TYPE","init"),this.P?(St(A,"$req",x),St(A,"SID","null"),re.T=!0,le(re,A,null)):le(re,A,x),this.G=2}}else this.G==3&&(u?d1(this,u):this.i.length==0||pr(this.h)||d1(this))};function d1(u,x){var A;x?A=x.l:A=u.U++;const V=Mi(u.I);St(V,"SID",u.K),St(V,"RID",A),St(V,"AID",u.T),Dl(u,V),u.m&&u.o&&X0(V,u.m,u.o),A=new te(u,u.j,A,u.B+1),u.m===null&&(A.H=u.o),x&&(u.i=x.D.concat(u.i)),x=p1(u,A,1e3),A.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),ui(u.h,A),le(A,V,x)}function Dl(u,x){u.H&&U(u.H,function(A,V){St(x,V,A)}),u.l&&Qv({},function(A,V){St(x,V,A)})}function p1(u,x,A){A=Math.min(u.i.length,A);var V=u.l?d(u.l.Na,u.l,u):null;e:{var re=u.i;let se=-1;for(;;){const Te=["count="+A];se==-1?0<A?(se=re[0].g,Te.push("ofs="+se)):se=0:Te.push("ofs="+se);let _t=!0;for(let mr=0;mr<A;mr++){let ot=re[mr].g;const Ir=re[mr].map;if(ot-=se,0>ot)se=Math.max(0,re[mr].g-100),_t=!1;else try{_I(Ir,Te,"req"+ot+"_")}catch{V&&V(Ir)}}if(_t){V=Te.join("&");break e}}}return u=u.i.splice(0,A),x.D=u,V}function m1(u){if(!u.g&&!u.u){u.Y=1;var x=u.Fa;oe||ue(),ie||(oe(),ie=!0),G.add(x,u),u.v=0}}function Q0(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Q(d(u.Fa,u),x1(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,g1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Q(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Zt(10),Ku(this),g1(this))};function J0(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function g1(u){u.g=new te(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var x=Mi(u.qa);St(x,"RID","rpc"),St(x,"SID",u.K),St(x,"AID",u.T),St(x,"CI",u.F?"0":"1"),!u.F&&u.ja&&St(x,"TO",u.ja),St(x,"TYPE","xmlhttp"),Dl(u,x),u.m&&u.o&&X0(x,u.m,u.o),u.L&&(u.g.I=u.L);var A=u.g;u=u.ia,A.L=1,A.v=Hu(Mi(x)),A.m=null,A.P=!0,ye(A,u)}t.Za=function(){this.C!=null&&(this.C=null,Ku(this),Q0(this),Zt(19))};function Xu(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function v1(u,x){var A=null;if(u.g==x){Xu(u),J0(u),u.g=null;var V=2}else if(Je(u.h,x))A=x.D,Al(u.h,x),V=1;else return;if(u.G!=0){if(x.o)if(V==1){A=x.m?x.m.length:0,x=Date.now()-x.F;var re=u.B;V=Oi(),kt(V,new H(V,A)),qu(u)}else m1(u);else if(re=x.s,re==3||re==0&&0<x.X||!(V==1&&TI(u,x)||V==2&&Q0(u)))switch(A&&0<A.length&&(x=u.h,x.i=x.i.concat(A)),re){case 1:ca(u,5);break;case 4:ca(u,10);break;case 3:ca(u,6);break;default:ca(u,2)}}}function x1(u,x){let A=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(A*=2),A*x}function ca(u,x){if(u.j.info("Error code "+x),x==2){var A=d(u.fb,u),V=u.Xa;const re=!V;V=new la(V||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ju(V,"https"),Hu(V),re?gI(V.toString(),A):vI(V.toString(),A)}else Zt(2);u.G=0,u.l&&u.l.sa(x),_1(u),h1(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Zt(2)):(this.j.info("Failed to ping google.com"),Zt(1))};function _1(u){if(u.G=0,u.ka=[],u.l){const x=Bu(u.h);(x.length!=0||u.i.length!=0)&&(w(u.ka,x),w(u.ka,u.i),u.h.i.length=0,m(u.i),u.i.length=0),u.l.ra()}}function y1(u,x,A){var V=A instanceof la?Mi(A):new la(A);if(V.g!="")x&&(V.g=x+"."+V.g),zu(V,V.s);else{var re=o.location;V=re.protocol,x=x?x+"."+re.hostname:re.hostname,re=+re.port;var se=new la(null);V&&ju(se,V),x&&(se.g=x),re&&zu(se,re),A&&(se.l=A),V=se}return A=u.D,x=u.ya,A&&x&&St(V,A,x),St(V,"VER",u.la),Dl(u,V),V}function w1(u,x,A){if(x&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=u.Ca&&!u.pa?new Mt(new $u({eb:A})):new Mt(u.pa),x.Ha(u.J),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function E1(){}t=E1.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Yu(){}Yu.prototype.g=function(u,x){return new dn(u,x)};function dn(u,x){gt.call(this),this.g=new f1(x),this.l=u,this.h=x&&x.messageUrlParams||null,u=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(u?u["X-WebChannel-Content-Type"]=x.messageContentType:u={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(u?u["X-WebChannel-Client-Profile"]=x.va:u={"X-WebChannel-Client-Profile":x.va}),this.g.S=u,(u=x&&x.Sb)&&!E(u)&&(this.g.m=u),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!E(x)&&(this.g.D=x,u=this.h,u!==null&&x in u&&(u=this.h,x in u&&delete u[x])),this.j=new co(this)}v(dn,gt),dn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},dn.prototype.close=function(){Y0(this.g)},dn.prototype.o=function(u){var x=this.g;if(typeof u=="string"){var A={};A.__data__=u,u=A}else this.u&&(A={},A.__data__=Fi(u),u=A);x.i.push(new $e(x.Ya++,u)),x.G==3&&qu(x)},dn.prototype.N=function(){this.g.l=null,delete this.j,Y0(this.g),delete this.g,dn.aa.N.call(this)};function T1(u){bi.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var x=u.__sm__;if(x){e:{for(const A in x){u=A;break e}u=void 0}(this.i=u)&&(u=this.i,x=x!==null&&u in x?x[u]:void 0),this.data=x}else this.data=u}v(T1,bi);function k1(){ci.call(this),this.status=1}v(k1,ci);function co(u){this.g=u}v(co,E1),co.prototype.ua=function(){kt(this.g,"a")},co.prototype.ta=function(u){kt(this.g,new T1(u))},co.prototype.sa=function(u){kt(this.g,new k1)},co.prototype.ra=function(){kt(this.g,"b")},Yu.prototype.createWebChannel=Yu.prototype.g,dn.prototype.send=dn.prototype.o,dn.prototype.open=dn.prototype.m,dn.prototype.close=dn.prototype.close,ZT=function(){return new Yu},JT=function(){return Oi()},QT=Sn,rm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},D.NO_ERROR=0,D.TIMEOUT=8,D.HTTP_ERROR=6,Xf=D,b.COMPLETE="complete",YT=b,ps.EventType=jn,jn.OPEN="a",jn.CLOSE="b",jn.ERROR="c",jn.MESSAGE="d",gt.prototype.listen=gt.prototype.K,Ql=ps,Mt.prototype.listenOnce=Mt.prototype.L,Mt.prototype.getLastError=Mt.prototype.Ka,Mt.prototype.getLastErrorCode=Mt.prototype.Ba,Mt.prototype.getStatus=Mt.prototype.Z,Mt.prototype.getResponseJson=Mt.prototype.Oa,Mt.prototype.getResponseText=Mt.prototype.oa,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Ha,XT=Mt}).apply(typeof xf<"u"?xf:typeof self<"u"?self:typeof window<"u"?window:{});const C_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Dr.UNAUTHENTICATED=new Dr(null),Dr.GOOGLE_CREDENTIALS=new Dr("google-credentials-uid"),Dr.FIRST_PARTY=new Dr("first-party-uid"),Dr.MOCK_USER=new Dr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La=new Pg("@firebase/firestore");function Wl(){return La.logLevel}function Pe(t,...e){if(La.logLevel<=Ye.DEBUG){const r=e.map($g);La.debug(`Firestore (${xl}): ${t}`,...r)}}function os(t,...e){if(La.logLevel<=Ye.ERROR){const r=e.map($g);La.error(`Firestore (${xl}): ${t}`,...r)}}function nl(t,...e){if(La.logLevel<=Ye.WARN){const r=e.map($g);La.warn(`Firestore (${xl}): ${t}`,...r)}}function $g(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(t="Unexpected state"){const e=`FIRESTORE (${xl}) INTERNAL ASSERTION FAILED: `+t;throw os(e),new Error(e)}function mt(t,e){t||Me()}function je(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends Ii{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class u3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Dr.UNAUTHENTICATED))}shutdown(){}}class f3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class h3{constructor(e){this.t=e,this.currentUser=Dr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){mt(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Yi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Yi,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Yi)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(mt(typeof n.accessToken=="string"),new ek(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mt(e===null||typeof e=="string"),new Dr(e)}}class d3{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Dr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class p3{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new d3(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Dr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class m3{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class g3{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){mt(this.o===void 0);const n=s=>{s.error!=null&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Pe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(mt(typeof r.token=="string"),this.R=r.token,new m3(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v3(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=v3(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function lt(t,e){return t<e?-1:t>e?1:0}function il(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Re(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Re(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Re(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Re(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ir.fromMillis(Date.now())}static fromDate(e){return ir.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new ir(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?lt(this.nanoseconds,e.nanoseconds):lt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new ir(0,0))}static max(){return new Ue(new ir(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,r,n){r===void 0?r=0:r>e.length&&Me(),n===void 0?n=e.length-r:n>e.length-r&&Me(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Jc.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Jc?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class It extends Jc{construct(e,r,n){return new It(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Re(ce.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new It(r)}static emptyPath(){return new It([])}}const x3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _r extends Jc{construct(e,r,n){return new _r(e,r,n)}static isValidIdentifier(e){return x3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_r.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new _r(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Re(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new Re(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Re(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Re(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _r(r)}static emptyPath(){return new _r([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(It.fromString(e))}static fromName(e){return new Fe(It.fromString(e).popFirst(5))}static empty(){return new Fe(It.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&It.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return It.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new It(e.slice()))}}function _3(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Ue.fromTimestamp(n===1e9?new ir(r+1,0):new ir(r,n));return new Ys(i,Fe.empty(),e)}function y3(t){return new Ys(t.readTime,t.key,-1)}class Ys{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ys(Ue.min(),Fe.empty(),-1)}static max(){return new Ys(Ue.max(),Fe.empty(),-1)}}function w3(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Fe.comparator(t.documentKey,e.documentKey),r!==0?r:lt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class T3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Iu(t){if(t.code!==ce.FAILED_PRECONDITION||t.message!==E3)throw t;Pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Me(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new me((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof me?r:me.resolve(r)}catch(r){return me.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):me.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):me.reject(r)}static resolve(e){return new me((r,n)=>{r(e)})}static reject(e){return new me((r,n)=>{n(e)})}static waitFor(e){return new me((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=me.resolve(!1);for(const n of e)r=r.next(i=>i?me.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new me((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(f=>{a[c]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new me((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function k3(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Cu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Wg.oe=-1;function A0(t){return t==null}function Lh(t){return t===0&&1/t==-1/0}function S3(t){return typeof t=="number"&&Number.isInteger(t)&&!Lh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R_(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Xa(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function rk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e,r){this.comparator=e,this.root=r||vr.EMPTY}insert(e,r){return new Lt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,vr.BLACK,null,null))}remove(e){return new Lt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _f(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _f(this.root,e,this.comparator,!1)}getReverseIterator(){return new _f(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _f(this.root,e,this.comparator,!0)}}class _f{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vr{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??vr.RED,this.left=i??vr.EMPTY,this.right=s??vr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new vr(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return vr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return vr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Me();const e=this.left.check();if(e!==this.right.check())throw Me();return e+(this.isRed()?0:1)}}vr.EMPTY=null,vr.RED=!0,vr.BLACK=!1;vr.EMPTY=new class{constructor(){this.size=0}get key(){throw Me()}get value(){throw Me()}get color(){throw Me()}get left(){throw Me()}get right(){throw Me()}copy(e,r,n,i,s){return this}insert(e,r,n){return new vr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.comparator=e,this.data=new Lt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new N_(this.data.getIterator())}getIteratorFrom(e){return new N_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof wr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new wr(this.comparator);return r.data=e,r}}class N_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.fields=e,e.sort(_r.comparator)}static empty(){return new _n([])}unionWith(e){let r=new wr(_r.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new _n(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return il(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new nk("Invalid base64 string: "+s):s}}(e);return new Sr(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Sr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return lt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Sr.EMPTY_BYTE_STRING=new Sr("");const A3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qs(t){if(mt(!!t),typeof t=="string"){let e=0;const r=A3.exec(t);if(mt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:zt(t.seconds),nanos:zt(t.nanos)}}function zt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ma(t){return typeof t=="string"?Sr.fromBase64String(t):Sr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Kg(t){const e=t.mapValue.fields.__previous_value__;return Gg(e)?Kg(e):e}function Zc(t){const e=Qs(t.mapValue.fields.__local_write_time__.timestampValue);return new ir(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I3{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class eu{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new eu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof eu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yf={mapValue:{}};function Va(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Gg(t)?4:R3(t)?9007199254740991:C3(t)?10:11:Me()}function Ti(t,e){if(t===e)return!0;const r=Va(t);if(r!==Va(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zc(t).isEqual(Zc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Qs(i.timestampValue),o=Qs(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ma(i.bytesValue).isEqual(Ma(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return zt(i.geoPointValue.latitude)===zt(s.geoPointValue.latitude)&&zt(i.geoPointValue.longitude)===zt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return zt(i.integerValue)===zt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=zt(i.doubleValue),o=zt(s.doubleValue);return a===o?Lh(a)===Lh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return il(t.arrayValue.values||[],e.arrayValue.values||[],Ti);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(R_(a)!==R_(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Ti(a[l],o[l])))return!1;return!0}(t,e);default:return Me()}}function tu(t,e){return(t.values||[]).find(r=>Ti(r,e))!==void 0}function sl(t,e){if(t===e)return 0;const r=Va(t),n=Va(e);if(r!==n)return lt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return lt(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=zt(s.integerValue||s.doubleValue),l=zt(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return P_(t.timestampValue,e.timestampValue);case 4:return P_(Zc(t),Zc(e));case 5:return lt(t.stringValue,e.stringValue);case 6:return function(s,a){const o=Ma(s),l=Ma(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const f=lt(o[c],l[c]);if(f!==0)return f}return lt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=lt(zt(s.latitude),zt(a.latitude));return o!==0?o:lt(zt(s.longitude),zt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return F_(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,f;const h=s.fields||{},d=a.fields||{},p=(o=h.value)===null||o===void 0?void 0:o.arrayValue,v=(l=d.value)===null||l===void 0?void 0:l.arrayValue,m=lt(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((f=v==null?void 0:v.values)===null||f===void 0?void 0:f.length)||0);return m!==0?m:F_(p,v)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===yf.mapValue&&a===yf.mapValue)return 0;if(s===yf.mapValue)return 1;if(a===yf.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},f=Object.keys(c);l.sort(),f.sort();for(let h=0;h<l.length&&h<f.length;++h){const d=lt(l[h],f[h]);if(d!==0)return d;const p=sl(o[l[h]],c[f[h]]);if(p!==0)return p}return lt(l.length,f.length)}(t.mapValue,e.mapValue);default:throw Me()}}function P_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return lt(t,e);const r=Qs(t),n=Qs(e),i=lt(r.seconds,n.seconds);return i!==0?i:lt(r.nanos,n.nanos)}function F_(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=sl(r[i],n[i]);if(s)return s}return lt(r.length,n.length)}function al(t){return nm(t)}function nm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Qs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Ma(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Fe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=nm(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${nm(r.fields[a])}`;return i+"}"}(t.mapValue):Me()}function D_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function im(t){return!!t&&"integerValue"in t}function qg(t){return!!t&&"arrayValue"in t}function b_(t){return!!t&&"nullValue"in t}function O_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yf(t){return!!t&&"mapValue"in t}function C3(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function gc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Xa(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=gc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=gc(t.arrayValue.values[r]);return e}return Object.assign({},t)}function R3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Yf(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=gc(r)}setAll(e){let r=_r.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=gc(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());Yf(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ti(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Yf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Xa(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new on(gc(this.value))}}function ik(t){const e=[];return Xa(t.fields,(r,n)=>{const i=new _r([r]);if(Yf(n)){const s=ik(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new _n(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Lr(e,0,Ue.min(),Ue.min(),Ue.min(),on.empty(),0)}static newFoundDocument(e,r,n,i){return new Lr(e,1,r,Ue.min(),n,i,0)}static newNoDocument(e,r){return new Lr(e,2,r,Ue.min(),Ue.min(),on.empty(),0)}static newUnknownDocument(e,r){return new Lr(e,3,r,Ue.min(),Ue.min(),on.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Lr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Lr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,r){this.position=e,this.inclusive=r}}function L_(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=Fe.comparator(Fe.fromName(a.referenceValue),r.key):n=sl(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function M_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ti(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,r="asc"){this.field=e,this.dir=r}}function N3(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{}class Qt extends sk{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new F3(e,r,n):r==="array-contains"?new O3(e,n):r==="in"?new L3(e,n):r==="not-in"?new M3(e,n):r==="array-contains-any"?new V3(e,n):new Qt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new D3(e,n):new b3(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(sl(r,this.value)):r!==null&&Va(this.value)===Va(r)&&this.matchesComparison(sl(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Me()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ai extends sk{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new ai(e,r)}matches(e){return ak(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ak(t){return t.op==="and"}function ok(t){return P3(t)&&ak(t)}function P3(t){for(const e of t.filters)if(e instanceof ai)return!1;return!0}function sm(t){if(t instanceof Qt)return t.field.canonicalString()+t.op.toString()+al(t.value);if(ok(t))return t.filters.map(e=>sm(e)).join(",");{const e=t.filters.map(r=>sm(r)).join(",");return`${t.op}(${e})`}}function lk(t,e){return t instanceof Qt?function(n,i){return i instanceof Qt&&n.op===i.op&&n.field.isEqual(i.field)&&Ti(n.value,i.value)}(t,e):t instanceof ai?function(n,i){return i instanceof ai&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&lk(a,i.filters[o]),!0):!1}(t,e):void Me()}function ck(t){return t instanceof Qt?function(r){return`${r.field.canonicalString()} ${r.op} ${al(r.value)}`}(t):t instanceof ai?function(r){return r.op.toString()+" {"+r.getFilters().map(ck).join(" ,")+"}"}(t):"Filter"}class F3 extends Qt{constructor(e,r,n){super(e,r,n),this.key=Fe.fromName(n.referenceValue)}matches(e){const r=Fe.comparator(e.key,this.key);return this.matchesComparison(r)}}class D3 extends Qt{constructor(e,r){super(e,"in",r),this.keys=uk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class b3 extends Qt{constructor(e,r){super(e,"not-in",r),this.keys=uk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function uk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Fe.fromName(n.referenceValue))}class O3 extends Qt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return qg(r)&&tu(r.arrayValue,this.value)}}class L3 extends Qt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&tu(this.value.arrayValue,r)}}class M3 extends Qt{constructor(e,r){super(e,"not-in",r)}matches(e){if(tu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!tu(this.value.arrayValue,r)}}class V3 extends Qt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!qg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>tu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function V_(t,e=null,r=[],n=[],i=null,s=null,a=null){return new U3(t,e,r,n,i,s,a)}function Xg(t){const e=je(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>sm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),A0(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>al(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>al(n)).join(",")),e.ue=r}return e.ue}function Yg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!N3(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!lk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!M_(t.startAt,e.startAt)&&M_(t.endAt,e.endAt)}function am(t){return Fe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function B3(t,e,r,n,i,s,a,o){return new _l(t,e,r,n,i,s,a,o)}function Qg(t){return new _l(t)}function U_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function fk(t){return t.collectionGroup!==null}function vc(t){const e=je(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new wr(_r.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new ru(s,n))}),r.has(_r.keyField().canonicalString())||e.ce.push(new ru(_r.keyField(),n))}return e.ce}function yi(t){const e=je(t);return e.le||(e.le=j3(e,vc(t))),e.le}function j3(t,e){if(t.limitType==="F")return V_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new ru(i.field,s)});const r=t.endAt?new Mh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Mh(t.startAt.position,t.startAt.inclusive):null;return V_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function om(t,e){const r=t.filters.concat([e]);return new _l(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function lm(t,e,r){return new _l(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function I0(t,e){return Yg(yi(t),yi(e))&&t.limitType===e.limitType}function hk(t){return`${Xg(yi(t))}|lt:${t.limitType}`}function go(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>ck(i)).join(", ")}]`),A0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>al(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>al(i)).join(",")),`Target(${n})`}(yi(t))}; limitType=${t.limitType})`}function C0(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Fe.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of vc(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=L_(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,vc(n),i)||n.endAt&&!function(a,o,l){const c=L_(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,vc(n),i))}(t,e)}function z3(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function dk(t){return(e,r)=>{let n=!1;for(const i of vc(t)){const s=H3(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function H3(t,e,r){const n=t.field.isKeyField()?Fe.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?sl(l,c):Me()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Me()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Xa(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return rk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3=new Lt(Fe.comparator);function ls(){return $3}const pk=new Lt(Fe.comparator);function Jl(...t){let e=pk;for(const r of t)e=e.insert(r.key,r);return e}function mk(t){let e=pk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function wa(){return xc()}function gk(){return xc()}function xc(){return new yl(t=>t.toString(),(t,e)=>t.isEqual(e))}const W3=new Lt(Fe.comparator),G3=new wr(Fe.comparator);function Xe(...t){let e=G3;for(const r of t)e=e.add(r);return e}const K3=new wr(lt);function q3(){return K3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lh(e)?"-0":e}}function vk(t){return{integerValue:""+t}}function X3(t,e){return S3(e)?vk(e):Jg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(){this._=void 0}}function Y3(t,e,r){return t instanceof nu?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Gg(s)&&(s=Kg(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof iu?_k(t,e):t instanceof su?yk(t,e):function(i,s){const a=xk(i,s),o=B_(a)+B_(i.Pe);return im(a)&&im(i.Pe)?vk(o):Jg(i.serializer,o)}(t,e)}function Q3(t,e,r){return t instanceof iu?_k(t,e):t instanceof su?yk(t,e):r}function xk(t,e){return t instanceof Vh?function(n){return im(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class nu extends R0{}class iu extends R0{constructor(e){super(),this.elements=e}}function _k(t,e){const r=wk(e);for(const n of t.elements)r.some(i=>Ti(i,n))||r.push(n);return{arrayValue:{values:r}}}class su extends R0{constructor(e){super(),this.elements=e}}function yk(t,e){let r=wk(e);for(const n of t.elements)r=r.filter(i=>!Ti(i,n));return{arrayValue:{values:r}}}class Vh extends R0{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function B_(t){return zt(t.integerValue||t.doubleValue)}function wk(t){return qg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3{constructor(e,r){this.field=e,this.transform=r}}function Z3(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof iu&&i instanceof iu||n instanceof su&&i instanceof su?il(n.elements,i.elements,Ti):n instanceof Vh&&i instanceof Vh?Ti(n.Pe,i.Pe):n instanceof nu&&i instanceof nu}(t.transform,e.transform)}class eb{constructor(e,r){this.version=e,this.transformResults=r}}class Ln{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Ln}static exists(e){return new Ln(void 0,e)}static updateTime(e){return new Ln(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class N0{}function Ek(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Zg(t.key,Ln.none()):new Ru(t.key,t.data,Ln.none());{const r=t.data,n=on.empty();let i=new wr(_r.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new aa(t.key,n,new _n(i.toArray()),Ln.none())}}function tb(t,e,r){t instanceof Ru?function(i,s,a){const o=i.value.clone(),l=z_(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof aa?function(i,s,a){if(!Qf(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=z_(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Tk(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function _c(t,e,r,n){return t instanceof Ru?function(s,a,o,l){if(!Qf(s.precondition,a))return o;const c=s.value.clone(),f=H_(s.fieldTransforms,l,a);return c.setAll(f),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof aa?function(s,a,o,l){if(!Qf(s.precondition,a))return o;const c=H_(s.fieldTransforms,l,a),f=a.data;return f.setAll(Tk(s)),f.setAll(c),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return Qf(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function rb(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=xk(n.transform,i||null);s!=null&&(r===null&&(r=on.empty()),r.set(n.field,s))}return r||null}function j_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&il(n,i,(s,a)=>Z3(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ru extends N0{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class aa extends N0{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Tk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function z_(t,e,r){const n=new Map;mt(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,Q3(a,o,r[i]))}return n}function H_(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,Y3(s,a,e))}return n}class Zg extends N0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nb extends N0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&tb(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=_c(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=_c(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=gk();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=Ek(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Ue.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Xe())}isEqual(e){return this.batchId===e.batchId&&il(this.mutations,e.mutations,(r,n)=>j_(r,n))&&il(this.baseMutations,e.baseMutations,(r,n)=>j_(r,n))}}class ev{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){mt(e.mutations.length===n.length);let i=function(){return W3}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new ev(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gt,Ze;function ob(t){switch(t){default:return Me();case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0}}function kk(t){if(t===void 0)return os("GRPC error has no .code"),ce.UNKNOWN;switch(t){case Gt.OK:return ce.OK;case Gt.CANCELLED:return ce.CANCELLED;case Gt.UNKNOWN:return ce.UNKNOWN;case Gt.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case Gt.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case Gt.INTERNAL:return ce.INTERNAL;case Gt.UNAVAILABLE:return ce.UNAVAILABLE;case Gt.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case Gt.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case Gt.NOT_FOUND:return ce.NOT_FOUND;case Gt.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case Gt.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case Gt.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case Gt.ABORTED:return ce.ABORTED;case Gt.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case Gt.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case Gt.DATA_LOSS:return ce.DATA_LOSS;default:return Me()}}(Ze=Gt||(Gt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lb(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb=new Aa([4294967295,4294967295],0);function $_(t){const e=lb().encode(t),r=new qT;return r.update(e),new Uint8Array(r.digest())}function W_(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Aa([r,n],0),new Aa([i,s],0)]}class tv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Zl(`Invalid padding: ${r}`);if(n<0)throw new Zl(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Zl(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Zl(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Aa.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Aa.fromNumber(n)));return i.compare(cb)===1&&(i=new Aa([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=$_(e),[n,i]=W_(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new tv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=$_(e),[n,i]=W_(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Zl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Nu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new P0(Ue.min(),i,new Lt(lt),ls(),Xe())}}class Nu{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Nu(n,r,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class Sk{constructor(e,r){this.targetId=e,this.me=r}}class Ak{constructor(e,r,n=Sr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class G_{constructor(){this.fe=0,this.ge=q_(),this.pe=Sr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Xe(),r=Xe(),n=Xe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Me()}}),new Nu(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=q_()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,mt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class ub{constructor(e){this.Le=e,this.Be=new Map,this.ke=ls(),this.qe=K_(),this.Qe=new Lt(lt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Me()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(am(s))if(n===0){const a=new Fe(s.path);this.Ue(r,a,Lr.newNoDocument(a,Ue.min()))}else mt(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=Ma(n).toUint8Array()}catch(l){if(l instanceof nk)return nl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new tv(a,i,s)}catch(l){return nl(l instanceof Zl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&am(o.target)){const l=new Fe(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Lr.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Xe();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new P0(e,r,this.Qe,this.ke,n);return this.ke=ls(),this.qe=K_(),this.Qe=new Lt(lt),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new G_,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new wr(lt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Pe("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new G_),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function K_(){return new Lt(Fe.comparator)}function q_(){return new Lt(Fe.comparator)}const fb={asc:"ASCENDING",desc:"DESCENDING"},hb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},db={and:"AND",or:"OR"};class pb{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function cm(t,e){return t.useProto3Json||A0(e)?e:{value:e}}function Uh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ik(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function mb(t,e){return Uh(t,e.toTimestamp())}function wi(t){return mt(!!t),Ue.fromTimestamp(function(r){const n=Qs(r);return new ir(n.seconds,n.nanos)}(t))}function rv(t,e){return um(t,e).canonicalString()}function um(t,e){const r=function(i){return new It(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Ck(t){const e=It.fromString(t);return mt(Dk(e)),e}function fm(t,e){return rv(t.databaseId,e.path)}function Ld(t,e){const r=Ck(e);if(r.get(1)!==t.databaseId.projectId)throw new Re(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Re(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Fe(Nk(r))}function Rk(t,e){return rv(t.databaseId,e)}function gb(t){const e=Ck(t);return e.length===4?It.emptyPath():Nk(e)}function hm(t){return new It(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Nk(t){return mt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function X_(t,e,r){return{name:fm(t,e),fields:r.value.mapValue.fields}}function vb(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Me()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,f){return c.useProto3Json?(mt(f===void 0||typeof f=="string"),Sr.fromBase64String(f||"")):(mt(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Sr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const f=c.code===void 0?ce.UNKNOWN:kk(c.code);return new Re(f,c.message||"")}(a);r=new Ak(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Ld(t,n.document.name),s=wi(n.document.updateTime),a=n.document.createTime?wi(n.document.createTime):Ue.min(),o=new on({mapValue:{fields:n.document.fields}}),l=Lr.newFoundDocument(i,s,a,o),c=n.targetIds||[],f=n.removedTargetIds||[];r=new Jf(c,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Ld(t,n.document),s=n.readTime?wi(n.readTime):Ue.min(),a=Lr.newNoDocument(i,s),o=n.removedTargetIds||[];r=new Jf([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Ld(t,n.document),s=n.removedTargetIds||[];r=new Jf([],s,i,null)}else{if(!("filter"in e))return Me();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new ab(i,s),o=n.targetId;r=new Sk(o,a)}}return r}function xb(t,e){let r;if(e instanceof Ru)r={update:X_(t,e.key,e.value)};else if(e instanceof Zg)r={delete:fm(t,e.key)};else if(e instanceof aa)r={update:X_(t,e.key,e.data),updateMask:Ib(e.fieldMask)};else{if(!(e instanceof nb))return Me();r={verify:fm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof nu)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof iu)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof su)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Vh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Me()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:mb(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Me()}(t,e.precondition)),r}function _b(t,e){return t&&t.length>0?(mt(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?wi(i.updateTime):wi(s);return a.isEqual(Ue.min())&&(a=wi(s)),new eb(a,i.transformResults||[])}(r,e))):[]}function yb(t,e){return{documents:[Rk(t,e.path)]}}function wb(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Rk(t,i);const s=function(c){if(c.length!==0)return Fk(ai.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(f=>function(d){return{field:vo(d.field),direction:kb(d.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=cm(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function Eb(t){let e=gb(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){mt(n===1);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(h){const d=Pk(h);return d instanceof ai&&ok(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(v){return new ru(xo(v.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,A0(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,p=h.values||[];return new Mh(p,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,p=h.values||[];return new Mh(p,d)}(r.endAt)),B3(e,i,a,s,o,"F",l,c)}function Tb(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Me()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Pk(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=xo(r.unaryFilter.field);return Qt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=xo(r.unaryFilter.field);return Qt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=xo(r.unaryFilter.field);return Qt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=xo(r.unaryFilter.field);return Qt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Me()}}(t):t.fieldFilter!==void 0?function(r){return Qt.create(xo(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Me()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ai.create(r.compositeFilter.filters.map(n=>Pk(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Me()}}(r.compositeFilter.op))}(t):Me()}function kb(t){return fb[t]}function Sb(t){return hb[t]}function Ab(t){return db[t]}function vo(t){return{fieldPath:t.canonicalString()}}function xo(t){return _r.fromServerFormat(t.fieldPath)}function Fk(t){return t instanceof Qt?function(r){if(r.op==="=="){if(O_(r.value))return{unaryFilter:{field:vo(r.field),op:"IS_NAN"}};if(b_(r.value))return{unaryFilter:{field:vo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(O_(r.value))return{unaryFilter:{field:vo(r.field),op:"IS_NOT_NAN"}};if(b_(r.value))return{unaryFilter:{field:vo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vo(r.field),op:Sb(r.op),value:r.value}}}(t):t instanceof ai?function(r){const n=r.getFilters().map(i=>Fk(i));return n.length===1?n[0]:{compositeFilter:{op:Ab(r.op),filters:n}}}(t):Me()}function Ib(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Dk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,r,n,i,s=Ue.min(),a=Ue.min(),o=Sr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Fs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Fs(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e){this.ct=e}}function Rb(t){const e=Eb({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?lm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(){this.un=new Pb}addToCollectionParentIndex(e,r){return this.un.add(r),me.resolve()}getCollectionParents(e,r){return me.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return me.resolve()}deleteFieldIndex(e,r){return me.resolve()}deleteAllFieldIndexes(e){return me.resolve()}createTargetIndexes(e,r){return me.resolve()}getDocumentsMatchingTarget(e,r){return me.resolve(null)}getIndexType(e,r){return me.resolve(0)}getFieldIndexes(e,r){return me.resolve([])}getNextCollectionGroupToUpdate(e){return me.resolve(null)}getMinOffset(e,r){return me.resolve(Ys.min())}getMinOffsetFromCollectionGroup(e,r){return me.resolve(Ys.min())}updateCollectionGroup(e,r,n){return me.resolve()}updateIndexEntries(e,r){return me.resolve()}}class Pb{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new wr(It.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new wr(It.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ol(0)}static kn(){return new ol(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb{constructor(){this.changes=new yl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Lr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?me.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&_c(n.mutation,i,_n.empty(),ir.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Xe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Xe()){const i=wa();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=Jl();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=wa();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Xe()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=ls();const a=xc(),o=function(){return xc()}();return r.forEach((l,c)=>{const f=n.get(c.key);i.has(c.key)&&(f===void 0||f.mutation instanceof aa)?s=s.insert(c.key,c):f!==void 0?(a.set(c.key,f.mutation.getFieldMask()),_c(f.mutation,c,f.mutation.getFieldMask(),ir.now())):a.set(c.key,_n.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,f)=>a.set(c,f)),r.forEach((c,f)=>{var h;return o.set(c,new Db(f,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=xc();let i=new Lt((a,o)=>a-o),s=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let f=n.get(l)||_n.empty();f=o.applyToLocalView(c,f),n.set(l,f);const h=(i.get(o.batchId)||Xe()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,f=l.value,h=gk();f.forEach(d=>{if(!s.has(d)){const p=Ek(r.get(d),n.get(d));p!==null&&h.set(d,p),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return me.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Fe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):fk(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):me.resolve(wa());let o=-1,l=s;return a.next(c=>me.forEach(c,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(f)?me.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{l=l.insert(f,d)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Xe())).next(f=>({batchId:o,changes:mk(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Fe(r)).next(n=>{let i=Jl();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=Jl();return this.indexManager.getCollectionParents(e,s).next(o=>me.forEach(o,l=>{const c=function(h,d){return new _l(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(f=>{f.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const f=c.getKey();a.get(f)===null&&(a=a.insert(f,Lr.newInvalidDocument(f)))});let o=Jl();return a.forEach((l,c)=>{const f=s.get(l);f!==void 0&&_c(f.mutation,c,_n.empty(),ir.now()),C0(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return me.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:wi(i.createTime)}}(r)),me.resolve()}getNamedQuery(e,r){return me.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:Rb(i.bundledQuery),readTime:wi(i.readTime)}}(r)),me.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(){this.overlays=new Lt(Fe.comparator),this.Ir=new Map}getOverlay(e,r){return me.resolve(this.overlays.get(r))}getOverlays(e,r){const n=wa();return me.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),me.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),me.resolve()}getOverlaysForCollection(e,r,n){const i=wa(),s=r.length+1,a=new Fe(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return me.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Lt((c,f)=>c-f);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let f=s.get(c.largestBatchId);f===null&&(f=wa(),s=s.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const o=wa(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,f)=>o.set(c,f)),!(o.size()>=i)););return me.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new sb(r,n));let s=this.Ir.get(r);s===void 0&&(s=Xe(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(){this.sessionToken=Sr.EMPTY_BYTE_STRING}getSessionToken(e){return me.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,me.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(){this.Tr=new wr(lr.Er),this.dr=new wr(lr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new lr(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new lr(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Fe(new It([])),n=new lr(r,e),i=new lr(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Fe(new It([])),n=new lr(r,e),i=new lr(r,e+1);let s=Xe();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new lr(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class lr{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Fe.comparator(e.key,r.key)||lt(e.wr,r.wr)}static Ar(e,r){return lt(e.wr,r.wr)||Fe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new wr(lr.Er)}checkEmpty(e){return me.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ib(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new lr(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return me.resolve(a)}lookupMutationBatch(e,r){return me.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return me.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return me.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return me.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new lr(r,0),i=new lr(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),me.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new wr(lt);return r.forEach(i=>{const s=new lr(i,0),a=new lr(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),me.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;Fe.isDocumentKey(s)||(s=s.child(""));const a=new lr(new Fe(s),0);let o=new wr(lt);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),me.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){mt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return me.forEach(r.mutations,i=>{const s=new lr(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new lr(r,0),i=this.br.firstAfterOrEqual(n);return me.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,me.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e){this.Mr=e,this.docs=function(){return new Lt(Fe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return me.resolve(n?n.document.mutableCopy():Lr.newInvalidDocument(r))}getEntries(e,r){let n=ls();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Lr.newInvalidDocument(i))}),me.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=ls();const a=r.path,o=new Fe(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:f}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||w3(y3(f),n)<=0||(i.has(f.key)||C0(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return me.resolve(s)}getAllFromCollectionGroup(e,r,n,i){Me()}Or(e,r){return me.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new Bb(this)}getSize(e){return me.resolve(this.size)}}class Bb extends Fb{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),me.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e){this.persistence=e,this.Nr=new yl(r=>Xg(r),Yg),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this.Lr=0,this.Br=new nv,this.targetCount=0,this.kr=ol.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),me.resolve()}getLastRemoteSnapshotVersion(e){return me.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return me.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),me.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),me.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new ol(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,me.resolve()}updateTargetData(e,r){return this.Kn(r),me.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,me.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),me.waitFor(s).next(()=>i)}getTargetCount(e){return me.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return me.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),me.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),me.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),me.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return me.resolve(n)}containsKey(e,r){return me.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Wg(0),this.Kr=!1,this.Kr=!0,this.$r=new Mb,this.referenceDelegate=e(this),this.Ur=new jb(this),this.indexManager=new Nb,this.remoteDocumentCache=function(i){return new Ub(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new Cb(r),this.Gr=new Ob(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new Lb,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new Vb(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Pe("MemoryPersistence","Starting transaction:",e);const i=new Hb(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return me.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class Hb extends T3{constructor(e){super(),this.currentSequenceNumber=e}}class iv{constructor(e){this.persistence=e,this.Jr=new nv,this.Yr=null}static Zr(e){return new iv(e)}get Xr(){if(this.Yr)return this.Yr;throw Me()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),me.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),me.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),me.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return me.forEach(this.Xr,n=>{const i=Fe.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,Ue.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return me.or([()=>me.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Xe(),i=Xe();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new sv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return YN()?8:k3(jr())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new $b;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(Wl()<=Ye.DEBUG&&Pe("QueryEngine","SDK will not create cache indexes for query:",go(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),me.resolve()):(Wl()<=Ye.DEBUG&&Pe("QueryEngine","Query:",go(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Wl()<=Ye.DEBUG&&Pe("QueryEngine","The SDK decides to create cache indexes for query:",go(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yi(r))):me.resolve())}Yi(e,r){if(U_(r))return me.resolve(null);let n=yi(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=lm(r,null,"F"),n=yi(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Xe(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,lm(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return U_(r)||i.isEqual(Ue.min())?me.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?me.resolve(null):(Wl()<=Ye.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),go(r)),this.rs(e,a,r,_3(i,-1)).next(o=>o))})}ts(e,r){let n=new wr(dk(e));return r.forEach((i,s)=>{C0(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return Wl()<=Ye.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",go(r)),this.Ji.getDocumentsMatchingQuery(e,r,Ys.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Lt(lt),this._s=new yl(s=>Xg(s),Yg),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bb(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function Kb(t,e,r,n){return new Gb(t,e,r,n)}async function bk(t,e){const r=je(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Xe();for(const c of i){a.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}for(const c of s){o.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function qb(t,e){const r=je(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,f){const h=c.batch,d=h.keys();let p=me.resolve();return d.forEach(v=>{p=p.next(()=>f.getEntry(l,v)).next(m=>{const w=c.docVersions.get(v);mt(w!==null),m.version.compareTo(w)<0&&(h.applyToRemoteDocument(m,c),m.isValidDocument()&&(m.setReadTime(c.commitVersion),f.addEntry(m)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Xe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function Ok(t){const e=je(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function Xb(t,e){const r=je(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((f,h)=>{const d=i.get(h);if(!d)return;o.push(r.Ur.removeMatchingKeys(s,f.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,f.addedDocuments,h)));let p=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Sr.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):f.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(f.resumeToken,n)),i=i.insert(h,p),function(m,w,T){return m.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(d,p,f)&&o.push(r.Ur.updateTargetData(s,p))});let l=ls(),c=Xe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(Yb(s,a,e.documentUpdates).next(f=>{l=f.Ps,c=f.Is})),!n.isEqual(Ue.min())){const f=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return me.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function Yb(t,e,r){let n=Xe(),i=Xe();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=ls();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Ue.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Pe("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function Qb(t,e){const r=je(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Jb(t,e){const r=je(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,me.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new Fs(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function dm(t,e,r){const n=je(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Cu(a))throw a;Pe("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function Y_(t,e,r){const n=je(t);let i=Ue.min(),s=Xe();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,f){const h=je(l),d=h._s.get(f);return d!==void 0?me.resolve(h.os.get(d)):h.Ur.getTargetData(c,f)}(n,a,yi(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:Ue.min(),r?s:Xe())).next(o=>(Zb(n,z3(e),o),{documents:o,Ts:s})))}function Zb(t,e,r){let n=t.us.get(e)||Ue.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class Q_{constructor(){this.activeTargetIds=q3()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class eO{constructor(){this.so=new Q_,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Q_,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Pe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Pe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wf=null;function Md(){return wf===null?wf=function(){return 268435456+Math.round(2147483648*Math.random())}():wf++,"0x"+wf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pr="WebChannelConnection";class iO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=Md(),l=this.xo(r,n.toUriEncodedString());Pe("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(f=>(Pe("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw nl("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",i),f})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+xl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=rO[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=Md();return new Promise((a,o)=>{const l=new XT;l.setWithCredentials(!0),l.listenOnce(YT.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Xf.NO_ERROR:const f=l.getResponseJson();Pe(Pr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case Xf.TIMEOUT:Pe(Pr,`RPC '${e}' ${s} timed out`),o(new Re(ce.DEADLINE_EXCEEDED,"Request time out"));break;case Xf.HTTP_ERROR:const h=l.getStatus();if(Pe(Pr,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const p=d==null?void 0:d.error;if(p&&p.status&&p.message){const v=function(w){const T=w.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(T)>=0?T:ce.UNKNOWN}(p.status);o(new Re(v,p.message))}else o(new Re(ce.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Re(ce.UNAVAILABLE,"Connection failed."));break;default:Me()}}finally{Pe(Pr,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Pe(Pr,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=Md(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ZT(),o=JT(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");Pe(Pr,`Creating RPC '${e}' stream ${i}: ${f}`,l);const h=a.createWebChannel(f,l);let d=!1,p=!1;const v=new nO({Io:w=>{p?Pe(Pr,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(d||(Pe(Pr,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),Pe(Pr,`RPC '${e}' stream ${i} sending:`,w),h.send(w))},To:()=>h.close()}),m=(w,T,E)=>{w.listen(T,y=>{try{E(y)}catch(N){setTimeout(()=>{throw N},0)}})};return m(h,Ql.EventType.OPEN,()=>{p||(Pe(Pr,`RPC '${e}' stream ${i} transport opened.`),v.yo())}),m(h,Ql.EventType.CLOSE,()=>{p||(p=!0,Pe(Pr,`RPC '${e}' stream ${i} transport closed`),v.So())}),m(h,Ql.EventType.ERROR,w=>{p||(p=!0,nl(Pr,`RPC '${e}' stream ${i} transport errored:`,w),v.So(new Re(ce.UNAVAILABLE,"The operation could not be completed")))}),m(h,Ql.EventType.MESSAGE,w=>{var T;if(!p){const E=w.data[0];mt(!!E);const y=E,N=y.error||((T=y[0])===null||T===void 0?void 0:T.error);if(N){Pe(Pr,`RPC '${e}' stream ${i} received error:`,N);const j=N.status;let U=function(S){const C=Gt[S];if(C!==void 0)return kk(C)}(j),g=N.message;U===void 0&&(U=ce.INTERNAL,g="Unknown error status: "+j+" with message "+N.message),p=!0,v.So(new Re(U,g)),h.close()}else Pe(Pr,`RPC '${e}' stream ${i} received:`,E),v.bo(E)}}),m(o,QT.STAT_EVENT,w=>{w.stat===rm.PROXY?Pe(Pr,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===rm.NOPROXY&&Pe(Pr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}}function Vd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F0(t){return new pb(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Pe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Lk(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===ce.RESOURCE_EXHAUSTED?(os(r.toString()),os("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new Re(ce.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Pe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Pe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sO extends Mk{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=vb(this.serializer,e),n=function(s){if(!("targetChange"in s))return Ue.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ue.min():a.readTime?wi(a.readTime):Ue.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=hm(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=am(l)?{documents:yb(s,l)}:{query:wb(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=Ik(s,a.resumeToken);const c=cm(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ue.min())>0){o.readTime=Uh(s,a.snapshotVersion.toTimestamp());const c=cm(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=Tb(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=hm(this.serializer),r.removeTarget=e,this.a_(r)}}class aO extends Mk{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return mt(!!e.streamToken),this.lastStreamToken=e.streamToken,mt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){mt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=_b(e.writeResults,e.commitTime),n=wi(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=hm(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>xb(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Re(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,um(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Re(ce.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,um(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Re(ce.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class lO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(os(r),this.D_=!1):Pe("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{Ya(this)&&(Pe("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=je(l);c.L_.add(4),await Pu(c),c.q_.set("Unknown"),c.L_.delete(4),await D0(c)}(this))})}),this.q_=new lO(n,i)}}async function D0(t){if(Ya(t))for(const e of t.B_)await e(!0)}async function Pu(t){for(const e of t.B_)await e(!1)}function Vk(t,e){const r=je(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),cv(r)?lv(r):wl(r).r_()&&ov(r,e))}function av(t,e){const r=je(t),n=wl(r);r.N_.delete(e),n.r_()&&Uk(r,e),r.N_.size===0&&(n.r_()?n.o_():Ya(r)&&r.q_.set("Unknown"))}function ov(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}wl(t).A_(e)}function Uk(t,e){t.Q_.xe(e),wl(t).R_(e)}function lv(t){t.Q_=new ub({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),wl(t).start(),t.q_.v_()}function cv(t){return Ya(t)&&!wl(t).n_()&&t.N_.size>0}function Ya(t){return je(t).L_.size===0}function Bk(t){t.Q_=void 0}async function uO(t){t.q_.set("Online")}async function fO(t){t.N_.forEach((e,r)=>{ov(t,e)})}async function hO(t,e){Bk(t),cv(t)?(t.q_.M_(e),lv(t)):t.q_.set("Unknown")}async function dO(t,e,r){if(t.q_.set("Online"),e instanceof Ak&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Pe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Bh(t,n)}else if(e instanceof Jf?t.Q_.Ke(e):e instanceof Sk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ue.min()))try{const n=await Ok(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.N_.get(c);f&&s.N_.set(c,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(Sr.EMPTY_BYTE_STRING,f.snapshotVersion)),Uk(s,l);const h=new Fs(f.target,l,c,f.sequenceNumber);ov(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Pe("RemoteStore","Failed to raise snapshot:",n),await Bh(t,n)}}async function Bh(t,e,r){if(!Cu(e))throw e;t.L_.add(1),await Pu(t),t.q_.set("Offline"),r||(r=()=>Ok(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Pe("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await D0(t)})}function jk(t,e){return e().catch(r=>Bh(t,r,e))}async function b0(t){const e=je(t),r=Js(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;pO(e);)try{const i=await Qb(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,mO(e,i)}catch(i){await Bh(e,i)}zk(e)&&Hk(e)}function pO(t){return Ya(t)&&t.O_.length<10}function mO(t,e){t.O_.push(e);const r=Js(t);r.r_()&&r.V_&&r.m_(e.mutations)}function zk(t){return Ya(t)&&!Js(t).n_()&&t.O_.length>0}function Hk(t){Js(t).start()}async function gO(t){Js(t).p_()}async function vO(t){const e=Js(t);for(const r of t.O_)e.m_(r.mutations)}async function xO(t,e,r){const n=t.O_.shift(),i=ev.from(n,e,r);await jk(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await b0(t)}async function _O(t,e){e&&Js(t).V_&&await async function(n,i){if(function(a){return ob(a)&&a!==ce.ABORTED}(i.code)){const s=n.O_.shift();Js(n).s_(),await jk(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await b0(n)}}(t,e),zk(t)&&Hk(t)}async function Z_(t,e){const r=je(t);r.asyncQueue.verifyOperationInProgress(),Pe("RemoteStore","RemoteStore received new credentials");const n=Ya(r);r.L_.add(3),await Pu(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await D0(r)}async function yO(t,e){const r=je(t);e?(r.L_.delete(2),await D0(r)):e||(r.L_.add(2),await Pu(r),r.q_.set("Unknown"))}function wl(t){return t.K_||(t.K_=function(r,n,i){const s=je(r);return s.w_(),new sO(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:uO.bind(null,t),Ro:fO.bind(null,t),mo:hO.bind(null,t),d_:dO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),cv(t)?lv(t):t.q_.set("Unknown")):(await t.K_.stop(),Bk(t))})),t.K_}function Js(t){return t.U_||(t.U_=function(r,n,i){const s=je(r);return s.w_(),new aO(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:gO.bind(null,t),mo:_O.bind(null,t),f_:vO.bind(null,t),g_:xO.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await b0(t)):(await t.U_.stop(),t.O_.length>0&&(Pe("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Yi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new uv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Re(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fv(t,e){if(os("AsyncQueue",`${e}: ${t}`),Cu(t))return new Re(ce.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Fe.comparator(r.key,n.key):(r,n)=>Fe.comparator(r.key,n.key),this.keyedMap=Jl(),this.sortedSet=new Lt(this.comparator)}static emptySet(e){return new zo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof zo)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new zo;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(){this.W_=new Lt(Fe.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Me():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class ll{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new ll(e,r,zo.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&I0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class EO{constructor(){this.queries=ty(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=je(r),s=i.queries;i.queries=ty(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Re(ce.ABORTED,"Firestore shutting down"))}}function ty(){return new yl(t=>hk(t),I0)}async function $k(t,e){const r=je(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new wO,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=fv(a,`Initialization of query '${go(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&hv(r)}async function Wk(t,e){const r=je(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function TO(t,e){const r=je(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&hv(r)}function kO(t,e,r){const n=je(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function hv(t){t.Y_.forEach(e=>{e.next()})}var pm,ry;(ry=pm||(pm={})).ea="default",ry.Cache="cache";class Gk{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new ll(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=ll.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==pm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e){this.key=e}}class qk{constructor(e){this.key=e}}class SO{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Xe(),this.mutatedKeys=Xe(),this.Aa=dk(e),this.Ra=new zo(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new ey,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,h)=>{const d=i.get(f),p=C0(this.query,h)?h:null,v=!!d&&this.mutatedKeys.has(d.key),m=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let w=!1;d&&p?d.data.isEqual(p.data)?v!==m&&(n.track({type:3,doc:p}),w=!0):this.ga(d,p)||(n.track({type:2,doc:p}),w=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!d&&p?(n.track({type:0,doc:p}),w=!0):d&&!p&&(n.track({type:1,doc:d}),w=!0,(l||c)&&(o=!0)),w&&(p?(a=a.add(p),s=m?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,h)=>function(p,v){const m=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Me()}};return m(p)-m(v)}(f.type,h.type)||this.Aa(f.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new ll(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ey,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Xe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new qk(n))}),this.da.forEach(n=>{e.has(n)||r.push(new Kk(n))}),r}ba(e){this.Ta=e.Ts,this.da=Xe();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return ll.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class AO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class IO{constructor(e){this.key=e,this.va=!1}}class CO{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new yl(o=>hk(o),I0),this.Ma=new Map,this.xa=new Set,this.Oa=new Lt(Fe.comparator),this.Na=new Map,this.La=new nv,this.Ba={},this.ka=new Map,this.qa=ol.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function RO(t,e,r=!0){const n=eS(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Xk(n,e,r,!0),i}async function NO(t,e){const r=eS(t);await Xk(r,e,!0,!1)}async function Xk(t,e,r,n){const i=await Jb(t.localStore,yi(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await PO(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&Vk(t.remoteStore,i),o}async function PO(t,e,r,n,i){t.Ka=(h,d,p)=>async function(m,w,T,E){let y=w.view.ma(T);y.ns&&(y=await Y_(m.localStore,w.query,!1).then(({documents:g})=>w.view.ma(g,y)));const N=E&&E.targetChanges.get(w.targetId),j=E&&E.targetMismatches.get(w.targetId)!=null,U=w.view.applyChanges(y,m.isPrimaryClient,N,j);return iy(m,w.targetId,U.wa),U.snapshot}(t,h,d,p);const s=await Y_(t.localStore,e,!0),a=new SO(e,s.Ts),o=a.ma(s.documents),l=Nu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);iy(t,r,c.wa);const f=new AO(e,r,a);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function FO(t,e,r){const n=je(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!I0(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await dm(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&av(n.remoteStore,i.targetId),mm(n,i.targetId)}).catch(Iu)):(mm(n,i.targetId),await dm(n.localStore,i.targetId,!0))}async function DO(t,e){const r=je(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),av(r.remoteStore,n.targetId))}async function bO(t,e,r){const n=jO(t);try{const i=await function(a,o){const l=je(a),c=ir.now(),f=o.reduce((p,v)=>p.add(v.key),Xe());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=ls(),m=Xe();return l.cs.getEntries(p,f).next(w=>{v=w,v.forEach((T,E)=>{E.isValidDocument()||(m=m.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,v)).next(w=>{h=w;const T=[];for(const E of o){const y=rb(E,h.get(E.key).overlayedDocument);y!=null&&T.push(new aa(E.key,y,ik(y.value.mapValue),Ln.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,T,o)}).next(w=>{d=w;const T=w.applyToLocalDocumentSet(h,m);return l.documentOverlayCache.saveOverlays(p,w.batchId,T)})}).then(()=>({batchId:d.batchId,changes:mk(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Lt(lt)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,i.batchId,r),await Fu(n,i.changes),await b0(n.remoteStore)}catch(i){const s=fv(i,"Failed to persist write");r.reject(s)}}async function Yk(t,e){const r=je(t);try{const n=await Xb(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(mt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?mt(a.va):i.removedDocuments.size>0&&(mt(a.va),a.va=!1))}),await Fu(r,n,e)}catch(n){await Iu(n)}}function ny(t,e,r){const n=je(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=je(a);l.onlineState=o;let c=!1;l.queries.forEach((f,h)=>{for(const d of h.j_)d.Z_(o)&&(c=!0)}),c&&hv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function OO(t,e,r){const n=je(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Lt(Fe.comparator);a=a.insert(s,Lr.newNoDocument(s,Ue.min()));const o=Xe().add(s),l=new P0(Ue.min(),new Map,new Lt(lt),a,o);await Yk(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),dv(n)}else await dm(n.localStore,e,!1).then(()=>mm(n,e,r)).catch(Iu)}async function LO(t,e){const r=je(t),n=e.batch.batchId;try{const i=await qb(r.localStore,e);Jk(r,n,null),Qk(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Fu(r,i)}catch(i){await Iu(i)}}async function MO(t,e,r){const n=je(t);try{const i=await function(a,o){const l=je(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let f;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(mt(h!==null),f=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,f)).next(()=>l.localDocuments.getDocuments(c,f))})}(n.localStore,e);Jk(n,e,r),Qk(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Fu(n,i)}catch(i){await Iu(i)}}function Qk(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function Jk(t,e,r){const n=je(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function mm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||Zk(t,n)})}function Zk(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(av(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),dv(t))}function iy(t,e,r){for(const n of r)n instanceof Kk?(t.La.addReference(n.key,e),VO(t,n)):n instanceof qk?(Pe("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||Zk(t,n.key)):Me()}function VO(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Pe("SyncEngine","New document in limbo: "+r),t.xa.add(n),dv(t))}function dv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Fe(It.fromString(e)),n=t.qa.next();t.Na.set(n,new IO(r)),t.Oa=t.Oa.insert(r,n),Vk(t.remoteStore,new Fs(yi(Qg(r.path)),n,"TargetPurposeLimboResolution",Wg.oe))}}async function Fu(t,e,r){const n=je(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var f;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=sv.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const f=je(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>me.forEach(c,d=>me.forEach(d.$i,p=>f.persistence.referenceDelegate.addReference(h,d.targetId,p)).next(()=>me.forEach(d.Ui,p=>f.persistence.referenceDelegate.removeReference(h,d.targetId,p)))))}catch(h){if(!Cu(h))throw h;Pe("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const p=f.os.get(d),v=p.snapshotVersion,m=p.withLastLimboFreeSnapshotVersion(v);f.os=f.os.insert(d,m)}}}(n.localStore,s))}async function UO(t,e){const r=je(t);if(!r.currentUser.isEqual(e)){Pe("SyncEngine","User change. New user:",e.toKey());const n=await bk(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new Re(ce.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Fu(r,n.hs)}}function BO(t,e){const r=je(t),n=r.Na.get(e);if(n&&n.va)return Xe().add(n.key);{let i=Xe();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function eS(t){const e=je(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Yk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=BO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=OO.bind(null,e),e.Ca.d_=TO.bind(null,e.eventManager),e.Ca.$a=kO.bind(null,e.eventManager),e}function jO(t){const e=je(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=LO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=MO.bind(null,e),e}class jh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=F0(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return Kb(this.persistence,new Wb,e.initialUser,this.serializer)}Ga(e){return new zb(iv.Zr,this.serializer)}Wa(e){return new eO}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jh.provider={build:()=>new jh};class gm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>ny(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=UO.bind(null,this.syncEngine),await yO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new EO}()}createDatastore(e){const r=F0(e.databaseInfo.databaseId),n=function(s){return new iO(s)}(e.databaseInfo);return function(s,a,o,l){return new oO(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new cO(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>ny(this.syncEngine,r,0),function(){return J_.D()?new J_:new tO}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,f){const h=new CO(i,s,a,o,l,c);return f&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=je(i);Pe("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Pu(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}gm.provider={build:()=>new gm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):os("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Dr.UNAUTHENTICATED,this.clientId=tk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Pe("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Pe("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=fv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Ud(t,e){t.asyncQueue.verifyOperationInProgress(),Pe("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await bk(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function sy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await HO(t);Pe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Z_(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Z_(e.remoteStore,i)),t._onlineComponents=e}async function HO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Pe("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ud(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ce.FAILED_PRECONDITION||i.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;nl("Error using user provided cache. Falling back to memory cache: "+r),await Ud(t,new jh)}}else Pe("FirestoreClient","Using default OfflineComponentProvider"),await Ud(t,new jh);return t._offlineComponents}async function rS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Pe("FirestoreClient","Using user provided OnlineComponentProvider"),await sy(t,t._uninitializedComponentsProvider._online)):(Pe("FirestoreClient","Using default OnlineComponentProvider"),await sy(t,new gm))),t._onlineComponents}function $O(t){return rS(t).then(e=>e.syncEngine)}async function nS(t){const e=await rS(t),r=e.eventManager;return r.onListen=RO.bind(null,e.syncEngine),r.onUnlisten=FO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=NO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=DO.bind(null,e.syncEngine),r}function WO(t,e,r={}){const n=new Yi;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const f=new tS({next:d=>{f.Za(),a.enqueueAndForget(()=>Wk(s,h));const p=d.docs.has(o);!p&&d.fromCache?c.reject(new Re(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&l&&l.source==="server"?c.reject(new Re(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new Gk(Qg(o.path),f,{includeMetadataChanges:!0,_a:!0});return $k(s,h)}(await nS(t),t.asyncQueue,e,r,n)),n.promise}function GO(t,e,r={}){const n=new Yi;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const f=new tS({next:d=>{f.Za(),a.enqueueAndForget(()=>Wk(s,h)),d.fromCache&&l.source==="server"?c.reject(new Re(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new Gk(o,f,{includeMetadataChanges:!0,_a:!0});return $k(s,h)}(await nS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ay=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sS(t,e,r){if(!r)throw new Re(ce.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function KO(t,e,r,n){if(e===!0&&n===!0)throw new Re(ce.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function oy(t){if(!Fe.isDocumentKey(t))throw new Re(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ly(t){if(Fe.isDocumentKey(t))throw new Re(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function O0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Me()}function oi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Re(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=O0(t);throw new Re(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Re(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Re(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}KO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iS((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Re(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Re(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Re(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class L0{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new cy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Re(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Re(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new cy(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new u3;switch(n.type){case"firstParty":return new p3(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Re(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=ay.get(r);n&&(Pe("ComponentProvider","Removing Datastore"),ay.delete(r),n.terminate())}(this),Promise.resolve()}}function qO(t,e,r,n={}){var i;const s=(t=oi(t,L0))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&nl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Dr.MOCK_USER;else{o=lT(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Re(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Dr(c)}t._authCredentials=new f3(new ek(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Qa(this.firestore,e,this._query)}}class Xr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ws(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xr(this.firestore,e,this._key)}}class Ws extends Qa{constructor(e,r,n){super(e,r,Qg(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xr(this.firestore,null,new Fe(e))}withConverter(e){return new Ws(this.firestore,e,this._path)}}function Zs(t,e,...r){if(t=Jt(t),sS("collection","path",e),t instanceof L0){const n=It.fromString(e,...r);return ly(n),new Ws(t,null,n)}{if(!(t instanceof Xr||t instanceof Ws))throw new Re(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(It.fromString(e,...r));return ly(n),new Ws(t.firestore,null,n)}}function Qn(t,e,...r){if(t=Jt(t),arguments.length===1&&(e=tk.newId()),sS("doc","path",e),t instanceof L0){const n=It.fromString(e,...r);return oy(n),new Xr(t,null,new Fe(n))}{if(!(t instanceof Xr||t instanceof Ws))throw new Re(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(It.fromString(e,...r));return oy(n),new Xr(t.firestore,t instanceof Ws?t.converter:null,new Fe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Lk(this,"async_queue_retry"),this.Vu=()=>{const n=Vd();n&&Pe("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Vd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Vd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Yi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Cu(e))throw e;Pe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw os("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=uv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Me()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}class Ja extends L0{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new uy,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new uy(e),this._firestoreClient=void 0,await e}}}function XO(t,e){const r=typeof t=="object"?t:E0(),n=typeof t=="string"?t:"(default)",i=Tu(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=Ng("firestore");s&&qO(i,...s)}return i}function pv(t){if(t._terminated)throw new Re(ce.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||YO(t),t._firestoreClient}function YO(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,f){return new I3(o,l,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,iS(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new zO(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cl(Sr.fromBase64String(e))}catch(r){throw new Re(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new cl(Sr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Re(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _r(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Re(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Re(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return lt(this._lat,e._lat)||lt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QO=/^__.*__$/;class JO{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new aa(e,this.data,this.fieldMask,r,this.fieldTransforms):new Ru(e,this.data,r,this.fieldTransforms)}}class aS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new aa(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function oS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Me()}}class vv{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new vv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return zh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(oS(this.Cu)&&QO.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class ZO{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||F0(e)}Qu(e,r,n,i=!1){return new vv({Cu:e,methodName:r,qu:n,path:_r.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function U0(t){const e=t._freezeSettings(),r=F0(t._databaseId);return new ZO(t._databaseId,!!e.ignoreUndefinedProperties,r)}function lS(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);_v("Data must be an object, but it was:",a,n);const o=cS(n,a);let l,c;if(s.merge)l=new _n(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const h of s.mergeFields){const d=vm(e,h,r);if(!a.contains(d))throw new Re(ce.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);fS(f,d)||f.push(d)}l=new _n(f),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new JO(new on(o),l,c)}class B0 extends V0{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof B0}}class xv extends V0{_toFieldTransform(e){return new J3(e.path,new nu)}isEqual(e){return e instanceof xv}}function e6(t,e,r,n){const i=t.Qu(1,e,r);_v("Data must be an object, but it was:",i,n);const s=[],a=on.empty();Xa(n,(l,c)=>{const f=yv(e,l,r);c=Jt(c);const h=i.Nu(f);if(c instanceof B0)s.push(f);else{const d=Du(c,h);d!=null&&(s.push(f),a.set(f,d))}});const o=new _n(s);return new aS(a,o,i.fieldTransforms)}function t6(t,e,r,n,i,s){const a=t.Qu(1,e,r),o=[vm(e,n,r)],l=[i];if(s.length%2!=0)throw new Re(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(vm(e,s[d])),l.push(s[d+1]);const c=[],f=on.empty();for(let d=o.length-1;d>=0;--d)if(!fS(c,o[d])){const p=o[d];let v=l[d];v=Jt(v);const m=a.Nu(p);if(v instanceof B0)c.push(p);else{const w=Du(v,m);w!=null&&(c.push(p),f.set(p,w))}}const h=new _n(c);return new aS(f,h,a.fieldTransforms)}function r6(t,e,r,n=!1){return Du(r,t.Qu(n?4:3,e))}function Du(t,e){if(uS(t=Jt(t)))return _v("Unsupported field value:",e,t),cS(t,e);if(t instanceof V0)return function(n,i){if(!oS(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=Du(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=Jt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return X3(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=ir.fromDate(n);return{timestampValue:Uh(i.serializer,s)}}if(n instanceof ir){const s=new ir(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Uh(i.serializer,s)}}if(n instanceof mv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof cl)return{bytesValue:Ik(i.serializer,n._byteString)};if(n instanceof Xr){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:rv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof gv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Jg(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${O0(n)}`)}(t,e)}function cS(t,e){const r={};return rk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xa(t,(n,i)=>{const s=Du(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function uS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ir||t instanceof mv||t instanceof cl||t instanceof Xr||t instanceof V0||t instanceof gv)}function _v(t,e,r){if(!uS(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=O0(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function vm(t,e,r){if((e=Jt(e))instanceof M0)return e._internalPath;if(typeof e=="string")return yv(t,e);throw zh("Field path arguments must be of type string or ",t,!1,void 0,r)}const n6=new RegExp("[~\\*/\\[\\]]");function yv(t,e,r){if(e.search(n6)>=0)throw zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new M0(...e.split("."))._internalPath}catch{throw zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function zh(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new Re(ce.INVALID_ARGUMENT,o+t+l)}function fS(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Xr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new i6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(j0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class i6 extends hS{data(){return super.data()}}function j0(t,e){return typeof e=="string"?yv(t,e):e instanceof M0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Re(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wv{}class dS extends wv{}function Ua(t,e,...r){let n=[];e instanceof wv&&n.push(e),n=n.concat(r),function(s){const a=s.filter(l=>l instanceof Ev).length,o=s.filter(l=>l instanceof z0).length;if(a>1||a>0&&o>0)throw new Re(ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class z0 extends dS{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new z0(e,r,n)}_apply(e){const r=this._parse(e);return pS(e._query,r),new Qa(e.firestore,e.converter,om(e._query,r))}_parse(e){const r=U0(e.firestore);return function(s,a,o,l,c,f,h){let d;if(c.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Re(ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){hy(h,f);const p=[];for(const v of h)p.push(fy(l,s,v));d={arrayValue:{values:p}}}else d=fy(l,s,h)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||hy(h,f),d=r6(o,a,h,f==="in"||f==="not-in");return Qt.create(c,f,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function ul(t,e,r){const n=e,i=j0("where",t);return z0._create(i,n,r)}class Ev extends wv{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Ev(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ai.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)pS(a,l),a=om(a,l)}(e._query,r),new Qa(e.firestore,e.converter,om(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Tv extends dS{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Tv(e,r)}_apply(e){const r=function(i,s,a){if(i.startAt!==null)throw new Re(ce.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Re(ce.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ru(s,a)}(e._query,this._field,this._direction);return new Qa(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new _l(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function a6(t,e="asc"){const r=e,n=j0("orderBy",t);return Tv._create(n,r)}function fy(t,e,r){if(typeof(r=Jt(r))=="string"){if(r==="")throw new Re(ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fk(e)&&r.indexOf("/")!==-1)throw new Re(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(It.fromString(r));if(!Fe.isDocumentKey(n))throw new Re(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return D_(t,new Fe(n))}if(r instanceof Xr)return D_(t,r._key);throw new Re(ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${O0(r)}.`)}function hy(t,e){if(!Array.isArray(t)||t.length===0)throw new Re(ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pS(t,e){const r=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Re(ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Re(ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class o6{convertValue(e,r="none"){switch(Va(e)){case 0:return null;case 1:return e.booleanValue;case 2:return zt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Ma(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Me()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Xa(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>zt(a.doubleValue));return new gv(s)}convertGeoPoint(e){return new mv(zt(e.latitude),zt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Kg(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Zc(e));default:return null}}convertTimestamp(e){const r=Qs(e);return new ir(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=It.fromString(e);mt(Dk(n));const i=new eu(n.get(1),n.get(3)),s=new Fe(n.popFirst(5));return i.isEqual(r)||os(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gS extends hS{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Zf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(j0("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Zf extends gS{data(e={}){return super.data(e)}}class l6{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new ec(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Zf(this._firestore,this._userDataWriter,n.key,n,new ec(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Re(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new Zf(i._firestore,i._userDataWriter,o.doc.key,o.doc,new ec(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new Zf(i._firestore,i._userDataWriter,o.doc.key,o.doc,new ec(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,f=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:c6(o.type),doc:l,oldIndex:c,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function c6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Me()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yc(t){t=oi(t,Xr);const e=oi(t.firestore,Ja);return WO(pv(e),t._key).then(r=>f6(e,t,r))}class vS extends o6{constructor(e){super(),this.firestore=e}convertBytes(e){return new cl(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Xr(this.firestore,null,r)}}function Ba(t){t=oi(t,Qa);const e=oi(t.firestore,Ja),r=pv(e),n=new vS(e);return s6(t._query),GO(r,t._query).then(i=>new l6(e,n,t,i))}function Ho(t,e,r){t=oi(t,Xr);const n=oi(t.firestore,Ja),i=mS(t.converter,e,r);return H0(n,[lS(U0(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Ln.none())])}function xS(t,e,r,...n){t=oi(t,Xr);const i=oi(t.firestore,Ja),s=U0(i);let a;return a=typeof(e=Jt(e))=="string"||e instanceof M0?t6(s,"updateDoc",t._key,e,r,n):e6(s,"updateDoc",t._key,e),H0(i,[a.toMutation(t._key,Ln.exists(!0))])}function u6(t){return H0(oi(t.firestore,Ja),[new Zg(t._key,Ln.none())])}function dy(t,e){const r=oi(t.firestore,Ja),n=Qn(t),i=mS(t.converter,e);return H0(r,[lS(U0(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,Ln.exists(!1))]).then(()=>n)}function H0(t,e){return function(n,i){const s=new Yi;return n.asyncQueue.enqueueAndForget(async()=>bO(await $O(n),i,s)),s.promise}(pv(t),e)}function f6(t,e,r){const n=r.docs.get(e._key),i=new vS(t);return new gS(t,i,e._key,n,new ec(r.hasPendingWrites,r.fromCache),e.converter)}function h6(){return new xv("serverTimestamp")}(function(e,r=!0){(function(i){xl=i})(qa),Xs(new is("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Ja(new h3(n.getProvider("auth-internal")),new g3(n.getProvider("app-check-internal")),function(c,f){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Re(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new eu(c.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),On(C_,"4.7.3",e),On(C_,"4.7.3","esm2017")})();var d6="firebase",p6="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */On(d6,p6,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S="firebasestorage.googleapis.com",m6="storageBucket",g6=2*60*1e3,v6=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends Ii{constructor(e,r,n=0){super(Bd(e),`Firebase Storage: ${r} (${Bd(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ci.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Bd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ki;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ki||(ki={}));function Bd(t){return"storage/"+t}function x6(){const t="An unknown error occurred, please check the error payload for server response.";return new Ci(ki.UNKNOWN,t)}function _6(){return new Ci(ki.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function y6(){return new Ci(ki.CANCELED,"User canceled the upload/download.")}function w6(t){return new Ci(ki.INVALID_URL,"Invalid URL '"+t+"'.")}function E6(t){return new Ci(ki.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function py(t){return new Ci(ki.INVALID_ARGUMENT,t)}function yS(){return new Ci(ki.APP_DELETED,"The Firebase app was deleted.")}function T6(t){return new Ci(ki.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Jn.makeFromUrl(e,r)}catch{return new Jn(e,"")}if(n.path==="")return n;throw E6(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function s(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function c(N){N.path_=decodeURIComponent(N.path)}const f="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${f}/b/${i}/o${d}`,"i"),v={bucket:1,path:3},m=r===_S?"(?:storage.googleapis.com|storage.cloud.google.com)":r,w="([^?#]*)",T=new RegExp(`^https?://${m}/${i}/${w}`,"i"),y=[{regex:o,indices:l,postModify:s},{regex:p,indices:v,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let N=0;N<y.length;N++){const j=y[N],U=j.regex.exec(e);if(U){const g=U[j.indices.bucket];let k=U[j.indices.path];k||(k=""),n=new Jn(g,k),j.postModify(n);break}}if(n==null)throw w6(e);return n}}class k6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S6(t,e,r){let n=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function f(...w){c||(c=!0,e.apply(null,w))}function h(w){i=setTimeout(()=>{i=null,t(p,l())},w)}function d(){s&&clearTimeout(s)}function p(w,...T){if(c){d();return}if(w){d(),f.call(null,w,...T);return}if(l()||a){d(),f.call(null,w,...T);return}n<64&&(n*=2);let y;o===1?(o=2,y=0):y=(n+Math.random())*1e3,h(y)}let v=!1;function m(w){v||(v=!0,d(),!c&&(i!==null?(w||(o=2),clearTimeout(i),h(0)):w||(o=1)))}return h(0),s=setTimeout(()=>{a=!0,m(!0)},r),m}function A6(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I6(t){return t!==void 0}function my(t,e,r,n){if(n<e)throw py(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw py(`Invalid value for '${t}'. Expected ${r} or less.`)}function C6(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var Hh;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Hh||(Hh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R6(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return r||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e,r,n,i,s,a,o,l,c,f,h,d=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=f,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,v)=>{this.resolve_=p,this.reject_=v,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new Ef(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Hh.NO_ERROR,l=s.getStatus();if(!o||R6(l,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===Hh.ABORT;n(!1,new Ef(!1,null,f));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new Ef(c,s))})},r=(n,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());I6(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=x6();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?yS():y6();a(l)}else{const l=_6();a(l)}};this.canceled_?r(!1,new Ef(!1,null,!0)):this.backoffId_=S6(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&A6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ef{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function P6(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function F6(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function D6(t,e){e&&(t["X-Firebase-GMPID"]=e)}function b6(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function O6(t,e,r,n,i,s,a=!0){const o=C6(t.urlParams),l=t.url+o,c=Object.assign({},t.headers);return D6(c,e),P6(c,r),F6(c,s),b6(c,n),new N6(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L6(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function M6(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,r){this._service=e,r instanceof Jn?this._location=r:this._location=Jn.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new $h(e,r)}get root(){const e=new Jn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return M6(this._location.path)}get storage(){return this._service}get parent(){const e=L6(this._location.path);if(e===null)return null;const r=new Jn(this._location.bucket,e);return new $h(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw T6(e)}}function gy(t,e){const r=e==null?void 0:e[m6];return r==null?null:Jn.makeFromBucketSpec(r,t)}function V6(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:i}=n;i&&(t._overrideAuthToken=typeof i=="string"?i:lT(i,t.app.options.projectId))}class U6{constructor(e,r,n,i,s){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=_S,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=g6,this._maxUploadRetryTime=v6,this._requests=new Set,i!=null?this._bucket=Jn.makeFromBucketSpec(i,this._host):this._bucket=gy(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Jn.makeFromBucketSpec(this._url,e):this._bucket=gy(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){my("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){my("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new $h(this,e)}_makeRequest(e,r,n,i,s=!0){if(this._deleted)return new k6(yS());{const a=O6(e,this._appId,n,i,r,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}const vy="@firebase/storage",xy="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS="storage";function B6(t=E0(),e){t=Jt(t);const n=Tu(t,wS).getImmediate({identifier:e}),i=Ng("storage");return i&&j6(n,...i),n}function j6(t,e,r,n={}){V6(t,e,r,n)}function z6(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new U6(r,n,i,e,qa)}function H6(){Xs(new is(wS,z6,"PUBLIC").setMultipleInstances(!0)),On(vy,xy,""),On(vy,xy,"esm2017")}H6();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $6{constructor(e,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||n.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xm="us-central1";class W6{constructor(e,r,n,i,s=xm,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new $6(r,n,i),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(s);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=xm}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function G6(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}const _y="@firebase/functions",yy="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K6="auth-internal",q6="app-check-internal",X6="messaging-internal";function Y6(t,e){const r=(n,{instanceIdentifier:i})=>{const s=n.getProvider("app").getImmediate(),a=n.getProvider(K6),o=n.getProvider(X6),l=n.getProvider(q6);return new W6(s,a,o,l,i,t)};Xs(new is(ES,r,"PUBLIC").setMultipleInstances(!0)),On(_y,yy,e),On(_y,yy,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q6(t=E0(),e=xm){const n=Tu(Jt(t),ES).getImmediate({identifier:e}),i=Ng("functions");return i&&J6(n,...i),n}function J6(t,e,r){G6(Jt(t),e,r)}Y6(fetch.bind(self));const Z6={apiKey:"AIzaSyAnEPcQISz9FY68mib-0StN6NQtTF3oz1c",authDomain:"xmas-movies.firebaseapp.com",projectId:"xmas-movies",storageBucket:"xmas-movies.firebasestorage.app",messagingSenderId:"721037810395",appId:"1:721037810395:web:1126b377adcc225c944afe"},$0=fT(Z6),wc=l3($0),TS=new gi;TS.setCustomParameters({prompt:"select_account"});const eL=TS,fr=XO($0);B6($0);Q6($0);const kS=ee.createContext(void 0),hs=()=>{const t=ee.useContext(kS);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},tL=({children:t})=>{const[e,r]=ee.useState(null),[n,i]=ee.useState(null),[s,a]=ee.useState(!0),[o,l]=ee.useState(null);ee.useEffect(()=>{const d=OT(wc,async p=>{if(r(p),l(null),p)try{const v=Qn(fr,"users",p.uid),m=await yc(v);if(m.exists())await Ho(v,{lastLoginAt:h6()},{merge:!0}),i(m.data());else{const w={email:p.email||"",displayName:p.displayName||"User",photoURL:p.photoURL||void 0,createdAt:new Date,lastLoginAt:new Date};await Ho(v,w),i({id:p.uid,...w})}}catch(v){console.error("Error fetching user profile:",v),l("Failed to load user profile")}else i(null);a(!1)});return()=>d()},[]);const h={currentUser:e,userProfile:n,isLoading:s,error:o,signInWithGoogle:async()=>{try{l(null),a(!0);const d=new gi;await GT(wc,d)}catch(d){console.error("Login error:",d),l(d.message||"Failed to sign in")}finally{a(!1)}},signOut:async()=>{try{await JF(wc)}catch(d){console.error("Sign out error:",d),l(d.message||"Failed to sign out")}}};return _.jsx(kS.Provider,{value:h,children:t})},rL=({snowflakeCount:t=100})=>{const e=ee.useRef(null),r=ee.useRef([]),n=ee.useRef(0);return ee.useEffect(()=>{const i=e.current;if(!i)return;const s=i.getContext("2d");if(!s)return;const a=()=>{i.width=window.innerWidth,i.height=window.innerHeight},o=()=>{r.current=[];for(let h=0;h<t;h++)r.current.push({x:Math.random()*i.width,y:Math.random()*i.height,size:Math.random()*4+1,speed:Math.random()*1+.5,opacity:Math.random()*.6+.3,wind:Math.random()*.5-.25})},l=h=>{s.beginPath(),s.arc(h.x,h.y,h.size,0,Math.PI*2),s.fillStyle=`rgba(255, 255, 255, ${h.opacity})`,s.fill()},c=h=>{h.y+=h.speed,h.x+=h.wind,h.y>i.height&&(h.y=-10,h.x=Math.random()*i.width),h.x>i.width?h.x=0:h.x<0&&(h.x=i.width)},f=()=>{s.clearRect(0,0,i.width,i.height),r.current.forEach(h=>{l(h),c(h)}),n.current=requestAnimationFrame(f)};return window.addEventListener("resize",a),a(),o(),f(),()=>{window.removeEventListener("resize",a),cancelAnimationFrame(n.current)}},[t]),_.jsx("canvas",{ref:e,className:"fixed top-0 left-0 w-full h-full pointer-events-none z-10","aria-hidden":"true"})};function nL(){const{currentUser:t}=hs(),[e,r]=ee.useState(!1),n=Ga();ee.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),ee.useEffect(()=>{e&&r(!1)},[n.pathname]);const i=()=>{r(!e)};return _.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-xmas-bg to-xmas-card bg-opacity-95",children:[_.jsx(rL,{snowflakeCount:150}),_.jsxs("div",{className:"navbar bg-gradient-to-r from-xmas-card via-xmas-card to-xmas-bg border-b border-xmas-gold px-2 sm:px-4 shadow-lg relative overflow-hidden",children:[_.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),_.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-8 snow-accumulation-fast"}),_.jsxs("div",{className:"flex items-center",children:[_.jsx("button",{className:"btn btn-ghost btn-sm md:hidden relative z-10",onClick:i,"aria-label":"Toggle navigation menu",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),_.jsxs(xt,{to:"/",className:"hidden sm:flex items-center group",children:[_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-xmas-gold to-xmas-line rounded-full opacity-70 group-hover:opacity-100 blur transition duration-200"}),_.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 bg-xmas-card rounded-full border border-xmas-gold overflow-hidden",children:_.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})})]}),_.jsx("div",{className:"ml-3 font-christmas text-xl sm:text-2xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),_.jsxs(xt,{to:"/",className:"sm:hidden flex items-center",children:[_.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold overflow-hidden",children:_.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),_.jsx("span",{className:"ml-2 font-christmas text-lg text-xmas-gold",children:"Christmas Movies"})]})]}),_.jsx("div",{className:"flex-1"}),_.jsx("div",{className:"flex items-center gap-1 sm:gap-2",children:t?_.jsxs("div",{className:"dropdown dropdown-end",children:[_.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar",children:_.jsx("div",{className:"w-10 rounded-full border border-xmas-gold",children:t.photoURL?_.jsx("img",{src:t.photoURL,alt:"Profile"}):_.jsx("div",{className:"bg-xmas-card flex items-center justify-center h-full",children:_.jsx("i",{className:"fas fa-user text-xmas-gold"})})})}),_.jsxs("ul",{tabIndex:0,className:"menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-xmas-card rounded-box w-52 border border-xmas-gold",children:[_.jsx("li",{children:_.jsxs(xt,{to:"/profile",className:"justify-between",children:["Profile",_.jsx("i",{className:"fas fa-user-circle"})]})}),_.jsx("li",{children:_.jsxs(xt,{to:"/movies",children:["My Movies",_.jsx("i",{className:"fas fa-film"})]})}),_.jsx("li",{children:_.jsxs(xt,{to:"/random",children:["Random Movie",_.jsx("i",{className:"fas fa-random"})]})}),_.jsx("li",{children:_.jsxs(xt,{to:"/import",children:["Import Movies",_.jsx("i",{className:"fas fa-file-import"})]})})]})]}):_.jsxs(xt,{to:"/login",className:"btn btn-primary btn-sm",children:[_.jsx("i",{className:"fas fa-sign-in-alt mr-1"})," Sign In"]})})]}),_.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-70 z-20 transition-opacity duration-300 md:hidden ${e?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:i}),_.jsxs("div",{className:`fixed top-0 left-0 h-full w-72 bg-gradient-to-b from-xmas-bg to-xmas-card border-r border-xmas-gold z-30 transform transition-transform duration-300 ease-in-out md:hidden shadow-xl ${e?"translate-x-0":"-translate-x-full"}`,children:[_.jsxs("div",{className:"relative overflow-hidden",children:[_.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),_.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-xmas-gold bg-xmas-card bg-opacity-80",children:[_.jsxs("div",{className:"flex items-center",children:[_.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold shadow-lg overflow-hidden",children:_.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),_.jsx("div",{className:"ml-3 font-christmas text-xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),_.jsx("button",{className:"btn btn-ghost btn-sm text-xmas-text hover:text-xmas-line",onClick:i,"aria-label":"Close navigation menu",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),_.jsx("div",{className:"overflow-y-auto h-full pb-20",children:_.jsx("div",{className:"p-4 pt-6",children:_.jsxs("div",{className:"mb-6",children:[_.jsx("h3",{className:"font-christmas text-xl text-xmas-gold mb-4 pl-2 border-l-2 border-xmas-line",children:"Navigation"}),_.jsxs("ul",{className:"space-y-3",children:[_.jsx("li",{children:_.jsx(po,{to:"/",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>_.jsxs(_.Fragment,{children:[_.jsx("i",{className:"fas fa-home mr-3 text-xmas-gold"}),_.jsx("span",{children:"Home"}),_.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})}),t?_.jsxs(_.Fragment,{children:[_.jsx("li",{children:_.jsx(po,{to:"/movies",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>_.jsxs(_.Fragment,{children:[_.jsx("i",{className:"fas fa-film mr-3 text-xmas-gold"}),_.jsx("span",{children:"My Movies"}),_.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})}),_.jsx("li",{children:_.jsx(po,{to:"/random",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>_.jsxs(_.Fragment,{children:[_.jsx("i",{className:"fas fa-random mr-3 text-xmas-gold"}),_.jsx("span",{children:"Random Movie"}),_.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})}),_.jsx("li",{children:_.jsx(po,{to:"/import",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>_.jsxs(_.Fragment,{children:[_.jsx("i",{className:"fas fa-file-import mr-3 text-xmas-gold"}),_.jsx("span",{children:"Import Movies"}),_.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})}),_.jsx("li",{children:_.jsx(po,{to:"/profile",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>_.jsxs(_.Fragment,{children:[_.jsx("i",{className:"fas fa-user-circle mr-3 text-xmas-gold"}),_.jsx("span",{children:"Profile"}),_.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})})]}):_.jsx("li",{children:_.jsx(po,{to:"/login",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>_.jsxs(_.Fragment,{children:[_.jsx("i",{className:"fas fa-sign-in-alt mr-3 text-xmas-gold"}),_.jsx("span",{children:"Sign In"}),_.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})})]})]})})})]}),_.jsx("main",{className:"p-4",children:_.jsx(Z2,{})}),_.jsx("div",{className:"fixed bottom-0 left-0 w-full pointer-events-none",children:_.jsx("div",{className:"container mx-auto",children:_.jsxs("div",{className:"relative h-16",children:[_.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-40"}),_.jsx("div",{className:"absolute bottom-4 left-4 opacity-30",children:_.jsx("i",{className:"fas fa-tree text-4xl text-xmas-gold"})}),_.jsx("div",{className:"absolute bottom-4 right-4 opacity-30",children:_.jsx("i",{className:"fas fa-star text-4xl text-xmas-gold"})})]})})})]})}const iL=({children:t})=>{const{currentUser:e,isLoading:r}=hs();return r?_.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):e?t?_.jsx(_.Fragment,{children:t}):_.jsx(Z2,{}):_.jsx(hN,{to:"/login"})},sL=()=>{const{currentUser:t}=hs();return _.jsxs("div",{className:"container mx-auto px-4 py-8",children:[_.jsxs("div",{className:"text-center mb-12",children:[_.jsx("h1",{className:"font-christmas text-5xl md:text-7xl text-xmas-line mb-4",children:"Christmas Movie Database"}),_.jsx("p",{className:"text-xl md:text-2xl text-xmas-snow mb-8",children:"Track, rate, and discover your favorite Christmas movies!"}),_.jsx("div",{className:"flex flex-col md:flex-row justify-center gap-6 mb-12",children:t?_.jsxs(xt,{to:"/movies",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[_.jsx("i",{className:"fas fa-film mr-2"})," My Movies"]}):_.jsxs(xt,{to:"/login",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[_.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In"]})})]}),_.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:_.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),_.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-20 snow-accumulation snow-accumulation-slow relative",children:[_.jsx("h2",{className:"font-christmas text-3xl text-xmas-line mb-6 text-center",children:"Features"}),_.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[_.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[_.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:_.jsx("i",{className:"fas fa-search"})}),_.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Find Movies"}),_.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Search and discover Christmas movies using TMDB integration"})]}),_.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold",children:[_.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:_.jsx("i",{className:"fas fa-star"})}),_.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Rate & Review"}),_.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Keep track of movies you've watched and rate them"})]}),_.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[_.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:_.jsx("i",{className:"fas fa-random"})}),_.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Random Picker"}),_.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Can't decide what to watch? Let our random movie picker help!"})]})]})]}),_.jsx("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 snow-accumulation snow-accumulation-fast relative",children:_.jsxs("div",{className:"mb-6 text-center",children:[_.jsxs("h2",{className:"font-christmas text-3xl md:text-4xl text-xmas-gold inline-block relative",children:[_.jsx("span",{className:"relative z-10",children:"Import Your Collection"}),_.jsx("span",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-xmas-gold opacity-30 rounded-full"})]}),_.jsx("p",{className:"mt-4 mb-6",children:"Already have a list of Christmas movies? Import them from Excel or search TMDB!"}),t?_.jsxs(xt,{to:"/import",className:"btn btn-primary",children:[_.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]}):_.jsxs(xt,{to:"/login",className:"btn btn-primary",children:[_.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In to Import"]})]})}),_.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:_.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),_.jsx("footer",{className:"text-center text-xmas-mute mt-12 pb-8",children:_.jsxs("p",{children:[" ",new Date().getFullYear()," Christmas Movie Database"]})})]})},aL=()=>{const t=Ka(),{currentUser:e,isLoading:r,error:n,signInWithGoogle:i}=hs();ee.useEffect(()=>{e&&!r&&t("/movies")},[e,r,t]);const s=async()=>{try{await i()}catch(a){console.error("Login failed:",a)}};return r?_.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):_.jsx("div",{className:"container mx-auto px-4 py-12",children:_.jsxs("div",{className:"max-w-md mx-auto",children:[_.jsxs("div",{className:"text-center mb-8",children:[_.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Christmas Movie Database"}),_.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage your Christmas movie collection"})]}),_.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[n&&_.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:_.jsx("p",{className:"text-error",children:n})}),_.jsxs("div",{className:"text-center mb-6",children:[_.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access your Christmas movie collection."}),_.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Track, rate, and discover Christmas movies!"}),_.jsxs("button",{onClick:s,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[_.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                  s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                  s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),_.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                  l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),_.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                  c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),_.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                  c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})]})]}),_.jsx("div",{className:"text-center mt-6",children:_.jsx("p",{className:"text-sm text-xmas-mute",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})},oL=()=>{const{currentUser:t}=hs(),[e,r]=ee.useState([]),[n,i]=ee.useState({}),[s,a]=ee.useState(!0),[o,l]=ee.useState(null),[c,f]=ee.useState("all");ee.useEffect(()=>{(async()=>{if(t)try{a(!0);const p=Ua(Zs(fr,"userMovies"),ul("userId","==",t.uid)),v=await Ba(p),m={},w=[];v.forEach(E=>{const y={id:E.id,...E.data()};m[y.movieId]=y,w.push(y.movieId)}),i(m);const T=[];if(w.length>0)for(let y=0;y<w.length;y+=10){const N=w.slice(y,y+10),j=Ua(Zs(fr,"movies"),ul("id","in",N));(await Ba(j)).forEach(g=>{T.push({id:g.id,...g.data()})})}r(T)}catch(p){console.error("Error fetching movies:",p),l("Failed to load movies")}finally{a(!1)}})()},[t]);const h=e.filter(d=>{const p=n[d.id];switch(c){case"watched":return p&&p.watched;case"unwatched":return!p||!p.watched;case"favorites":return p&&p.favorite;default:return!0}});return s?_.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):_.jsxs("div",{className:"container mx-auto px-4 py-8",children:[_.jsxs("div",{className:"flex justify-between items-center mb-8",children:[_.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"My Christmas Movies"}),_.jsx("div",{className:"flex gap-2",children:_.jsxs(xt,{to:"/import",className:"btn btn-primary",children:[_.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})})]}),o&&_.jsxs("div",{className:"alert alert-error mb-6",children:[_.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),_.jsx("span",{children:o})]}),_.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[_.jsx("button",{className:`tab ${c==="all"?"tab-active":""}`,onClick:()=>f("all"),children:"All Movies"}),_.jsx("button",{className:`tab ${c==="watched"?"tab-active":""}`,onClick:()=>f("watched"),children:"Watched"}),_.jsx("button",{className:`tab ${c==="unwatched"?"tab-active":""}`,onClick:()=>f("unwatched"),children:"Unwatched"}),_.jsx("button",{className:`tab ${c==="favorites"?"tab-active":""}`,onClick:()=>f("favorites"),children:"Favorites"})]}),h.length===0?_.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[_.jsx("h3",{className:"text-xl mb-4",children:"No movies found"}),_.jsx("p",{className:"mb-4",children:c==="all"?"You haven't added any Christmas movies yet.":`You don't have any ${c} Christmas movies.`}),_.jsxs(xt,{to:"/import",className:"btn btn-primary",children:[_.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):_.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:h.map(d=>{var v;const p=n[d.id];return _.jsxs("div",{className:"card bg-xmas-card shadow-xl",children:[_.jsxs("figure",{className:"relative h-64",children:[d.posterUrl?_.jsx("img",{src:d.posterUrl,alt:d.title,className:"w-full h-full object-cover"}):_.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800",children:_.jsx("i",{className:"fas fa-film text-4xl text-gray-500"})}),p&&p.watched&&_.jsx("div",{className:"absolute top-2 left-2 badge badge-success",children:"Watched"}),p&&p.favorite&&_.jsx("div",{className:"absolute top-2 right-2 text-yellow-400",children:_.jsx("i",{className:"fas fa-star"})})]}),_.jsxs("div",{className:"card-body",children:[_.jsx("h2",{className:"card-title font-christmas",children:d.title}),_.jsx("p",{className:"text-sm text-gray-400",children:(v=d.releaseDate)==null?void 0:v.substring(0,4)}),p&&p.rating&&_.jsxs("div",{className:"flex items-center mt-2",children:[_.jsx("span",{className:"text-yellow-400 mr-1",children:_.jsx("i",{className:"fas fa-star"})}),_.jsxs("span",{children:[p.rating,"/10"]})]}),_.jsx("div",{className:"card-actions justify-end mt-4",children:_.jsx(xt,{to:`/movies/${d.id}`,className:"btn btn-primary btn-sm",children:"View Details"})})]})]},d.id)})})]})},lL=()=>{const{movieId:t}=JR(),e=Ka(),{currentUser:r}=hs(),[n,i]=ee.useState(null),[s,a]=ee.useState(null),[o,l]=ee.useState(!0),[c,f]=ee.useState(null),[h,d]=ee.useState(!1),[p,v]=ee.useState(!1),[m,w]=ee.useState(""),[T,E]=ee.useState(null),[y,N]=ee.useState(""),[j,U]=ee.useState(!1);ee.useEffect(()=>{(async()=>{if(!(!r||!t))try{l(!0);const C=await yc(Qn(fr,"movies",t));if(!C.exists()){f("Movie not found"),l(!1);return}const P={id:C.id,...C.data()};i(P);const F=Qn(fr,"userMovies",`${r.uid}_${t}`),O=await yc(F);if(O.exists()){const de={id:O.id,...O.data()};a(de),v(de.watched),w(de.watchedDate?de.watchedDate.toISOString().split("T")[0]:""),E(de.rating||null),N(de.review||""),U(de.favorite)}}catch(C){console.error("Error fetching movie data:",C),f("Failed to load movie data")}finally{l(!1)}})()},[r,t]);const g=async()=>{if(!(!r||!t||!n))try{d(!0);const S=Qn(fr,"userMovies",`${r.uid}_${t}`),C={userId:r.uid,movieId:t,watched:p,favorite:j,updatedAt:new Date};p&&m&&(C.watchedDate=new Date(m)),T!==null&&(C.rating=T),y&&(C.review=y),s?await xS(S,C):await Ho(S,{...C,addedAt:new Date});const P=await yc(S);a({id:P.id,...P.data()})}catch(S){console.error("Error saving movie data:",S),f("Failed to save movie data")}finally{d(!1)}},k=async()=>{if(!(!r||!t||!window.confirm("Are you sure you want to remove this movie from your collection?")))try{d(!0);const S=Qn(fr,"userMovies",`${r.uid}_${t}`);await u6(S),e("/movies")}catch(S){console.error("Error deleting movie:",S),f("Failed to delete movie"),d(!1)}};return o?_.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):n?_.jsxs("div",{className:"container mx-auto px-4 py-8",children:[_.jsx("div",{className:"mb-4",children:_.jsxs(xt,{to:"/movies",className:"btn btn-ghost",children:[_.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),c&&_.jsxs("div",{className:"alert alert-error mb-6",children:[_.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),_.jsx("span",{children:c})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[_.jsxs("div",{className:"md:col-span-1",children:[_.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:n.posterUrl?_.jsx("img",{src:n.posterUrl,alt:n.title,className:"w-full h-auto"}):_.jsx("div",{className:"w-full h-96 flex items-center justify-center bg-gray-800",children:_.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),_.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[_.jsxs("button",{className:`btn ${j?"btn-warning":"btn-outline"} w-full`,onClick:()=>U(!j),children:[_.jsx("i",{className:`fas fa-star mr-2 ${j?"text-white":""}`}),j?"Favorited":"Add to Favorites"]}),_.jsxs("button",{className:`btn ${p?"btn-success":"btn-outline"} w-full`,onClick:()=>v(!p),children:[_.jsx("i",{className:`fas fa-check mr-2 ${p?"text-white":""}`}),p?"Watched":"Mark as Watched"]}),_.jsxs("button",{className:"btn btn-error btn-outline w-full",onClick:k,disabled:h,children:[_.jsx("i",{className:"fas fa-trash mr-2"}),"Remove from Collection"]})]})]}),_.jsxs("div",{className:"md:col-span-2",children:[_.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:n.title}),n.releaseDate&&_.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(n.releaseDate).getFullYear()}),n.genres&&n.genres.length>0&&_.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:n.genres.map((S,C)=>_.jsx("span",{className:"badge badge-outline",children:S},C))}),n.runtime&&_.jsxs("p",{className:"mb-4",children:[_.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(n.runtime/60),"h ",n.runtime%60,"m"]}),n.overview&&_.jsxs("div",{className:"mb-6",children:[_.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),_.jsx("p",{className:"text-gray-300",children:n.overview})]}),n.directors&&n.directors.length>0&&_.jsxs("div",{className:"mb-4",children:[_.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",n.directors.length>1?"s":""]}),_.jsx("p",{children:n.directors.join(", ")})]}),n.cast&&n.cast.length>0&&_.jsxs("div",{className:"mb-6",children:[_.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),_.jsx("p",{children:n.cast.slice(0,10).join(", ")})]}),_.jsx("div",{className:"divider"}),_.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold mb-4",children:"Your Rating & Review"}),p&&_.jsxs("div",{className:"form-control mb-4",children:[_.jsx("label",{className:"label",children:_.jsx("span",{className:"label-text",children:"Date Watched"})}),_.jsx("input",{type:"date",className:"input input-bordered",value:m,onChange:S=>w(S.target.value)})]}),_.jsxs("div",{className:"form-control mb-4",children:[_.jsx("label",{className:"label",children:_.jsx("span",{className:"label-text",children:"Your Rating"})}),_.jsx("div",{className:"rating rating-lg",children:[1,2,3,4,5,6,7,8,9,10].map(S=>_.jsx("input",{type:"radio",name:"rating",className:`mask mask-star-2 ${S<=5?"bg-orange-400":"bg-yellow-400"}`,checked:T===S,onChange:()=>E(S)},S))}),T&&_.jsx("div",{className:"mt-2",children:_.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>E(null),children:"Clear Rating"})})]}),_.jsxs("div",{className:"form-control mb-6",children:[_.jsx("label",{className:"label",children:_.jsx("span",{className:"label-text",children:"Your Review"})}),_.jsx("textarea",{className:"textarea textarea-bordered h-32",placeholder:"Write your thoughts about this movie...",value:y,onChange:S=>N(S.target.value)})]}),_.jsx("div",{className:"flex justify-end",children:_.jsx("button",{className:"btn btn-primary",onClick:g,disabled:h,children:h?_.jsxs(_.Fragment,{children:[_.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Saving..."]}):_.jsxs(_.Fragment,{children:[_.jsx("i",{className:"fas fa-save mr-2"}),"Save Changes"]})})})]})]})]}):_.jsxs("div",{className:"container mx-auto px-4 py-8",children:[_.jsxs("div",{className:"alert alert-error",children:[_.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),_.jsx("span",{children:"Movie not found"})]}),_.jsx("div",{className:"mt-4",children:_.jsx(xt,{to:"/movies",className:"btn btn-primary",children:"Back to Movies"})})]})},SS="https://api.themoviedb.org/3",cL="https://image.tmdb.org/t/p/w500",uL="https://image.tmdb.org/t/p/original",fL=async(t,e)=>{try{const r=await fetch(`${SS}/search/movie?api_key=${e}&query=${encodeURIComponent(t)}&include_adult=false`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()}catch(r){throw console.error("Error searching TMDB:",r),r}},hL=async(t,e)=>{try{const r=await fetch(`${SS}/movie/${t}?api_key=${e}&append_to_response=credits`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()}catch(r){throw console.error("Error fetching movie details:",r),r}},dL=t=>{var e,r,n;return{tmdbId:t.id,title:t.title,originalTitle:t.original_title,releaseDate:t.release_date,posterUrl:t.poster_path?`${cL}${t.poster_path}`:void 0,backdropUrl:t.backdrop_path?`${uL}${t.backdrop_path}`:void 0,overview:t.overview,runtime:t.runtime,genres:((e=t.genres)==null?void 0:e.map(i=>i.name))||[],directors:((r=t.credits)==null?void 0:r.crew.filter(i=>i.job==="Director").map(i=>i.name))||[],cast:((n=t.credits)==null?void 0:n.cast.slice(0,10).map(i=>i.name))||[],isChristmas:!0}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var AS=1252,pL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],kv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Sv=function(t){pL.indexOf(t)!=-1&&(AS=kv[0]=t)};function mL(){Sv(1252)}var Zn=function(t){Sv(t)};function IS(){Zn(1200),mL()}function wy(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function gL(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function CS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var tc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?gL(t.slice(2)):e==254&&r==255?CS(t.slice(2)):e==65279?t.slice(1):t},Tf=function(e){return String.fromCharCode(e)},Ey=function(e){return String.fromCharCode(e)},au,Ds="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ty(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Ds.charAt(s)+Ds.charAt(a)+Ds.charAt(o)+Ds.charAt(l);return e}function En(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=Ds.indexOf(t.charAt(c++)),a=Ds.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Ds.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ds.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Za=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ea(t){return Qe?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function ky(t){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Yn=function(e){return Qe?Za(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function eo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Av(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Av(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Cs=Qe?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Za(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function vL(t){for(var e=[],r=0,n=t.length+250,i=ea(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=ea(65535),n=65530)}return e.push(i.slice(0,r)),Cs(e)}var Yr=/\u0000/g,rc=/[\u0001-\u0006]/g;function $o(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ei(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}function Iv(t,e){var r=""+t;return r.length>=e?r:Ut(" ",e-r.length)+r}function Wh(t,e){var r=""+t;return r.length>=e?r:r+Ut(" ",e-r.length)}function xL(t,e){var r=""+Math.round(t);return r.length>=e?r:Ut("0",e-r.length)+r}function _L(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}var Sy=Math.pow(2,32);function mo(t,e){if(t>Sy||t<-Sy)return xL(t,e);var r=Math.round(t);return _L(r,e)}function Gh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Ay=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],jd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function yL(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Iy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},wL={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Kh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,f=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*a+s,f=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=f;if(f>e&&(c>e?(f=l,o=s):(f=c,o=a)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function Ea(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=IL(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var RS=new Date(1899,11,31,0,0,0),EL=RS.getTime(),TL=new Date(1900,2,1,0,0,0);function NS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=TL&&(r+=24*60*60*1e3),(r-(EL+(t.getTimezoneOffset()-RS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Cv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function kL(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SL(t){var e=t<0?12:11,r=Cv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function AL(t){var e=Cv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function ou(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=SL(t):e===10?r=t.toFixed(10).substr(0,12):r=AL(t),Cv(kL(r.toUpperCase()))}function ja(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):ou(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Un(14,NS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function IL(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function CL(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return jd[r.m-1][1];case 5:return jd[r.m-1][0];default:return jd[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Ay[r.q][0];default:return Ay[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ei(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=ei(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?ei(l,c):"";return f}function bs(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var PS=/%/g;function RL(t,e,r){var n=e.replace(PS,""),i=e.length-n.length;return Qi(t,n,r*Math.pow(10,2*i))+Ut("%",i)}function NL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Qi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function FS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+FS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var DS=/# (\?+)( ?)\/( ?)(\d+)/;function PL(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Ut(" ",t[1].length+1+t[4].length):Iv(a,t[1].length)+t[2]+"/"+t[3]+ei(o,t[4].length))}function FL(t,e,r){return r+(e===0?"":""+e)+Ut(" ",t[1].length+2+t[4].length)}var bS=/^#*0*\.([0#]+)/,OS=/\).*[0#]/,LS=/\(###\) ###\\?-####/;function Wr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Cy(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Ry(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function DL(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function bL(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Rn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(OS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Rn("n",n,r):"("+Rn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return NL(t,e,r);if(e.indexOf("%")!==-1)return RL(t,e,r);if(e.indexOf("E")!==-1)return FS(e,r);if(e.charCodeAt(0)===36)return"$"+Rn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+mo(l,e.length);if(e.match(/^[#?]+$/))return i=mo(r,0),i==="0"&&(i=""),i.length>e.length?i:Wr(e.substr(0,e.length-i.length))+i;if(s=e.match(DS))return PL(s,l,c);if(e.match(/^#+0+$/))return c+mo(l,e.length-e.indexOf("0"));if(s=e.match(bS))return i=Cy(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Wr(s[1])).replace(/\.$/,"."+Wr(s[1])).replace(/\.(\d*)$/,function(v,m){return"."+m+Ut("0",Wr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+Cy(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+bs(mo(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Rn(t,e,-r):bs(""+(Math.floor(r)+DL(r,s[1].length)))+"."+ei(Ry(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Rn(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=$o(Rn(t,e.replace(/[\\-]/g,""),r)),a=0,$o($o(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(LS))return i=Rn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Kh(l,Math.pow(10,a)-1,!1),i=""+c,f=Qi("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Wh(o[2],a),f.length<s[4].length&&(f=Wr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Kh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Iv(o[1],a)+s[2]+"/"+s[3]+Wh(o[2],a):Ut(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=mo(r,0),e.length<=i.length?i:Wr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Wr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Ry(r,s[1].length),r<0?"-"+Rn(t,e,-r):bs(bL(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ei(0,3-v.length):"")+v})+"."+ei(a,s[1].length);switch(e){case"###,##0.00":return Rn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=bs(mo(l,0));return p!=="0"?c+p:"";case"###,###.00":return Rn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Rn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function OL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Qi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function LL(t,e,r){var n=e.replace(PS,""),i=e.length-n.length;return Qi(t,n,r*Math.pow(10,2*i))+Ut("%",i)}function MS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+MS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function di(t,e,r){if(t.charCodeAt(0)===40&&!e.match(OS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?di("n",n,r):"("+di("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return OL(t,e,r);if(e.indexOf("%")!==-1)return LL(t,e,r);if(e.indexOf("E")!==-1)return MS(e,r);if(e.charCodeAt(0)===36)return"$"+di(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ei(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Wr(e.substr(0,e.length-i.length))+i;if(s=e.match(DS))return FL(s,l,c);if(e.match(/^#+0+$/))return c+ei(l,e.length-e.indexOf("0"));if(s=e.match(bS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Wr(s[1])).replace(/\.$/,"."+Wr(s[1])),i=i.replace(/\.(\d*)$/,function(v,m){return"."+m+Ut("0",Wr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+bs(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+di(t,e,-r):bs(""+r)+"."+Ut("0",s[1].length);if(s=e.match(/^#,#*,#0/))return di(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=$o(di(t,e.replace(/[\\-]/g,""),r)),a=0,$o($o(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(LS))return i=di(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Kh(l,Math.pow(10,a)-1,!1),i=""+c,f=Qi("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Wh(o[2],a),f.length<s[4].length&&(f=Wr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Kh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Iv(o[1],a)+s[2]+"/"+s[3]+Wh(o[2],a):Ut(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Wr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Wr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+di(t,e,-r):bs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ei(0,3-v.length):"")+v})+"."+ei(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=bs(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return di(t,e.slice(0,e.lastIndexOf(".")),r)+Wr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Qi(t,e,r){return(r|0)===r?di(t,e,r):Rn(t,e,r)}function ML(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var VS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function El(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Gh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(VS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function VL(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,f,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Gh(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=t.charAt(++a),v=p==="("||p===")"?p:"t";i[i.length]={t:v,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=Ea(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Ea(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=Ea(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",a+=5,d="h"):(m.t="t",++a),c==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(VS)){if(c==null&&(c=Ea(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",El(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var w=0,T=0,E;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,l="h",w<1&&(w=1);break;case"s":(E=i[a].v.match(/\.0+$/))&&(T=Math.max(T,E[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",N;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=CL(i[a].t.charCodeAt(0),i[a].v,c,T),i[a].t="t";break;case"n":case"?":for(N=a+1;i[N]!=null&&((o=i[N].t)==="?"||o==="D"||(o===" "||o==="t")&&i[N+1]!=null&&(i[N+1].t==="?"||i[N+1].t==="t"&&i[N+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[N].v==="/"||i[N].v===" "&&i[N+1]!=null&&i[N+1].t=="?"));)i[a].v+=i[N].v,i[N]={v:"",t:";"},++N;y+=i[a].v,a=N-1;break;case"G":i[a].t="t",i[a].v=ja(e,r);break}var j="",U,g;if(y.length>0){y.charCodeAt(0)==40?(U=e<0&&y.charCodeAt(0)===45?-e:e,g=Qi("n",y,U)):(U=e<0&&n>1?-e:e,g=Qi("n",y,U),U<0&&i[0]&&i[0].t=="t"&&(g=g.substr(1),i[0].v="-"+i[0].v)),N=g.length-1;var k=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){k=a;break}var S=i.length;if(k===i.length&&g.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(N>=i[a].v.length-1?(N-=i[a].v.length,i[a].v=g.substr(N+1,i[a].v.length)):N<0?i[a].v="":(i[a].v=g.substr(0,N+1),N=-1),i[a].t="t",S=a);N>=0&&S<i.length&&(i[S].v=g.substr(0,N+1)+i[S].v)}else if(k!==i.length&&g.indexOf("E")===-1){for(N=g.indexOf(".")-1,a=k;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")-1:i[a].v.length-1,j=i[a].v.substr(f+1);f>=0;--f)N>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(j=g.charAt(N--)+j);i[a].v=j,i[a].t="t",S=a}for(N>=0&&S<i.length&&(i[S].v=g.substr(0,N+1)+i[S].v),N=g.indexOf(".")+1,a=k;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==k)){for(f=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")+1:0,j=i[a].v.substr(0,f);f<i[a].v.length;++f)N<g.length&&(j+=g.charAt(N++));i[a].v=j,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(U=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Qi(i[a].t,i[a].v,U),i[a].t="t");var C="";for(a=0;a!==i.length;++a)i[a]!=null&&(C+=i[a].v);return C}var Ny=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Py(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function UL(t,e){var r=ML(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Ny),o=r[1].match(Ny);return Py(e,a)?[n,r[0]]:Py(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Un(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[t],n==null&&(n=r.table&&r.table[Iy[t]]||ze[Iy[t]]),n==null&&(n=wL[t]||"General");break}if(Gh(n,0))return ja(e,r);e instanceof Date&&(e=NS(e,r.date1904));var i=UL(n,e);if(Gh(i[1]))return ja(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return VL(i[1],e,r,i[0])}function Ia(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ze[r]==null){e<0&&(e=r);continue}if(ze[r]==t){e=r;break}}e<0&&(e=391)}return ze[e]=t,e}function US(){ze=yL()}var BL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},BS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function jL(t){var e=typeof t=="number"?ze[t]:t;return e=e.replace(BS,"(\\d+)"),new RegExp("^"+e+"$")}function zL(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(BS)||[]).forEach(function(h,d){var p=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:i=p;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?f:c+"T"+f}var HL=function(){var t={};t.version="1.2.0";function e(){for(var g=0,k=new Array(256),S=0;S!=256;++S)g=S,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,k[S]=g;return typeof Int32Array<"u"?new Int32Array(k):k}var r=e();function n(g){var k=0,S=0,C=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)P[C]=g[C];for(C=0;C!=256;++C)for(S=g[C],k=256+C;k<4096;k+=256)S=P[k]=S>>>8^g[S&255];var F=[];for(C=1;C!=16;++C)F[C-1]=typeof Int32Array<"u"?P.subarray(C*256,C*256+256):P.slice(C*256,C*256+256);return F}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],f=i[5],h=i[6],d=i[7],p=i[8],v=i[9],m=i[10],w=i[11],T=i[12],E=i[13],y=i[14];function N(g,k){for(var S=k^-1,C=0,P=g.length;C<P;)S=S>>>8^r[(S^g.charCodeAt(C++))&255];return~S}function j(g,k){for(var S=k^-1,C=g.length-15,P=0;P<C;)S=y[g[P++]^S&255]^E[g[P++]^S>>8&255]^T[g[P++]^S>>16&255]^w[g[P++]^S>>>24]^m[g[P++]]^v[g[P++]]^p[g[P++]]^d[g[P++]]^h[g[P++]]^f[g[P++]]^c[g[P++]]^l[g[P++]]^o[g[P++]]^a[g[P++]]^s[g[P++]]^r[g[P++]];for(C+=15;P<C;)S=S>>>8^r[(S^g[P++])&255];return~S}function U(g,k){for(var S=k^-1,C=0,P=g.length,F=0,O=0;C<P;)F=g.charCodeAt(C++),F<128?S=S>>>8^r[(S^F)&255]:F<2048?(S=S>>>8^r[(S^(192|F>>6&31))&255],S=S>>>8^r[(S^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,O=g.charCodeAt(C++)&1023,S=S>>>8^r[(S^(240|F>>8&7))&255],S=S>>>8^r[(S^(128|F>>2&63))&255],S=S>>>8^r[(S^(128|O>>6&15|(F&3)<<4))&255],S=S>>>8^r[(S^(128|O&63))&255]):(S=S>>>8^r[(S^(224|F>>12&15))&255],S=S>>>8^r[(S^(128|F>>6&63))&255],S=S>>>8^r[(S^(128|F&63))&255]);return~S}return t.table=r,t.bstr=N,t.buf=j,t.str=U,t}(),et=function(){var e={};e.version="1.2.1";function r(I,M){for(var R=I.split("/"),D=M.split("/"),b=0,L=0,K=Math.min(R.length,D.length);b<K;++b){if(L=R[b].length-D[b].length)return L;if(R[b]!=D[b])return R[b]<D[b]?-1:1}return R.length-D.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var M=I.lastIndexOf("/");return M===-1?I:I.slice(0,M+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var M=I.lastIndexOf("/");return M===-1?I:I.slice(M+1)}function s(I,M){typeof M=="string"&&(M=new Date(M));var R=M.getHours();R=R<<6|M.getMinutes(),R=R<<5|M.getSeconds()>>>1,I.write_shift(2,R);var D=M.getFullYear()-1980;D=D<<4|M.getMonth()+1,D=D<<5|M.getDate(),I.write_shift(2,D)}function a(I){var M=I.read_shift(2)&65535,R=I.read_shift(2)&65535,D=new Date,b=R&31;R>>>=5;var L=R&15;R>>>=4,D.setMilliseconds(0),D.setFullYear(R+1980),D.setMonth(L-1),D.setDate(b);var K=M&31;M>>>=5;var te=M&63;return M>>>=6,D.setHours(M),D.setMinutes(te),D.setSeconds(K<<1),D}function o(I){xr(I,0);for(var M={},R=0;I.l<=I.length-4;){var D=I.read_shift(2),b=I.read_shift(2),L=I.l+b,K={};switch(D){case 21589:R=I.read_shift(1),R&1&&(K.mtime=I.read_shift(4)),b>5&&(R&2&&(K.atime=I.read_shift(4)),R&4&&(K.ctime=I.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}I.l=L,M[D]=K}return M}var l;function c(){return l||(l={})}function f(I,M){if(I[0]==80&&I[1]==75)return ps(I,M);if((I[0]|32)==109&&(I[1]|32)==105)return oo(I,M);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var R=3,D=512,b=0,L=0,K=0,te=0,Z=0,J=[],Y=I.slice(0,512);xr(Y,0);var le=h(Y);switch(R=le[0],R){case 3:D=512;break;case 4:D=4096;break;case 0:if(le[1]==0)return ps(I,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}D!==512&&(Y=I.slice(0,D),xr(Y,28));var ye=I.slice(0,D);d(Y,R);var Ce=Y.read_shift(4,"i");if(R===3&&Ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ce);Y.l+=4,K=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),te=Y.read_shift(4,"i"),b=Y.read_shift(4,"i"),Z=Y.read_shift(4,"i"),L=Y.read_shift(4,"i");for(var pe=-1,we=0;we<109&&(pe=Y.read_shift(4,"i"),!(pe<0));++we)J[we]=pe;var De=p(I,D);w(Z,L,De,D,J);var nt=E(De,K,J,D);nt[K].name="!Directory",b>0&&te!==O&&(nt[te].name="!MiniFAT"),nt[J[0]].name="!FAT",nt.fat_addrs=J,nt.ssz=D;var Ke={},ht=[],rn=[],$e=[];y(K,nt,De,ht,b,Ke,rn,te),v(rn,$e,ht),ht.shift();var ut={FileIndex:rn,FullPaths:$e};return M&&M.raw&&(ut.raw={header:ye,sectors:De}),ut}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(de,"Header Signature: "),I.l+=16;var M=I.read_shift(2,"u");return[I.read_shift(2,"u"),M]}function d(I,M){var R=9;switch(I.l+=2,R=I.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function p(I,M){for(var R=Math.ceil(I.length/M)-1,D=[],b=1;b<R;++b)D[b-1]=I.slice(b*M,(b+1)*M);return D[R-1]=I.slice(R*M),D}function v(I,M,R){for(var D=0,b=0,L=0,K=0,te=0,Z=R.length,J=[],Y=[];D<Z;++D)J[D]=Y[D]=D,M[D]=R[D];for(;te<Y.length;++te)D=Y[te],b=I[D].L,L=I[D].R,K=I[D].C,J[D]===D&&(b!==-1&&J[b]!==b&&(J[D]=J[b]),L!==-1&&J[L]!==L&&(J[D]=J[L])),K!==-1&&(J[K]=D),b!==-1&&D!=J[D]&&(J[b]=J[D],Y.lastIndexOf(b)<te&&Y.push(b)),L!==-1&&D!=J[D]&&(J[L]=J[D],Y.lastIndexOf(L)<te&&Y.push(L));for(D=1;D<Z;++D)J[D]===D&&(L!==-1&&J[L]!==L?J[D]=J[L]:b!==-1&&J[b]!==b&&(J[D]=J[b]));for(D=1;D<Z;++D)if(I[D].type!==0){if(te=D,te!=J[te])do te=J[te],M[D]=M[te]+"/"+M[D];while(te!==0&&J[te]!==-1&&te!=J[te]);J[D]=-1}for(M[0]+="/",D=1;D<Z;++D)I[D].type!==2&&(M[D]+="/")}function m(I,M,R){for(var D=I.start,b=I.size,L=[],K=D;R&&b>0&&K>=0;)L.push(M.slice(K*F,K*F+F)),b-=F,K=ma(R,K*4);return L.length===0?er(0):Cs(L).slice(0,I.size)}function w(I,M,R,D,b){var L=O;if(I===O){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var K=R[I],te=(D>>>2)-1;if(!K)return;for(var Z=0;Z<te&&(L=ma(K,Z*4))!==O;++Z)b.push(L);w(ma(K,D-4),M-1,R,D,b)}}function T(I,M,R,D,b){var L=[],K=[];b||(b=[]);var te=D-1,Z=0,J=0;for(Z=M;Z>=0;){b[Z]=!0,L[L.length]=Z,K.push(I[Z]);var Y=R[Math.floor(Z*4/D)];if(J=Z*4&te,D<4+J)throw new Error("FAT boundary crossed: "+Z+" 4 "+D);if(!I[Y])break;Z=ma(I[Y],J)}return{nodes:L,data:jy([K])}}function E(I,M,R,D){var b=I.length,L=[],K=[],te=[],Z=[],J=D-1,Y=0,le=0,ye=0,Ce=0;for(Y=0;Y<b;++Y)if(te=[],ye=Y+M,ye>=b&&(ye-=b),!K[ye]){Z=[];var pe=[];for(le=ye;le>=0;){pe[le]=!0,K[le]=!0,te[te.length]=le,Z.push(I[le]);var we=R[Math.floor(le*4/D)];if(Ce=le*4&J,D<4+Ce)throw new Error("FAT boundary crossed: "+le+" 4 "+D);if(!I[we]||(le=ma(I[we],Ce),pe[le]))break}L[ye]={nodes:te,data:jy([Z])}}return L}function y(I,M,R,D,b,L,K,te){for(var Z=0,J=D.length?2:0,Y=M[I].data,le=0,ye=0,Ce;le<Y.length;le+=128){var pe=Y.slice(le,le+128);xr(pe,64),ye=pe.read_shift(2),Ce=Dv(pe,0,ye-J),D.push(Ce);var we={name:Ce,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},De=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);De!==0&&(we.ct=N(pe,pe.l-8));var nt=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);nt!==0&&(we.mt=N(pe,pe.l-8)),we.start=pe.read_shift(4,"i"),we.size=pe.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=O,we.name=""),we.type===5?(Z=we.start,b>0&&Z!==O&&(M[Z].name="!StreamData")):we.size>=4096?(we.storage="fat",M[we.start]===void 0&&(M[we.start]=T(R,we.start,M.fat_addrs,M.ssz)),M[we.start].name=we.name,we.content=M[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:Z!==O&&we.start!==O&&M[Z]&&(we.content=m(we,M[Z].data,(M[te]||{}).data))),we.content&&xr(we.content,0),L[Ce]=we,K.push(we)}}function N(I,M){return new Date((gn(I,M+4)/1e7*Math.pow(2,32)+gn(I,M)/1e7-11644473600)*1e3)}function j(I,M){return c(),f(l.readFileSync(I),M)}function U(I,M){var R=M&&M.type;switch(R||Qe&&Buffer.isBuffer(I)&&(R="buffer"),R||"base64"){case"file":return j(I,M);case"base64":return f(Yn(En(I)),M);case"binary":return f(Yn(I),M)}return f(I,M)}function g(I,M){var R=M||{},D=R.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=D+"/",I.FileIndex[0]={name:D,type:5}),R.CLSID&&(I.FileIndex[0].clsid=R.CLSID),k(I)}function k(I){var M="Sh33tJ5";if(!et.find(I,"/"+M)){var R=er(4);R[0]=55,R[1]=R[3]=50,R[2]=54,I.FileIndex.push({name:M,type:2,content:R,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+M),S(I)}}function S(I,M){g(I);for(var R=!1,D=!1,b=I.FullPaths.length-1;b>=0;--b){var L=I.FileIndex[b];switch(L.type){case 0:D?R=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:D=!0,isNaN(L.R*L.L*L.C)&&(R=!0),L.R>-1&&L.L>-1&&L.R==L.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!M)){var K=new Date(1987,1,19),te=0,Z=Object.create?Object.create(null):{},J=[];for(b=0;b<I.FullPaths.length;++b)Z[I.FullPaths[b]]=!0,I.FileIndex[b].type!==0&&J.push([I.FullPaths[b],I.FileIndex[b]]);for(b=0;b<J.length;++b){var Y=n(J[b][0]);D=Z[Y],D||(J.push([Y,{name:i(Y).replace("/",""),type:1,clsid:Ie,ct:K,mt:K,content:null}]),Z[Y]=!0)}for(J.sort(function(Ce,pe){return r(Ce[0],pe[0])}),I.FullPaths=[],I.FileIndex=[],b=0;b<J.length;++b)I.FullPaths[b]=J[b][0],I.FileIndex[b]=J[b][1];for(b=0;b<J.length;++b){var le=I.FileIndex[b],ye=I.FullPaths[b];if(le.name=i(ye).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||Ie,b===0)le.C=J.length>1?1:-1,le.size=0,le.type=5;else if(ye.slice(-1)=="/"){for(te=b+1;te<J.length&&n(I.FullPaths[te])!=ye;++te);for(le.C=te>=J.length?-1:te,te=b+1;te<J.length&&n(I.FullPaths[te])!=n(ye);++te);le.R=te>=J.length?-1:te,le.type=1}else n(I.FullPaths[b+1]||"")==n(ye)&&(le.R=b+1),le.type=2}}}function C(I,M){var R=M||{};if(R.fileType=="mad")return Zt(I,R);switch(S(I),R.fileType){case"zip":return bi(I,R)}var D=function(Ce){for(var pe=0,we=0,De=0;De<Ce.FileIndex.length;++De){var nt=Ce.FileIndex[De];if(nt.content){var Ke=nt.content.length;Ke>0&&(Ke<4096?pe+=Ke+63>>6:we+=Ke+511>>9)}}for(var ht=Ce.FullPaths.length+3>>2,rn=pe+7>>3,$e=pe+127>>7,ut=rn+we+ht+$e,pr=ut+127>>7,In=pr<=109?0:Math.ceil((pr-109)/127);ut+pr+In+127>>7>pr;)In=++pr<=109?0:Math.ceil((pr-109)/127);var Je=[1,In,pr,$e,ht,we,pe,0];return Ce.FileIndex[0].size=pe<<6,Je[7]=(Ce.FileIndex[0].start=Je[0]+Je[1]+Je[2]+Je[3]+Je[4]+Je[5])+(Je[6]+7>>3),Je}(I),b=er(D[7]<<9),L=0,K=0;{for(L=0;L<8;++L)b.write_shift(1,ve[L]);for(L=0;L<8;++L)b.write_shift(2,0);for(b.write_shift(2,62),b.write_shift(2,3),b.write_shift(2,65534),b.write_shift(2,9),b.write_shift(2,6),L=0;L<3;++L)b.write_shift(2,0);for(b.write_shift(4,0),b.write_shift(4,D[2]),b.write_shift(4,D[0]+D[1]+D[2]+D[3]-1),b.write_shift(4,0),b.write_shift(4,4096),b.write_shift(4,D[3]?D[0]+D[1]+D[2]-1:O),b.write_shift(4,D[3]),b.write_shift(-4,D[1]?D[0]-1:O),b.write_shift(4,D[1]),L=0;L<109;++L)b.write_shift(-4,L<D[2]?D[1]+L:-1)}if(D[1])for(K=0;K<D[1];++K){for(;L<236+K*127;++L)b.write_shift(-4,L<D[2]?D[1]+L:-1);b.write_shift(-4,K===D[1]-1?O:K+1)}var te=function(Ce){for(K+=Ce;L<K-1;++L)b.write_shift(-4,L+1);Ce&&(++L,b.write_shift(-4,O))};for(K=L=0,K+=D[1];L<K;++L)b.write_shift(-4,oe.DIFSECT);for(K+=D[2];L<K;++L)b.write_shift(-4,oe.FATSECT);te(D[3]),te(D[4]);for(var Z=0,J=0,Y=I.FileIndex[0];Z<I.FileIndex.length;++Z)Y=I.FileIndex[Z],Y.content&&(J=Y.content.length,!(J<4096)&&(Y.start=K,te(J+511>>9)));for(te(D[6]+7>>3);b.l&511;)b.write_shift(-4,oe.ENDOFCHAIN);for(K=L=0,Z=0;Z<I.FileIndex.length;++Z)Y=I.FileIndex[Z],Y.content&&(J=Y.content.length,!(!J||J>=4096)&&(Y.start=K,te(J+63>>6)));for(;b.l&511;)b.write_shift(-4,oe.ENDOFCHAIN);for(L=0;L<D[4]<<2;++L){var le=I.FullPaths[L];if(!le||le.length===0){for(Z=0;Z<17;++Z)b.write_shift(4,0);for(Z=0;Z<3;++Z)b.write_shift(4,-1);for(Z=0;Z<12;++Z)b.write_shift(4,0);continue}Y=I.FileIndex[L],L===0&&(Y.start=Y.size?Y.start-1:O);var ye=L===0&&R.root||Y.name;if(J=2*(ye.length+1),b.write_shift(64,ye,"utf16le"),b.write_shift(2,J),b.write_shift(1,Y.type),b.write_shift(1,Y.color),b.write_shift(-4,Y.L),b.write_shift(-4,Y.R),b.write_shift(-4,Y.C),Y.clsid)b.write_shift(16,Y.clsid,"hex");else for(Z=0;Z<4;++Z)b.write_shift(4,0);b.write_shift(4,Y.state||0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,Y.start),b.write_shift(4,Y.size),b.write_shift(4,0)}for(L=1;L<I.FileIndex.length;++L)if(Y=I.FileIndex[L],Y.size>=4096)if(b.l=Y.start+1<<9,Qe&&Buffer.isBuffer(Y.content))Y.content.copy(b,b.l,0,Y.size),b.l+=Y.size+511&-512;else{for(Z=0;Z<Y.size;++Z)b.write_shift(1,Y.content[Z]);for(;Z&511;++Z)b.write_shift(1,0)}for(L=1;L<I.FileIndex.length;++L)if(Y=I.FileIndex[L],Y.size>0&&Y.size<4096)if(Qe&&Buffer.isBuffer(Y.content))Y.content.copy(b,b.l,0,Y.size),b.l+=Y.size+63&-64;else{for(Z=0;Z<Y.size;++Z)b.write_shift(1,Y.content[Z]);for(;Z&63;++Z)b.write_shift(1,0)}if(Qe)b.l=b.length;else for(;b.l<b.length;)b.write_shift(1,0);return b}function P(I,M){var R=I.FullPaths.map(function(Z){return Z.toUpperCase()}),D=R.map(function(Z){var J=Z.split("/");return J[J.length-(Z.slice(-1)=="/"?2:1)]}),b=!1;M.charCodeAt(0)===47?(b=!0,M=R[0].slice(0,-1)+M):b=M.indexOf("/")!==-1;var L=M.toUpperCase(),K=b===!0?R.indexOf(L):D.indexOf(L);if(K!==-1)return I.FileIndex[K];var te=!L.match(rc);for(L=L.replace(Yr,""),te&&(L=L.replace(rc,"!")),K=0;K<R.length;++K)if((te?R[K].replace(rc,"!"):R[K]).replace(Yr,"")==L||(te?D[K].replace(rc,"!"):D[K]).replace(Yr,"")==L)return I.FileIndex[K];return null}var F=64,O=-2,de="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],Ie="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:O,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(I,M,R){c();var D=C(I,R);l.writeFileSync(M,D)}function G(I){for(var M=new Array(I.length),R=0;R<I.length;++R)M[R]=String.fromCharCode(I[R]);return M.join("")}function ue(I,M){var R=C(I,M);switch(M&&M.type||"buffer"){case"file":return c(),l.writeFileSync(M.filename,R),R;case"binary":return typeof R=="string"?R:G(R);case"base64":return Ty(typeof R=="string"?R:G(R));case"buffer":if(Qe)return Buffer.isBuffer(R)?R:Za(R);case"array":return typeof R=="string"?Yn(R):R}return R}var Ee;function B(I){try{var M=I.InflateRaw,R=new M;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)Ee=I;else throw new Error("zlib does not expose bytesRead")}catch(D){console.error("cannot use native zlib: "+(D.message||D))}}function X(I,M){if(!Ee)return Di(I,M);var R=Ee.InflateRaw,D=new R,b=D._processChunk(I.slice(I.l),D._finishFlushFlag);return I.l+=D.bytesRead,b}function q(I){return Ee?Ee.deflateRawSync(I):Ve(I)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ae(I){var M=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(M>>16|M>>8|M)&255}for(var he=typeof Uint8Array<"u",ge=he?new Uint8Array(256):[],He=0;He<256;++He)ge[He]=Ae(He);function z(I,M){var R=ge[I&255];return M<=8?R>>>8-M:(R=R<<8|ge[I>>8&255],M<=16?R>>>16-M:(R=R<<8|ge[I>>16&255],R>>>24-M))}function at(I,M){var R=M&7,D=M>>>3;return(I[D]|(R<=6?0:I[D+1]<<8))>>>R&3}function We(I,M){var R=M&7,D=M>>>3;return(I[D]|(R<=5?0:I[D+1]<<8))>>>R&7}function rt(I,M){var R=M&7,D=M>>>3;return(I[D]|(R<=4?0:I[D+1]<<8))>>>R&15}function be(I,M){var R=M&7,D=M>>>3;return(I[D]|(R<=3?0:I[D+1]<<8))>>>R&31}function Se(I,M){var R=M&7,D=M>>>3;return(I[D]|(R<=1?0:I[D+1]<<8))>>>R&127}function Et(I,M,R){var D=M&7,b=M>>>3,L=(1<<R)-1,K=I[b]>>>D;return R<8-D||(K|=I[b+1]<<8-D,R<16-D)||(K|=I[b+2]<<16-D,R<24-D)||(K|=I[b+3]<<24-D),K&L}function ar(I,M,R){var D=M&7,b=M>>>3;return D<=5?I[b]|=(R&7)<<D:(I[b]|=R<<D&255,I[b+1]=(R&7)>>8-D),M+3}function Ar(I,M,R){var D=M&7,b=M>>>3;return R=(R&1)<<D,I[b]|=R,M+1}function en(I,M,R){var D=M&7,b=M>>>3;return R<<=D,I[b]|=R&255,R>>>=8,I[b+1]=R,M+8}function Pi(I,M,R){var D=M&7,b=M>>>3;return R<<=D,I[b]|=R&255,R>>>=8,I[b+1]=R&255,I[b+2]=R>>>8,M+16}function tn(I,M){var R=I.length,D=2*R>M?2*R:M+5,b=0;if(R>=M)return I;if(Qe){var L=ky(D);if(I.copy)I.copy(L);else for(;b<I.length;++b)L[b]=I[b];return L}else if(he){var K=new Uint8Array(D);if(K.set)K.set(I);else for(;b<R;++b)K[b]=I[b];return K}return I.length=D,I}function Tt(I){for(var M=new Array(I),R=0;R<I;++R)M[R]=0;return M}function or(I,M,R){var D=1,b=0,L=0,K=0,te=0,Z=I.length,J=he?new Uint16Array(32):Tt(32);for(L=0;L<32;++L)J[L]=0;for(L=Z;L<R;++L)I[L]=0;Z=I.length;var Y=he?new Uint16Array(Z):Tt(Z);for(L=0;L<Z;++L)J[b=I[L]]++,D<b&&(D=b),Y[L]=0;for(J[0]=0,L=1;L<=D;++L)J[L+16]=te=te+J[L-1]<<1;for(L=0;L<Z;++L)te=I[L],te!=0&&(Y[L]=J[te+16]++);var le=0;for(L=0;L<Z;++L)if(le=I[L],le!=0)for(te=z(Y[L],D)>>D-le,K=(1<<D+4-le)-1;K>=0;--K)M[te|K<<le]=le&15|L<<4;return D}var gt=he?new Uint16Array(512):Tt(512),kt=he?new Uint16Array(32):Tt(32);if(!he){for(var ft=0;ft<512;++ft)gt[ft]=0;for(ft=0;ft<32;++ft)kt[ft]=0}(function(){for(var I=[],M=0;M<32;M++)I.push(5);or(I,kt,32);var R=[];for(M=0;M<=143;M++)R.push(8);for(;M<=255;M++)R.push(9);for(;M<=279;M++)R.push(7);for(;M<=287;M++)R.push(8);or(R,gt,288)})();var Ft=function(){for(var M=he?new Uint8Array(32768):[],R=0,D=0;R<xe.length-1;++R)for(;D<xe[R+1];++D)M[D]=R;for(;D<32768;++D)M[D]=29;var b=he?new Uint8Array(259):[];for(R=0,D=0;R<ae.length-1;++R)for(;D<ae[R+1];++D)b[D]=R;function L(te,Z){for(var J=0;J<te.length;){var Y=Math.min(65535,te.length-J),le=J+Y==te.length;for(Z.write_shift(1,+le),Z.write_shift(2,Y),Z.write_shift(2,~Y&65535);Y-- >0;)Z[Z.l++]=te[J++]}return Z.l}function K(te,Z){for(var J=0,Y=0,le=he?new Uint16Array(32768):[];Y<te.length;){var ye=Math.min(65535,te.length-Y);if(ye<10){for(J=ar(Z,J,+(Y+ye==te.length)),J&7&&(J+=8-(J&7)),Z.l=J/8|0,Z.write_shift(2,ye),Z.write_shift(2,~ye&65535);ye-- >0;)Z[Z.l++]=te[Y++];J=Z.l*8;continue}J=ar(Z,J,+(Y+ye==te.length)+2);for(var Ce=0;ye-- >0;){var pe=te[Y];Ce=(Ce<<5^pe)&32767;var we=-1,De=0;if((we=le[Ce])&&(we|=Y&-32768,we>Y&&(we-=32768),we<Y))for(;te[we+De]==te[Y+De]&&De<250;)++De;if(De>2){pe=b[De],pe<=22?J=en(Z,J,ge[pe+1]>>1)-1:(en(Z,J,3),J+=5,en(Z,J,ge[pe-23]>>5),J+=3);var nt=pe<8?0:pe-4>>2;nt>0&&(Pi(Z,J,De-ae[pe]),J+=nt),pe=M[Y-we],J=en(Z,J,ge[pe]>>3),J-=3;var Ke=pe<4?0:pe-2>>1;Ke>0&&(Pi(Z,J,Y-we-xe[pe]),J+=Ke);for(var ht=0;ht<De;++ht)le[Ce]=Y&32767,Ce=(Ce<<5^te[Y])&32767,++Y;ye-=De-1}else pe<=143?pe=pe+48:J=Ar(Z,J,1),J=en(Z,J,ge[pe]),le[Ce]=Y&32767,++Y}J=en(Z,J,0)-1}return Z.l=(J+7)/8|0,Z.l}return function(Z,J){return Z.length<8?L(Z,J):K(Z,J)}}();function Ve(I){var M=er(50+Math.floor(I.length*1.1)),R=Ft(I,M);return M.slice(0,R)}var vt=he?new Uint16Array(32768):Tt(32768),$t=he?new Uint16Array(32768):Tt(32768),ct=he?new Uint16Array(128):Tt(128),hn=1,Fi=1;function so(I,M){var R=be(I,M)+257;M+=5;var D=be(I,M)+1;M+=5;var b=rt(I,M)+4;M+=4;for(var L=0,K=he?new Uint8Array(19):Tt(19),te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,J=he?new Uint8Array(8):Tt(8),Y=he?new Uint8Array(8):Tt(8),le=K.length,ye=0;ye<b;++ye)K[W[ye]]=L=We(I,M),Z<L&&(Z=L),J[L]++,M+=3;var Ce=0;for(J[0]=0,ye=1;ye<=Z;++ye)Y[ye]=Ce=Ce+J[ye-1]<<1;for(ye=0;ye<le;++ye)(Ce=K[ye])!=0&&(te[ye]=Y[Ce]++);var pe=0;for(ye=0;ye<le;++ye)if(pe=K[ye],pe!=0){Ce=ge[te[ye]]>>8-pe;for(var we=(1<<7-pe)-1;we>=0;--we)ct[Ce|we<<pe]=pe&7|ye<<3}var De=[];for(Z=1;De.length<R+D;)switch(Ce=ct[Se(I,M)],M+=Ce&7,Ce>>>=3){case 16:for(L=3+at(I,M),M+=2,Ce=De[De.length-1];L-- >0;)De.push(Ce);break;case 17:for(L=3+We(I,M),M+=3;L-- >0;)De.push(0);break;case 18:for(L=11+Se(I,M),M+=7;L-- >0;)De.push(0);break;default:De.push(Ce),Z<Ce&&(Z=Ce);break}var nt=De.slice(0,R),Ke=De.slice(R);for(ye=R;ye<286;++ye)nt[ye]=0;for(ye=D;ye<30;++ye)Ke[ye]=0;return hn=or(nt,vt,286),Fi=or(Ke,$t,30),M}function Sl(I,M){if(I[0]==3&&!(I[1]&3))return[ea(M),2];for(var R=0,D=0,b=ky(M||1<<18),L=0,K=b.length>>>0,te=0,Z=0;!(D&1);){if(D=We(I,R),R+=3,D>>>1)D>>1==1?(te=9,Z=5):(R=so(I,R),te=hn,Z=Fi);else{R&7&&(R+=8-(R&7));var J=I[R>>>3]|I[(R>>>3)+1]<<8;if(R+=32,J>0)for(!M&&K<L+J&&(b=tn(b,L+J),K=b.length);J-- >0;)b[L++]=I[R>>>3],R+=8;continue}for(;;){!M&&K<L+32767&&(b=tn(b,L+32767),K=b.length);var Y=Et(I,R,te),le=D>>>1==1?gt[Y]:vt[Y];if(R+=le&15,le>>>=4,!(le>>>8&255))b[L++]=le;else{if(le==256)break;le-=257;var ye=le<8?0:le-4>>2;ye>5&&(ye=0);var Ce=L+ae[le];ye>0&&(Ce+=Et(I,R,ye),R+=ye),Y=Et(I,R,Z),le=D>>>1==1?kt[Y]:$t[Y],R+=le&15,le>>>=4;var pe=le<4?0:le-2>>1,we=xe[le];for(pe>0&&(we+=Et(I,R,pe),R+=pe),!M&&K<Ce&&(b=tn(b,Ce+100),K=b.length);L<Ce;)b[L]=b[L-we],++L}}}return M?[b,R+7>>>3]:[b.slice(0,L),R+7>>>3]}function Di(I,M){var R=I.slice(I.l||0),D=Sl(R,M);return I.l+=D[1],D[0]}function li(I,M){if(I)typeof console<"u"&&console.error(M);else throw new Error(M)}function ps(I,M){var R=I;xr(R,0);var D=[],b=[],L={FileIndex:D,FullPaths:b};g(L,{root:M.root});for(var K=R.length-4;(R[K]!=80||R[K+1]!=75||R[K+2]!=5||R[K+3]!=6)&&K>=0;)--K;R.l=K+4,R.l+=4;var te=R.read_shift(2);R.l+=6;var Z=R.read_shift(4);for(R.l=Z,K=0;K<te;++K){R.l+=20;var J=R.read_shift(4),Y=R.read_shift(4),le=R.read_shift(2),ye=R.read_shift(2),Ce=R.read_shift(2);R.l+=8;var pe=R.read_shift(4),we=o(R.slice(R.l+le,R.l+le+ye));R.l+=le+ye+Ce;var De=R.l;R.l=pe+4,jn(R,J,Y,L,we),R.l=De}return L}function jn(I,M,R,D,b){I.l+=2;var L=I.read_shift(2),K=I.read_shift(2),te=a(I);if(L&8257)throw new Error("Unsupported ZIP encryption");for(var Z=I.read_shift(4),J=I.read_shift(4),Y=I.read_shift(4),le=I.read_shift(2),ye=I.read_shift(2),Ce="",pe=0;pe<le;++pe)Ce+=String.fromCharCode(I[I.l++]);if(ye){var we=o(I.slice(I.l,I.l+ye));(we[21589]||{}).mt&&(te=we[21589].mt),((b||{})[21589]||{}).mt&&(te=b[21589].mt)}I.l+=ye;var De=I.slice(I.l,I.l+J);switch(K){case 8:De=X(I,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var nt=!1;L&8&&(Z=I.read_shift(4),Z==134695760&&(Z=I.read_shift(4),nt=!0),J=I.read_shift(4),Y=I.read_shift(4)),J!=M&&li(nt,"Bad compressed size: "+M+" != "+J),Y!=R&&li(nt,"Bad uncompressed size: "+R+" != "+Y),Q(D,Ce,De,{unsafe:!0,mt:te})}function bi(I,M){var R=M||{},D=[],b=[],L=er(1),K=R.compression?8:0,te=0,Z=0,J=0,Y=0,le=0,ye=I.FullPaths[0],Ce=ye,pe=I.FileIndex[0],we=[],De=0;for(Z=1;Z<I.FullPaths.length;++Z)if(Ce=I.FullPaths[Z].slice(ye.length),pe=I.FileIndex[Z],!(!pe.size||!pe.content||Ce=="Sh33tJ5")){var nt=Y,Ke=er(Ce.length);for(J=0;J<Ce.length;++J)Ke.write_shift(1,Ce.charCodeAt(J)&127);Ke=Ke.slice(0,Ke.l),we[le]=HL.buf(pe.content,0);var ht=pe.content;K==8&&(ht=q(ht)),L=er(30),L.write_shift(4,67324752),L.write_shift(2,20),L.write_shift(2,te),L.write_shift(2,K),pe.mt?s(L,pe.mt):L.write_shift(4,0),L.write_shift(-4,we[le]),L.write_shift(4,ht.length),L.write_shift(4,pe.content.length),L.write_shift(2,Ke.length),L.write_shift(2,0),Y+=L.length,D.push(L),Y+=Ke.length,D.push(Ke),Y+=ht.length,D.push(ht),L=er(46),L.write_shift(4,33639248),L.write_shift(2,0),L.write_shift(2,20),L.write_shift(2,te),L.write_shift(2,K),L.write_shift(4,0),L.write_shift(-4,we[le]),L.write_shift(4,ht.length),L.write_shift(4,pe.content.length),L.write_shift(2,Ke.length),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(4,0),L.write_shift(4,nt),De+=L.l,b.push(L),De+=Ke.length,b.push(Ke),++le}return L=er(22),L.write_shift(4,101010256),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,le),L.write_shift(2,le),L.write_shift(4,De),L.write_shift(4,Y),L.write_shift(2,0),Cs([Cs(D),Cs(b),L])}var ci={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Sn(I,M){if(I.ctype)return I.ctype;var R=I.name||"",D=R.match(/\.([^\.]+)$/);return D&&ci[D[1]]||M&&(D=(R=M).match(/[\.\\]([^\.\\])+$/),D&&ci[D[1]])?ci[D[1]]:"application/octet-stream"}function ao(I){for(var M=Ty(I),R=[],D=0;D<M.length;D+=76)R.push(M.slice(D,D+76));return R.join(`\r
`)+`\r
`}function Oi(I){var M=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(J){var Y=J.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],D=M.split(`\r
`),b=0;b<D.length;++b){var L=D[b];if(L.length==0){R.push("");continue}for(var K=0;K<L.length;){var te=76,Z=L.slice(K,K+te);Z.charAt(te-1)=="="?te--:Z.charAt(te-2)=="="?te-=2:Z.charAt(te-3)=="="&&(te-=3),Z=L.slice(K,K+te),K+=te,K<L.length&&(Z+="="),R.push(Z)}}return R.join(`\r
`)}function Li(I){for(var M=[],R=0;R<I.length;++R){for(var D=I[R];R<=I.length&&D.charAt(D.length-1)=="=";)D=D.slice(0,D.length-1)+I[++R];M.push(D)}for(var b=0;b<M.length;++b)M[b]=M[b].replace(/[=][0-9A-Fa-f]{2}/g,function(L){return String.fromCharCode(parseInt(L.slice(1),16))});return Yn(M.join(`\r
`))}function An(I,M,R){for(var D="",b="",L="",K,te=0;te<10;++te){var Z=M[te];if(!Z||Z.match(/^\s*$/))break;var J=Z.match(/^(.*?):\s*([^\s].*)$/);if(J)switch(J[1].toLowerCase()){case"content-location":D=J[2].trim();break;case"content-type":L=J[2].trim();break;case"content-transfer-encoding":b=J[2].trim();break}}switch(++te,b.toLowerCase()){case"base64":K=Yn(En(M.slice(te).join("")));break;case"quoted-printable":K=Li(M.slice(te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+b)}var Y=Q(I,D.slice(R.length),K,{unsafe:!0});L&&(Y.ctype=L)}function oo(I,M){if(G(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=M&&M.root||"",D=(Qe&&Buffer.isBuffer(I)?I.toString("binary"):G(I)).split(`\r
`),b=0,L="";for(b=0;b<D.length;++b)if(L=D[b],!!/^Content-Location:/i.test(L)&&(L=L.slice(L.indexOf("file")),R||(R=L.slice(0,L.lastIndexOf("/")+1)),L.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),L.slice(0,R.length)!=R););var K=(D[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var te="--"+(K[1]||""),Z=[],J=[],Y={FileIndex:Z,FullPaths:J};g(Y);var le,ye=0;for(b=0;b<D.length;++b){var Ce=D[b];Ce!==te&&Ce!==te+"--"||(ye++&&An(Y,D.slice(le,b),R),le=b)}return Y}function Zt(I,M){var R=M||{},D=R.boundary||"SheetJS";D="------="+D;for(var b=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+D.slice(2)+'"',"","",""],L=I.FullPaths[0],K=L,te=I.FileIndex[0],Z=1;Z<I.FullPaths.length;++Z)if(K=I.FullPaths[Z].slice(L.length),te=I.FileIndex[Z],!(!te.size||!te.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(De){return"_x"+De.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(De){return"_u"+De.charCodeAt(0).toString(16)+"_"});for(var J=te.content,Y=Qe&&Buffer.isBuffer(J)?J.toString("binary"):G(J),le=0,ye=Math.min(1024,Y.length),Ce=0,pe=0;pe<=ye;++pe)(Ce=Y.charCodeAt(pe))>=32&&Ce<128&&++le;var we=le>=ye*4/5;b.push(D),b.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+K),b.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),b.push("Content-Type: "+Sn(te,K)),b.push(""),b.push(we?Oi(Y):ao(Y))}return b.push(D+`--\r
`),b.join(`\r
`)}function H(I){var M={};return g(M,I),M}function Q(I,M,R,D){var b=D&&D.unsafe;b||g(I);var L=!b&&et.find(I,M);if(!L){var K=I.FullPaths[0];M.slice(0,K.length)==K?K=M:(K.slice(-1)!="/"&&(K+="/"),K=(K+M).replace("//","/")),L={name:i(M),type:2},I.FileIndex.push(L),I.FullPaths.push(K),b||et.utils.cfb_gc(I)}return L.content=R,L.size=R?R.length:0,D&&(D.CLSID&&(L.clsid=D.CLSID),D.mt&&(L.mt=D.mt),D.ct&&(L.ct=D.ct)),L}function ne(I,M){g(I);var R=et.find(I,M);if(R){for(var D=0;D<I.FileIndex.length;++D)if(I.FileIndex[D]==R)return I.FileIndex.splice(D,1),I.FullPaths.splice(D,1),!0}return!1}function fe(I,M,R){g(I);var D=et.find(I,M);if(D){for(var b=0;b<I.FileIndex.length;++b)if(I.FileIndex[b]==D)return I.FileIndex[b].name=i(R),I.FullPaths[b]=R,!0}return!1}function ke(I){S(I,!0)}return e.find=P,e.read=U,e.parse=f,e.write=ue,e.writeFile=ie,e.utils={cfb_new:H,cfb_add:Q,cfb_del:ne,cfb_mov:fe,cfb_gc:ke,ReadShift:Ec,CheckField:lA,prep_blob:xr,bconcat:Cs,use_zlib:B,_deflateRaw:Ve,_inflateRaw:Di,consts:oe},e}();function $L(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Si(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Rv(t){for(var e=[],r=Si(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var qh=new Date(1899,11,30,0,0,0);function Qr(t,e){var r=t.getTime(),n=qh.getTime()+(t.getTimezoneOffset()-qh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var jS=new Date,WL=qh.getTime()+(jS.getTimezoneOffset()-qh.getTimezoneOffset())*6e4,Fy=jS.getTimezoneOffset();function W0(t){var e=new Date;return e.setTime(t*24*60*60*1e3+WL),e.getTimezoneOffset()!==Fy&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Fy)*6e4),e}function GL(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var Dy=new Date("2017-02-19T19:06:09.000Z"),zS=isNaN(Dy.getFullYear())?new Date("2/19/17"):Dy,KL=zS.getFullYear()==2017;function dr(t,e){var r=new Date(t);if(KL)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(zS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function za(t,e){if(Qe&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ic(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ic(CS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ic(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ic(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Er(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Er(t[r]));return e}function Ut(t,e){for(var r="";r.length<e;)r+=t;return r}function ii(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var qL=["january","february","march","april","may","june","july","august","september","october","november","december"];function fl(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&qL.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var XL=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function HS(t){return t?t.content&&t.type?za(t.content,!0):t.data?tc(t.data):t.asNodeBuffer&&Qe?tc(t.asNodeBuffer().toString("binary")):t.asBinary?tc(t.asBinary()):t._data&&t._data.getContent?tc(za(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function $S(t){if(!t)return null;if(t.data)return wy(t.data);if(t.asNodeBuffer&&Qe)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?wy(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function YL(t){return t&&t.name.slice(-4)===".bin"?$S(t):HS(t)}function Nn(t,e){for(var r=t.FullPaths||Si(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function Nv(t,e){var r=Nn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Kt(t,e,r){if(!r)return YL(Nv(t,e));if(!e)return null;try{return Kt(t,e)}catch{return null}}function vn(t,e,r){if(!r)return HS(Nv(t,e));if(!e)return null;try{return vn(t,e)}catch{return null}}function QL(t,e,r){return $S(Nv(t,e))}function by(t){for(var e=t.FullPaths||Si(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function JL(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Qe?n=Za(r):n=vL(r),et.utils.cfb_add(t,e,n)}et.utils.cfb_add(t,e,r)}else t.file(e,r)}function WS(t,e){switch(e.type){case"base64":return et.read(t,{type:"base64"});case"binary":return et.read(t,{type:"binary"});case"buffer":case"array":return et.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function nc(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var GS=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ZL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Oy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,eM=/<[^>]*>/g,Hr=GS.match(Oy)?Oy:eM,tM=/<\w*:/,rM=/<(\/?)\w+:/;function Oe(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(ZL),o=0,l="",c=0,f="",h="",d=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(f=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Ri(t){return t.replace(rM,"<$1")}var KS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},nM=Rv(KS),st=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return KS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),iM=/[&<>'"]/g,sM=/[\u0000-\u001f]/g;function Pv(t){var e=t+"";return e.replace(iM,function(r){return nM[r]}).replace(/\n/g,"<br/>").replace(sM,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Ly=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Nt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function zd(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function My(t){var e=ea(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Vy(t){return Za(t,"binary").toString("utf8")}var kf="foo bar baz",wt=Qe&&(Vy(kf)==zd(kf)&&Vy||My(kf)==zd(kf)&&My)||zd,ic=Qe?function(t){return Za(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},lu=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),qS=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),aM=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),oM=/<\/?(?:vt:)?variant>/g,lM=/<(?:vt:)([^>]*)>([\s\S]*)</;function Uy(t,e){var r=Oe(t),n=t.match(aM(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(oM,"").match(lM);a&&i.push({v:wt(a[2]),t:a[1]})}),i}var cM=/(^\s|\s$|\n)/;function uM(t){return Si(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function fM(t,e,r){return"<"+t+(r!=null?uM(r):"")+(e!=null?(e.match(cM)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Fv(t){if(Qe&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return wt(eo(Av(t)));throw new Error("Bad input format: expected Buffer or string")}var cu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,hM={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},dM=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function pM(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function mM(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var By=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},jy=Qe?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Za(e)})):By(t)}:By,zy=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ki(t,i)));return n.join("").replace(Yr,"")},Dv=Qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Yr,""):zy(t,e,r)}:zy,Hy=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},XS=Qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Hy(t,e,r)}:Hy,$y=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(_o(t,i)));return n.join("")},bu=Qe?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):$y(e,r,n)}:$y,YS=function(t,e){var r=gn(t,e);return r>0?bu(t,e+4,e+4+r-1):""},QS=YS,JS=function(t,e){var r=gn(t,e);return r>0?bu(t,e+4,e+4+r-1):""},ZS=JS,eA=function(t,e){var r=2*gn(t,e);return r>0?bu(t,e+4,e+4+r-1):""},tA=eA,rA=function(e,r){var n=gn(e,r);return n>0?Dv(e,r+4,r+4+n):""},nA=rA,iA=function(t,e){var r=gn(t,e);return r>0?bu(t,e+4,e+4+r):""},sA=iA,aA=function(t,e){return pM(t,e)},Xh=aA,oA=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Qe&&(QS=function(e,r){if(!Buffer.isBuffer(e))return YS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},ZS=function(e,r){if(!Buffer.isBuffer(e))return JS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},tA=function(e,r){if(!Buffer.isBuffer(e))return eA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},nA=function(e,r){if(!Buffer.isBuffer(e))return rA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},sA=function(e,r){if(!Buffer.isBuffer(e))return iA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Xh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):aA(e,r)},oA=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var _o=function(t,e){return t[e]},Ki=function(t,e){return t[e+1]*256+t[e]},gM=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},gn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ma=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},vM=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Ec(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Ki(this,c)),c+=2;t*=2;break;case"utf8":r=bu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Dv(this,this.l,this.l+t);break;case"wstr":return Ec.call(this,t,"dbcs");case"lpstr-ansi":r=QS(this,this.l),t=4+gn(this,this.l);break;case"lpstr-cp":r=ZS(this,this.l),t=4+gn(this,this.l);break;case"lpwstr":r=tA(this,this.l),t=4+2*gn(this,this.l);break;case"lpp4":t=4+gn(this,this.l),r=nA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+gn(this,this.l),r=sA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=_o(this,this.l+t++))!==0;)s.push(Tf(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Ki(this,this.l+t))!==0;)s.push(Tf(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=_o(this,c),this.l=c+1,o=Ec.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Tf(Ki(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=_o(this,c),this.l=c+1,o=Ec.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Tf(_o(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=_o(this,this.l),this.l++,n;case 2:return n=(e==="i"?gM:Ki)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?ma:vM)(this,this.l),this.l+=4,n):(i=gn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Xh(this,this.l):i=Xh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=XS(this,this.l,t);break}}return this.l+=t,r}var xM=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},_M=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},yM=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function wM(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)yM(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,xM(this,e,this.l);break;case 8:if(n=8,r==="f"){mM(this,e,this.l);break}case 16:break;case-4:n=4,_M(this,e,this.l);break}return this.l+=n,this}function lA(t,e){var r=XS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function xr(t,e){t.l=e,t.read_shift=Ec,t.chk=lA,t.write_shift=wM}function zr(t,e){t.l+=e}function er(t){var e=ea(t);return xr(e,0),e}function ds(t,e,r){if(t){var n,i,s;xr(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=t0[o]||t0[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var f=c.f&&c.f(t,s,r);if(t.l=l,e(f,c,o))return}}}function _m(){var t=[],e=Qe?256:2048,r=function(c){var f=er(c);return xr(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),Cs(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function Tc(t,e,r){var n=Er(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Wy(t,e,r){var n=Er(t);return n.s=Tc(n.s,e.s,r),n.e=Tc(n.e,e.s,r),n}function kc(t,e){if(t.cRel&&t.c<0)for(t=Er(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Er(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Be(t);return!t.cRel&&t.cRel!=null&&(r=kM(r)),!t.rRel&&t.rRel!=null&&(r=EM(r)),r}function Hd(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+nr(t.s.c)+":"+(t.e.cRel?"":"$")+nr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Tr(t.s.r)+":"+(t.e.rRel?"":"$")+Tr(t.e.r):kc(t.s,e.biff)+":"+kc(t.e,e.biff)}function bv(t){return parseInt(TM(t),10)-1}function Tr(t){return""+(t+1)}function EM(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function TM(t){return t.replace(/\$(\d+)$/,"$1")}function Ov(t){for(var e=SM(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function nr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function kM(t){return t.replace(/^([A-Z])/,"$$$1")}function SM(t){return t.replace(/^\$([A-Z])/,"$1")}function AM(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Be(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Tl(t){var e=t.indexOf(":");return e==-1?{s:Kr(t),e:Kr(t)}:{s:Kr(t.slice(0,e)),e:Kr(t.slice(e+1))}}function tt(t,e){return typeof e>"u"||typeof e=="number"?tt(t.s,t.e):(typeof t!="string"&&(t=Be(t)),typeof e!="string"&&(e=Be(e)),t==e?t:t+":"+e)}function Bt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Gy(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Un(t.z,r?Qr(e):e)}catch{}try{return t.w=Un((t.XF||{}).numFmtId||(r?14:0),r?Qr(e):e)}catch{return""+e}}function cs(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?no[t.v]||t.v:e==null?Gy(t,t.v):Gy(t,e))}function oa(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function cA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Kr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Bt(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),a==-1&&(c.e.r=a=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var p={v:e[h][d]},v=a+h,m=o+d;if(c.s.r>v&&(c.s.r=v),c.s.c>m&&(c.s.c=m),c.e.r<v&&(c.e.r=v),c.e.c<m&&(c.e.c=m),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))p=e[h][d];else if(Array.isArray(p.v)&&(p.f=e[h][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||ze[14],n.cellDates?(p.t="d",p.w=Un(p.z,Qr(p.v))):(p.t="n",p.v=Qr(p.v),p.w=Un(p.z,p.v))):p.t="s";if(i)s[v]||(s[v]=[]),s[v][m]&&s[v][m].z&&(p.z=s[v][m].z),s[v][m]=p;else{var w=Be({c:m,r:v});s[w]&&s[w].z&&(p.z=s[w].z),s[w]=p}}}return c.s.c<1e7&&(s["!ref"]=tt(c)),s}function kl(t,e){return cA(null,t,e)}function IM(t){return t.read_shift(4,"i")}function Ur(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function CM(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Lv(t,e){var r=t.l,n=t.read_shift(1),i=Ur(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(CM(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var RM=Lv;function Bn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function to(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var NM=Ur;function Mv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var PM=Ur,ym=Mv;function Vv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Xh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ma(e,0)>>2;return r?i/100:i}function uA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var ro=uA;function Mr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function FM(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=Ca[i];c&&(e.rgb=fu(c));break;case 2:e.rgb=fu([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function DM(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function fA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function bM(t){return fA(t,1)}function OM(t){return fA(t,2)}var Uv=2,sn=3,Sf=11,Ky=12,Yh=19,Af=64,LM=65,MM=71,VM=4108,UM=4126,cr=80,hA=81,BM=[cr,hA],jM={1:{n:"CodePage",t:Uv},2:{n:"Category",t:cr},3:{n:"PresentationFormat",t:cr},4:{n:"ByteCount",t:sn},5:{n:"LineCount",t:sn},6:{n:"ParagraphCount",t:sn},7:{n:"SlideCount",t:sn},8:{n:"NoteCount",t:sn},9:{n:"HiddenCount",t:sn},10:{n:"MultimediaClipCount",t:sn},11:{n:"ScaleCrop",t:Sf},12:{n:"HeadingPairs",t:VM},13:{n:"TitlesOfParts",t:UM},14:{n:"Manager",t:cr},15:{n:"Company",t:cr},16:{n:"LinksUpToDate",t:Sf},17:{n:"CharacterCount",t:sn},19:{n:"SharedDoc",t:Sf},22:{n:"HyperlinksChanged",t:Sf},23:{n:"AppVersion",t:sn,p:"version"},24:{n:"DigSig",t:LM},26:{n:"ContentType",t:cr},27:{n:"ContentStatus",t:cr},28:{n:"Language",t:cr},29:{n:"Version",t:cr},255:{},2147483648:{n:"Locale",t:Yh},2147483651:{n:"Behavior",t:Yh},1919054434:{}},zM={1:{n:"CodePage",t:Uv},2:{n:"Title",t:cr},3:{n:"Subject",t:cr},4:{n:"Author",t:cr},5:{n:"Keywords",t:cr},6:{n:"Comments",t:cr},7:{n:"Template",t:cr},8:{n:"LastAuthor",t:cr},9:{n:"RevNumber",t:cr},10:{n:"EditTime",t:Af},11:{n:"LastPrinted",t:Af},12:{n:"CreatedDate",t:Af},13:{n:"ModifiedDate",t:Af},14:{n:"PageCount",t:sn},15:{n:"WordCount",t:sn},16:{n:"CharCount",t:sn},17:{n:"Thumbnail",t:MM},18:{n:"Application",t:cr},19:{n:"DocSecurity",t:sn},255:{},2147483648:{n:"Locale",t:Yh},2147483651:{n:"Behavior",t:Yh},1919054434:{}},qy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},HM=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function $M(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var WM=$M([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ca=Er(WM),no={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},dA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Xy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function GM(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function KM(t){var e=GM();if(!t||!t.match)return e;var r={};if((t.match(Hr)||[]).forEach(function(n){var i=Oe(n);switch(i[0].replace(tM,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[Xy[i.ContentType]]!==void 0&&e[Xy[i.ContentType]].push(i.PartName);break}}),e.xmlns!==hM.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Fo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wm(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Sc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Hr)||[]).forEach(function(i){var s=Oe(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:nc(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}var qM="application/vnd.oasis.opendocument.spreadsheet";function XM(t,e){for(var r=Fv(t),n,i;n=cu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Oe(n[0],!1),i.path=="/"&&i.type!==qM)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Ac=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],YM=function(){for(var t=new Array(Ac.length),e=0;e<Ac.length;++e){var r=Ac[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function pA(t){var e={};t=wt(t);for(var r=0;r<Ac.length;++r){var n=Ac[r],i=t.match(YM[r]);i!=null&&i.length>0&&(e[n[1]]=st(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=dr(e[n[1]]))}return e}var QM=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function mA(t,e,r,n){var i=[];if(typeof t=="string")i=Uy(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(f){return{v:f}}));var a=typeof e=="string"?Uy(e,n).map(function(f){return f.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function JM(t,e,r){var n={};return e||(e={}),t=wt(t),QM.forEach(function(i){var s=(t.match(lu(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=st(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&mA(n.HeadingPairs,n.TitlesOfParts,e,r),e}var ZM=/<[^>]+>[^<]*/g;function e8(t,e){var r={},n="",i=t.match(ZM);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Oe(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=st(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=st(f);break;case"bool":r[n]=Nt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=dr(f);break;case"cy":case"error":r[n]=st(f);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var t8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},$d;function r8(t,e,r){$d||($d=Rv(t8)),e=$d[e]||e,t[e]=r}function Bv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function gA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function vA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function xA(t,e,r){return e===31?vA(t):gA(t,e,r)}function Em(t,e,r){return xA(t,e,r===!1?0:4)}function n8(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return xA(t,e,0)}function i8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Yr,""),t.l-i&2&&(t.l+=2)}return r}function s8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Yr,"");return r}function a8(t){var e=t.l,r=Qh(t,hA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Qh(t,sn);return[r,n]}function o8(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(a8(t));return r}function Yy(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Yr,"").replace(rc,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function _A(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function l8(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Qh(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==Ky&&n!==e&&BM.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Ky?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return gA(t,n,4).replace(Yr,"");case 31:return vA(t);case 64:return Bv(t);case 65:return _A(t);case 71:return l8(t);case 80:return Em(t,n,!s.raw).replace(Yr,"");case 81:return n8(t,n).replace(Yr,"");case 4108:return o8(t);case 4126:case 4127:return n==4127?i8(t):s8(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Qy(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var f=t.read_shift(4),h=t.read_shift(4);s[a]=[f,h+r]}s.sort(function(E,y){return E[1]-y[1]});var d={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var p=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(p=!1,t.l=s[a][1]),p)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var v=e[s[a][0]];if(d[v.n]=Qh(t,v.t,{raw:!0}),v.p==="version"&&(d[v.n]=String(d[v.n]>>16)+"."+("0000"+String(d[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(d[v.n]){case 0:d[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Zn(o=d[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[v.n])}}else if(s[a][0]===1){if(o=d.CodePage=Qh(t,Uv),Zn(o),l!==-1){var m=t.l;t.l=s[l][1],c=Yy(t,o),t.l=m}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}c=Yy(t,o)}else{var w=c[s[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=_A(t);break;case 30:t.l+=4,T=Em(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=Em(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=jt(t,4);break;case 64:t.l+=4,T=dr(Bv(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[w]=T}}return t.l=r+n,d}function Jy(t,e,r){var n=t.content;if(!n)return{};xr(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==et.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=Qy(n,e),d={SystemIdentifier:c};for(var p in h)d[p]=h[p];if(d.FMTID=s,i===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=Qy(n,null)}catch{}for(p in v)d[p]=v[p];return d.FMTID=[s,a],d}function _s(t,e){return t.read_shift(e),null}function c8(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function jt(t,e){return t.read_shift(e)===1}function qt(t){return t.read_shift(2,"u")}function yA(t,e){return c8(t,e,qt)}function u8(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Ou(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function f8(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Ha(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Lu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ha(t,n,r)}function io(t,e,r){if(r.biff>5)return Lu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function h8(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function d8(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Yr,"");return n&&(t.l+=24),i}function p8(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Yr,"");return r+a}function m8(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return d8(t);case"0303000000000000c000000000000046":return p8(t);default:throw new Error("Unsupported Moniker "+r)}}function If(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Yr,""):"";return r}function g8(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,c="",f,h;i&16&&(s=If(t,r-t.l)),i&128&&(a=If(t,r-t.l)),(i&257)===257&&(o=If(t,r-t.l)),(i&257)===1&&(l=m8(t,r-t.l)),i&8&&(c=If(t,r-t.l)),i&32&&(f=t.read_shift(16)),i&64&&(h=Bv(t)),t.l=r;var d=a||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return f&&(p.guid=f),h&&(p.time=h),s&&(p.Tooltip=s),p}function wA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function EA(t,e){var r=wA(t);return r[3]=0,r}function Ni(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function v8(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function x8(t,e,r){return e===0?"":io(t,e,r)}function _8(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function TA(t){var e=t.read_shift(2),r=Vv(t);return[e,r]}function y8(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Ou(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function G0(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function kA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var w8=kA;function SA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function E8(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function T8(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Fr(t){t.l+=2,t.l+=t.read_shift(2)}var k8={0:Fr,4:Fr,5:Fr,6:Fr,7:T8,8:Fr,9:Fr,10:Fr,11:Fr,12:Fr,13:E8,14:Fr,15:Fr,16:Fr,17:Fr,18:Fr,19:Fr,20:Fr,21:SA};function S8(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(k8[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Cf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function A8(t,e){return e===0||t.read_shift(2),1200}function I8(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=io(t,0,r);return t.read_shift(e+n-t.l),i}function C8(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function R8(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Ou(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function N8(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(f8(t));return s.Count=n,s.Unique=i,s}function P8(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function F8(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function D8(t){var e=v8(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function b8(t){return t.read_shift(2),t.read_shift(4)}function Zy(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function O8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function L8(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function M8(){}function V8(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Ou(t,0,r),n}function U8(t){var e=Ni(t);return e.isst=t.read_shift(4),e}function B8(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Ni(t);r.biff==2&&t.l++;var s=Lu(t,n-t.l,r);return i.val=s,i}function j8(t,e,r){var n=t.read_shift(2),i=io(t,0,r);return[n,i]}var z8=io;function ew(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function H8(t){var e=t.read_shift(2),r=t.read_shift(2),n=TA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function $8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(TA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function W8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function G8(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=HM[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function K8(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=G8(t,e,n.fStyle,r),n}function q8(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function tw(t,e,r){var n=Ni(t);(r.biff==2||e==9)&&++t.l;var i=u8(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function X8(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ni(t),i=Mr(t);return n.val=i,n}var rw=x8;function Y8(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ha(t,s),o=[];n>t.l;)o.push(Lu(t));return[s,i,a,o]}function nw(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=y8(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var Q8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function iw(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Ha(t,a,r);i&32&&(c=Q8[c.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var h=n==t.l||o===0||!(f>0)?[]:FU(t,f,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function AA(t,e,r){if(r.biff<8)return J8(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(_8(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function J8(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Ou(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function Z8(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Ha(t,n,r),a=Ha(t,i,r);return[s,a]}function e5(t,e,r){var n=kA(t);t.l++;var i=t.read_shift(1);return e-=8,[DU(t,e,r),i,n]}function sw(t,e,r){var n=w8(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,NU(t,e,r)]}function t5(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function r5(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=io(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function n5(t,e,r){return r5(t,e,r)}function i5(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(G0(t));return r}function s5(t,e,r){if(r&&r.biff<8)return o5(t,e,r);var n=SA(t),i=S8(t,e-22,n[1]);return{cmo:n,ft:i}}var a5={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function o5(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((a5[n]||zr)(t,e,r)),{cmo:[i,n,s],ft:a}}function l5(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=h8(t,6,r);var o=t.read_shift(2);t.read_shift(2),qt(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var f=t[t.l],h=Ha(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function c5(t,e){var r=G0(t);t.l+=16;var n=g8(t,e-24);return[r,n]}function u5(t,e){t.read_shift(2);var r=G0(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Yr,""),[r,n]}function f5(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=qy[r]||r,r=t.read_shift(2),e[1]=qy[r]||r,e}function h5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(EA(t));return r}function d5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(EA(t));return r}function p5(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function IA(t,e,r){if(!r.cellStyles)return zr(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function m5(t,e){var r={};return e<32||(t.l+=16,r.header=Mr(t),r.footer=Mr(t),t.l+=2),r}function g5(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var v5=Ni,x5=yA,_5=Lu;function y5(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function w5(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ni(t);++t.l;var i=io(t,e-7,r);return n.t="str",n.val=i,n}function E5(t){var e=Ni(t);++t.l;var r=Mr(t);return e.t="n",e.val=r,e}function T5(t){var e=Ni(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function k5(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function S5(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function A5(t,e,r){var n=t.l+e,i=Ni(t),s=t.read_shift(2),a=Ha(t,s,r);return t.l=n,i.t="str",i.val=a,i}var I5=[2,3,48,49,131,139,140,245],aw=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Rv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=ea(1);switch(l.type){case"base64":f=Yn(En(o));break;case"binary":f=Yn(o);break;case"buffer":case"array":f=o;break}xr(f,0);var h=f.read_shift(1),d=!!(h&136),p=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,w=521;h==2&&(m=f.read_shift(2)),f.l+=3,h!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(w=f.read_shift(2));var T=f.read_shift(2),E=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(E=t[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var y=[],N={},j=Math.min(f.length,h==2?521:w-10-(p?264:0)),U=v?32:11;f.l<j&&f[f.l]!=13;)switch(N={},N.name=au.utils.decode(E,f.slice(f.l,f.l+U)).replace(/[\u0000\r\n].*$/g,""),f.l+=U,N.type=String.fromCharCode(f.read_shift(1)),h!=2&&!v&&(N.offset=f.read_shift(4)),N.len=f.read_shift(1),h==2&&(N.offset=f.read_shift(2)),N.dec=f.read_shift(1),N.name.length&&y.push(N),h!=2&&(f.l+=v?13:14),N.type){case"B":(!p||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var g=0,k=0;for(c[0]=[],k=0;k!=y.length;++k)c[0][k]=y[k].name;for(;m-- >0;){if(f[f.l]===42){f.l+=T;continue}for(++f.l,c[++g]=[],k=0,k=0;k!=y.length;++k){var S=f.slice(f.l,f.l+y[k].len);f.l+=y[k].len,xr(S,0);var C=au.utils.decode(E,S);switch(y[k].type){case"C":C.trim().length&&(c[g][k]=C.replace(/\s+$/,""));break;case"D":C.length===8?c[g][k]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):c[g][k]=C;break;case"F":c[g][k]=parseFloat(C.trim());break;case"+":case"I":c[g][k]=v?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":c[g][k]=!0;break;case"N":case"F":c[g][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[g][k]="##MEMO##"+(v?parseInt(C.trim(),10):S.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(c[g][k]=+C||0);break;case"@":c[g][k]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[g][k]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[g][k]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[g][k]=-S.read_shift(-8,"f");break;case"B":if(p&&y[k].len==8){c[g][k]=S.read_shift(8,"f");break}case"G":case"P":S.l+=y[k].len;break;case"0":if(y[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[k].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=kl(r(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function i(o,l){try{return oa(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Zn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=_m(),h=Rm(o,{header:1,raw:!0,cellDates:!0}),d=h[0],p=h.slice(1),v=o["!cols"]||[],m=0,w=0,T=0,E=1;for(m=0;m<d.length;++m){if(((v[m]||{}).DBF||{}).name){d[m]=v[m].DBF.name,++T;continue}if(d[m]!=null){if(++T,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(w=0;w<1024;++w)if(d.indexOf(d[m]+"_"+w)==-1){d[m]+="_"+w;break}}}}var y=Bt(o["!ref"]),N=[],j=[],U=[];for(m=0;m<=y.e.c-y.s.c;++m){var g="",k="",S=0,C=[];for(w=0;w<p.length;++w)p[w][m]!=null&&C.push(p[w][m]);if(C.length==0||d[m]==null){N[m]="?";continue}for(w=0;w<C.length;++w){switch(typeof C[w]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=C[w]instanceof Date?"D":"C";break;default:k="C"}S=Math.max(S,String(C[w]).length),g=g&&g!=k?"C":k}S>250&&(S=250),k=((v[m]||{}).DBF||{}).type,k=="C"&&v[m].DBF.len>S&&(S=v[m].DBF.len),g=="B"&&k=="N"&&(g="N",U[m]=v[m].DBF.dec,S=v[m].DBF.len),j[m]=g=="C"||k=="N"?S:s[g]||0,E+=j[m],N[m]=g}var P=f.next(32);for(P.write_shift(4,318902576),P.write_shift(4,p.length),P.write_shift(2,296+32*T),P.write_shift(2,E),m=0;m<4;++m)P.write_shift(4,0);for(P.write_shift(4,0|(+e[AS]||3)<<8),m=0,w=0;m<d.length;++m)if(d[m]!=null){var F=f.next(32),O=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,O,"sbcs"),F.write_shift(1,N[m]=="?"?"C":N[m],"sbcs"),F.write_shift(4,w),F.write_shift(1,j[m]||s[N[m]]||0),F.write_shift(1,U[m]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),w+=j[m]||s[N[m]]||0}var de=f.next(264);for(de.write_shift(4,13),m=0;m<65;++m)de.write_shift(4,0);for(m=0;m<p.length;++m){var ve=f.next(E);for(ve.write_shift(1,0),w=0;w<d.length;++w)if(d[w]!=null)switch(N[w]){case"L":ve.write_shift(1,p[m][w]==null?63:p[m][w]?84:70);break;case"B":ve.write_shift(8,p[m][w]||0,"f");break;case"N":var Ie="0";for(typeof p[m][w]=="number"&&(Ie=p[m][w].toFixed(U[w]||0)),T=0;T<j[w]-Ie.length;++T)ve.write_shift(1,32);ve.write_shift(1,Ie,"sbcs");break;case"D":p[m][w]?(ve.write_shift(4,("0000"+p[m][w].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(p[m][w].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+p[m][w].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(p[m][w]!=null?p[m][w]:"").slice(0,j[w]);for(ve.write_shift(1,oe,"sbcs"),T=0;T<j[w]-oe.length;++T)ve.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),C5=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Si(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var v=t[p];return typeof v=="number"?Ey(v):v},n=function(d,p,v){var m=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return m==59?d:Ey(m)};t["|"]=254;function i(d,p){switch(p.type){case"base64":return s(En(d),p);case"binary":return s(d,p);case"buffer":return s(Qe&&Buffer.isBuffer(d)?d.toString("binary"):eo(d),p);case"array":return s(za(d),p)}throw new Error("Unrecognized type "+p.type)}function s(d,p){var v=d.split(/[\n\r]+/),m=-1,w=-1,T=0,E=0,y=[],N=[],j=null,U={},g=[],k=[],S=[],C=0,P;for(+p.codepage>=0&&Zn(+p.codepage);T!==v.length;++T){C=0;var F=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),O=F.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),de=O[0],ve;if(F.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":O[1].charAt(0)=="P"&&N.push(F.slice(3).replace(/;;/g,";"));break;case"C":var Ie=!1,oe=!1,ie=!1,G=!1,ue=-1,Ee=-1;for(E=1;E<O.length;++E)switch(O[E].charAt(0)){case"A":break;case"X":w=parseInt(O[E].slice(1))-1,oe=!0;break;case"Y":for(m=parseInt(O[E].slice(1))-1,oe||(w=0),P=y.length;P<=m;++P)y[P]=[];break;case"K":ve=O[E].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(ii(ve))?isNaN(fl(ve).getDate())||(ve=dr(ve)):(ve=ii(ve),j!==null&&El(j)&&(ve=W0(ve))),Ie=!0;break;case"E":G=!0;var B=Wo(O[E].slice(1),{r:m,c:w});y[m][w]=[y[m][w],B];break;case"S":ie=!0,y[m][w]=[y[m][w],"S5S"];break;case"G":break;case"R":ue=parseInt(O[E].slice(1))-1;break;case"C":Ee=parseInt(O[E].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+F)}if(Ie&&(y[m][w]&&y[m][w].length==2?y[m][w][0]=ve:y[m][w]=ve,j=null),ie){if(G)throw new Error("SYLK shared formula cannot have own formula");var X=ue>-1&&y[ue][Ee];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");y[m][w][1]=MA(X[1],{r:m-ue,c:w-Ee})}break;case"F":var q=0;for(E=1;E<O.length;++E)switch(O[E].charAt(0)){case"X":w=parseInt(O[E].slice(1))-1,++q;break;case"Y":for(m=parseInt(O[E].slice(1))-1,P=y.length;P<=m;++P)y[P]=[];break;case"M":C=parseInt(O[E].slice(1))/20;break;case"F":break;case"G":break;case"P":j=N[parseInt(O[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=O[E].slice(1).split(" "),P=parseInt(S[0],10);P<=parseInt(S[1],10);++P)C=parseInt(S[2],10),k[P-1]=C===0?{hidden:!0}:{wch:C},hl(k[P-1]);break;case"C":w=parseInt(O[E].slice(1))-1,k[w]||(k[w]={});break;case"R":m=parseInt(O[E].slice(1))-1,g[m]||(g[m]={}),C>0?(g[m].hpt=C,g[m].hpx=hu(C)):C===0&&(g[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+F)}q<1&&(j=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+F)}}return g.length>0&&(U["!rows"]=g),k.length>0&&(U["!cols"]=k),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,U]}function a(d,p){var v=i(d,p),m=v[0],w=v[1],T=kl(m,p);return Si(w).forEach(function(E){T[E]=w[E]}),T}function o(d,p){return oa(a(d,p),p)}function l(d,p,v,m){var w="C;Y"+(v+1)+";X"+(m+1)+";K";switch(d.t){case"n":w+=d.v||0,d.f&&!d.F&&(w+=";E"+pV(d.f,{r:v,c:m}));break;case"b":w+=d.v?"TRUE":"FALSE";break;case"e":w+=d.w||d.v;break;case"d":w+='"'+(d.w||d.v)+'"';break;case"s":w+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(d,p){p.forEach(function(v,m){var w="F;W"+(m+1)+" "+(m+1)+" ";v.hidden?w+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Zh(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=e0(v.wpx)),typeof v.wch=="number"&&(w+=Math.round(v.wch))),w.charAt(w.length-1)!=" "&&d.push(w)})}function f(d,p){p.forEach(function(v,m){var w="F;";v.hidden?w+="M0;":v.hpt?w+="M"+20*v.hpt+";":v.hpx&&(w+="M"+20*bA(v.hpx)+";"),w.length>2&&d.push(w+"R"+(m+1))})}function h(d,p){var v=["ID;PWXL;N;E"],m=[],w=Bt(d["!ref"]),T,E=Array.isArray(d),y=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),d["!cols"]&&c(v,d["!cols"]),d["!rows"]&&f(v,d["!rows"]),v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var j=w.s.c;j<=w.e.c;++j){var U=Be({r:N,c:j});T=E?(d[N]||[])[j]:d[U],!(!T||T.v==null&&(!T.f||T.F))&&m.push(l(T,d,N,j))}return v.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),R5=function(){function t(s,a){switch(a.type){case"base64":return e(En(s),a);case"binary":return e(s,a);case"buffer":return e(Qe&&Buffer.isBuffer(s)?s.toString("binary"):eo(s),a);case"array":return e(za(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[f].trim().split(","),p=d[0],v=d[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+p){case-1:if(m==="BOT"){h[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][c]=!0:m==="FALSE"?h[l][c]=!1:isNaN(ii(v))?isNaN(fl(v).getDate())?h[l][c]=v:h[l][c]=dr(v):h[l][c]=ii(v),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return kl(t(s,a),a)}function n(s,a){return oa(r(s,a),a)}var i=function(){var s=function(l,c,f,h,d){l.push(c),l.push(f+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},a=function(l,c,f,h){l.push(c+","+f),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],f=Bt(l["!ref"]),h,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){a(c,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var m=Be({r:p,c:v});if(h=d?(l[p]||[])[v]:l[m],!h){a(c,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,w,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Un(h.z||ze[14],Qr(dr(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,E=c.join(T);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),N5=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var p=h.split(`
`),v=-1,m=-1,w=0,T=[];w!==p.length;++w){var E=p[w].trim().split(":");if(E[0]==="cell"){var y=Kr(E[1]);if(T.length<=y.r)for(v=T.length;v<=y.r;++v)T[v]||(T[v]=[]);switch(v=y.r,m=y.c,E[2]){case"t":T[v][m]=t(E[3]);break;case"v":T[v][m]=+E[3];break;case"vtf":var N=E[E.length-1];case"vtc":switch(E[3]){case"nl":T[v][m]=!!+E[4];break;default:T[v][m]=+E[4];break}E[2]=="vtf"&&(T[v][m]=[T[v][m],N])}}}return d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),T}function n(h,d){return kl(r(h,d),d)}function i(h,d){return oa(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],p=[],v,m="",w=Tl(h["!ref"]),T=Array.isArray(h),E=w.s.r;E<=w.e.r;++E)for(var y=w.s.c;y<=w.e.c;++y)if(m=Be({r:E,c:y}),v=T?(h[E]||[])[y]:h[m],!(!v||v.v==null||v.t==="z")){switch(p=["cell",m,"t"],v.t){case"s":case"str":p.push(e(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=e(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=Qr(dr(v.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=v.w||Un(v.z||ze[14],N);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),uu=function(){function t(f,h,d,p,v){v.raw?h[d][p]=f:f===""||(f==="TRUE"?h[d][p]=!0:f==="FALSE"?h[d][p]=!1:isNaN(ii(f))?isNaN(fl(f).getDate())?h[d][p]=f:h[d][p]=dr(f):h[d][p]=ii(f))}function e(f,h){var d=h||{},p=[];if(!f||f.length===0)return p;for(var v=f.split(/[\r\n]/),m=v.length-1;m>=0&&v[m].length===0;)--m;for(var w=10,T=0,E=0;E<=m;++E)T=v[E].indexOf(" "),T==-1?T=v[E].length:T++,w=Math.max(w,T);for(E=0;E<=m;++E){p[E]=[];var y=0;for(t(v[E].slice(0,w).trim(),p,E,y,d),y=1;y<=(v[E].length-w)/10+1;++y)t(v[E].slice(w+(y-1)*10,w+y*10).trim(),p,E,y,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var h={},d=!1,p=0,v=0;p<f.length;++p)(v=f.charCodeAt(p))==34?d=!d:!d&&v in r&&(h[v]=(h[v]||0)+1);v=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&v.push([h[p],p]);if(!v.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&v.push([h[p],p])}return v.sort(function(m,w){return m[0]-w[0]||n[m[1]]-n[w[1]]}),r[v.pop()[1]]||44}function s(f,h){var d=h||{},p="",v=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=i(f.slice(0,1024)):d&&d.FS?p=d.FS:p=i(f.slice(0,1024));var w=0,T=0,E=0,y=0,N=0,j=p.charCodeAt(0),U=!1,g=0,k=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var S=d.dateNF!=null?jL(d.dateNF):null;function C(){var P=f.slice(y,N),F={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)F.t="z";else if(d.raw)F.t="s",F.v=P;else if(P.trim().length===0)F.t="s",F.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(F.t="s",F.v=P.slice(2,-1).replace(/""/g,'"')):gV(P)?(F.t="n",F.f=P.slice(1)):(F.t="s",F.v=P);else if(P=="TRUE")F.t="b",F.v=!0;else if(P=="FALSE")F.t="b",F.v=!1;else if(!isNaN(E=ii(P)))F.t="n",d.cellText!==!1&&(F.w=P),F.v=E;else if(!isNaN(fl(P).getDate())||S&&P.match(S)){F.z=d.dateNF||ze[14];var O=0;S&&P.match(S)&&(P=zL(P,d.dateNF,P.match(S)||[]),O=1),d.cellDates?(F.t="d",F.v=dr(P,O)):(F.t="n",F.v=Qr(dr(P,O))),d.cellText!==!1&&(F.w=Un(F.z,F.v instanceof Date?Qr(F.v):F.v)),d.cellNF||delete F.z}else F.t="s",F.v=P;if(F.t=="z"||(d.dense?(v[w]||(v[w]=[]),v[w][T]=F):v[Be({c:T,r:w})]=F),y=N+1,k=f.charCodeAt(y),m.e.c<T&&(m.e.c=T),m.e.r<w&&(m.e.r=w),g==j)++T;else if(T=0,++w,d.sheetRows&&d.sheetRows<=w)return!0}e:for(;N<f.length;++N)switch(g=f.charCodeAt(N)){case 34:k===34&&(U=!U);break;case j:case 10:case 13:if(!U&&C())break e;break}return N-y>0&&C(),v["!ref"]=tt(m),v}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):kl(e(f,h),h)}function o(f,h){var d="",p=h.type=="string"?[0,0,0,0]:qv(f,h);switch(h.type){case"base64":d=En(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof au<"u"||(d=Qe&&Buffer.isBuffer(f)?f.toString("binary"):eo(f));break;case"array":d=za(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=wt(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=wt(d):h.type=="binary"&&typeof au<"u",d.slice(0,19)=="socialcalc:version:"?N5.to_sheet(h.type=="string"?d:wt(d),h):a(d,h)}function l(f,h){return oa(o(f,h),h)}function c(f){for(var h=[],d=Bt(f["!ref"]),p,v=Array.isArray(f),m=d.s.r;m<=d.e.r;++m){for(var w=[],T=d.s.c;T<=d.e.c;++T){var E=Be({r:m,c:T});if(p=v?(f[m]||[])[T]:f[E],!p||p.v==null){w.push("          ");continue}for(var y=(p.w||(cs(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(T===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function P5(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=C5.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return uu.to_workbook(t,e)}}var Ic=function(){function t(B,X,q){if(B){xr(B,B.l||0);for(var W=q.Enum||ue;B.l<B.length;){var ae=B.read_shift(2),xe=W[ae]||W[65535],Ae=B.read_shift(2),he=B.l+Ae,ge=xe.f&&xe.f(B,Ae,q);if(B.l=he,X(ge,xe,ae))return}}}function e(B,X){switch(X.type){case"base64":return r(Yn(En(B)),X);case"binary":return r(Yn(B),X);case"buffer":case"array":return r(B,X)}throw"Unsupported type "+X.type}function r(B,X){if(!B)return B;var q=X||{},W=q.dense?[]:{},ae="Sheet1",xe="",Ae=0,he={},ge=[],He=[],z={s:{r:0,c:0},e:{r:0,c:0}},at=q.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)q.Enum=ue,t(B,function(Se,Et,ar){switch(ar){case 0:q.vers=Se,Se>=4096&&(q.qpro=!0);break;case 6:z=Se;break;case 204:Se&&(xe=Se);break;case 222:xe=Se;break;case 15:case 51:q.qpro||(Se[1].v=Se[1].v.slice(1));case 13:case 14:case 16:ar==14&&(Se[2]&112)==112&&(Se[2]&15)>1&&(Se[2]&15)<15&&(Se[1].z=q.dateNF||ze[14],q.cellDates&&(Se[1].t="d",Se[1].v=W0(Se[1].v))),q.qpro&&Se[3]>Ae&&(W["!ref"]=tt(z),he[ae]=W,ge.push(ae),W=q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Ae=Se[3],ae=xe||"Sheet"+(Ae+1),xe="");var Ar=q.dense?(W[Se[0].r]||[])[Se[0].c]:W[Be(Se[0])];if(Ar){Ar.t=Se[1].t,Ar.v=Se[1].v,Se[1].z!=null&&(Ar.z=Se[1].z),Se[1].f!=null&&(Ar.f=Se[1].f);break}q.dense?(W[Se[0].r]||(W[Se[0].r]=[]),W[Se[0].r][Se[0].c]=Se[1]):W[Be(Se[0])]=Se[1];break}},q);else if(B[2]==26||B[2]==14)q.Enum=Ee,B[2]==14&&(q.qpro=!0,B.l=0),t(B,function(Se,Et,ar){switch(ar){case 204:ae=Se;break;case 22:Se[1].v=Se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Se[3]>Ae&&(W["!ref"]=tt(z),he[ae]=W,ge.push(ae),W=q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Ae=Se[3],ae="Sheet"+(Ae+1)),at>0&&Se[0].r>=at)break;q.dense?(W[Se[0].r]||(W[Se[0].r]=[]),W[Se[0].r][Se[0].c]=Se[1]):W[Be(Se[0])]=Se[1],z.e.c<Se[0].c&&(z.e.c=Se[0].c),z.e.r<Se[0].r&&(z.e.r=Se[0].r);break;case 27:Se[14e3]&&(He[Se[14e3][0]]=Se[14e3][1]);break;case 1537:He[Se[0]]=Se[1],Se[0]==Ae&&(ae=Se[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(W["!ref"]=tt(z),he[xe||ae]=W,ge.push(xe||ae),!He.length)return{SheetNames:ge,Sheets:he};for(var We={},rt=[],be=0;be<He.length;++be)he[ge[be]]?(rt.push(He[be]||ge[be]),We[He[be]]=he[He[be]]||he[ge[be]]):(rt.push(He[be]),We[He[be]]={"!ref":"A1"});return{SheetNames:rt,Sheets:We}}function n(B,X){var q=X||{};if(+q.codepage>=0&&Zn(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var W=_m(),ae=Bt(B["!ref"]),xe=Array.isArray(B),Ae=[];Wn(W,0,s(1030)),Wn(W,6,l(ae));for(var he=Math.min(ae.e.r,8191),ge=ae.s.r;ge<=he;++ge)for(var He=Tr(ge),z=ae.s.c;z<=ae.e.c;++z){ge===ae.s.r&&(Ae[z]=nr(z));var at=Ae[z]+He,We=xe?(B[ge]||[])[z]:B[at];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?Wn(W,13,p(ge,z,We.v)):Wn(W,14,m(ge,z,We.v));else{var rt=cs(We);Wn(W,15,h(ge,z,rt.slice(0,239)))}}return Wn(W,1),W.end()}function i(B,X){var q=X||{};if(+q.codepage>=0&&Zn(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var W=_m();Wn(W,0,a(B));for(var ae=0,xe=0;ae<B.SheetNames.length;++ae)(B.Sheets[B.SheetNames[ae]]||{})["!ref"]&&Wn(W,27,G(B.SheetNames[ae],xe++));var Ae=0;for(ae=0;ae<B.SheetNames.length;++ae){var he=B.Sheets[B.SheetNames[ae]];if(!(!he||!he["!ref"])){for(var ge=Bt(he["!ref"]),He=Array.isArray(he),z=[],at=Math.min(ge.e.r,8191),We=ge.s.r;We<=at;++We)for(var rt=Tr(We),be=ge.s.c;be<=ge.e.c;++be){We===ge.s.r&&(z[be]=nr(be));var Se=z[be]+rt,Et=He?(he[We]||[])[be]:he[Se];if(!(!Et||Et.t=="z"))if(Et.t=="n")Wn(W,23,C(We,be,Ae,Et.v));else{var ar=cs(Et);Wn(W,22,g(We,be,Ae,ar.slice(0,239)))}}++Ae}}return Wn(W,1),W.end()}function s(B){var X=er(2);return X.write_shift(2,B),X}function a(B){var X=er(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var q=0,W=0,ae=0,xe=0;xe<B.SheetNames.length;++xe){var Ae=B.SheetNames[xe],he=B.Sheets[Ae];if(!(!he||!he["!ref"])){++ae;var ge=Tl(he["!ref"]);q<ge.e.r&&(q=ge.e.r),W<ge.e.c&&(W=ge.e.c)}}return q>8191&&(q=8191),X.write_shift(2,q),X.write_shift(1,ae),X.write_shift(1,W),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function o(B,X,q){var W={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&q.qpro?(W.s.c=B.read_shift(1),B.l++,W.s.r=B.read_shift(2),W.e.c=B.read_shift(1),B.l++,W.e.r=B.read_shift(2),W):(W.s.c=B.read_shift(2),W.s.r=B.read_shift(2),X==12&&q.qpro&&(B.l+=2),W.e.c=B.read_shift(2),W.e.r=B.read_shift(2),X==12&&q.qpro&&(B.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function l(B){var X=er(8);return X.write_shift(2,B.s.c),X.write_shift(2,B.s.r),X.write_shift(2,B.e.c),X.write_shift(2,B.e.r),X}function c(B,X,q){var W=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(W[0].c=B.read_shift(1),W[3]=B.read_shift(1),W[0].r=B.read_shift(2),B.l+=2):(W[2]=B.read_shift(1),W[0].c=B.read_shift(2),W[0].r=B.read_shift(2)),W}function f(B,X,q){var W=B.l+X,ae=c(B,X,q);if(ae[1].t="s",q.vers==20768){B.l++;var xe=B.read_shift(1);return ae[1].v=B.read_shift(xe,"utf8"),ae}return q.qpro&&B.l++,ae[1].v=B.read_shift(W-B.l,"cstr"),ae}function h(B,X,q){var W=er(7+q.length);W.write_shift(1,255),W.write_shift(2,X),W.write_shift(2,B),W.write_shift(1,39);for(var ae=0;ae<W.length;++ae){var xe=q.charCodeAt(ae);W.write_shift(1,xe>=128?95:xe)}return W.write_shift(1,0),W}function d(B,X,q){var W=c(B,X,q);return W[1].v=B.read_shift(2,"i"),W}function p(B,X,q){var W=er(7);return W.write_shift(1,255),W.write_shift(2,X),W.write_shift(2,B),W.write_shift(2,q,"i"),W}function v(B,X,q){var W=c(B,X,q);return W[1].v=B.read_shift(8,"f"),W}function m(B,X,q){var W=er(13);return W.write_shift(1,255),W.write_shift(2,X),W.write_shift(2,B),W.write_shift(8,q,"f"),W}function w(B,X,q){var W=B.l+X,ae=c(B,X,q);if(ae[1].v=B.read_shift(8,"f"),q.qpro)B.l=W;else{var xe=B.read_shift(2);N(B.slice(B.l,B.l+xe),ae),B.l+=xe}return ae}function T(B,X,q){var W=X&32768;return X&=-32769,X=(W?B:0)+(X>=8192?X-16384:X),(W?"":"$")+(q?nr(X):Tr(X))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(B,X){xr(B,0);for(var q=[],W=0,ae="",xe="",Ae="",he="";B.l<B.length;){var ge=B[B.l++];switch(ge){case 0:q.push(B.read_shift(8,"f"));break;case 1:xe=T(X[0].c,B.read_shift(2),!0),ae=T(X[0].r,B.read_shift(2),!1),q.push(xe+ae);break;case 2:{var He=T(X[0].c,B.read_shift(2),!0),z=T(X[0].r,B.read_shift(2),!1);xe=T(X[0].c,B.read_shift(2),!0),ae=T(X[0].r,B.read_shift(2),!1),q.push(He+z+":"+xe+ae)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(B.read_shift(2));break;case 6:{for(var at="";ge=B[B.l++];)at+=String.fromCharCode(ge);q.push('"'+at.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:he=q.pop(),Ae=q.pop(),q.push(["AND","OR"][ge-20]+"("+Ae+","+he+")");break;default:if(ge<32&&y[ge])he=q.pop(),Ae=q.pop(),q.push(Ae+y[ge]+he);else if(E[ge]){if(W=E[ge][1],W==69&&(W=B[B.l++]),W>q.length){console.error("WK1 bad formula parse 0x"+ge.toString(16)+":|"+q.join("|")+"|");return}var We=q.slice(-W);q.length-=W,q.push(E[ge][0]+"("+We.join(",")+")")}else return ge<=7?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=24?console.error("WK1 unsupported op "+ge.toString(16)):ge<=30?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=115?console.error("WK1 unsupported function opcode "+ge.toString(16)):console.error("WK1 unrecognized opcode "+ge.toString(16))}}q.length==1?X[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function j(B){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=B.read_shift(2),X[3]=B[B.l++],X[0].c=B[B.l++],X}function U(B,X){var q=j(B);return q[1].t="s",q[1].v=B.read_shift(X-4,"cstr"),q}function g(B,X,q,W){var ae=er(6+W.length);ae.write_shift(2,B),ae.write_shift(1,q),ae.write_shift(1,X),ae.write_shift(1,39);for(var xe=0;xe<W.length;++xe){var Ae=W.charCodeAt(xe);ae.write_shift(1,Ae>=128?95:Ae)}return ae.write_shift(1,0),ae}function k(B,X){var q=j(B);q[1].v=B.read_shift(2);var W=q[1].v>>1;if(q[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return q[1].v=W,q}function S(B,X){var q=j(B),W=B.read_shift(4),ae=B.read_shift(4),xe=B.read_shift(2);if(xe==65535)return W===0&&ae===3221225472?(q[1].t="e",q[1].v=15):W===0&&ae===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Ae=xe&32768;return xe=(xe&32767)-16446,q[1].v=(1-Ae*2)*(ae*Math.pow(2,xe+32)+W*Math.pow(2,xe)),q}function C(B,X,q,W){var ae=er(14);if(ae.write_shift(2,B),ae.write_shift(1,q),ae.write_shift(1,X),W==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var xe=0,Ae=0,he=0,ge=0;return W<0&&(xe=1,W=-W),Ae=Math.log2(W)|0,W/=Math.pow(2,Ae-31),ge=W>>>0,ge&2147483648||(W/=2,++Ae,ge=W>>>0),W-=ge,ge|=2147483648,ge>>>=0,W*=Math.pow(2,32),he=W>>>0,ae.write_shift(4,he),ae.write_shift(4,ge),Ae+=16383+(xe?32768:0),ae.write_shift(2,Ae),ae}function P(B,X){var q=S(B);return B.l+=X-14,q}function F(B,X){var q=j(B),W=B.read_shift(4);return q[1].v=W>>6,q}function O(B,X){var q=j(B),W=B.read_shift(8,"f");return q[1].v=W,q}function de(B,X){var q=O(B);return B.l+=X-10,q}function ve(B,X){return B[B.l+X-1]==0?B.read_shift(X,"cstr"):""}function Ie(B,X){var q=B[B.l++];q>X-1&&(q=X-1);for(var W="";W.length<q;)W+=String.fromCharCode(B[B.l++]);return W}function oe(B,X,q){if(!(!q.qpro||X<21)){var W=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var ae=B.read_shift(X-21,"cstr");return[W,ae]}}function ie(B,X){for(var q={},W=B.l+X;B.l<W;){var ae=B.read_shift(2);if(ae==14e3){for(q[ae]=[0,""],q[ae][0]=B.read_shift(2);B[B.l];)q[ae][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return q}function G(B,X){var q=er(5+B.length);q.write_shift(2,14e3),q.write_shift(2,X);for(var W=0;W<B.length;++W){var ae=B.charCodeAt(W);q[q.l++]=ae>127?95:ae}return q[q.l++]=0,q}var ue={0:{n:"BOF",f:qt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:Ie},65535:{n:""}},Ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:O},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function F5(t){var e={},r=t.match(Hr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Oe(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=kv[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var D5=function(){var t=lu("t"),e=lu("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:st(a[1])},l=s.match(e);return l&&(o.s=F5(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),b5=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),O5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,L5=/<(?:\w+:)?r>/,M5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function jv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=st(wt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=wt(t),r&&(n.h=Pv(n.t))):t.match(L5)&&(n.r=wt(t),n.t=st(wt((t.replace(M5,"").match(O5)||[]).join("").replace(Hr,""))),r&&(n.h=b5(D5(n.r)))),n):{t:""}}var V5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,U5=/<(?:\w+:)?(?:si|sstItem)>/g,B5=/<\/(?:\w+:)?(?:si|sstItem)>/;function j5(t,e){var r=[],n="";if(!t)return r;var i=t.match(V5);if(i){n=i[2].replace(U5,"").split(B5);for(var s=0;s!=n.length;++s){var a=jv(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=Oe(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function z5(t){return[t.read_shift(4),t.read_shift(4)]}function H5(t,e){var r=[],n=!1;return ds(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function CA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ji(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function $5(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ji(t,4),e.U=Ji(t,4),e.W=Ji(t,4),e}function W5(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function G5(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(W5(t));return e}function K5(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function q5(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ji(t,4),e.U=Ji(t,4),e.W=Ji(t,4),e}function X5(t){var e=q5(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function RA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function NA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function Y5(t){var e=Ji(t);switch(e.Minor){case 2:return[e.Minor,Q5(t)];case 3:return[e.Minor,J5()];case 4:return[e.Minor,Z5(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Q5(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=RA(t,r),i=NA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function J5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Z5(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Hr,function(s){var a=Oe(s);switch(Ri(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function e9(t,e){var r={},n=r.EncryptionVersionInfo=Ji(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=RA(t,i),e-=i,r.EncryptionVerifier=NA(t,e),r}function t9(t){var e={},r=e.EncryptionVersionInfo=Ji(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function r9(t){var e=0,r,n=CA(t),i=n.length+1,s,a,o,l,c;for(r=ea(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var PA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var f=a[c],h=0;h!=7;++h)f&64&&(o^=r[l]),f*=2,--l;return o};return function(a){for(var o=CA(a),l=s(o),c=o.length,f=ea(16),h=0;h!=16;++h)f[h]=0;var d,p,v;for((c&1)===1&&(d=l>>8,f[c]=i(t[0],d),--c,d=l&255,p=o[o.length-1],f[c]=i(p,d));c>0;)--c,d=l>>8,f[c]=i(o[c],d),--c,d=l&255,f[c]=i(o[c],d);for(c=15,v=15-o.length;v>0;)d=l>>8,f[c]=i(t[v],d),--c,--v,d=l&255,f[c]=i(o[c],d),--c,--v;return f}}(),n9=function(t,e,r,n,i){i||(i=e),n||(n=PA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},i9=function(t){var e=0,r=PA(t);return function(n){var i=n9("",n,e,r);return e=i[1],i[0]}};function s9(t,e,r,n){var i={key:qt(t),verificationBytes:qt(t)};return r.password&&(i.verifier=r9(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=i9(r.password)),i}function a9(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=t9(t):n.Data=e9(t,e),n}function o9(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?a9(t,e-2,n):s9(t,r.biff>=8?e:e-2,r,n),n}var l9=function(){function t(i,s){switch(s.type){case"base64":return e(En(i),s);case"binary":return e(i,s);case"buffer":return e(Qe&&Buffer.isBuffer(i)?i.toString("binary"):eo(i),s);case"array":return e(za(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,p=0,v,m=-1;v=d.exec(f);){switch(v[0]){case"\\cell":var w=f.slice(p,d.lastIndex-v[0].length);if(w[0]==" "&&(w=w.slice(1)),++m,w.length){var T={v:w,t:"s"};Array.isArray(o)?o[h][m]=T:o[Be({r:h,c:m})]=T}break}p=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=tt(c),o}function r(i,s){return oa(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Bt(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=Be({r:c,c:f});o=l?(i[c]||[])[f]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(cs(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function c9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function fu(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function u9(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function f9(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function Jh(t,e){if(e===0)return t;var r=u9(c9(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),fu(f9(r))}var FA=6,h9=15,d9=1,Gr=FA;function Zh(t){return Math.floor((t+Math.round(128/Gr)/256)*Gr)}function e0(t){return Math.floor((t-5)/Gr*100+.5)/100}function Tm(t){return Math.round((t*Gr+5)/Gr*256)/256}function Wd(t){return Tm(e0(Zh(t)))}function zv(t){var e=Math.abs(t-Wd(t)),r=Gr;if(e>.005)for(Gr=d9;Gr<h9;++Gr)Math.abs(t-Wd(t))<=e&&(e=Math.abs(t-Wd(t)),r=Gr);Gr=r}function hl(t){t.width?(t.wpx=Zh(t.width),t.wch=e0(t.wpx),t.MDW=Gr):t.wpx?(t.wch=e0(t.wpx),t.width=Tm(t.wch),t.MDW=Gr):typeof t.wch=="number"&&(t.width=Tm(t.wch),t.wpx=Zh(t.width),t.MDW=Gr),t.customWidth&&delete t.customWidth}var p9=96,DA=p9;function bA(t){return t*96/DA}function hu(t){return t*DA/96}var m9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function g9(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Hr)||[]).forEach(function(a){var o=Oe(a);switch(Ri(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Nt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Nt(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function v9(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Hr)||[]).forEach(function(a){var o=Oe(a);switch(Ri(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function x9(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Hr)||[]).forEach(function(a){var o=Oe(a);switch(Ri(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=wt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Nt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Nt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Nt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Nt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Nt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Nt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Nt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=kv[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Nt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Ca[i.color.index];i.color.index==81&&(l=Ca[1]),l||(l=Ca[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Jh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function _9(t,e,r){e.NumberFmt=[];for(var n=Si(ze),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ze[n[i]];var s=t[0].match(Hr);if(s)for(i=0;i<s.length;++i){var a=Oe(s[i]);switch(Ri(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=st(wt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Ia(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Rf=["numFmtId","fillId","fontId","borderId","xfId"],Nf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function y9(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Hr)||[]).forEach(function(s){var a=Oe(s),o=0;switch(Ri(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Rf.length;++o)n[Rf[o]]&&(n[Rf[o]]=parseInt(n[Rf[o]],10));for(o=0;o<Nf.length;++o)n[Nf[o]]&&(n[Nf[o]]=Nt(n[Nf[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Nt(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var w9=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&_9(h,f,c),(h=o.match(i))&&x9(h,f,l,c),(h=o.match(n))&&v9(h,f,l,c),(h=o.match(s))&&g9(h,f,l,c),(h=o.match(r))&&y9(h,f,c),f}}();function E9(t,e){var r=t.read_shift(2),n=Ur(t);return[r,n]}function T9(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=DM(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=FM(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ur(t),n}var k9=zr;function S9(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var A9=zr;function I9(t,e,r){var n={};n.NumberFmt=[];for(var i in ze)n.NumberFmt[i]=ze[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return ds(t,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Ia(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Jh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var C9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function R9(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Hr)||[]).forEach(function(i){var s=Oe(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[C9.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function N9(){}function P9(){}var F9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,D9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,b9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function O9(t,e,r){e.themeElements={};var n;[["clrScheme",F9,R9],["fontScheme",D9,N9],["fmtScheme",b9,P9]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var L9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function OA(t,e){(!t||t.length===0)&&(t=M9());var r,n={};if(!(r=t.match(L9)))throw new Error("themeElements not found in theme");return O9(r[0],n,e),n.raw=t,n}function M9(t,e){var r=[GS];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function V9(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=WS(s,{type:"array"})}catch{return}var o=vn(a,"theme/theme/theme1.xml",!0);if(o)return OA(o,r)}}function U9(t){return t.read_shift(4)}function B9(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=j9(t,4);break;case 2:e.xclrValue=wA(t);break;case 3:e.xclrValue=U9(t);break;case 4:t.l+=4;break}return t.l+=8,e}function j9(t,e){return zr(t,e)}function z9(t,e){return zr(t,e)}function H9(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=B9(t);break;case 6:n[1]=z9(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function $9(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(H9(t,r-t.l));return{ixfe:n,ext:s}}function W9(t,e){e.forEach(function(r){switch(r[0]){}})}function G9(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ur(t)}}function K9(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function q9(t){return t.l+=4,t.read_shift(4)!=0}function X9(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return ds(t,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function Y9(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(Hr,function(o){var l=Oe(o);switch(Ri(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Q9(t){var e=[];if(!t)return e;var r=1;return(t.match(Hr)||[]).forEach(function(n){var i=Oe(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function J9(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Be(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function Z9(t,e,r){var n=[];return ds(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function eV(t,e,r,n){if(!t)return t;var i=n||{},s=!1;ds(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function tV(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function ow(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Kr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=Bt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=tt(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}s.c.push(f)})}function rV(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Oe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Kr(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&jv(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function nV(t,e){var r=[],n=!1,i={},s=0;return t.replace(Hr,function(o,l){var c=Oe(o);switch(Ri(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function iV(t,e){var r=[],n=!1;return t.replace(Hr,function(s){var a=Oe(s);switch(Ri(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function sV(t){var e={};e.iauthor=t.read_shift(4);var r=ro(t);return e.rfx=r.s,e.ref=Be(r.s),t.l+=16,e}var aV=Ur;function oV(t,e){var r=[],n=[],i={},s=!1;return ds(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var lV="application/vnd.ms-office.vbaProject";function cV(t){var e=et.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(e,i,t.FileIndex[n].content)}}),et.write(e)}function uV(){return{"!type":"dialog"}}function fV(){return{"!type":"dialog"}}function hV(){return{"!type":"macro"}}function dV(){return{"!type":"macro"}}var Wo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?c+=e.r:--c,i+(o?"":"$")+nr(f)+(l?"":"$")+Tr(c)}return function(i,s){return e=s,i.replace(t,r)}}(),LA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,pV=function(){return function(e,r){return e.replace(LA,function(n,i,s,a,o,l){var c=Ov(a)-(s?0:r.c),f=bv(l)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+d})}}();function MA(t,e){return t.replace(LA,function(r,n,i,s,a,o){return n+(i=="$"?i+s:nr(Ov(s)+e.c))+(a=="$"?a+o:Tr(bv(o)+e.r))})}function mV(t,e,r){var n=Tl(e),i=n.s,s=Kr(r),a={r:s.r-i.r,c:s.c-i.c};return MA(t,a)}function gV(t){return t.length!=1}function lw(t){return t.replace(/_xlfn\./g,"")}function Wt(t){t.l+=1}function ta(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function VA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return UA(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=ta(t),o=ta(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function UA(t){var e=ta(t),r=ta(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function vV(t,e,r){if(r.biff<8)return UA(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=ta(t),a=ta(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function BA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return xV(t);var n=t.read_shift(r&&r.biff==12?4:2),i=ta(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function xV(t){var e=ta(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function _V(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function yV(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return wV(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function wV(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function EV(t,e,r){var n=(t[t.l++]&96)>>5,i=VA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function TV(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=VA(t,s,r);return[n,i,a]}function kV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function SV(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function AV(t,e,r){var n=(t[t.l++]&96)>>5,i=vV(t,e-1,r);return[n,i]}function IV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function cw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function CV(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function RV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function NV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function PV(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function FV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function jA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function DV(t){return t.read_shift(2),jA(t)}function bV(t){return t.read_shift(2),jA(t)}function OV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=BA(t,0,r);return[n,i]}function LV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=yV(t,0,r);return[n,i]}function MV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=BA(t,0,r);return[n,i,s]}function VV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[UU[i],$A[i],n]}function UV(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:BV(t);return[i,(s[0]===0?$A:VU)[s[1]]]}function BV(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function jV(t,e,r){t.l+=r&&r.biff==2?3:4}function zV(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function HV(t){return t.l++,no[t.read_shift(1)]}function $V(t){return t.l++,t.read_shift(2)}function WV(t){return t.l++,t.read_shift(1)!==0}function GV(t){return t.l++,Mr(t)}function KV(t,e,r){return t.l++,Ou(t,e-1,r)}function qV(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=jt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=no[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Mr(t);break;case 2:r[1]=io(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function XV(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ro:G0)(t));return i}function YV(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=qV(t,r.biff);return a}function QV(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function JV(t,e,r){if(r.biff==5)return ZV(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function ZV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function eU(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function tU(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function rU(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function nU(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var iU=zr,sU=zr,aU=zr;function Mu(t,e,r){return t.l+=2,[_V(t)]}function Hv(t){return t.l+=6,[]}var oU=Mu,lU=Hv,cU=Hv,uU=Mu;function zA(t){return t.l+=2,[qt(t),t.read_shift(2)&1]}var fU=Mu,hU=zA,dU=Hv,pU=Mu,mU=Mu,gU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function vU(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=gU[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function xU(t){return t.l+=2,[t.read_shift(4)]}function _U(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function yU(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function wU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function EU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function TU(t){return t.l+=4,[0,0]}var uw={1:{n:"PtgExp",f:zV},2:{n:"PtgTbl",f:aU},3:{n:"PtgAdd",f:Wt},4:{n:"PtgSub",f:Wt},5:{n:"PtgMul",f:Wt},6:{n:"PtgDiv",f:Wt},7:{n:"PtgPower",f:Wt},8:{n:"PtgConcat",f:Wt},9:{n:"PtgLt",f:Wt},10:{n:"PtgLe",f:Wt},11:{n:"PtgEq",f:Wt},12:{n:"PtgGe",f:Wt},13:{n:"PtgGt",f:Wt},14:{n:"PtgNe",f:Wt},15:{n:"PtgIsect",f:Wt},16:{n:"PtgUnion",f:Wt},17:{n:"PtgRange",f:Wt},18:{n:"PtgUplus",f:Wt},19:{n:"PtgUminus",f:Wt},20:{n:"PtgPercent",f:Wt},21:{n:"PtgParen",f:Wt},22:{n:"PtgMissArg",f:Wt},23:{n:"PtgStr",f:KV},26:{n:"PtgSheet",f:_U},27:{n:"PtgEndSheet",f:yU},28:{n:"PtgErr",f:HV},29:{n:"PtgBool",f:WV},30:{n:"PtgInt",f:$V},31:{n:"PtgNum",f:GV},32:{n:"PtgArray",f:IV},33:{n:"PtgFunc",f:VV},34:{n:"PtgFuncVar",f:UV},35:{n:"PtgName",f:QV},36:{n:"PtgRef",f:OV},37:{n:"PtgArea",f:EV},38:{n:"PtgMemArea",f:eU},39:{n:"PtgMemErr",f:iU},40:{n:"PtgMemNoMem",f:sU},41:{n:"PtgMemFunc",f:tU},42:{n:"PtgRefErr",f:rU},43:{n:"PtgAreaErr",f:kV},44:{n:"PtgRefN",f:LV},45:{n:"PtgAreaN",f:AV},46:{n:"PtgMemAreaN",f:wU},47:{n:"PtgMemNoMemN",f:EU},57:{n:"PtgNameX",f:JV},58:{n:"PtgRef3d",f:MV},59:{n:"PtgArea3d",f:TV},60:{n:"PtgRefErr3d",f:nU},61:{n:"PtgAreaErr3d",f:SV},255:{}},kU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},SU={1:{n:"PtgElfLel",f:zA},2:{n:"PtgElfRw",f:pU},3:{n:"PtgElfCol",f:oU},6:{n:"PtgElfRwV",f:mU},7:{n:"PtgElfColV",f:uU},10:{n:"PtgElfRadical",f:fU},11:{n:"PtgElfRadicalS",f:dU},13:{n:"PtgElfColS",f:lU},15:{n:"PtgElfColSV",f:cU},16:{n:"PtgElfRadicalLel",f:hU},25:{n:"PtgList",f:vU},29:{n:"PtgSxName",f:xU},255:{}},AU={0:{n:"PtgAttrNoop",f:TU},1:{n:"PtgAttrSemi",f:FV},2:{n:"PtgAttrIf",f:NV},4:{n:"PtgAttrChoose",f:CV},8:{n:"PtgAttrGoto",f:RV},16:{n:"PtgAttrSum",f:jV},32:{n:"PtgAttrBaxcel",f:cw},33:{n:"PtgAttrBaxcel",f:cw},64:{n:"PtgAttrSpace",f:DV},65:{n:"PtgAttrSpaceSemi",f:bV},128:{n:"PtgAttrIfError",f:PV},255:{}};function Vu(t,e,r,n){if(n.biff<8)return zr(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=YV(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=XV(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(zr(t,e)),s}function Uu(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=uw[s]||uw[kU[s]],(s===24||s===25)&&(i=(s===24?SU:AU)[t[t.l+1]]),!i||!i.f?zr(t,e):a.push([i.n,i.f(t,e,r)]);return a}function IU(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var CU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function RU(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function HA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function fw(t,e,r){var n=HA(t,e,r);return n=="#REF"?n:RU(n,r)}function br(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,f,h=0,d=0,p,v="";if(!t[0]||!t[0][0])return"";for(var m=-1,w="",T=0,E=t[0].length;T<E;++T){var y=t[0][T];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(t[0][m][1][0]){case 0:w=Ut(" ",t[0][m][1][1]);break;case 1:w=Ut("\r",t[0][m][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}c=c+w,m=-1}o.push(c+CU[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Tc(y[1][1],a,i),o.push(kc(f,s));break;case"PtgRefN":f=r?Tc(y[1][1],r,i):y[1][1],o.push(kc(f,s));break;case"PtgRef3d":h=y[1][1],f=Tc(y[1][2],a,i),v=fw(n,h,i),o.push(v+"!"+kc(f,s));break;case"PtgFunc":case"PtgFuncVar":var N=y[1][0],j=y[1][1];N||(N=0),N&=127;var U=N==0?[]:o.slice(-N);o.length-=N,j==="User"&&(j=U.shift()),o.push(j+"("+U.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=Wy(y[1][1],r?{s:r}:a,i),o.push(Hd(p,i));break;case"PtgArea":p=Wy(y[1][1],a,i),o.push(Hd(p,i));break;case"PtgArea3d":h=y[1][1],p=y[1][2],v=fw(n,h,i),o.push(v+"!"+Hd(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=y[1][2];var g=(n.names||[])[d-1]||(n[0]||[])[d],k=g?g.Name:"SH33TJSNAME"+String(d);k&&k.slice(0,6)=="_xlfn."&&!i.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var S=y[1][1];d=y[1][2];var C;if(i.biff<=5)S<0&&(S=-S),n[S]&&(C=n[S][d]);else{var P="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][d]&&n[S][d].itab>0&&(P=n.SheetNames[n[S][d].itab-1]+"!"):P=n.SheetNames[d-1]+"!"),n[S]&&n[S][d])P+=n[S][d].Name;else if(n[0]&&n[0][d])P+=n[0][d].Name;else{var F=(HA(n,S,i)||"").split(";;");F[d-1]?P=F[d-1]:P+="SH33TJSERRX"}o.push(P);break}C||(C={Name:"SH33TJSERRY"}),o.push(C.Name);break;case"PtgParen":var O="(",de=")";if(m>=0){switch(w="",t[0][m][1][0]){case 2:O=Ut(" ",t[0][m][1][1])+O;break;case 3:O=Ut("\r",t[0][m][1][1])+O;break;case 4:de=Ut(" ",t[0][m][1][1])+de;break;case 5:de=Ut("\r",t[0][m][1][1])+de;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}o.push(O+o.pop()+de);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:y[1][1],r:y[1][0]};var ve={c:r.c,r:r.r};if(n.sharedf[Be(f)]){var Ie=n.sharedf[Be(f)];o.push(br(Ie,a,ve,n,i))}else{var oe=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(br(c[1],a,ve,n,i)),oe=!0;break}oe||o.push(y[1])}break;case"PtgArray":o.push("{"+IU(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&ie.indexOf(t[0][T][0])==-1){y=t[0][m];var G=!0;switch(y[1][0]){case 4:G=!1;case 0:w=Ut(" ",y[1][1]);break;case 5:G=!1;case 1:w=Ut("\r",y[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((G?w:"")+o.pop()+(G?"":w)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function NU(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],zr(t,e-2)];var o=Uu(t,a,r);return e!==a+i&&(s=Vu(t,e-a-i,o,r)),t.l=n,[o,s]}function PU(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],zr(t,e-2)];var o=Uu(t,a,r);return e!==a+i&&(s=Vu(t,e-a-i,o,r)),t.l=n,[o,s]}function FU(t,e,r,n){var i=t.l+e,s=Uu(t,n,r),a;return i!==t.l&&(a=Vu(t,i-t.l,s,r)),[s,a]}function DU(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=Uu(t,s,r);return s==65535?[[],zr(t,e-2)]:(e!==s+2&&(i=Vu(t,n-s-2,a,r)),[a,i])}function bU(t){var e;if(Ki(t,t.l+6)!==65535)return[Mr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Gd(t,e,r){var n=t.l+e,i=Ni(t);r.biff==2&&++t.l;var s=bU(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=PU(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function K0(t,e,r){var n=t.read_shift(4),i=Uu(t,n,r),s=t.read_shift(4),a=s>0?Vu(t,s,i,r):null;return[i,a]}var OU=K0,q0=K0,LU=K0,MU=K0,VU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$A={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},UU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function hw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Kd(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Cc={},Go={};function Rc(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function WA(t,e,r,n,i,s){try{n.cellNF&&(t.z=ze[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=dr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ze[e]==null&&Ia(BL[e]||"General",e),t.t==="e")t.w=t.w||no[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ou(t.v);else if(t.t==="d"){var a=Qr(t.v);(a|0)===a?t.w=a.toString(10):t.w=ou(a)}else{if(t.v===void 0)return"";t.w=ja(t.v,Go)}else t.t==="d"?t.w=Un(e,Qr(t.v),Go):t.w=Un(e,t.v,Go)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Jh(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Jh(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function BU(t,e){var r=Bt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=tt(r))}var jU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,zU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,HU=/<(?:\w:)?hyperlink [^>]*>/mg,$U=/"(\w*:\w*)"/,WU=/<(?:\w:)?col\b[^>]*[\/]?>/g,GU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,KU=/<(?:\w:)?pageMargins[^>]*\/>/g,GA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,qU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,XU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function YU(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",h=t.match(zU);h?(c=t.slice(0,h.index),f=t.slice(h.index+h[0].length)):c=f=t;var d=c.match(GA);d?$v(d[0],o,i,r):(d=c.match(qU))&&QU(d[0],d[1]||"",o,i,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var v=c.slice(p,p+50).match($U);v&&BU(o,v[1])}var m=c.match(XU);m&&m[1]&&nB(m[1],i);var w=[];if(e.cellStyles){var T=c.match(WU);T&&eB(w,T)}h&&iB(h[1],o,e,l,s,a);var E=f.match(GU);E&&(o["!autofilter"]=tB(E[0]));var y=[],N=f.match(jU);if(N)for(p=0;p!=N.length;++p)y[p]=Bt(N[p].slice(N[p].indexOf('"')+1));var j=f.match(HU);j&&JU(o,j,n);var U=f.match(KU);if(U&&(o["!margins"]=ZU(Oe(U[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=tt(l)),e.sheetRows>0&&o["!ref"]){var g=Bt(o["!ref"]);e.sheetRows<=+g.e.r&&(g.e.r=e.sheetRows-1,g.e.r>l.e.r&&(g.e.r=l.e.r),g.e.r<g.s.r&&(g.s.r=g.e.r),g.e.c>l.e.c&&(g.e.c=l.e.c),g.e.c<g.s.c&&(g.s.c=g.e.c),o["!fullref"]=o["!ref"],o["!ref"]=tt(g))}return w.length>0&&(o["!cols"]=w),y.length>0&&(o["!merges"]=y),o}function $v(t,e,r,n){var i=Oe(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=st(wt(i.codeName)))}function QU(t,e,r,n,i){$v(t.slice(0,t.indexOf(">")),r,n,i)}function JU(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=Oe(wt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+st(s.location))):(s.Target="#"+st(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Bt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Be({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=s)}}}function ZU(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function eB(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Oe(e[n],!0);i.hidden&&(i.hidden=Nt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,zv(i.width)),hl(i);s<=a;)t[s++]=Er(i)}}function tB(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var rB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function nB(t,e){e.Views||(e.Views=[{}]),(t.match(rB)||[]).forEach(function(r,n){var i=Oe(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Nt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var iB=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=lu("v"),a=lu("f");return function(l,c,f,h,d,p){for(var v=0,m="",w=[],T=[],E=0,y=0,N=0,j="",U,g,k=0,S=0,C,P,F=0,O=0,de=Array.isArray(p.CellXf),ve,Ie=[],oe=[],ie=Array.isArray(c),G=[],ue={},Ee=!1,B=!!f.sheetStubs,X=l.split(e),q=0,W=X.length;q!=W;++q){m=X[q].trim();var ae=m.length;if(ae!==0){var xe=0;e:for(v=0;v<ae;++v)switch(m[v]){case">":if(m[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(g=Oe(m.slice(xe,v),!0),k=g.r!=null?parseInt(g.r,10):k+1,S=-1,f.sheetRows&&f.sheetRows<k)continue;ue={},Ee=!1,g.ht&&(Ee=!0,ue.hpt=parseFloat(g.ht),ue.hpx=hu(ue.hpt)),g.hidden=="1"&&(Ee=!0,ue.hidden=!0),g.outlineLevel!=null&&(Ee=!0,ue.level=+g.outlineLevel),Ee&&(G[k-1]=ue)}break;case"<":xe=v;break}if(xe>=v)break;if(g=Oe(m.slice(xe,v),!0),k=g.r!=null?parseInt(g.r,10):k+1,S=-1,!(f.sheetRows&&f.sheetRows<k)){h.s.r>k-1&&(h.s.r=k-1),h.e.r<k-1&&(h.e.r=k-1),f&&f.cellStyles&&(ue={},Ee=!1,g.ht&&(Ee=!0,ue.hpt=parseFloat(g.ht),ue.hpx=hu(ue.hpt)),g.hidden=="1"&&(Ee=!0,ue.hidden=!0),g.outlineLevel!=null&&(Ee=!0,ue.level=+g.outlineLevel),Ee&&(G[k-1]=ue)),w=m.slice(v).split(t);for(var Ae=0;Ae!=w.length&&w[Ae].trim().charAt(0)=="<";++Ae);for(w=w.slice(Ae),v=0;v!=w.length;++v)if(m=w[v].trim(),m.length!==0){if(T=m.match(r),E=v,y=0,N=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,T!=null&&T.length===2){for(E=0,j=T[1],y=0;y!=j.length&&!((N=j.charCodeAt(y)-64)<1||N>26);++y)E=26*E+N;--E,S=E}else++S;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,g=Oe(m.slice(0,y),!0),g.r||(g.r=Be({r:k-1,c:S})),j=m.slice(y),U={t:""},(T=j.match(s))!=null&&T[1]!==""&&(U.v=st(T[1])),f.cellFormula){if((T=j.match(a))!=null&&T[1]!==""){if(U.f=st(wt(T[1])).replace(/\r\n/g,`
`),f.xlfn||(U.f=lw(U.f)),T[0].indexOf('t="array"')>-1)U.F=(j.match(i)||[])[1],U.F.indexOf(":")>-1&&Ie.push([Bt(U.F),U.F]);else if(T[0].indexOf('t="shared"')>-1){P=Oe(T[0]);var he=st(wt(T[1]));f.xlfn||(he=lw(he)),oe[parseInt(P.si,10)]=[P,he,g.r]}}else(T=j.match(/<f[^>]*\/>/))&&(P=Oe(T[0]),oe[P.si]&&(U.f=mV(oe[P.si][1],oe[P.si][2],g.r)));var ge=Kr(g.r);for(y=0;y<Ie.length;++y)ge.r>=Ie[y][0].s.r&&ge.r<=Ie[y][0].e.r&&ge.c>=Ie[y][0].s.c&&ge.c<=Ie[y][0].e.c&&(U.F=Ie[y][1])}if(g.t==null&&U.v===void 0)if(U.f||U.F)U.v=0,U.t="n";else if(B)U.t="z";else continue;else U.t=g.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),U.t){case"n":if(U.v==""||U.v==null){if(!B)continue;U.t="z"}else U.v=parseFloat(U.v);break;case"s":if(typeof U.v>"u"){if(!B)continue;U.t="z"}else C=Cc[parseInt(U.v,10)],U.v=C.t,U.r=C.r,f.cellHTML&&(U.h=C.h);break;case"str":U.t="s",U.v=U.v!=null?wt(U.v):"",f.cellHTML&&(U.h=Pv(U.v));break;case"inlineStr":T=j.match(n),U.t="s",T!=null&&(C=jv(T[1]))?(U.v=C.t,f.cellHTML&&(U.h=C.h)):U.v="";break;case"b":U.v=Nt(U.v);break;case"d":f.cellDates?U.v=dr(U.v,1):(U.v=Qr(dr(U.v,1)),U.t="n");break;case"e":(!f||f.cellText!==!1)&&(U.w=U.v),U.v=dA[U.v];break}if(F=O=0,ve=null,de&&g.s!==void 0&&(ve=p.CellXf[g.s],ve!=null&&(ve.numFmtId!=null&&(F=ve.numFmtId),f.cellStyles&&ve.fillId!=null&&(O=ve.fillId))),WA(U,F,O,f,d,p),f.cellDates&&de&&U.t=="n"&&El(ze[F])&&(U.t="d",U.v=W0(U.v)),g.cm&&f.xlmeta){var He=(f.xlmeta.Cell||[])[+g.cm-1];He&&He.type=="XLDAPR"&&(U.D=!0)}if(ie){var z=Kr(g.r);c[z.r]||(c[z.r]=[]),c[z.r][z.c]=U}else c[g.r]=U}}}}G.length>0&&(c["!rows"]=G)}}();function sB(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var aB=ro;function oB(){}function lB(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=NM(t),r}function cB(t){var e=Bn(t);return[e]}function uB(t){var e=to(t);return[e]}function fB(t){var e=Bn(t),r=t.read_shift(1);return[e,r,"b"]}function hB(t){var e=to(t),r=t.read_shift(1);return[e,r,"b"]}function dB(t){var e=Bn(t),r=t.read_shift(1);return[e,r,"e"]}function pB(t){var e=to(t),r=t.read_shift(1);return[e,r,"e"]}function mB(t){var e=Bn(t),r=t.read_shift(4);return[e,r,"s"]}function gB(t){var e=to(t),r=t.read_shift(4);return[e,r,"s"]}function vB(t){var e=Bn(t),r=Mr(t);return[e,r,"n"]}function KA(t){var e=to(t),r=Mr(t);return[e,r,"n"]}function xB(t){var e=Bn(t),r=Vv(t);return[e,r,"n"]}function _B(t){var e=to(t),r=Vv(t);return[e,r,"n"]}function yB(t){var e=Bn(t),r=Lv(t);return[e,r,"is"]}function wB(t){var e=Bn(t),r=Ur(t);return[e,r,"str"]}function EB(t){var e=to(t),r=Ur(t);return[e,r,"str"]}function TB(t,e,r){var n=t.l+e,i=Bn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=q0(t,n-t.l,r);a[3]=br(o,null,i,r.supbooks,r)}else t.l=n;return a}function kB(t,e,r){var n=t.l+e,i=Bn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=q0(t,n-t.l,r);a[3]=br(o,null,i,r.supbooks,r)}else t.l=n;return a}function SB(t,e,r){var n=t.l+e,i=Bn(t);i.r=r["!row"];var s=Mr(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=q0(t,n-t.l,r);a[3]=br(o,null,i,r.supbooks,r)}else t.l=n;return a}function AB(t,e,r){var n=t.l+e,i=Bn(t);i.r=r["!row"];var s=Ur(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=q0(t,n-t.l,r);a[3]=br(o,null,i,r.supbooks,r)}else t.l=n;return a}var IB=ro;function CB(t,e){var r=t.l+e,n=ro(t),i=Mv(t),s=Ur(t),a=Ur(t),o=Ur(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function RB(){}function NB(t,e,r){var n=t.l+e,i=uA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=OU(t,n-t.l,r);a[1]=o}else t.l=n;return a}function PB(t,e,r){var n=t.l+e,i=ro(t),s=[i];if(r.cellFormula){var a=MU(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}var FB=["left","right","top","bottom","header","footer"];function DB(t){var e={};return FB.forEach(function(r){e[r]=Mr(t)}),e}function bB(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function OB(){}function LB(){}function MB(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,p,v,m,w,T,E,y,N,j,U=[];o.biff=12,o["!row"]=0;var g=0,k=!1,S=[],C={},P=o.supbooks||i.supbooks||[[]];if(P.sharedf=C,P.arrayf=S,P.SheetNames=i.SheetNames||i.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=P,i.Names))for(var F=0;F<i.Names.length;++F)P[0][F+1]=i.Names[F];var O=[],de=[],ve=!1;t0[16]={n:"BrtShortReal",f:KA};var Ie;if(ds(t,function(G,ue,Ee){if(!d)switch(Ee){case 148:c=G;break;case 0:p=G,o.sheetRows&&o.sheetRows<=p.r&&(d=!0),N=Tr(w=p.r),o["!row"]=p.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=hu(G.hpt)),de[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:G[2]},G[2]){case"n":v.v=G[1];break;case"s":y=Cc[G[1]],v.v=y.t,v.r=y.r;break;case"b":v.v=!!G[1];break;case"e":v.v=G[1],o.cellText!==!1&&(v.w=no[v.v]);break;case"str":v.t="s",v.v=G[1];break;case"is":v.t="s",v.v=G[1].t;break}if((m=a.CellXf[G[0].iStyleRef])&&WA(v,m.numFmtId,null,o,s,a),T=G[0].c==-1?T+1:G[0].c,o.dense?(l[w]||(l[w]=[]),l[w][T]=v):l[nr(T)+N]=v,o.cellFormula){for(k=!1,g=0;g<S.length;++g){var B=S[g];p.r>=B[0].s.r&&p.r<=B[0].e.r&&T>=B[0].s.c&&T<=B[0].e.c&&(v.F=tt(B[0]),k=!0)}!k&&G.length>3&&(v.f=G[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>T&&(f.s.c=T),f.e.r<p.r&&(f.e.r=p.r),f.e.c<T&&(f.e.c=T),o.cellDates&&m&&v.t=="n"&&El(ze[m.numFmtId])){var X=Ea(v.v);X&&(v.t="d",v.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}Ie&&(Ie.type=="XLDAPR"&&(v.D=!0),Ie=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;v={t:"z",v:void 0},T=G[0].c==-1?T+1:G[0].c,o.dense?(l[w]||(l[w]=[]),l[w][T]=v):l[nr(T)+N]=v,f.s.r>p.r&&(f.s.r=p.r),f.s.c>T&&(f.s.c=T),f.e.r<p.r&&(f.e.r=p.r),f.e.c<T&&(f.e.c=T),Ie&&(Ie.type=="XLDAPR"&&(v.D=!0),Ie=void 0);break;case 176:U.push(G);break;case 49:Ie=((o.xlmeta||{}).Cell||[])[G-1];break;case 494:var q=n["!id"][G.relId];for(q?(G.Target=q.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=q):G.relId==""&&(G.Target="#"+G.loc),w=G.rfx.s.r;w<=G.rfx.e.r;++w)for(T=G.rfx.s.c;T<=G.rfx.e.c;++T)o.dense?(l[w]||(l[w]=[]),l[w][T]||(l[w][T]={t:"z",v:void 0}),l[w][T].l=G):(E=Be({c:T,r:w}),l[E]||(l[E]={t:"z",v:void 0}),l[E].l=G);break;case 426:if(!o.cellFormula)break;S.push(G),j=o.dense?l[w][T]:l[nr(T)+N],j.f=br(G[1],f,{r:p.r,c:T},P,o),j.F=tt(G[0]);break;case 427:if(!o.cellFormula)break;C[Be(G[0].s)]=G[1],j=o.dense?l[w][T]:l[nr(T)+N],j.f=br(G[1],f,{r:p.r,c:T},P,o);break;case 60:if(!o.cellStyles)break;for(;G.e>=G.s;)O[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},ve||(ve=!0,zv(G.w/256)),hl(O[G.e+1]);break;case 161:l["!autofilter"]={ref:tt(G)};break;case 476:l["!margins"]=G;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),G.name&&(i.Sheets[r].CodeName=G.name),(G.above||G.left)&&(l["!outline"]={above:G.above,left:G.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),G.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ue.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Ee.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=tt(c||f)),o.sheetRows&&l["!ref"]){var oe=Bt(l["!ref"]);o.sheetRows<=+oe.e.r&&(oe.e.r=o.sheetRows-1,oe.e.r>f.e.r&&(oe.e.r=f.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>f.e.c&&(oe.e.c=f.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),l["!fullref"]=l["!ref"],l["!ref"]=tt(oe))}return U.length>0&&(l["!merges"]=U),O.length>0&&(l["!cols"]=O),de.length>0&&(l["!rows"]=de),l}function VB(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=st((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function UB(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=VB(h);f.s.r=f.s.c=0,f.e.c=o,c=nr(o),d[0].forEach(function(p,v){a[c+Tr(v)]={t:"n",v:p,z:d[1]},l=v}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(a["!ref"]=tt(f)),a}function BB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(GA);return o&&$v(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function jB(t,e){t.l+=10;var r=Ur(t);return{name:r}}function zB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return ds(t,function(l,c,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var qA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],HB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],$B=[],WB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function dw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Nt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function pw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Nt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function XA(t){pw(t.WBProps,qA),pw(t.CalcPr,WB),dw(t.WBView,HB),dw(t.Sheets,$B),Go.date1904=Nt(t.WBProps.date1904)}var GB="][*?/\\".split("");function KB(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return GB.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var qB=/<\w+:workbook/;function XB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(Hr,function(l,c){var f=Oe(l);switch(Ri(f[0])){case"<?xml":break;case"<workbook":l.match(qB)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":qA.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Nt(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=wt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=st(wt(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=wt(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),Nt(f.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=st(wt(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),dM.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return XA(r),r}function YB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=ym(t),r.name=Ur(t),r}function QB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Ur(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function JB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function ZB(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=PM(t),a=LU(t,0,r),o=Mv(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function e7(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],t0[16]={n:"BrtFRTArchID$",f:JB},ds(t,function(l,c,f){switch(f){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=br(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),XA(r),r.Names=s,r.supbooks=a,r}function t7(t,e,r){return e.slice(-4)===".bin"?e7(t,r):XB(t,r)}function r7(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?MB(t,n,r,i,s,a,o):YU(t,n,r,i,s,a,o)}function n7(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?zB(t,n,r,i,s):BB(t,n,r,i,s)}function i7(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?hV():dV()}function s7(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?uV():fV()}function a7(t,e,r,n){return e.slice(-4)===".bin"?I9(t,r,n):w9(t,r,n)}function o7(t,e,r){return OA(t,r)}function l7(t,e,r){return e.slice(-4)===".bin"?H5(t,r):j5(t,r)}function c7(t,e,r){return e.slice(-4)===".bin"?oV(t,r):rV(t,r)}function u7(t,e,r){return e.slice(-4)===".bin"?Z9(t):Q9(t)}function f7(t,e,r,n){return r.slice(-4)===".bin"?eV(t,e,r,n):void 0}function h7(t,e,r){return e.slice(-4)===".bin"?X9(t,e,r):Y9(t,e,r)}var YA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,QA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function $n(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(YA),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(QA),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function d7(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(YA),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(QA),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Nc;function p7(t,e){var r=Nc[t]||st(t);return r==="General"?ja(e):Un(r,e)}function m7(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Nt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=dr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[st(e)]=i}function g7(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||no[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ou(t.v):t.w=ja(t.v):t.w=p7(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Nc[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&El(n)){var i=Ea(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function v7(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=m9[n.Pattern]||n.Pattern)}t[e.ID]=e}function x7(t,e,r,n,i,s,a,o,l,c){var f="General",h=n.StyleID,d={};c=c||{};var p=[],v=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(f=s[h].nf),s[h].Interior&&p.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Nt(t);break;case"String":n.t="s",n.r=Ly(st(t)),n.v=t.indexOf("<")>-1?st(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(dr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=st(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=dA[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Ly(e||t));break}if(g7(n,f,c),c.cellFormula!==!1)if(n.Formula){var m=st(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Wo(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Wo("RC:RC",i):n.ArrayRange&&(n.F=Wo(n.ArrayRange,i),l.push([Bt(n.F),n.F]))}else for(v=0;v<l.length;++v)i.r>=l[v][0].s.r&&i.r<=l[v][0].e.r&&i.c>=l[v][0].s.c&&i.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(p.forEach(function(w){!d.patternType&&w.patternType&&(d.patternType=w.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function _7(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function qd(t,e){var r=e||{};US();var n=tc(Fv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=wt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=Er(r);return a.type="string",uu.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Et){i.indexOf("<"+Et)>=0&&(s=!0)}),s)return C7(n,r);Nc={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},h=[],d=r.dense?[]:{},p="",v={},m={},w=$n('<Data ss:Type="String">'),T=0,E=0,y=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},U={},g="",k=0,S=[],C={},P={},F=0,O=[],de=[],ve={},Ie=[],oe,ie=!1,G=[],ue=[],Ee={},B=0,X=0,q={Sheets:[],WBProps:{date1904:!1}},W={};cu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";o=cu.exec(n);)switch(o[3]=(ae=o[3]).toLowerCase()){case"data":if(ae=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?x7(n.slice(T,o.index),g,w,l[l.length-1][0]=="comment"?ve:v,{c:E,r:y},j,Ie[E],m,G,r):(g="",w=$n(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(de.length>0&&(v.c=de),(!r.sheetRows||r.sheetRows>y)&&v.v!==void 0&&(r.dense?(d[y]||(d[y]=[]),d[y][E]=v):d[nr(E)+Tr(y)]=v),v.HRef&&(v.l={Target:st(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(B=E+(parseInt(v.MergeAcross,10)|0),X=y+(parseInt(v.MergeDown,10)|0),S.push({s:{c:E,r:y},e:{c:B,r:X}})),!r.sheetStubs)v.MergeAcross?E=B+1:++E;else if(v.MergeAcross||v.MergeDown){for(var xe=E;xe<=B;++xe)for(var Ae=y;Ae<=X;++Ae)(xe>E||Ae>y)&&(r.dense?(d[Ae]||(d[Ae]=[]),d[Ae][xe]={t:"z"}):d[nr(xe)+Tr(Ae)]={t:"z"});E=B+1}else++E;else v=d7(o[0]),v.Index&&(E=+v.Index-1),E<N.s.c&&(N.s.c=E),E>N.e.c&&(N.e.c=E),o[0].slice(-2)==="/>"&&++E,de=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<N.s.r&&(N.s.r=y),y>N.e.r&&(N.e.r=y),o[0].slice(-2)==="/>"&&(m=$n(o[0]),m.Index&&(y=+m.Index-1)),E=0,++y):(m=$n(o[0]),m.Index&&(y=+m.Index-1),Ee={},(m.AutoFitHeight=="0"||m.Height)&&(Ee.hpx=parseInt(m.Height,10),Ee.hpt=bA(Ee.hpx),ue[y]=Ee),m.Hidden=="1"&&(Ee.hidden=!0,ue[y]=Ee));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(d["!ref"]=tt(N),r.sheetRows&&r.sheetRows<=N.e.r&&(d["!fullref"]=d["!ref"],N.e.r=r.sheetRows-1,d["!ref"]=tt(N))),S.length&&(d["!merges"]=S),Ie.length>0&&(d["!cols"]=Ie),ue.length>0&&(d["!rows"]=ue),f[p]=d}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=E=0,l.push([o[3],!1]),c=$n(o[0]),p=st(c.Name),d=r.dense?[]:{},S=[],G=[],ue=[],W={name:p,Hidden:0},q.Sheets.push(W);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Ie=[],ie=!1}break;case"style":o[1]==="/"?v7(j,U,r):U=$n(o[0]);break;case"numberformat":U.nf=st($n(o[0]).Format||"General"),Nc[U.nf]&&(U.nf=Nc[U.nf]);for(var he=0;he!=392&&ze[he]!=U.nf;++he);if(he==392){for(he=57;he!=392;++he)if(ze[he]==null){Ia(U.nf,he);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(oe=$n(o[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!ie&&oe.wpx>10){ie=!0,Gr=FA;for(var ge=0;ge<Ie.length;++ge)Ie[ge]&&hl(Ie[ge])}ie&&hl(oe),Ie[oe.Index-1||Ie.length]=oe;for(var He=0;He<+oe.Span;++He)Ie[Ie.length]=Er(oe);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var z=Oe(o[0]),at={Name:z.Name,Ref:Wo(z.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(at.Sheet=q.Sheets.length-1),q.Names.push(at);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?g+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;U.Interior=$n(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?r8(C,ae,n.slice(F,o.index)):F=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));_7(ve),de.push(ve)}else l.push([o[3],!1]),c=$n(o[0]),ve={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var We=$n(o[0]);d["!autofilter"]={ref:Wo(We.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return yw(n,r);var rt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:rt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:rt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:rt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:rt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(F,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else F=o.index+o[0].length;break;case"header":d["!margins"]||Rc(d["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(d["!margins"].header=+Oe(o[0]).Margin);break;case"footer":d["!margins"]||Rc(d["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(d["!margins"].footer=+Oe(o[0]).Margin);break;case"pagemargins":var be=Oe(o[0]);d["!margins"]||Rc(d["!margins"]={},"xlml"),isNaN(+be.Top)||(d["!margins"].top=+be.Top),isNaN(+be.Left)||(d["!margins"].left=+be.Left),isNaN(+be.Right)||(d["!margins"].right=+be.Right),isNaN(+be.Bottom)||(d["!margins"].bottom=+be.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:rt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:rt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:rt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:rt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:rt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:rt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:rt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:rt=!1}break;case"smarttags":break;default:rt=!1;break}if(rt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?m7(P,ae,O,n.slice(F,o.index)):(O=o,F=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Se={};return!r.bookSheets&&!r.bookProps&&(Se.Sheets=f),Se.SheetNames=h,Se.Workbook=q,Se.SSF=Er(ze),Se.Props=C,Se.Custprops=P,Se}function km(t,e){switch(Kv(e=e||{}),e.type||"base64"){case"base64":return qd(En(t),e);case"binary":case"buffer":case"file":return qd(t,e);case"array":return qd(eo(t),e)}}function y7(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=bM(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=OM(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var w7=[60,1084,2066,2165,2175];function E7(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Ki(r,r.l),c=Sm[l],f=0;c!=null&&w7.indexOf(l)>-1;)s=Ki(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),a.push(o),r.l+=4+s,c=Sm[l=Ki(r,r.l)];var h=Cs(a);xr(h,0);var d=0;h.lens=[];for(var p=0;p<a.length;++p)h.lens.push(d),d+=a[p].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function hi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ze[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||no[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ou(t.v):t.w=ja(t.v):t.w=Un(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&El(ze[n]||String(n))){var i=Ea(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Pf(t,e,r){return{v:t,ixfe:e,t:r}}function T7(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],c="",f={},h,d="",p,v,m,w,T={},E=[],y,N,j=[],U=[],g={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},S=function(Ve){return Ve<8?Ca[Ve]:Ve<64&&U[Ve-8]||Ca[Ve]},C=function(Ve,vt,$t){var ct=vt.XF.data;if(!(!ct||!ct.patternType||!$t||!$t.cellStyles)){vt.s={},vt.s.patternType=ct.patternType;var hn;(hn=fu(S(ct.icvFore)))&&(vt.s.fgColor={rgb:hn}),(hn=fu(S(ct.icvBack)))&&(vt.s.bgColor={rgb:hn})}},P=function(Ve,vt,$t){if(!(Ee>1)&&!($t.sheetRows&&Ve.r>=$t.sheetRows)){if($t.cellStyles&&vt.XF&&vt.XF.data&&C(Ve,vt,$t),delete vt.ixfe,delete vt.XF,h=Ve,d=Be(Ve),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ve.r<a.s.r&&(a.s.r=Ve.r),Ve.c<a.s.c&&(a.s.c=Ve.c),Ve.r+1>a.e.r&&(a.e.r=Ve.r+1),Ve.c+1>a.e.c&&(a.e.c=Ve.c+1),$t.cellFormula&&vt.f){for(var ct=0;ct<E.length;++ct)if(!(E[ct][0].s.c>Ve.c||E[ct][0].s.r>Ve.r)&&!(E[ct][0].e.c<Ve.c||E[ct][0].e.r<Ve.r)){vt.F=tt(E[ct][0]),(E[ct][0].s.c!=Ve.c||E[ct][0].s.r!=Ve.r)&&delete vt.f,vt.f&&(vt.f=""+br(E[ct][1],a,Ve,G,F));break}}$t.dense?(i[Ve.r]||(i[Ve.r]=[]),i[Ve.r][Ve.c]=vt):i[d]=vt}},F={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(F.password=e.password);var O,de=[],ve=[],Ie=[],oe=[],ie=!1,G=[];G.SheetNames=F.snames,G.sharedf=F.sharedf,G.arrayf=F.arrayf,G.names=[],G.XTI=[];var ue=0,Ee=0,B=0,X=[],q=[],W;F.codepage=1200,Zn(1200);for(var ae=!1;t.l<t.length-1;){var xe=t.l,Ae=t.read_shift(2);if(Ae===0&&ue===10)break;var he=t.l===t.length?0:t.read_shift(2),ge=Sm[Ae];if(ge&&ge.f){if(e.bookSheets&&ue===133&&Ae!==133)break;if(ue=Ae,ge.r===2||ge.r==12){var He=t.read_shift(2);if(he-=2,!F.enc&&He!==Ae&&((He&255)<<8|He>>8)!==Ae)throw new Error("rt mismatch: "+He+"!="+Ae);ge.r==12&&(t.l+=10,he-=10)}var z={};if(Ae===10?z=ge.f(t,he,F):z=E7(Ae,ge,t,he,F),Ee==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(Ae){case 34:r.opts.Date1904=g.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(t.l=0),F.enc=z,!e.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=z;break;case 66:var at=Number(z);switch(at){case 21010:at=1200;break;case 32768:at=1e4;break;case 32769:at=1252;break}Zn(F.codepage=at),ae=!0;break;case 317:F.rrtabid=z;break;case 25:F.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:F.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(i["!type"]="dialog"),z.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),z.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:j.push(z);break;case 430:G.push([z]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(z);break;case 24:case 536:W={Name:z.Name,Ref:br(z.rgce,a,null,G,F)},z.itab>0&&(W.Sheet=z.itab-1),G.names.push(W),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(q[z.itab-1]={ref:tt(z.rgce[0][0][1][2])});break;case 22:F.ExternCount=z;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(z),G.XTI=G.XTI.concat(z);break;case 2196:if(F.biff<8)break;W!=null&&(W.Comment=z[1]);break;case 18:i["!protect"]=z;break;case 19:z!==0&&F.WTF&&console.error("Password verifier: "+z);break;case 133:s[z.pos]=z,F.snames.push(z.name);break;case 10:{if(--Ee)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=tt(a),e.sheetRows&&e.sheetRows<=a.e.r){var We=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=tt(a),a.e.r=We}a.e.r++,a.e.c++}de.length>0&&(i["!merges"]=de),ve.length>0&&(i["!objects"]=ve),Ie.length>0&&(i["!cols"]=Ie),oe.length>0&&(i["!rows"]=oe),g.Sheets.push(k)}c===""?f=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[Ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),F.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(F.biff=5,ae=!0,Zn(F.codepage=28591)),F.biff==8&&z.BIFFVer==0&&z.dt==16&&(F.biff=2),Ee++)break;if(i=e.dense?[]:{},F.biff<8&&!ae&&(ae=!0,Zn(F.codepage=e.codepage||1252)),F.biff<5||z.BIFFVer==0&&z.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var rt={pos:t.l-he,name:c};s[rt.pos]=rt,F.snames.push(c)}else c=(s[xe]||{name:""}).name;z.dt==32&&(i["!type"]="chart"),z.dt==64&&(i["!type"]="macro"),de=[],ve=[],F.arrayf=E=[],Ie=[],oe=[],ie=!1,k={Hidden:(s[xe]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[z.r]||[])[z.c]:i[Be({c:z.c,r:z.r})])&&++z.c,y={ixfe:z.ixfe,XF:j[z.ixfe]||{},v:z.val,t:"n"},B>0&&(y.z=X[y.ixfe>>8&63]),hi(y,e,r.opts.Date1904),P({c:z.c,r:z.r},y,e);break;case 5:case 517:y={ixfe:z.ixfe,XF:j[z.ixfe],v:z.val,t:z.t},B>0&&(y.z=X[y.ixfe>>8&63]),hi(y,e,r.opts.Date1904),P({c:z.c,r:z.r},y,e);break;case 638:y={ixfe:z.ixfe,XF:j[z.ixfe],v:z.rknum,t:"n"},B>0&&(y.z=X[y.ixfe>>8&63]),hi(y,e,r.opts.Date1904),P({c:z.c,r:z.r},y,e);break;case 189:for(var be=z.c;be<=z.C;++be){var Se=z.rkrec[be-z.c][0];y={ixfe:Se,XF:j[Se],v:z.rkrec[be-z.c][1],t:"n"},B>0&&(y.z=X[y.ixfe>>8&63]),hi(y,e,r.opts.Date1904),P({c:be,r:z.r},y,e)}break;case 6:case 518:case 1030:{if(z.val=="String"){o=z;break}if(y=Pf(z.val,z.cell.ixfe,z.tt),y.XF=j[y.ixfe],e.cellFormula){var Et=z.formula;if(Et&&Et[0]&&Et[0][0]&&Et[0][0][0]=="PtgExp"){var ar=Et[0][0][1][0],Ar=Et[0][0][1][1],en=Be({r:ar,c:Ar});T[en]?y.f=""+br(z.formula,a,z.cell,G,F):y.F=((e.dense?(i[ar]||[])[Ar]:i[en])||{}).F}else y.f=""+br(z.formula,a,z.cell,G,F)}B>0&&(y.z=X[y.ixfe>>8&63]),hi(y,e,r.opts.Date1904),P(z.cell,y,e),o=z}break;case 7:case 519:if(o)o.val=z,y=Pf(z,o.cell.ixfe,"s"),y.XF=j[y.ixfe],e.cellFormula&&(y.f=""+br(o.formula,a,o.cell,G,F)),B>0&&(y.z=X[y.ixfe>>8&63]),hi(y,e,r.opts.Date1904),P(o.cell,y,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(z);var Pi=Be(z[0].s);if(p=e.dense?(i[z[0].s.r]||[])[z[0].s.c]:i[Pi],e.cellFormula&&p){if(!o||!Pi||!p)break;p.f=""+br(z[1],a,z[0],G,F),p.F=tt(z[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;T[Be(o.cell)]=z[0],p=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Be(o.cell)],(p||{}).f=""+br(z[0],a,h,G,F)}}break;case 253:y=Pf(l[z.isst].t,z.ixfe,"s"),l[z.isst].h&&(y.h=l[z.isst].h),y.XF=j[y.ixfe],B>0&&(y.z=X[y.ixfe>>8&63]),hi(y,e,r.opts.Date1904),P({c:z.c,r:z.r},y,e);break;case 513:e.sheetStubs&&(y={ixfe:z.ixfe,XF:j[z.ixfe],t:"z"},B>0&&(y.z=X[y.ixfe>>8&63]),hi(y,e,r.opts.Date1904),P({c:z.c,r:z.r},y,e));break;case 190:if(e.sheetStubs)for(var tn=z.c;tn<=z.C;++tn){var Tt=z.ixfe[tn-z.c];y={ixfe:Tt,XF:j[Tt],t:"z"},B>0&&(y.z=X[y.ixfe>>8&63]),hi(y,e,r.opts.Date1904),P({c:tn,r:z.r},y,e)}break;case 214:case 516:case 4:y=Pf(z.val,z.ixfe,"s"),y.XF=j[y.ixfe],B>0&&(y.z=X[y.ixfe>>8&63]),hi(y,e,r.opts.Date1904),P({c:z.c,r:z.r},y,e);break;case 0:case 512:Ee===1&&(a=z);break;case 252:l=z;break;case 1054:if(F.biff==4){X[B++]=z[1];for(var or=0;or<B+163&&ze[or]!=z[1];++or);or>=163&&Ia(z[1],B+163)}else Ia(z[1],z[0]);break;case 30:{X[B++]=z;for(var gt=0;gt<B+163&&ze[gt]!=z;++gt);gt>=163&&Ia(z,B+163)}break;case 229:de=de.concat(z);break;case 93:ve[z.cmo[0]]=F.lastobj=z;break;case 438:F.lastobj.TxO=z;break;case 127:F.lastobj.ImData=z;break;case 440:for(w=z[0].s.r;w<=z[0].e.r;++w)for(m=z[0].s.c;m<=z[0].e.c;++m)p=e.dense?(i[w]||[])[m]:i[Be({c:m,r:w})],p&&(p.l=z[1]);break;case 2048:for(w=z[0].s.r;w<=z[0].e.r;++w)for(m=z[0].s.c;m<=z[0].e.c;++m)p=e.dense?(i[w]||[])[m]:i[Be({c:m,r:w})],p&&p.l&&(p.l.Tooltip=z[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;p=e.dense?(i[z[0].r]||[])[z[0].c]:i[Be(z[0])];var kt=ve[z[2]];p||(e.dense?(i[z[0].r]||(i[z[0].r]=[]),p=i[z[0].r][z[0].c]={t:"z"}):p=i[Be(z[0])]={t:"z"},a.e.r=Math.max(a.e.r,z[0].r),a.s.r=Math.min(a.s.r,z[0].r),a.e.c=Math.max(a.e.c,z[0].c),a.s.c=Math.min(a.s.c,z[0].c)),p.c||(p.c=[]),v={a:z[1],t:kt.TxO.t},p.c.push(v)}break;case 2173:W9(j[z.ixfe],z.ext);break;case 125:{if(!F.cellStyles)break;for(;z.e>=z.s;)Ie[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},ie||(ie=!0,zv(z.w/256)),hl(Ie[z.e+1])}break;case 520:{var ft={};z.level!=null&&(oe[z.r]=ft,ft.level=z.level),z.hidden&&(oe[z.r]=ft,ft.hidden=!0),z.hpt&&(oe[z.r]=ft,ft.hpt=z.hpt,ft.hpx=hu(z.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Rc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ae]]=z;break;case 161:i["!margins"]||Rc(i["!margins"]={}),i["!margins"].header=z.header,i["!margins"].footer=z.footer;break;case 574:z.RTL&&(g.Views[0].RTL=!0);break;case 146:U=z;break;case 2198:O=z;break;case 140:N=z;break;case 442:c?k.CodeName=z||k.name:g.WBProps.CodeName=z||"ThisWorkbook";break}}else ge||console.error("Missing Info for XLS Record 0x"+Ae.toString(16)),t.l+=he}return r.SheetNames=Si(s).sort(function(Ft,Ve){return Number(Ft)-Number(Ve)}).map(function(Ft){return s[Ft].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&q.forEach(function(Ft,Ve){r.Sheets[r.SheetNames[Ve]]["!autofilter"]=Ft}),r.Strings=l,r.SSF=Er(ze),F.enc&&(r.Encryption=F.enc),O&&(r.Themes=O),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),G.names.length>0&&(g.Names=G.names),r.Workbook=g,r}var mw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function k7(t,e,r){var n=et.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Jy(n,jM,mw.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=et.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=Jy(a,zM,mw.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(mA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function JA(t,e){e||(e={}),Kv(e),IS(),e.codepage&&Sv(e.codepage);var r,n;if(t.FullPaths){if(et.find(t,"/encryption"))throw new Error("File is password-protected");r=et.find(t,"!CompObj"),n=et.find(t,"/Workbook")||et.find(t,"/Book")}else{switch(e.type){case"base64":t=Yn(En(t));break;case"binary":t=Yn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}xr(t,0),n={content:t}}var i,s;if(r&&y7(r),e.bookProps&&!e.bookSheets)i={};else{var a=Qe?"buffer":"array";if(n&&n.content)i=T7(n.content,e);else if((s=et.find(t,"PerfectOffice_MAIN"))&&s.content)i=Ic.to_workbook(s.content,(e.type=a,e));else if((s=et.find(t,"NativeContent_MAIN"))&&s.content)i=Ic.to_workbook(s.content,(e.type=a,e));else throw(s=et.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&et.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=cV(t))}var o={};return t.FullPaths&&k7(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}var t0={0:{f:sB},1:{f:cB},2:{f:xB},3:{f:dB},4:{f:fB},5:{f:vB},6:{f:wB},7:{f:mB},8:{f:AB},9:{f:SB},10:{f:TB},11:{f:kB},12:{f:uB},13:{f:_B},14:{f:pB},15:{f:hB},16:{f:KA},17:{f:EB},18:{f:gB},19:{f:Lv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ZB},40:{},42:{},43:{f:T9},44:{f:E9},45:{f:k9},46:{f:A9},47:{f:S9},48:{},49:{f:IM},50:{},51:{f:K9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:IA},62:{f:yB},63:{f:J9},64:{f:OB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:zr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:bB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:lB},148:{f:aB,p:16},151:{f:RB},152:{},153:{f:QB},154:{},155:{},156:{f:YB},157:{},158:{},159:{T:1,f:z5},160:{T:-1},161:{T:1,f:ro},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:IB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:G9},336:{T:-1},337:{f:q9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ym},357:{},358:{},359:{},360:{T:1},361:{},362:{f:AA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:NB},427:{f:PB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:DB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:oB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:CB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ym},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:aV},633:{T:1},634:{T:-1},635:{T:1,f:sV},636:{T:-1},637:{f:RM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:jB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:LB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Sm={6:{f:Gd},10:{f:_s},12:{f:qt},13:{f:qt},14:{f:jt},15:{f:jt},16:{f:Mr},17:{f:jt},18:{f:jt},19:{f:qt},20:{f:rw},21:{f:rw},23:{f:AA},24:{f:iw},25:{f:jt},26:{},27:{},28:{f:n5},29:{},34:{f:jt},35:{f:nw},38:{f:Mr},39:{f:Mr},40:{f:Mr},41:{f:Mr},42:{f:jt},43:{f:jt},47:{f:o9},49:{f:V8},51:{f:qt},60:{},61:{f:O8},64:{f:jt},65:{f:M8},66:{f:qt},77:{},80:{},81:{},82:{},85:{f:qt},89:{},90:{},91:{},92:{f:I8},93:{f:s5},94:{},95:{f:jt},96:{},97:{},99:{f:jt},125:{f:IA},128:{f:q8},129:{f:C8},130:{f:qt},131:{f:jt},132:{f:jt},133:{f:R8},134:{},140:{f:f5},141:{f:qt},144:{},146:{f:d5},151:{},152:{},153:{},154:{},155:{},156:{f:qt},157:{},158:{},160:{f:x5},161:{f:m5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:$8},190:{f:W8},193:{f:_s},197:{},198:{},199:{},200:{},201:{},202:{f:jt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:qt},220:{},221:{f:jt},222:{},224:{f:K8},225:{f:A8},226:{f:_s},227:{},229:{f:i5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:N8},253:{f:U8},255:{f:P8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:yA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:jt},353:{f:_s},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Y8},431:{f:jt},432:{},433:{},434:{},437:{},438:{f:l5},439:{f:jt},440:{f:c5},441:{},442:{f:Lu},443:{},444:{f:qt},445:{},446:{},448:{f:_s},449:{f:b8,r:2},450:{f:_s},512:{f:ew},513:{f:v5},515:{f:X8},516:{f:B8},517:{f:tw},519:{f:_5},520:{f:F8},523:{},545:{f:sw},549:{f:Zy},566:{},574:{f:L8},638:{f:H8},659:{},1048:{},1054:{f:j8},1084:{},1212:{f:e5},2048:{f:u5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Cf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_s},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:p5,r:12},2173:{f:$9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:jt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Z8,r:12},2197:{},2198:{f:V9,r:12},2199:{},2200:{},2201:{},2202:{f:t5,r:12},2203:{f:_s},2204:{},2205:{},2206:{},2207:{},2211:{f:D8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:qt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:g5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:h5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ew},1:{},2:{f:T5},3:{f:E5},4:{f:w5},5:{f:tw},7:{f:k5},8:{},9:{f:Cf},11:{},22:{f:qt},30:{f:z8},31:{},32:{},33:{f:sw},36:{},37:{f:Zy},50:{f:S5},62:{},52:{},67:{},68:{f:qt},69:{},86:{},126:{},127:{f:y5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:A5},223:{},234:{},354:{},421:{},518:{f:Gd},521:{f:Cf},536:{f:iw},547:{f:nw},561:{},579:{},1030:{f:Gd},1033:{f:Cf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Wn(t,e,r,n){var i=e;if(!isNaN(i)){var s=(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&oA(r)&&t.push(r)}}function gw(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=XL(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,h=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(a=0;a<l.length;++a){var m=l[a].trim(),w=m.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var T=m.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var E=T[o].trim();if(E.match(/<t[dh]/i)){for(var y=E,N=0;y.charAt(0)=="<"&&(N=y.indexOf(">"))>-1;)y=y.slice(N+1);for(var j=0;j<v.length;++j){var U=v[j];U.s.c==f&&U.s.r<c&&c<=U.e.r&&(f=U.e.c+1,j=-1)}var g=Oe(E.slice(0,E.indexOf(">")));d=g.colspan?+g.colspan:1,((h=+g.rowspan)>1||d>1)&&v.push({s:{r:c,c:f},e:{r:c+(h||1)-1,c:f+d-1}});var k=g.t||g["data-t"]||"";if(!y.length){f+=d;continue}if(y=qS(y),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!y.length){f+=d;continue}var S={t:"s",v:y};r.raw||!y.trim().length||k=="s"||(y==="TRUE"?S={t:"b",v:!0}:y==="FALSE"?S={t:"b",v:!1}:isNaN(ii(y))?isNaN(fl(y).getDate())||(S={t:"d",v:dr(y)},r.cellDates||(S={t:"n",v:Qr(S.v)}),S.z=r.dateNF||ze[14]):S={t:"n",v:ii(y)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=S):n[Be({r:c,c:f})]=S,f+=d}}}}return n["!ref"]=tt(p),v.length&&(n["!merges"]=v),n}function S7(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var f=Be({r,c:a}),h=n.dense?(t[r]||[])[a]:t[f],d=h&&h.v!=null&&(h.h||Pv(h.w||(cs(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+f,s.push(fM("td",d,p))}}var v="<tr>";return v+s.join("")+"</tr>"}var A7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',I7="</body></html>";function C7(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return oa(gw(r[0],e),e);var n=Xv();return r.forEach(function(i,s){Yv(n,gw(i,e),"Sheet"+(s+1))}),n}function R7(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function N7(t,e){var r=e||{},n=r.header!=null?r.header:A7,i=r.footer!=null?r.footer:I7,s=[n],a=Tl(t["!ref"]);r.dense=Array.isArray(t),s.push(R7(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(S7(t,a,o,r));return s.push("</table>"+i),s.join("")}function ZA(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Kr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=Tl(t["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),i==-1&&(c.e.r=i=f.e.r+1)}var h=[],d=0,p=t["!rows"]||(t["!rows"]=[]),v=0,m=0,w=0,T=0,E=0,y=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&m<l;++v){var N=o[v];if(vw(N)){if(n.display)continue;p[m]={hidden:!0}}var j=N.children;for(w=T=0;w<j.length;++w){var U=j[w];if(!(n.display&&vw(U))){var g=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):qS(U.innerHTML),k=U.getAttribute("data-z")||U.getAttribute("z");for(d=0;d<h.length;++d){var S=h[d];S.s.c==T+s&&S.s.r<m+i&&m+i<=S.e.r&&(T=S.e.c+1-s,d=-1)}y=+U.getAttribute("colspan")||1,((E=+U.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:m+i,c:T+s},e:{r:m+i+(E||1)-1,c:T+s+(y||1)-1}});var C={t:"s",v:g},P=U.getAttribute("data-t")||U.getAttribute("t")||"";g!=null&&(g.length==0?C.t=P||"z":n.raw||g.trim().length==0||P=="s"||(g==="TRUE"?C={t:"b",v:!0}:g==="FALSE"?C={t:"b",v:!1}:isNaN(ii(g))?isNaN(fl(g).getDate())||(C={t:"d",v:dr(g)},n.cellDates||(C={t:"n",v:Qr(C.v)}),C.z=n.dateNF||ze[14]):C={t:"n",v:ii(g)})),C.z===void 0&&k!=null&&(C.z=k);var F="",O=U.getElementsByTagName("A");if(O&&O.length)for(var de=0;de<O.length&&!(O[de].hasAttribute("href")&&(F=O[de].getAttribute("href"),F.charAt(0)!="#"));++de);F&&F.charAt(0)!="#"&&(C.l={Target:F}),n.dense?(t[m+i]||(t[m+i]=[]),t[m+i][T+s]=C):t[Be({c:T+s,r:m+i})]=C,c.e.c<T+s&&(c.e.c=T+s),T+=y}}++m}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),t["!ref"]=tt(c),m>=l&&(t["!fullref"]=tt((c.e.r=o.length-v+m-1+i,c))),t}function eI(t,e){var r=e||{},n=r.dense?[]:{};return ZA(n,t,e)}function P7(t,e){return oa(eI(t,e),e)}function vw(t){var e="",r=F7(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function F7(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function D7(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=st(e.replace(/<[^>]*>/g,""));return[r]}var xw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function tI(t,e){var r=e||{},n=Fv(t),i=[],s,a,o={name:""},l="",c=0,f,h,d={},p=[],v=r.dense?[]:{},m,w,T={value:""},E="",y=0,N=[],j=-1,U=-1,g={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,S={},C=[],P={},F=0,O=0,de=[],ve=1,Ie=1,oe=[],ie={Names:[]},G={},ue=["",""],Ee=[],B={},X="",q=0,W=!1,ae=!1,xe=0;for(cu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=cu.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(g.e.c>=g.s.c&&g.e.r>=g.s.r?v["!ref"]=tt(g):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=g.e.r&&(v["!fullref"]=v["!ref"],g.e.r=r.sheetRows-1,v["!ref"]=tt(g)),C.length&&(v["!merges"]=C),de.length&&(v["!rows"]=de),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),d[f.name]=v,ae=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Oe(m[0],!1),j=U=-1,g.s.r=g.s.c=1e7,g.e.r=g.e.c=0,v=r.dense?[]:{},C=[],de=[],ae=!0);break;case"table-row-group":m[1]==="/"?--k:++k;break;case"table-row":case"":if(m[1]==="/"){j+=ve,ve=1;break}if(h=Oe(m[0],!1),h.?j=h.-1:j==-1&&(j=0),ve=+h["number-rows-repeated"]||1,ve<10)for(xe=0;xe<ve;++xe)k>0&&(de[j+xe]={level:k});U=-1;break;case"covered-table-cell":m[1]!=="/"&&++U,r.sheetStubs&&(r.dense?(v[j]||(v[j]=[]),v[j][U]={t:"z"}):v[Be({r:j,c:U})]={t:"z"}),E="",N=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++U,T=Oe(m[0],!1),Ie=parseInt(T["number-columns-repeated"]||"1",10),w={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(w.f=hw(st(T.formula))),(T.||T["value-type"])=="string"&&(w.t="s",w.v=st(T["string-value"]||""),r.dense?(v[j]||(v[j]=[]),v[j][U]=w):v[Be({r:j,c:U})]=w),U+=Ie-1;else if(m[1]!=="/"){++U,E="",y=0,N=[],Ie=1;var Ae=ve?j+ve-1:j;if(U>g.e.c&&(g.e.c=U),U<g.s.c&&(g.s.c=U),j<g.s.r&&(g.s.r=j),Ae>g.e.r&&(g.e.r=Ae),T=Oe(m[0],!1),Ee=[],B={},w={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=st(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(F=parseInt(T["number-matrix-rows-spanned"],10)||0,O=parseInt(T["number-matrix-columns-spanned"],10)||0,P={s:{r:j,c:U},e:{r:j+F-1,c:U+O-1}},w.F=tt(P),oe.push([P,w.F])),T.formula)w.f=hw(T.formula);else for(xe=0;xe<oe.length;++xe)j>=oe[xe][0].s.r&&j<=oe[xe][0].e.r&&U>=oe[xe][0].s.c&&U<=oe[xe][0].e.c&&(w.F=oe[xe][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(F=parseInt(T["number-rows-spanned"],10)||0,O=parseInt(T["number-columns-spanned"],10)||0,P={s:{r:j,c:U},e:{r:j+F-1,c:U+O-1}},C.push(P)),T["number-columns-repeated"]&&(Ie=parseInt(T["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Nt(T["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(T.value);break;case"percentage":w.t="n",w.v=parseFloat(T.value);break;case"currency":w.t="n",w.v=parseFloat(T.value);break;case"date":w.t="d",w.v=dr(T["date-value"]),r.cellDates||(w.t="n",w.v=Qr(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=GL(T["time-value"])/86400,r.cellDates&&(w.t="d",w.v=W0(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(T.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",T["string-value"]!=null&&(E=st(T["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(W=!1,w.t==="s"&&(w.v=E||"",N.length&&(w.R=N),W=y==0),G.Target&&(w.l=G),Ee.length>0&&(w.c=Ee,Ee=[]),E&&r.cellText!==!1&&(w.w=E),W&&(w.t="z",delete w.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var he=0;he<ve;++he){if(Ie=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(v[j+he]||(v[j+he]=[]),v[j+he][U]=he==0?w:Er(w);--Ie>0;)v[j+he][U+Ie]=Er(w);else for(v[Be({r:j+he,c:U})]=w;--Ie>0;)v[Be({r:j+he,c:U+Ie})]=Er(w);g.e.c<=U&&(g.e.c=U)}Ie=parseInt(T["number-columns-repeated"]||"1",10),U+=Ie-1,Ie=0,w={},E="",N=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;B.t=E,N.length&&(B.R=N),B.a=X,Ee.push(B)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);X="",q=0,E="",y=0,N=[];break;case"creator":m[1]==="/"?X=n.slice(q,m.index):q=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);E="",y=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(S[o.name]=l,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Oe(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Oe(m[0],!1),l+=xw[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Oe(m[0],!1),l+=xw[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":a=Oe(m[0],!1),ue=Kd(a["cell-range-address"]);var ge={Name:a.name,Ref:ue[0]+"!"+ue[1]};ae&&(ge.Sheet=p.length),ie.Names.push(ge);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!T||!T["string-value"])){var He=D7(n.slice(y,m.index));E=(E.length>0?E+`
`:"")+He[0]}else Oe(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ue=Kd(Oe(m[0])["target-range-address"]),d[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(G=Oe(m[0],!1),!G.href)break;G.Target=st(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(ue=Kd(G.Target.slice(1)),G.Target="#"+ue[0]+"!"+ue[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var z={Sheets:d,SheetNames:p,Workbook:ie};return r.bookSheets&&delete z.Sheets,z}function _w(t,e){e=e||{},Nn(t,"META-INF/manifest.xml")&&XM(Kt(t,"META-INF/manifest.xml"),e);var r=vn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=tI(wt(r),e);return Nn(t,"meta.xml")&&(n.Props=pA(Kt(t,"meta.xml"))),n}function yw(t,e){return tI(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Wv(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Am(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):wt(eo(t))}function Im(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function ww(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function b7(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function du(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function sr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Vr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=du(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=du(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function Gv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function O7(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=du(t,n),s=Vr(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:sr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Vr(o.data),c=sr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=sr(s[3][0].data)>>>0>0),r.push(a)}return r}function L7(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=du(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Im(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var f=Im(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function M7(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(L7(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Im(e)}function V7(t,e,r,n){var i=Wv(t),s=i.getUint32(4,!0),a=(n>1?12:8)+ww(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=ww(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function U7(t,e,r){var n=Wv(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);i&1&&(l=b7(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function B7(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return V7(t,e,r,t[0]);case 5:return U7(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Gs(t){var e=Vr(t);return du(e[1][0].data)}function Ew(t,e){var r=Vr(e.data),n=sr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Vr(a.data),l=sr(o[1][0].data)>>>0;switch(n){case 1:s[l]=Am(o[3][0].data);break;case 8:{var c=t[Gs(o[9][0].data)][0],f=Vr(c.data),h=t[Gs(f[1][0].data)][0],d=sr(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=Vr(h.data);s[l]=p[3].map(function(v){return Am(v.data)}).join("")}break}}),s}function j7(t,e){var r,n,i,s,a,o,l,c,f,h,d,p,v,m,w=Vr(t),T=sr(w[1][0].data)>>>0,E=sr(w[2][0].data)>>>0,y=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&sr(w[8][0].data)>0||!1,N,j;if((s=(i=w[7])==null?void 0:i[0])!=null&&s.data&&e!=0)N=(o=(a=w[7])==null?void 0:a[0])==null?void 0:o.data,j=(c=(l=w[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(f=w[4])==null?void 0:f[0])!=null&&h.data&&e!=1)N=(p=(d=w[4])==null?void 0:d[0])==null?void 0:p.data,j=(m=(v=w[3])==null?void 0:v[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var U=y?4:1,g=Wv(N),k=[],S=0;S<N.length/2;++S){var C=g.getUint16(S*2,!0);C<65535&&k.push([S,C])}if(k.length!=E)throw"Expected ".concat(E," cells, found ").concat(k.length);var P=[];for(S=0;S<k.length-1;++S)P[k[S][0]]=j.subarray(k[S][1]*U,k[S+1][1]*U);return k.length>=1&&(P[k[k.length-1][0]]=j.subarray(k[k.length-1][1]*U)),{R:T,cells:P}}function z7(t,e){var r,n=Vr(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?sr(n[7][0].data)>>>0>0?1:0:-1,s=Gv(n[5],function(a){return j7(a,i)});return{nrows:sr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function H7(t,e,r){var n,i=Vr(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(sr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(sr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=tt(s);var a=Vr(i[4][0].data),o=Ew(t,t[Gs(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?Ew(t,t[Gs(a[17][0].data)][0]):[],c=Vr(a[3][0].data),f=0;c[1].forEach(function(h){var d=Vr(h.data),p=t[Gs(d[2][0].data)][0],v=sr(p.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var m=z7(t,p);m.data.forEach(function(w,T){w.forEach(function(E,y){var N=Be({r:f+T,c:y}),j=B7(E,o,l);j&&(r[N]=j)})}),f+=m.nrows})}function $7(t,e){var r=Vr(e.data),n={"!ref":"A1"},i=t[Gs(r[2][0].data)],s=sr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return H7(t,i[0],n),n}function W7(t,e){var r,n=Vr(e.data),i={name:(r=n[1])!=null&&r[0]?Am(n[1][0].data):"",sheets:[]},s=Gv(n[2],Gs);return s.forEach(function(a){t[a].forEach(function(o){var l=sr(o.meta[1][0].data);l==6e3&&i.sheets.push($7(t,o))})}),i}function G7(t,e){var r=Xv(),n=Vr(e.data),i=Gv(n[1],Gs);if(i.forEach(function(s){t[s].forEach(function(a){var o=sr(a.meta[1][0].data);if(o==2){var l=W7(t,a);l.sheets.forEach(function(c,f){Yv(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Xd(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=M7(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var f;try{f=O7(c)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&sr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var f=sr(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return G7(s,o)}function K7(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Kv(t){K7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function q7(t){return Fo.WS.indexOf(t)>-1?"sheet":t==Fo.CS?"chart":t==Fo.DS?"dialog":t==Fo.MS?"macro":t&&t.length?t:"sheet"}function X7(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,q7(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Y7(t,e,r,n,i,s,a,o,l,c,f,h){try{s[n]=Sc(vn(t,r,!0),e);var d=Kt(t,e),p;switch(o){case"sheet":p=r7(d,e,i,l,s[n],c,f,h);break;case"chart":if(p=n7(d,e,i,l,s[n],c,f,h),!p||!p["!drawel"])break;var v=nc(p["!drawel"].Target,e),m=wm(v),w=tV(vn(t,v,!0),Sc(vn(t,m,!0),v)),T=nc(w,v),E=wm(T);p=UB(vn(t,T,!0),T,l,Sc(vn(t,E,!0),T),c,p);break;case"macro":p=i7(d,e,i,l,s[n],c,f,h);break;case"dialog":p=s7(d,e,i,l,s[n],c,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var y=[];s&&s[n]&&Si(s[n]).forEach(function(N){var j="";if(s[n][N].Type==Fo.CMNT){j=nc(s[n][N].Target,e);var U=c7(Kt(t,j,!0),j,l);if(!U||!U.length)return;ow(p,U,!1)}s[n][N].Type==Fo.TCMNT&&(j=nc(s[n][N].Target,e),y=y.concat(nV(Kt(t,j,!0),l)))}),y&&y.length&&ow(p,y,!0,l.people||[])}catch(N){if(l.WTF)throw N}}function Cn(t){return t.charAt(0)=="/"?t.slice(1):t}function Q7(t,e){if(US(),e=e||{},Kv(e),Nn(t,"META-INF/manifest.xml")||Nn(t,"objectdata.xml"))return _w(t,e);if(Nn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Xd<"u"){if(t.FileIndex)return Xd(t);var r=et.utils.cfb_new();return by(t).forEach(function(de){JL(r,de,QL(t,de))}),Xd(r)}throw new Error("Unsupported NUMBERS file")}if(!Nn(t,"[Content_Types].xml"))throw Nn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Nn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=by(t),i=KM(vn(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Kt(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Kt(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Cc=[],i.sst)try{Cc=l7(Kt(t,Cn(i.sst)),i.sst,e)}catch(de){if(e.WTF)throw de}e.cellStyles&&i.themes.length&&(l=o7(vn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=a7(Kt(t,Cn(i.style)),i.style,l,e))}i.links.map(function(de){try{var ve=Sc(vn(t,wm(Cn(de))),de);return f7(Kt(t,Cn(de)),ve,de,e)}catch{}});var f=t7(Kt(t,Cn(i.workbooks[0])),i.workbooks[0],e),h={},d="";i.coreprops.length&&(d=Kt(t,Cn(i.coreprops[0]),!0),d&&(h=pA(d)),i.extprops.length!==0&&(d=Kt(t,Cn(i.extprops[0]),!0),d&&JM(d,h,e)));var p={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=vn(t,Cn(i.custprops[0]),!0),d&&(p=e8(d,e)));var v={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(ve){return ve.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(v.Props=h,v.Custprops=p),e.bookSheets&&typeof a<"u"&&(v.SheetNames=a),e.bookSheets?v.SheetNames:e.bookProps))return v;a={};var m={};e.bookDeps&&i.calcchain&&(m=u7(Kt(t,Cn(i.calcchain)),i.calcchain));var w=0,T={},E,y;{var N=f.Sheets;h.Worksheets=N.length,h.SheetNames=[];for(var j=0;j!=N.length;++j)h.SheetNames[j]=N[j].name}var U=s?"bin":"xml",g=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,g+1)+"_rels/"+i.workbooks[0].slice(g+1)+".rels").replace(/^\//,"");Nn(t,k)||(k="xl/_rels/workbook."+U+".rels");var S=Sc(vn(t,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=h7(Kt(t,Cn(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=iV(Kt(t,Cn(i.people[0])),e)),S&&(S=X7(S,f.Sheets));var C=Kt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var P="sheet";if(S&&S[w]?(E="xl/"+S[w][1].replace(/[\/]?xl\//,""),Nn(t,E)||(E=S[w][1]),Nn(t,E)||(E=k.replace(/_rels\/.*$/,"")+S[w][1]),P=S[w][2]):(E="xl/worksheets/sheet"+(w+1-C)+"."+U,E=E.replace(/sheet0\./,"sheet.")),y=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var F=!1,O=0;O!=e.sheets.length;++O)typeof e.sheets[O]=="number"&&e.sheets[O]==w&&(F=1),typeof e.sheets[O]=="string"&&e.sheets[O].toLowerCase()==h.SheetNames[w].toLowerCase()&&(F=1);if(!F)continue e}}Y7(t,E,y,h.SheetNames[w],w,T,a,P,e,f,l,c)}return v={Directory:i,Workbook:f,Props:h,Custprops:p,Deps:m,Sheets:a,SheetNames:h.SheetNames,Strings:Cc,Styles:c,Themes:l,SSF:Er(ze)},e&&e.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(de,ve){de=de.replace(/^Root Entry[\/]/,""),v.keys.push(de),v.files[de]=t.FileIndex[ve]}))),e&&e.bookVBA&&(i.vba.length>0?v.vbaraw=Kt(t,Cn(i.vba[0]),!0):i.defaults&&i.defaults.bin===lV&&(v.vbaraw=Kt(t,"xl/vbaProject.bin",!0))),v}function J7(t,e){var r=e||{},n="Workbook",i=et.find(t,n);try{if(n="/!DataSpaces/Version",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if($5(i.content),n="/!DataSpaces/DataSpaceMap",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=G5(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=K5(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);X5(i.content)}catch{}if(n="/EncryptionInfo",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Y5(i.content);if(n="/EncryptedPackage",i=et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function qv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=En(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Z7(t,e){return et.find(t,"EncryptedPackage")?J7(t,e):JA(t,e)}function ej(t,e){var r,n=t,i=e||{};return i.type||(i.type=Qe&&Buffer.isBuffer(t)?"buffer":"base64"),r=WS(n,i),Q7(r,i)}function rI(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return km(t.slice(r),e);default:break e}return uu.to_workbook(t,e)}function tj(t,e){var r="",n=qv(t,e);switch(e.type){case"base64":r=En(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=za(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=wt(r)),e.type="binary",rI(r,e)}function rj(t,e){var r=t;return e.type=="base64"&&(r=En(r)),r=au.utils.decode(1200,r.slice(2),"str"),e.type="binary",rI(r,e)}function nj(t){return t.match(/[^\x00-\x7F]/)?ic(t):t}function Yd(t,e,r,n){return n?(r.type="string",uu.to_workbook(t,r)):uu.to_workbook(e,r)}function Cm(t,e){IS();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Cm(new Uint8Array(t),(r=Er(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Go={},r.dateNF&&(Go.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=$L(t),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=nj(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Er(r),r.type="array",Cm(Av(n),r)}switch((i=qv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return Z7(et.read(n,r),r);break;case 9:if(i[1]<=8)return JA(n,r);break;case 60:return km(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return P5(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return R5.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?ej(n,r):Yd(t,n,r,s);case 239:return i[3]===60?km(n,r):Yd(t,n,r,s);case 255:if(i[1]===254)return rj(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Ic.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Ic.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return aw.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return l9.to_workbook(n,r);break;case 10:case 13:case 32:return tj(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return I5.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?aw.to_workbook(n,r):Yd(t,n,r,s)}function ij(t,e,r,n,i,s,a,o){var l=Tr(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var v=a?t[r][p]:t[n[p]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[p]!=null&&(d[s[p]]=c);continue}var m=v.v;switch(v.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[p]!=null){if(m==null)if(v.t=="e"&&m===null)d[s[p]]=null;else if(c!==void 0)d[s[p]]=c;else if(f&&m===null)d[s[p]]=null;else continue;else d[s[p]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?m:cs(v,m,o);m!=null&&(h=!1)}}return{row:d,isempty:h}}function Rm(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},f=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=Bt(f);break;case"number":l=Bt(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var h=Tr(l.s.r),d=[],p=[],v=0,m=0,w=Array.isArray(t),T=l.s.r,E=0,y={};w&&!t[T]&&(t[T]=[]);var N=c.skipHidden&&t["!cols"]||[],j=c.skipHidden&&t["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(N[E]||{}).hidden)switch(d[E]=nr(E),r=w?t[T][E]:t[d[E]+h],n){case 1:s[E]=E-l.s.c;break;case 2:s[E]=d[E];break;case 3:s[E]=c.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=cs(r,null,c),m=y[a]||0,!m)y[a]=1;else{do o=a+"_"+m++;while(y[o]);y[a]=m,y[o]=1}s[E]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(j[T]||{}).hidden){var U=ij(t,l,T,d,n,s,w,c);(U.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[v++]=U.row)}return p.length=v,p}var Tw=/"/g;function sj(t,e,r,n,i,s,a,o){for(var l=!0,c=[],f="",h=Tr(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var p=o.dense?(t[r]||[])[d]:t[n[d]+h];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:cs(p,null,o));for(var v=0,m=0;v!==f.length;++v)if((m=f.charCodeAt(v))===i||m===s||m===34||o.forceQuotes){f='"'+f.replace(Tw,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(Tw,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(a)}function nI(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Bt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(d[v]||{}).hidden||(h[v]=nr(v));for(var m=0,w=i.s.r;w<=i.e.r;++w)(p[w]||{}).hidden||(f=sj(t,i,w,h,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function aj(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=nI(t,e);return r}function oj(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Bt(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=nr(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=Tr(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function iI(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Kr(n.origin):n.origin;a=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=Bt(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var d=n.header||[],p=0;e.forEach(function(m,w){Si(m).forEach(function(T){(p=d.indexOf(T))==-1&&(d[p=d.length]=T);var E=m[T],y="z",N="",j=Be({c:o+p,r:a+w+i});c=pu(s,j),E&&typeof E=="object"&&!(E instanceof Date)?s[j]=E:(typeof E=="number"?y="n":typeof E=="boolean"?y="b":typeof E=="string"?y="s":E instanceof Date?(y="d",n.cellDates||(y="n",E=Qr(E)),N=n.dateNF||ze[14]):E===null&&n.nullError&&(y="e",E=0),c?(c.t=y,c.v=E,delete c.w,delete c.R,N&&(c.z=N)):s[j]=c={t:y,v:E},N&&(c.z=N))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var v=Tr(a);if(i)for(p=0;p<d.length;++p)s[nr(p+o)+v]={t:"s",v:d[p]};return s["!ref"]=tt(f),s}function lj(t,e){return iI(null,t,e)}function pu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Kr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?pu(t,Be(e)):pu(t,Be({r:e,c:r||0}))}function cj(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Xv(){return{SheetNames:[],Sheets:{}}}function Yv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(KB(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function uj(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=cj(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function fj(t,e){return t.z=e,t}function sI(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function hj(t,e,r){return sI(t,"#"+e,r)}function dj(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function pj(t,e,r,n){for(var i=typeof e!="string"?e:Bt(e),s=typeof e=="string"?e:tt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=pu(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var mj={encode_col:nr,encode_row:Tr,encode_cell:Be,encode_range:tt,decode_col:Ov,decode_row:bv,split_cell:AM,decode_cell:Kr,decode_range:Tl,format_cell:cs,sheet_add_aoa:cA,sheet_add_json:iI,sheet_add_dom:ZA,aoa_to_sheet:kl,json_to_sheet:lj,table_to_sheet:eI,table_to_book:P7,sheet_to_csv:nI,sheet_to_txt:aj,sheet_to_json:Rm,sheet_to_html:N7,sheet_to_formulae:oj,sheet_to_row_object_array:Rm,sheet_get_cell:pu,book_new:Xv,book_append_sheet:Yv,book_set_sheet_visibility:uj,cell_set_number_format:fj,cell_set_hyperlink:sI,cell_set_internal_link:hj,cell_add_comment:dj,sheet_set_array_formula:pj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const gj=()=>{var Ie;const t=Ka(),{currentUser:e,userProfile:r}=hs(),[n,i]=ee.useState("tmdb"),[s,a]=ee.useState(!1),[o,l]=ee.useState(null),[c,f]=ee.useState(null),[h,d]=ee.useState(""),[p,v]=ee.useState([]),[m,w]=ee.useState(null),[T,E]=ee.useState(""),[y,N]=ee.useState(null),[j,U]=ee.useState([]),[g,k]=ee.useState(0),[S,C]=ee.useState(0);ee.useEffect(()=>{r!=null&&r.tmdbApiKey&&E(r.tmdbApiKey)},[r]);const P=async()=>{if(!(!h.trim()||!T))try{a(!0),l(null),w(null);const oe=await fL(h,T);v(oe.results)}catch(oe){console.error("Search error:",oe),l(oe.message||"Failed to search movies")}finally{a(!1)}},F=async oe=>{try{a(!0),l(null);const ie=await hL(oe.id,T);w(ie)}catch(ie){console.error("Error fetching movie details:",ie),l(ie.message||"Failed to fetch movie details")}finally{a(!1)}},O=async()=>{if(!(!e||!m))try{a(!0),l(null);const oe=Zs(fr,"movies"),ie=Ua(oe,ul("tmdbId","==",m.id)),G=await Ba(ie);let ue;if(G.empty){const B={...dL(m),addedAt:new Date,updatedAt:new Date};ue=(await dy(oe,B)).id}else ue=G.docs[0].id;const Ee=Qn(fr,"userMovies",`${e.uid}_${ue}`);if(await Ho(Ee,{userId:e.uid,movieId:ue,watched:!1,favorite:!1,addedAt:new Date,updatedAt:new Date}),f("Movie added to your collection!"),w(null),v([]),d(""),T&&T!==(r==null?void 0:r.tmdbApiKey)){const B=Qn(fr,"users",e.uid);await Ho(B,{tmdbApiKey:T},{merge:!0})}setTimeout(()=>{t(`/movies/${ue}`)},1500)}catch(oe){console.error("Error adding movie:",oe),l(oe.message||"Failed to add movie to collection")}finally{a(!1)}},de=oe=>{var ue;const ie=(ue=oe.target.files)==null?void 0:ue[0];if(!ie)return;N(ie);const G=new FileReader;G.onload=Ee=>{var B;try{const X=(B=Ee.target)==null?void 0:B.result,q=Cm(X,{type:"binary"}),W=q.SheetNames[0],ae=q.Sheets[W],Ae=mj.sheet_to_json(ae).map(he=>({title:he.title||he.Title||he.name||he.Name||"",releaseDate:he.releaseDate||he.ReleaseDate||he.release_date||he.year||he.Year||"",watched:he.watched||he.Watched||!1,rating:he.rating||he.Rating||null,review:he.review||he.Review||he.notes||he.Notes||""})).filter(he=>he.title);U(Ae),C(Ae.length)}catch(X){console.error("Error parsing Excel file:",X),l("Failed to parse Excel file. Please check the format.")}},G.onerror=()=>{l("Failed to read Excel file")},G.readAsBinaryString(ie)},ve=async()=>{if(!(!e||!j.length))try{a(!0),l(null),k(0);const oe=Zs(fr,"movies");let ie=0;for(const G of j){const ue={title:G.title,releaseDate:G.releaseDate,isChristmas:!0,addedAt:new Date,updatedAt:new Date},B=(await dy(oe,ue)).id,X=Qn(fr,"userMovies",`${e.uid}_${B}`);await Ho(X,{userId:e.uid,movieId:B,watched:G.watched||!1,rating:G.rating||null,review:G.review||"",favorite:!1,addedAt:new Date,updatedAt:new Date}),ie++,k(Math.round(ie/j.length*100))}f(`Successfully imported ${ie} movies!`),U([]),N(null),setTimeout(()=>{t("/movies")},2e3)}catch(oe){console.error("Error importing movies:",oe),l(oe.message||"Failed to import movies")}finally{a(!1)}};return _.jsxs("div",{className:"container mx-auto px-4 py-8",children:[_.jsx("div",{className:"mb-6",children:_.jsxs(xt,{to:"/movies",className:"btn btn-ghost",children:[_.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),_.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Import Movies"}),o&&_.jsxs("div",{className:"alert alert-error mb-6",children:[_.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),_.jsx("span",{children:o})]}),c&&_.jsxs("div",{className:"alert alert-success mb-6",children:[_.jsx("i",{className:"fas fa-check-circle mr-2"}),_.jsx("span",{children:c})]}),_.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[_.jsxs("button",{className:`tab ${n==="tmdb"?"tab-active":""}`,onClick:()=>i("tmdb"),children:[_.jsx("i",{className:"fas fa-search mr-2"})," Search TMDB"]}),_.jsxs("button",{className:`tab ${n==="excel"?"tab-active":""}`,onClick:()=>i("excel"),children:[_.jsx("i",{className:"fas fa-file-excel mr-2"})," Import from Excel"]})]}),n==="tmdb"&&_.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[_.jsxs("div",{className:"mb-6",children:[_.jsx("label",{className:"label",children:_.jsx("span",{className:"label-text",children:"TMDB API Key"})}),_.jsx("input",{type:"text",className:"input input-bordered w-full",placeholder:"Enter your TMDB API key",value:T,onChange:oe=>E(oe.target.value)}),_.jsx("label",{className:"label",children:_.jsxs("span",{className:"label-text-alt",children:["Don't have an API key? ",_.jsx("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",className:"link link-primary",children:"Get one here"})]})})]}),_.jsxs("div",{className:"flex gap-2 mb-6",children:[_.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a Christmas movie...",value:h,onChange:oe=>d(oe.target.value),onKeyDown:oe=>oe.key==="Enter"&&P()}),_.jsx("button",{className:"btn btn-primary",onClick:P,disabled:s||!T,children:s?_.jsx("span",{className:"loading loading-spinner loading-sm"}):_.jsx("i",{className:"fas fa-search"})})]}),p.length>0&&!m&&_.jsxs("div",{className:"mb-6",children:[_.jsx("h2",{className:"text-xl font-bold mb-4",children:"Search Results"}),_.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:p.map(oe=>{var ie;return _.jsxs("div",{className:"card bg-base-100 shadow-xl cursor-pointer hover:shadow-2xl transition-shadow",onClick:()=>F(oe),children:[_.jsx("figure",{className:"h-48",children:oe.poster_path?_.jsx("img",{src:`https://image.tmdb.org/t/p/w500${oe.poster_path}`,alt:oe.title,className:"w-full h-full object-cover"}):_.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800",children:_.jsx("i",{className:"fas fa-film text-4xl text-gray-500"})})}),_.jsxs("div",{className:"card-body p-4",children:[_.jsx("h3",{className:"card-title text-lg",children:oe.title}),_.jsx("p",{className:"text-sm text-gray-400",children:(ie=oe.release_date)==null?void 0:ie.substring(0,4)})]})]},oe.id)})})]}),m&&_.jsxs("div",{className:"mb-6",children:[_.jsx("h2",{className:"text-xl font-bold mb-4",children:"Selected Movie"}),_.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[_.jsx("div",{className:"md:w-1/3",children:m.poster_path?_.jsx("img",{src:`https://image.tmdb.org/t/p/w500${m.poster_path}`,alt:m.title,className:"w-full rounded-lg shadow-lg"}):_.jsx("div",{className:"w-full h-96 flex items-center justify-center bg-gray-800 rounded-lg",children:_.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),_.jsxs("div",{className:"md:w-2/3",children:[_.jsx("h3",{className:"text-2xl font-bold mb-2",children:m.title}),_.jsx("p",{className:"text-gray-400 mb-4",children:(Ie=m.release_date)==null?void 0:Ie.substring(0,4)}),m.genres&&_.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:m.genres.map(oe=>_.jsx("span",{className:"badge badge-outline",children:oe.name},oe.id))}),_.jsx("p",{className:"mb-6",children:m.overview}),_.jsx("button",{className:"btn btn-primary",onClick:O,disabled:s,children:s?_.jsxs(_.Fragment,{children:[_.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Adding..."]}):_.jsxs(_.Fragment,{children:[_.jsx("i",{className:"fas fa-plus mr-2"}),"Add to Collection"]})}),_.jsx("button",{className:"btn btn-ghost ml-2",onClick:()=>w(null),disabled:s,children:"Cancel"})]})]})]})]}),n==="excel"&&_.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[_.jsxs("div",{className:"mb-6",children:[_.jsx("h2",{className:"text-xl font-bold mb-4",children:"Import from Excel"}),_.jsx("p",{className:"mb-4",children:"Upload an Excel file with your Christmas movie list. The file should have columns for:"}),_.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[_.jsx("li",{children:"Title (required)"}),_.jsx("li",{children:"Release Date/Year (optional)"}),_.jsx("li",{children:"Watched (optional, true/false)"}),_.jsx("li",{children:"Rating (optional, 1-10)"}),_.jsx("li",{children:"Review/Notes (optional)"})]})]}),_.jsx("div",{className:"mb-6",children:_.jsx("input",{type:"file",className:"file-input file-input-bordered w-full",accept:".xlsx,.xls",onChange:de,disabled:s})}),j.length>0&&_.jsxs("div",{className:"mb-6",children:[_.jsxs("h3",{className:"text-lg font-bold mb-2",children:["Preview (",j.length," movies found)"]}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"table table-zebra w-full",children:[_.jsx("thead",{children:_.jsxs("tr",{children:[_.jsx("th",{children:"Title"}),_.jsx("th",{children:"Year"}),_.jsx("th",{children:"Watched"}),_.jsx("th",{children:"Rating"})]})}),_.jsxs("tbody",{children:[j.slice(0,10).map((oe,ie)=>_.jsxs("tr",{children:[_.jsx("td",{children:oe.title}),_.jsx("td",{children:oe.releaseDate}),_.jsx("td",{children:oe.watched?"Yes":"No"}),_.jsx("td",{children:oe.rating||"-"})]},ie)),j.length>10&&_.jsx("tr",{children:_.jsxs("td",{colSpan:4,className:"text-center",children:["...and ",j.length-10," more"]})})]})]})}),g>0&&_.jsxs("div",{className:"mt-4",children:[_.jsx("progress",{className:"progress progress-primary w-full",value:g,max:"100"}),_.jsxs("p",{className:"text-center mt-2",children:[g,"% complete"]})]}),_.jsx("div",{className:"mt-6 flex justify-end",children:_.jsx("button",{className:"btn btn-primary",onClick:ve,disabled:s,children:s?_.jsxs(_.Fragment,{children:[_.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Importing..."]}):_.jsxs(_.Fragment,{children:[_.jsx("i",{className:"fas fa-file-import mr-2"}),"Import ",j.length," Movies"]})})})]})]})]})},vj=()=>{var w,T,E;const{currentUser:t}=hs(),[e,r]=ee.useState([]),[n,i]=ee.useState({}),[s,a]=ee.useState(!0),[o,l]=ee.useState(null),[c,f]=ee.useState(null),[h,d]=ee.useState(!1),[p,v]=ee.useState(!1);ee.useEffect(()=>{(async()=>{if(t)try{a(!0);const N=Ua(Zs(fr,"userMovies"),ul("userId","==",t.uid)),j=await Ba(N),U={},g=[];j.forEach(S=>{const C={id:S.id,...S.data()};U[C.movieId]=C,g.push(C.movieId)}),i(U);const k=[];if(g.length>0)for(let C=0;C<g.length;C+=10){const P=g.slice(C,C+10),F=Ua(Zs(fr,"movies"),ul("id","in",P));(await Ba(F)).forEach(de=>{k.push({id:de.id,...de.data()})})}r(k)}catch(N){console.error("Error fetching movies:",N),l("Failed to load movies")}finally{a(!1)}})()},[t]);const m=()=>{if(e.length===0)return;v(!0),f(null);const y=e.filter(g=>{const k=n[g.id];return h||!k||!k.watched});if(y.length===0){l("No eligible movies found. Try including watched movies."),v(!1);return}let N=0;const j=20,U=setInterval(()=>{const g=Math.floor(Math.random()*y.length);f(y[g]),N++,N>=j&&(clearInterval(U),v(!1))},100)};return s?_.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):_.jsxs("div",{className:"container mx-auto px-4 py-8",children:[_.jsx("div",{className:"mb-4",children:_.jsxs(xt,{to:"/movies",className:"btn btn-ghost",children:[_.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),_.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Christmas Movie Picker"}),o&&_.jsxs("div",{className:"alert alert-error mb-6",children:[_.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),_.jsx("span",{children:o})]}),e.length===0?_.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[_.jsx("h3",{className:"text-xl mb-4",children:"No movies in your collection"}),_.jsx("p",{className:"mb-4",children:"Add some Christmas movies to use the random movie picker!"}),_.jsxs(xt,{to:"/import",className:"btn btn-primary",children:[_.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):_.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg shadow-lg",children:[_.jsxs("div",{className:"text-center mb-6",children:[_.jsx("p",{className:"mb-4",children:"Can't decide what Christmas movie to watch? Let us pick one for you!"}),_.jsx("div",{className:"form-control mb-6",children:_.jsxs("label",{className:"label cursor-pointer justify-center",children:[_.jsx("span",{className:"label-text mr-2",children:"Include watched movies"}),_.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:h,onChange:()=>d(!h)})]})}),_.jsx("button",{className:"btn btn-primary btn-lg",onClick:m,disabled:p,children:p?_.jsxs(_.Fragment,{children:[_.jsx("span",{className:"loading loading-spinner loading-md mr-2"}),"Picking a movie..."]}):_.jsxs(_.Fragment,{children:[_.jsx("i",{className:"fas fa-random mr-2"}),"Pick a Random Movie"]})})]}),c&&_.jsx("div",{className:"mt-8 flex flex-col items-center",children:_.jsx("div",{className:"w-full max-w-md",children:_.jsxs("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:[_.jsxs("figure",{className:"relative h-96",children:[c.posterUrl?_.jsx("img",{src:c.posterUrl,alt:c.title,className:"w-full h-full object-cover"}):_.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800",children:_.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})}),((w=n[c.id])==null?void 0:w.watched)&&_.jsx("div",{className:"absolute top-4 left-4 badge badge-lg badge-success",children:"Already Watched"}),((T=n[c.id])==null?void 0:T.rating)&&_.jsxs("div",{className:"absolute top-4 right-4 badge badge-lg badge-warning",children:[_.jsx("i",{className:"fas fa-star mr-1"}),n[c.id].rating,"/10"]})]}),_.jsxs("div",{className:"card-body",children:[_.jsx("h2",{className:"card-title text-2xl font-christmas",children:c.title}),_.jsx("p",{className:"text-gray-400",children:(E=c.releaseDate)==null?void 0:E.substring(0,4)}),c.overview&&_.jsx("p",{className:"mt-2",children:c.overview}),_.jsxs("div",{className:"card-actions justify-end mt-4",children:[_.jsx(xt,{to:`/movies/${c.id}`,className:"btn btn-primary",children:"View Details"}),_.jsx("button",{className:"btn btn-outline",onClick:m,disabled:p,children:"Pick Another"})]})]})]})})})]})]})},xj=()=>{const{currentUser:t,userProfile:e,signOut:r}=hs(),[n,i]=ee.useState(""),[s,a]=ee.useState(!1),[o,l]=ee.useState(null),[c,f]=ee.useState(null),[h,d]=ee.useState({totalMovies:0,watchedMovies:0,unwatchedMovies:0,averageRating:0,favoriteMovies:0});ee.useEffect(()=>{e!=null&&e.tmdbApiKey&&i(e.tmdbApiKey),(async()=>{if(t)try{const w=Ua(Zs(fr,"userMovies"),ul("userId","==",t.uid)),T=await Ba(w),E=[];T.forEach(S=>{E.push({id:S.id,...S.data()})});const y=E.length,N=E.filter(S=>S.watched).length,j=y-N,U=E.filter(S=>S.favorite).length,g=E.filter(S=>S.rating!==void 0&&S.rating!==null),k=g.length>0?g.reduce((S,C)=>S+(C.rating||0),0)/g.length:0;d({totalMovies:y,watchedMovies:N,unwatchedMovies:j,averageRating:k,favoriteMovies:U})}catch(w){console.error("Error fetching user stats:",w)}})()},[t,e]);const p=async()=>{if(t)try{a(!0),l(null);const m=Qn(fr,"users",t.uid);await xS(m,{tmdbApiKey:n}),f("TMDB API key saved successfully!"),setTimeout(()=>{f(null)},3e3)}catch(m){console.error("Error saving API key:",m),l(m.message||"Failed to save API key")}finally{a(!1)}},v=async()=>{try{await r()}catch(m){console.error("Error signing out:",m)}};return!t||!e?_.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):_.jsxs("div",{className:"container mx-auto px-4 py-8",children:[_.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Your Profile"}),o&&_.jsxs("div",{className:"alert alert-error mb-6",children:[_.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),_.jsx("span",{children:o})]}),c&&_.jsxs("div",{className:"alert alert-success mb-6",children:[_.jsx("i",{className:"fas fa-check-circle mr-2"}),_.jsx("span",{children:c})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[_.jsx("div",{className:"md:col-span-1",children:_.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[_.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.photoURL?_.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-24 h-24 rounded-full mb-4"}):_.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-700 flex items-center justify-center mb-4",children:_.jsx("i",{className:"fas fa-user text-4xl text-gray-400"})}),_.jsx("h2",{className:"text-xl font-bold",children:e.displayName}),_.jsx("p",{className:"text-gray-400",children:e.email})]}),_.jsx("div",{className:"divider"}),_.jsxs("div",{className:"mb-6",children:[_.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your Stats"}),_.jsxs("ul",{className:"space-y-2",children:[_.jsxs("li",{className:"flex justify-between",children:[_.jsx("span",{children:"Total Movies:"}),_.jsx("span",{className:"font-bold",children:h.totalMovies})]}),_.jsxs("li",{className:"flex justify-between",children:[_.jsx("span",{children:"Watched:"}),_.jsx("span",{className:"font-bold",children:h.watchedMovies})]}),_.jsxs("li",{className:"flex justify-between",children:[_.jsx("span",{children:"Unwatched:"}),_.jsx("span",{className:"font-bold",children:h.unwatchedMovies})]}),_.jsxs("li",{className:"flex justify-between",children:[_.jsx("span",{children:"Favorites:"}),_.jsx("span",{className:"font-bold",children:h.favoriteMovies})]}),_.jsxs("li",{className:"flex justify-between",children:[_.jsx("span",{children:"Average Rating:"}),_.jsxs("span",{className:"font-bold",children:[h.averageRating.toFixed(1),"/10"]})]})]})]}),_.jsx("div",{className:"mt-6",children:_.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:v,children:[_.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Sign Out"]})})]})}),_.jsx("div",{className:"md:col-span-2",children:_.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[_.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Settings"}),_.jsxs("div",{className:"mb-6",children:[_.jsx("h3",{className:"text-lg font-bold mb-2",children:"TMDB API Key"}),_.jsxs("p",{className:"mb-4",children:["Your TMDB API key is used to search for movies and fetch movie details. If you don't have one, you can get it for free from ",_.jsx("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",className:"link link-primary",children:"The Movie Database"}),"."]}),_.jsxs("div",{className:"form-control",children:[_.jsx("label",{className:"label",children:_.jsx("span",{className:"label-text",children:"API Key"})}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("input",{type:"text",className:"input input-bordered flex-1",value:n,onChange:m=>i(m.target.value),placeholder:"Enter your TMDB API key"}),_.jsx("button",{className:"btn btn-primary",onClick:p,disabled:s,children:s?_.jsx("span",{className:"loading loading-spinner loading-sm"}):_.jsx("i",{className:"fas fa-save"})})]})]})]}),_.jsx("div",{className:"divider"}),_.jsxs("div",{className:"mb-6",children:[_.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Links"}),_.jsxs("div",{className:"flex flex-wrap gap-2",children:[_.jsxs(xt,{to:"/movies",className:"btn btn-outline btn-sm",children:[_.jsx("i",{className:"fas fa-film mr-2"}),"My Movies"]}),_.jsxs(xt,{to:"/import",className:"btn btn-outline btn-sm",children:[_.jsx("i",{className:"fas fa-file-import mr-2"}),"Import Movies"]}),_.jsxs(xt,{to:"/random",className:"btn btn-outline btn-sm",children:[_.jsx("i",{className:"fas fa-random mr-2"}),"Random Movie Picker"]})]})]})]})})]})]})},aI=()=>{const[t,e]=ee.useState(!1),[r,n]=ee.useState(!0),[i,s]=ee.useState(null),[a,o]=ee.useState(null);return ee.useEffect(()=>{const l=OT(wc,async c=>{if(n(!0),s(null),!c){e(!1),o(null),n(!1);return}o({uid:c.uid,email:c.email});try{if((await yT(c)).claims.admin===!0){e(!0),n(!1);return}const d=Qn(fr,"admins",c.uid),p=await yc(d);e(p.exists())}catch(f){console.error("Error checking admin status:",f),s("Failed to verify admin status"),e(!1)}finally{n(!1)}});return()=>l()},[]),{isAdmin:t,loading:r,error:i,currentUser:a}},_j=()=>{const t=Ka(),{isAdmin:e,loading:r,currentUser:n}=aI(),[i,s]=ee.useState(!1),[a,o]=ee.useState(null),l=!1;ee.useEffect(()=>{e&&!r&&t("/admin")},[e,r,t]);const c=async()=>{o(null),s(!0);try{await GT(wc,eL)}catch(f){console.error("Login error:",f),f.code==="auth/popup-closed-by-user"?o("Sign-in popup was closed. Please try again."):f.code==="auth/cancelled-popup-request"?o("Another popup is already open. Please try again."):f.code==="auth/unauthorized-domain"?(console.error("Unauthorized domain error:",window.location.hostname),o("This domain is not authorized for OAuth operations. Please add "+window.location.hostname+" to your Firebase authorized domains list in the Firebase console under Authentication > Sign-in method > Authorized domains.")):o("Failed to sign in. Please try again."),s(!1)}};return r?_.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):_.jsx("div",{className:"container mx-auto px-4 py-12",children:_.jsxs("div",{className:"max-w-md mx-auto",children:[_.jsxs("div",{className:"text-center mb-8",children:[_.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Admin Login"}),_.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage the Christmas Quiz"})]}),_.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[l,n&&_.jsxs("div",{className:"bg-info bg-opacity-10 border-l-4 border-info p-4 mb-6 rounded",children:[_.jsx("p",{className:"text-info font-bold mb-2",children:"User Authenticated"}),_.jsxs("p",{className:"text-info text-sm mb-1",children:["Email: ",n.email]}),_.jsxs("p",{className:"text-info text-sm mb-2",children:["UID: ",n.uid]}),_.jsxs("p",{className:"text-info text-sm",children:["To grant admin access, create a document in the ",_.jsx("code",{className:"bg-base-300 px-1 py-0.5 rounded",children:"admins"})," collection with this UID as the document ID."]}),l]}),a&&_.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:_.jsx("p",{className:"text-error",children:a})}),_.jsxs("div",{className:"text-center mb-6",children:[_.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access the admin panel."}),_.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Only authorized administrators will be granted access."}),_.jsx("button",{onClick:c,className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:i,children:i?_.jsxs(_.Fragment,{children:[_.jsx("span",{className:"loading loading-spinner loading-sm"}),"Signing in..."]}):_.jsxs(_.Fragment,{children:[_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[_.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                      s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                      s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),_.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                      l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),_.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                      c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),_.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                      c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})})]})]}),_.jsx("div",{className:"text-center mt-6",children:_.jsx("button",{onClick:()=>t("/"),className:"btn btn-link text-xmas-mute",children:"Back to Home"})})]})})};var sc=(t=>(t.GENERAL="general",t.PICTURE="picture",t.MUSIC="music",t.TRIVIA="trivia",t.CHRISTMAS="christmas",t))(sc||{});const yj=()=>{const t=Ka(),{isAdmin:e,loading:r}=aI(),[n,i]=ee.useState([]),[s,a]=ee.useState(!0),[o,l]=ee.useState(null);ee.useEffect(()=>{!r&&!e&&t("/admin/login")},[e,r,t]),ee.useEffect(()=>{e&&(async()=>{if(e){a(!0);try{const h=await Ba(Ua(Zs(fr,"rounds"),a6("order","asc"))),d=[];h.forEach(p=>{const v=p.data();d.push({id:p.id,...v})}),i(d)}catch(h){console.error("Error fetching rounds:",h),l("Failed to load rounds")}finally{a(!1)}}})()},[e]);const c=f=>{switch(f){case sc.PICTURE:return _.jsx("i",{className:"fas fa-image text-info"});case sc.MUSIC:return _.jsx("i",{className:"fas fa-music text-success"});case sc.TRIVIA:return _.jsx("i",{className:"fas fa-lightbulb text-warning"});case sc.CHRISTMAS:return _.jsx("i",{className:"fas fa-holly-berry text-error"});default:return _.jsx("i",{className:"fas fa-question-circle text-primary"})}};return r||s?_.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):_.jsxs("div",{className:"container mx-auto px-4 py-8",children:[_.jsxs("div",{className:"flex justify-between items-center mb-8",children:[_.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Dashboard"}),_.jsx("div",{className:"flex gap-2",children:_.jsxs(xt,{to:"/admin/results",className:"btn btn-outline",children:[_.jsx("i",{className:"fas fa-trophy mr-2"})," View Results"]})})]}),o&&_.jsxs("div",{className:"alert alert-error mb-6",children:[_.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),_.jsx("span",{children:o})]}),_.jsxs("div",{className:"mb-8",children:[_.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Quiz Rounds"}),n.length===0?_.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[_.jsx("h3",{className:"text-xl mb-4",children:"No rounds yet"}),_.jsx("p",{className:"mb-4",children:"Start by adding your first quiz round!"}),_.jsxs(xt,{to:"/admin/rounds",className:"btn btn-primary",children:[_.jsx("i",{className:"fas fa-plus mr-2"})," Add Round"]})]}):_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.map(f=>_.jsx("div",{className:"card bg-xmas-card shadow-xl",children:_.jsxs("div",{className:"card-body",children:[_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsxs("h2",{className:"card-title font-christmas",children:[c(f.type)," ",f.title]}),_.jsxs("div",{className:"badge badge-outline",children:["#",f.order]})]}),_.jsx("p",{className:"text-sm mb-4",children:f.description}),_.jsx("div",{className:"card-actions justify-end",children:_.jsxs(xt,{to:`/admin/questions/${f.id}`,className:"btn btn-primary btn-sm",children:[_.jsx("i",{className:"fas fa-list mr-1"})," Manage Questions"]})})]})},f.id)),_.jsx("div",{className:"card bg-base-100 border-2 border-dashed border-base-300 shadow-xl flex items-center justify-center",children:_.jsxs("div",{className:"card-body items-center text-center",children:[_.jsx("h2",{className:"card-title font-christmas",children:"Add New Round"}),_.jsx("p",{children:"Create a new quiz round"}),_.jsx("div",{className:"card-actions justify-center mt-4",children:_.jsxs(xt,{to:"/admin/rounds",className:"btn btn-primary",children:[_.jsx("i",{className:"fas fa-plus mr-2"})," Add Round"]})})]})})]})]})]})},wj=yN([{element:_.jsx(nL,{}),children:[{path:"/",element:_.jsx(sL,{})},{path:"/login",element:_.jsx(aL,{})},{element:_.jsx(iL,{}),children:[{path:"/movies",element:_.jsx(oL,{})},{path:"/movies/:movieId",element:_.jsx(lL,{})},{path:"/import",element:_.jsx(gj,{})},{path:"/random",element:_.jsx(vj,{})},{path:"/profile",element:_.jsx(xj,{})}]},{path:"/admin/login",element:_.jsx(_j,{})},{path:"/admin",element:_.jsx(yj,{})}]}]);Qd.createRoot(document.getElementById("root")).render(_.jsx(Lw.StrictMode,{children:_.jsx(tL,{children:_.jsx(CN,{router:wj})})}));
