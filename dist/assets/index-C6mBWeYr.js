function Ow(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function Mw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Lw={exports:{}},td={},jw={exports:{}},st={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uu=Symbol.for("react.element"),OI=Symbol.for("react.portal"),MI=Symbol.for("react.fragment"),LI=Symbol.for("react.strict_mode"),jI=Symbol.for("react.profiler"),VI=Symbol.for("react.provider"),UI=Symbol.for("react.context"),BI=Symbol.for("react.forward_ref"),zI=Symbol.for("react.suspense"),$I=Symbol.for("react.memo"),HI=Symbol.for("react.lazy"),Dx=Symbol.iterator;function WI(t){return t===null||typeof t!="object"?null:(t=Dx&&t[Dx]||t["@@iterator"],typeof t=="function"?t:null)}var Vw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Uw=Object.assign,Bw={};function fl(t,e,r){this.props=t,this.context=e,this.refs=Bw,this.updater=r||Vw}fl.prototype.isReactComponent={};fl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};fl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function zw(){}zw.prototype=fl.prototype;function Om(t,e,r){this.props=t,this.context=e,this.refs=Bw,this.updater=r||Vw}var Mm=Om.prototype=new zw;Mm.constructor=Om;Uw(Mm,fl.prototype);Mm.isPureReactComponent=!0;var Fx=Array.isArray,$w=Object.prototype.hasOwnProperty,Lm={current:null},Hw={key:!0,ref:!0,__self:!0,__source:!0};function Ww(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)$w.call(e,n)&&!Hw.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:uu,type:t,key:i,ref:a,props:s,_owner:Lm.current}}function GI(t,e){return{$$typeof:uu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function jm(t){return typeof t=="object"&&t!==null&&t.$$typeof===uu}function KI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var bx=/\/+/g;function Zd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?KI(""+t.key):e.toString(36)}function Cf(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case uu:case OI:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+Zd(a,0):n,Fx(s)?(r="",t!=null&&(r=t.replace(bx,"$&/")+"/"),Cf(s,e,r,"",function(c){return c})):s!=null&&(jm(s)&&(s=GI(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(bx,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",Fx(t))for(var o=0;o<t.length;o++){i=t[o];var l=n+Zd(i,o);a+=Cf(i,e,r,l,s)}else if(l=WI(t),typeof l=="function")for(t=l.call(t),o=0;!(i=t.next()).done;)i=i.value,l=n+Zd(i,o++),a+=Cf(i,e,r,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function qu(t,e,r){if(t==null)return t;var n=[],s=0;return Cf(t,n,"","",function(i){return e.call(r,i,s++)}),n}function qI(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var tn={current:null},Rf={transition:null},XI={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:Rf,ReactCurrentOwner:Lm};function Gw(){throw Error("act(...) is not supported in production builds of React.")}st.Children={map:qu,forEach:function(t,e,r){qu(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return qu(t,function(){e++}),e},toArray:function(t){return qu(t,function(e){return e})||[]},only:function(t){if(!jm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};st.Component=fl;st.Fragment=MI;st.Profiler=jI;st.PureComponent=Om;st.StrictMode=LI;st.Suspense=zI;st.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XI;st.act=Gw;st.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Uw({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Lm.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)$w.call(e,l)&&!Hw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:uu,type:t.type,key:s,ref:i,props:n,_owner:a}};st.createContext=function(t){return t={$$typeof:UI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:VI,_context:t},t.Consumer=t};st.createElement=Ww;st.createFactory=function(t){var e=Ww.bind(null,t);return e.type=t,e};st.createRef=function(){return{current:null}};st.forwardRef=function(t){return{$$typeof:BI,render:t}};st.isValidElement=jm;st.lazy=function(t){return{$$typeof:HI,_payload:{_status:-1,_result:t},_init:qI}};st.memo=function(t,e){return{$$typeof:$I,type:t,compare:e===void 0?null:e}};st.startTransition=function(t){var e=Rf.transition;Rf.transition={};try{t()}finally{Rf.transition=e}};st.unstable_act=Gw;st.useCallback=function(t,e){return tn.current.useCallback(t,e)};st.useContext=function(t){return tn.current.useContext(t)};st.useDebugValue=function(){};st.useDeferredValue=function(t){return tn.current.useDeferredValue(t)};st.useEffect=function(t,e){return tn.current.useEffect(t,e)};st.useId=function(){return tn.current.useId()};st.useImperativeHandle=function(t,e,r){return tn.current.useImperativeHandle(t,e,r)};st.useInsertionEffect=function(t,e){return tn.current.useInsertionEffect(t,e)};st.useLayoutEffect=function(t,e){return tn.current.useLayoutEffect(t,e)};st.useMemo=function(t,e){return tn.current.useMemo(t,e)};st.useReducer=function(t,e,r){return tn.current.useReducer(t,e,r)};st.useRef=function(t){return tn.current.useRef(t)};st.useState=function(t){return tn.current.useState(t)};st.useSyncExternalStore=function(t,e,r){return tn.current.useSyncExternalStore(t,e,r)};st.useTransition=function(){return tn.current.useTransition()};st.version="18.3.1";jw.exports=st;var X=jw.exports;const Kw=Mw(X),YI=Ow({__proto__:null,default:Kw},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QI=X,JI=Symbol.for("react.element"),ZI=Symbol.for("react.fragment"),eC=Object.prototype.hasOwnProperty,tC=QI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rC={key:!0,ref:!0,__self:!0,__source:!0};function qw(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)eC.call(e,n)&&!rC.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:JI,type:t,key:i,ref:a,props:s,_owner:tC.current}}td.Fragment=ZI;td.jsx=qw;td.jsxs=qw;Lw.exports=td;var d=Lw.exports,ep={},Xw={exports:{}},kn={},Yw={exports:{}},Qw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(oe,K){var de=oe.length;oe.push(K);e:for(;0<de;){var Te=de-1>>>1,B=oe[Te];if(0<s(B,K))oe[Te]=K,oe[de]=B,de=Te;else break e}}function r(oe){return oe.length===0?null:oe[0]}function n(oe){if(oe.length===0)return null;var K=oe[0],de=oe.pop();if(de!==K){oe[0]=de;e:for(var Te=0,B=oe.length,ee=B>>>1;Te<ee;){var q=2*(Te+1)-1,W=oe[q],ae=q+1,ve=oe[ae];if(0>s(W,de))ae<B&&0>s(ve,W)?(oe[Te]=ve,oe[ae]=de,Te=ae):(oe[Te]=W,oe[q]=de,Te=q);else if(ae<B&&0>s(ve,de))oe[Te]=ve,oe[ae]=de,Te=ae;else break e}}return K}function s(oe,K){var de=oe.sortIndex-K.sortIndex;return de!==0?de:oe.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,h=null,p=3,m=!1,x=!1,v=!1,y=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(oe){for(var K=r(c);K!==null;){if(K.callback===null)n(c);else if(K.startTime<=oe)n(c),K.sortIndex=K.expirationTime,e(l,K);else break;K=r(c)}}function D(oe){if(v=!1,w(oe),!x)if(r(l)!==null)x=!0,Ae(U);else{var K=r(c);K!==null&&_e(D,K.startTime-oe)}}function U(oe,K){x=!1,v&&(v=!1,T(E),E=-1),m=!0;var de=p;try{for(w(K),h=r(l);h!==null&&(!(h.expirationTime>K)||oe&&!P());){var Te=h.callback;if(typeof Te=="function"){h.callback=null,p=h.priorityLevel;var B=Te(h.expirationTime<=K);K=t.unstable_now(),typeof B=="function"?h.callback=B:h===r(l)&&n(l),w(K)}else n(l);h=r(l)}if(h!==null)var ee=!0;else{var q=r(c);q!==null&&_e(D,q.startTime-K),ee=!1}return ee}finally{h=null,p=de,m=!1}}var V=!1,g=null,E=-1,S=5,C=-1;function P(){return!(t.unstable_now()-C<S)}function R(){if(g!==null){var oe=t.unstable_now();C=oe;var K=!0;try{K=g(!0,oe)}finally{K?b():(V=!1,g=null)}}else V=!1}var b;if(typeof k=="function")b=function(){k(R)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,fe=ce.port2;ce.port1.onmessage=R,b=function(){fe.postMessage(null)}}else b=function(){y(R,0)};function Ae(oe){g=oe,V||(V=!0,b())}function _e(oe,K){E=y(function(){oe(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(oe){oe.callback=null},t.unstable_continueExecution=function(){x||m||(x=!0,Ae(U))},t.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<oe?Math.floor(1e3/oe):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(oe){switch(p){case 1:case 2:case 3:var K=3;break;default:K=p}var de=p;p=K;try{return oe()}finally{p=de}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(oe,K){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var de=p;p=oe;try{return K()}finally{p=de}},t.unstable_scheduleCallback=function(oe,K,de){var Te=t.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?Te+de:Te):de=Te,oe){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=de+B,oe={id:u++,callback:K,priorityLevel:oe,startTime:de,expirationTime:B,sortIndex:-1},de>Te?(oe.sortIndex=de,e(c,oe),r(l)===null&&oe===r(c)&&(v?(T(E),E=-1):v=!0,_e(D,de-Te))):(oe.sortIndex=B,e(l,oe),x||m||(x=!0,Ae(U))),oe},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(oe){var K=p;return function(){var de=p;p=K;try{return oe.apply(this,arguments)}finally{p=de}}}})(Qw);Yw.exports=Qw;var nC=Yw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sC=X,En=nC;function xe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jw=new Set,Ic={};function Wa(t,e){Go(t,e),Go(t+"Capture",e)}function Go(t,e){for(Ic[t]=e,t=0;t<e.length;t++)Jw.add(e[t])}var ei=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tp=Object.prototype.hasOwnProperty,iC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ox={},Mx={};function aC(t){return tp.call(Mx,t)?!0:tp.call(Ox,t)?!1:iC.test(t)?Mx[t]=!0:(Ox[t]=!0,!1)}function oC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function lC(t,e,r,n){if(e===null||typeof e>"u"||oC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function rn(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Cr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Cr[t]=new rn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Cr[e]=new rn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Cr[t]=new rn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Cr[t]=new rn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Cr[t]=new rn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Cr[t]=new rn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Cr[t]=new rn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Cr[t]=new rn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Cr[t]=new rn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Vm=/[\-:]([a-z])/g;function Um(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Vm,Um);Cr[e]=new rn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Vm,Um);Cr[e]=new rn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Vm,Um);Cr[e]=new rn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Cr[t]=new rn(t,1,!1,t.toLowerCase(),null,!1,!1)});Cr.xlinkHref=new rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Cr[t]=new rn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Bm(t,e,r,n){var s=Cr.hasOwnProperty(e)?Cr[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(lC(e,r,s,n)&&(r=null),n||s===null?aC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var fi=sC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xu=Symbol.for("react.element"),_o=Symbol.for("react.portal"),yo=Symbol.for("react.fragment"),zm=Symbol.for("react.strict_mode"),rp=Symbol.for("react.profiler"),Zw=Symbol.for("react.provider"),eE=Symbol.for("react.context"),$m=Symbol.for("react.forward_ref"),np=Symbol.for("react.suspense"),sp=Symbol.for("react.suspense_list"),Hm=Symbol.for("react.memo"),Ei=Symbol.for("react.lazy"),tE=Symbol.for("react.offscreen"),Lx=Symbol.iterator;function Dl(t){return t===null||typeof t!="object"?null:(t=Lx&&t[Lx]||t["@@iterator"],typeof t=="function"?t:null)}var Bt=Object.assign,e0;function Hl(t){if(e0===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);e0=e&&e[1]||""}return`
`+e0+t}var t0=!1;function r0(t,e){if(!t||t0)return"";t0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var l=`
`+s[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{t0=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Hl(t):""}function cC(t){switch(t.tag){case 5:return Hl(t.type);case 16:return Hl("Lazy");case 13:return Hl("Suspense");case 19:return Hl("SuspenseList");case 0:case 2:case 15:return t=r0(t.type,!1),t;case 11:return t=r0(t.type.render,!1),t;case 1:return t=r0(t.type,!0),t;default:return""}}function ip(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case yo:return"Fragment";case _o:return"Portal";case rp:return"Profiler";case zm:return"StrictMode";case np:return"Suspense";case sp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case eE:return(t.displayName||"Context")+".Consumer";case Zw:return(t._context.displayName||"Context")+".Provider";case $m:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Hm:return e=t.displayName||null,e!==null?e:ip(t.type)||"Memo";case Ei:e=t._payload,t=t._init;try{return ip(t(e))}catch{}}return null}function uC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ip(e);case 8:return e===zm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function qi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function rE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function fC(t){var e=rE(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Yu(t){t._valueTracker||(t._valueTracker=fC(t))}function nE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=rE(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Yf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ap(t,e){var r=e.checked;return Bt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function jx(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=qi(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function sE(t,e){e=e.checked,e!=null&&Bm(t,"checked",e,!1)}function op(t,e){sE(t,e);var r=qi(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?lp(t,e.type,r):e.hasOwnProperty("defaultValue")&&lp(t,e.type,qi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Vx(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function lp(t,e,r){(e!=="number"||Yf(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Wl=Array.isArray;function Do(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+qi(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function cp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(xe(91));return Bt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ux(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(xe(92));if(Wl(r)){if(1<r.length)throw Error(xe(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:qi(r)}}function iE(t,e){var r=qi(e.value),n=qi(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Bx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function aE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function up(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?aE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Qu,oE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Qu=Qu||document.createElement("div"),Qu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Qu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Cc(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var nc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hC=["Webkit","ms","Moz","O"];Object.keys(nc).forEach(function(t){hC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),nc[e]=nc[t]})});function lE(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||nc.hasOwnProperty(t)&&nc[t]?(""+e).trim():e+"px"}function cE(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=lE(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var dC=Bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fp(t,e){if(e){if(dC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(xe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(xe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(xe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(xe(62))}}function hp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dp=null;function Wm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var pp=null,Fo=null,bo=null;function zx(t){if(t=du(t)){if(typeof pp!="function")throw Error(xe(280));var e=t.stateNode;e&&(e=ad(e),pp(t.stateNode,t.type,e))}}function uE(t){Fo?bo?bo.push(t):bo=[t]:Fo=t}function fE(){if(Fo){var t=Fo,e=bo;if(bo=Fo=null,zx(t),e)for(t=0;t<e.length;t++)zx(e[t])}}function hE(t,e){return t(e)}function dE(){}var n0=!1;function pE(t,e,r){if(n0)return t(e,r);n0=!0;try{return hE(t,e,r)}finally{n0=!1,(Fo!==null||bo!==null)&&(dE(),fE())}}function Rc(t,e){var r=t.stateNode;if(r===null)return null;var n=ad(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(xe(231,e,typeof r));return r}var mp=!1;if(ei)try{var Fl={};Object.defineProperty(Fl,"passive",{get:function(){mp=!0}}),window.addEventListener("test",Fl,Fl),window.removeEventListener("test",Fl,Fl)}catch{mp=!1}function pC(t,e,r,n,s,i,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var sc=!1,Qf=null,Jf=!1,gp=null,mC={onError:function(t){sc=!0,Qf=t}};function gC(t,e,r,n,s,i,a,o,l){sc=!1,Qf=null,pC.apply(mC,arguments)}function vC(t,e,r,n,s,i,a,o,l){if(gC.apply(this,arguments),sc){if(sc){var c=Qf;sc=!1,Qf=null}else throw Error(xe(198));Jf||(Jf=!0,gp=c)}}function Ga(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function mE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function $x(t){if(Ga(t)!==t)throw Error(xe(188))}function xC(t){var e=t.alternate;if(!e){if(e=Ga(t),e===null)throw Error(xe(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return $x(s),t;if(i===n)return $x(s),e;i=i.sibling}throw Error(xe(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a)throw Error(xe(189))}}if(r.alternate!==n)throw Error(xe(190))}if(r.tag!==3)throw Error(xe(188));return r.stateNode.current===r?t:e}function gE(t){return t=xC(t),t!==null?vE(t):null}function vE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=vE(t);if(e!==null)return e;t=t.sibling}return null}var xE=En.unstable_scheduleCallback,Hx=En.unstable_cancelCallback,_C=En.unstable_shouldYield,yC=En.unstable_requestPaint,Xt=En.unstable_now,wC=En.unstable_getCurrentPriorityLevel,Gm=En.unstable_ImmediatePriority,_E=En.unstable_UserBlockingPriority,Zf=En.unstable_NormalPriority,EC=En.unstable_LowPriority,yE=En.unstable_IdlePriority,rd=null,_s=null;function TC(t){if(_s&&typeof _s.onCommitFiberRoot=="function")try{_s.onCommitFiberRoot(rd,t,void 0,(t.current.flags&128)===128)}catch{}}var rs=Math.clz32?Math.clz32:AC,kC=Math.log,SC=Math.LN2;function AC(t){return t>>>=0,t===0?32:31-(kC(t)/SC|0)|0}var Ju=64,Zu=4194304;function Gl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function eh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~s;o!==0?n=Gl(o):(i&=a,i!==0&&(n=Gl(i)))}else a=r&~s,a!==0?n=Gl(a):i!==0&&(n=Gl(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-rs(e),s=1<<r,n|=t[r],e&=~s;return n}function IC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function CC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-rs(i),o=1<<a,l=s[a];l===-1?(!(o&r)||o&n)&&(s[a]=IC(o,e)):l<=e&&(t.expiredLanes|=o),i&=~o}}function vp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function wE(){var t=Ju;return Ju<<=1,!(Ju&4194240)&&(Ju=64),t}function s0(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function fu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-rs(e),t[e]=r}function RC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-rs(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function Km(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-rs(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var It=0;function EE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var TE,qm,kE,SE,AE,xp=!1,ef=[],Mi=null,Li=null,ji=null,Nc=new Map,Pc=new Map,ki=[],NC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wx(t,e){switch(t){case"focusin":case"focusout":Mi=null;break;case"dragenter":case"dragleave":Li=null;break;case"mouseover":case"mouseout":ji=null;break;case"pointerover":case"pointerout":Nc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(e.pointerId)}}function bl(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=du(e),e!==null&&qm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function PC(t,e,r,n,s){switch(e){case"focusin":return Mi=bl(Mi,t,e,r,n,s),!0;case"dragenter":return Li=bl(Li,t,e,r,n,s),!0;case"mouseover":return ji=bl(ji,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return Nc.set(i,bl(Nc.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Pc.set(i,bl(Pc.get(i)||null,t,e,r,n,s)),!0}return!1}function IE(t){var e=va(t.target);if(e!==null){var r=Ga(e);if(r!==null){if(e=r.tag,e===13){if(e=mE(r),e!==null){t.blockedOn=e,AE(t.priority,function(){kE(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Nf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=_p(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);dp=n,r.target.dispatchEvent(n),dp=null}else return e=du(r),e!==null&&qm(e),t.blockedOn=r,!1;e.shift()}return!0}function Gx(t,e,r){Nf(t)&&r.delete(e)}function DC(){xp=!1,Mi!==null&&Nf(Mi)&&(Mi=null),Li!==null&&Nf(Li)&&(Li=null),ji!==null&&Nf(ji)&&(ji=null),Nc.forEach(Gx),Pc.forEach(Gx)}function Ol(t,e){t.blockedOn===e&&(t.blockedOn=null,xp||(xp=!0,En.unstable_scheduleCallback(En.unstable_NormalPriority,DC)))}function Dc(t){function e(s){return Ol(s,t)}if(0<ef.length){Ol(ef[0],t);for(var r=1;r<ef.length;r++){var n=ef[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Mi!==null&&Ol(Mi,t),Li!==null&&Ol(Li,t),ji!==null&&Ol(ji,t),Nc.forEach(e),Pc.forEach(e),r=0;r<ki.length;r++)n=ki[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<ki.length&&(r=ki[0],r.blockedOn===null);)IE(r),r.blockedOn===null&&ki.shift()}var Oo=fi.ReactCurrentBatchConfig,th=!0;function FC(t,e,r,n){var s=It,i=Oo.transition;Oo.transition=null;try{It=1,Xm(t,e,r,n)}finally{It=s,Oo.transition=i}}function bC(t,e,r,n){var s=It,i=Oo.transition;Oo.transition=null;try{It=4,Xm(t,e,r,n)}finally{It=s,Oo.transition=i}}function Xm(t,e,r,n){if(th){var s=_p(t,e,r,n);if(s===null)p0(t,e,n,rh,r),Wx(t,n);else if(PC(s,t,e,r,n))n.stopPropagation();else if(Wx(t,n),e&4&&-1<NC.indexOf(t)){for(;s!==null;){var i=du(s);if(i!==null&&TE(i),i=_p(t,e,r,n),i===null&&p0(t,e,n,rh,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else p0(t,e,n,null,r)}}var rh=null;function _p(t,e,r,n){if(rh=null,t=Wm(n),t=va(t),t!==null)if(e=Ga(t),e===null)t=null;else if(r=e.tag,r===13){if(t=mE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return rh=t,null}function CE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wC()){case Gm:return 1;case _E:return 4;case Zf:case EC:return 16;case yE:return 536870912;default:return 16}default:return 16}}var Ni=null,Ym=null,Pf=null;function RE(){if(Pf)return Pf;var t,e=Ym,r=e.length,n,s="value"in Ni?Ni.value:Ni.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return Pf=s.slice(t,1<n?1-n:void 0)}function Df(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function tf(){return!0}function Kx(){return!1}function Sn(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?tf:Kx,this.isPropagationStopped=Kx,this}return Bt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=tf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=tf)},persist:function(){},isPersistent:tf}),e}var hl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qm=Sn(hl),hu=Bt({},hl,{view:0,detail:0}),OC=Sn(hu),i0,a0,Ml,nd=Bt({},hu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ml&&(Ml&&t.type==="mousemove"?(i0=t.screenX-Ml.screenX,a0=t.screenY-Ml.screenY):a0=i0=0,Ml=t),i0)},movementY:function(t){return"movementY"in t?t.movementY:a0}}),qx=Sn(nd),MC=Bt({},nd,{dataTransfer:0}),LC=Sn(MC),jC=Bt({},hu,{relatedTarget:0}),o0=Sn(jC),VC=Bt({},hl,{animationName:0,elapsedTime:0,pseudoElement:0}),UC=Sn(VC),BC=Bt({},hl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),zC=Sn(BC),$C=Bt({},hl,{data:0}),Xx=Sn($C),HC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},WC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=GC[t])?!!e[t]:!1}function Jm(){return KC}var qC=Bt({},hu,{key:function(t){if(t.key){var e=HC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Df(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?WC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jm,charCode:function(t){return t.type==="keypress"?Df(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Df(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),XC=Sn(qC),YC=Bt({},nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yx=Sn(YC),QC=Bt({},hu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jm}),JC=Sn(QC),ZC=Bt({},hl,{propertyName:0,elapsedTime:0,pseudoElement:0}),e4=Sn(ZC),t4=Bt({},nd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),r4=Sn(t4),n4=[9,13,27,32],Zm=ei&&"CompositionEvent"in window,ic=null;ei&&"documentMode"in document&&(ic=document.documentMode);var s4=ei&&"TextEvent"in window&&!ic,NE=ei&&(!Zm||ic&&8<ic&&11>=ic),Qx=" ",Jx=!1;function PE(t,e){switch(t){case"keyup":return n4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function DE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var wo=!1;function i4(t,e){switch(t){case"compositionend":return DE(e);case"keypress":return e.which!==32?null:(Jx=!0,Qx);case"textInput":return t=e.data,t===Qx&&Jx?null:t;default:return null}}function a4(t,e){if(wo)return t==="compositionend"||!Zm&&PE(t,e)?(t=RE(),Pf=Ym=Ni=null,wo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return NE&&e.locale!=="ko"?null:e.data;default:return null}}var o4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!o4[t.type]:e==="textarea"}function FE(t,e,r,n){uE(n),e=nh(e,"onChange"),0<e.length&&(r=new Qm("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var ac=null,Fc=null;function l4(t){HE(t,0)}function sd(t){var e=ko(t);if(nE(e))return t}function c4(t,e){if(t==="change")return e}var bE=!1;if(ei){var l0;if(ei){var c0="oninput"in document;if(!c0){var e1=document.createElement("div");e1.setAttribute("oninput","return;"),c0=typeof e1.oninput=="function"}l0=c0}else l0=!1;bE=l0&&(!document.documentMode||9<document.documentMode)}function t1(){ac&&(ac.detachEvent("onpropertychange",OE),Fc=ac=null)}function OE(t){if(t.propertyName==="value"&&sd(Fc)){var e=[];FE(e,Fc,t,Wm(t)),pE(l4,e)}}function u4(t,e,r){t==="focusin"?(t1(),ac=e,Fc=r,ac.attachEvent("onpropertychange",OE)):t==="focusout"&&t1()}function f4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return sd(Fc)}function h4(t,e){if(t==="click")return sd(e)}function d4(t,e){if(t==="input"||t==="change")return sd(e)}function p4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var as=typeof Object.is=="function"?Object.is:p4;function bc(t,e){if(as(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!tp.call(e,s)||!as(t[s],e[s]))return!1}return!0}function r1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function n1(t,e){var r=r1(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=r1(r)}}function ME(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ME(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function LE(){for(var t=window,e=Yf();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Yf(t.document)}return e}function eg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function m4(t){var e=LE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&ME(r.ownerDocument.documentElement,r)){if(n!==null&&eg(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=n1(r,i);var a=n1(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var g4=ei&&"documentMode"in document&&11>=document.documentMode,Eo=null,yp=null,oc=null,wp=!1;function s1(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;wp||Eo==null||Eo!==Yf(n)||(n=Eo,"selectionStart"in n&&eg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),oc&&bc(oc,n)||(oc=n,n=nh(yp,"onSelect"),0<n.length&&(e=new Qm("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Eo)))}function rf(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var To={animationend:rf("Animation","AnimationEnd"),animationiteration:rf("Animation","AnimationIteration"),animationstart:rf("Animation","AnimationStart"),transitionend:rf("Transition","TransitionEnd")},u0={},jE={};ei&&(jE=document.createElement("div").style,"AnimationEvent"in window||(delete To.animationend.animation,delete To.animationiteration.animation,delete To.animationstart.animation),"TransitionEvent"in window||delete To.transitionend.transition);function id(t){if(u0[t])return u0[t];if(!To[t])return t;var e=To[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in jE)return u0[t]=e[r];return t}var VE=id("animationend"),UE=id("animationiteration"),BE=id("animationstart"),zE=id("transitionend"),$E=new Map,i1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ra(t,e){$E.set(t,e),Wa(e,[t])}for(var f0=0;f0<i1.length;f0++){var h0=i1[f0],v4=h0.toLowerCase(),x4=h0[0].toUpperCase()+h0.slice(1);ra(v4,"on"+x4)}ra(VE,"onAnimationEnd");ra(UE,"onAnimationIteration");ra(BE,"onAnimationStart");ra("dblclick","onDoubleClick");ra("focusin","onFocus");ra("focusout","onBlur");ra(zE,"onTransitionEnd");Go("onMouseEnter",["mouseout","mouseover"]);Go("onMouseLeave",["mouseout","mouseover"]);Go("onPointerEnter",["pointerout","pointerover"]);Go("onPointerLeave",["pointerout","pointerover"]);Wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Kl));function a1(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,vC(n,e,void 0,t),t.currentTarget=null}function HE(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&s.isPropagationStopped())break e;a1(s,o,c),i=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&s.isPropagationStopped())break e;a1(s,o,c),i=l}}}if(Jf)throw t=gp,Jf=!1,gp=null,t}function Ft(t,e){var r=e[Ap];r===void 0&&(r=e[Ap]=new Set);var n=t+"__bubble";r.has(n)||(WE(e,t,2,!1),r.add(n))}function d0(t,e,r){var n=0;e&&(n|=4),WE(r,t,n,e)}var nf="_reactListening"+Math.random().toString(36).slice(2);function Oc(t){if(!t[nf]){t[nf]=!0,Jw.forEach(function(r){r!=="selectionchange"&&(_4.has(r)||d0(r,!1,t),d0(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[nf]||(e[nf]=!0,d0("selectionchange",!1,e))}}function WE(t,e,r,n){switch(CE(e)){case 1:var s=FC;break;case 4:s=bC;break;default:s=Xm}r=s.bind(null,e,r,t),s=void 0,!mp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function p0(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;a=a.return}for(;o!==null;){if(a=va(o),a===null)return;if(l=a.tag,l===5||l===6){n=i=a;continue e}o=o.parentNode}}n=n.return}pE(function(){var c=i,u=Wm(r),h=[];e:{var p=$E.get(t);if(p!==void 0){var m=Qm,x=t;switch(t){case"keypress":if(Df(r)===0)break e;case"keydown":case"keyup":m=XC;break;case"focusin":x="focus",m=o0;break;case"focusout":x="blur",m=o0;break;case"beforeblur":case"afterblur":m=o0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=qx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=LC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=JC;break;case VE:case UE:case BE:m=UC;break;case zE:m=e4;break;case"scroll":m=OC;break;case"wheel":m=r4;break;case"copy":case"cut":case"paste":m=zC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Yx}var v=(e&4)!==0,y=!v&&t==="scroll",T=v?p!==null?p+"Capture":null:p;v=[];for(var k=c,w;k!==null;){w=k;var D=w.stateNode;if(w.tag===5&&D!==null&&(w=D,T!==null&&(D=Rc(k,T),D!=null&&v.push(Mc(k,D,w)))),y)break;k=k.return}0<v.length&&(p=new m(p,x,null,r,u),h.push({event:p,listeners:v}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",p&&r!==dp&&(x=r.relatedTarget||r.fromElement)&&(va(x)||x[ti]))break e;if((m||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,m?(x=r.relatedTarget||r.toElement,m=c,x=x?va(x):null,x!==null&&(y=Ga(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(m=null,x=c),m!==x)){if(v=qx,D="onMouseLeave",T="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(v=Yx,D="onPointerLeave",T="onPointerEnter",k="pointer"),y=m==null?p:ko(m),w=x==null?p:ko(x),p=new v(D,k+"leave",m,r,u),p.target=y,p.relatedTarget=w,D=null,va(u)===c&&(v=new v(T,k+"enter",x,r,u),v.target=w,v.relatedTarget=y,D=v),y=D,m&&x)t:{for(v=m,T=x,k=0,w=v;w;w=fo(w))k++;for(w=0,D=T;D;D=fo(D))w++;for(;0<k-w;)v=fo(v),k--;for(;0<w-k;)T=fo(T),w--;for(;k--;){if(v===T||T!==null&&v===T.alternate)break t;v=fo(v),T=fo(T)}v=null}else v=null;m!==null&&o1(h,p,m,v,!1),x!==null&&y!==null&&o1(h,y,x,v,!0)}}e:{if(p=c?ko(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var U=c4;else if(Zx(p))if(bE)U=d4;else{U=f4;var V=u4}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(U=h4);if(U&&(U=U(t,c))){FE(h,U,r,u);break e}V&&V(t,p,c),t==="focusout"&&(V=p._wrapperState)&&V.controlled&&p.type==="number"&&lp(p,"number",p.value)}switch(V=c?ko(c):window,t){case"focusin":(Zx(V)||V.contentEditable==="true")&&(Eo=V,yp=c,oc=null);break;case"focusout":oc=yp=Eo=null;break;case"mousedown":wp=!0;break;case"contextmenu":case"mouseup":case"dragend":wp=!1,s1(h,r,u);break;case"selectionchange":if(g4)break;case"keydown":case"keyup":s1(h,r,u)}var g;if(Zm)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else wo?PE(t,r)&&(E="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(NE&&r.locale!=="ko"&&(wo||E!=="onCompositionStart"?E==="onCompositionEnd"&&wo&&(g=RE()):(Ni=u,Ym="value"in Ni?Ni.value:Ni.textContent,wo=!0)),V=nh(c,E),0<V.length&&(E=new Xx(E,t,null,r,u),h.push({event:E,listeners:V}),g?E.data=g:(g=DE(r),g!==null&&(E.data=g)))),(g=s4?i4(t,r):a4(t,r))&&(c=nh(c,"onBeforeInput"),0<c.length&&(u=new Xx("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=g))}HE(h,e)})}function Mc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function nh(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Rc(t,r),i!=null&&n.unshift(Mc(t,i,s)),i=Rc(t,e),i!=null&&n.push(Mc(t,i,s))),t=t.return}return n}function fo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function o1(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=Rc(r,i),l!=null&&a.unshift(Mc(r,l,o))):s||(l=Rc(r,i),l!=null&&a.push(Mc(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var y4=/\r\n?/g,w4=/\u0000|\uFFFD/g;function l1(t){return(typeof t=="string"?t:""+t).replace(y4,`
`).replace(w4,"")}function sf(t,e,r){if(e=l1(e),l1(t)!==e&&r)throw Error(xe(425))}function sh(){}var Ep=null,Tp=null;function kp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sp=typeof setTimeout=="function"?setTimeout:void 0,E4=typeof clearTimeout=="function"?clearTimeout:void 0,c1=typeof Promise=="function"?Promise:void 0,T4=typeof queueMicrotask=="function"?queueMicrotask:typeof c1<"u"?function(t){return c1.resolve(null).then(t).catch(k4)}:Sp;function k4(t){setTimeout(function(){throw t})}function m0(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Dc(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Dc(e)}function Vi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function u1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var dl=Math.random().toString(36).slice(2),vs="__reactFiber$"+dl,Lc="__reactProps$"+dl,ti="__reactContainer$"+dl,Ap="__reactEvents$"+dl,S4="__reactListeners$"+dl,A4="__reactHandles$"+dl;function va(t){var e=t[vs];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ti]||r[vs]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=u1(t);t!==null;){if(r=t[vs])return r;t=u1(t)}return e}t=r,r=t.parentNode}return null}function du(t){return t=t[vs]||t[ti],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ko(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(xe(33))}function ad(t){return t[Lc]||null}var Ip=[],So=-1;function na(t){return{current:t}}function Ot(t){0>So||(t.current=Ip[So],Ip[So]=null,So--)}function Nt(t,e){So++,Ip[So]=t.current,t.current=e}var Xi={},$r=na(Xi),un=na(!1),Pa=Xi;function Ko(t,e){var r=t.type.contextTypes;if(!r)return Xi;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function fn(t){return t=t.childContextTypes,t!=null}function ih(){Ot(un),Ot($r)}function f1(t,e,r){if($r.current!==Xi)throw Error(xe(168));Nt($r,e),Nt(un,r)}function GE(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(xe(108,uC(t)||"Unknown",s));return Bt({},r,n)}function ah(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Xi,Pa=$r.current,Nt($r,t),Nt(un,un.current),!0}function h1(t,e,r){var n=t.stateNode;if(!n)throw Error(xe(169));r?(t=GE(t,e,Pa),n.__reactInternalMemoizedMergedChildContext=t,Ot(un),Ot($r),Nt($r,t)):Ot(un),Nt(un,r)}var Bs=null,od=!1,g0=!1;function KE(t){Bs===null?Bs=[t]:Bs.push(t)}function I4(t){od=!0,KE(t)}function sa(){if(!g0&&Bs!==null){g0=!0;var t=0,e=It;try{var r=Bs;for(It=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Bs=null,od=!1}catch(s){throw Bs!==null&&(Bs=Bs.slice(t+1)),xE(Gm,sa),s}finally{It=e,g0=!1}}return null}var Ao=[],Io=0,oh=null,lh=0,Dn=[],Fn=0,Da=null,zs=1,$s="";function fa(t,e){Ao[Io++]=lh,Ao[Io++]=oh,oh=t,lh=e}function qE(t,e,r){Dn[Fn++]=zs,Dn[Fn++]=$s,Dn[Fn++]=Da,Da=t;var n=zs;t=$s;var s=32-rs(n)-1;n&=~(1<<s),r+=1;var i=32-rs(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,zs=1<<32-rs(e)+s|r<<s|n,$s=i+t}else zs=1<<i|r<<s|n,$s=t}function tg(t){t.return!==null&&(fa(t,1),qE(t,1,0))}function rg(t){for(;t===oh;)oh=Ao[--Io],Ao[Io]=null,lh=Ao[--Io],Ao[Io]=null;for(;t===Da;)Da=Dn[--Fn],Dn[Fn]=null,$s=Dn[--Fn],Dn[Fn]=null,zs=Dn[--Fn],Dn[Fn]=null}var wn=null,_n=null,jt=!1,Yn=null;function XE(t,e){var r=bn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function d1(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,wn=t,_n=Vi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,wn=t,_n=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Da!==null?{id:zs,overflow:$s}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=bn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,wn=t,_n=null,!0):!1;default:return!1}}function Cp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Rp(t){if(jt){var e=_n;if(e){var r=e;if(!d1(t,e)){if(Cp(t))throw Error(xe(418));e=Vi(r.nextSibling);var n=wn;e&&d1(t,e)?XE(n,r):(t.flags=t.flags&-4097|2,jt=!1,wn=t)}}else{if(Cp(t))throw Error(xe(418));t.flags=t.flags&-4097|2,jt=!1,wn=t}}}function p1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;wn=t}function af(t){if(t!==wn)return!1;if(!jt)return p1(t),jt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!kp(t.type,t.memoizedProps)),e&&(e=_n)){if(Cp(t))throw YE(),Error(xe(418));for(;e;)XE(t,e),e=Vi(e.nextSibling)}if(p1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(xe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){_n=Vi(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}_n=null}}else _n=wn?Vi(t.stateNode.nextSibling):null;return!0}function YE(){for(var t=_n;t;)t=Vi(t.nextSibling)}function qo(){_n=wn=null,jt=!1}function ng(t){Yn===null?Yn=[t]:Yn.push(t)}var C4=fi.ReactCurrentBatchConfig;function Ll(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(xe(309));var n=r.stateNode}if(!n)throw Error(xe(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(xe(284));if(!r._owner)throw Error(xe(290,t))}return t}function of(t,e){throw t=Object.prototype.toString.call(e),Error(xe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function m1(t){var e=t._init;return e(t._payload)}function QE(t){function e(T,k){if(t){var w=T.deletions;w===null?(T.deletions=[k],T.flags|=16):w.push(k)}}function r(T,k){if(!t)return null;for(;k!==null;)e(T,k),k=k.sibling;return null}function n(T,k){for(T=new Map;k!==null;)k.key!==null?T.set(k.key,k):T.set(k.index,k),k=k.sibling;return T}function s(T,k){return T=$i(T,k),T.index=0,T.sibling=null,T}function i(T,k,w){return T.index=w,t?(w=T.alternate,w!==null?(w=w.index,w<k?(T.flags|=2,k):w):(T.flags|=2,k)):(T.flags|=1048576,k)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,k,w,D){return k===null||k.tag!==6?(k=T0(w,T.mode,D),k.return=T,k):(k=s(k,w),k.return=T,k)}function l(T,k,w,D){var U=w.type;return U===yo?u(T,k,w.props.children,D,w.key):k!==null&&(k.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ei&&m1(U)===k.type)?(D=s(k,w.props),D.ref=Ll(T,k,w),D.return=T,D):(D=Vf(w.type,w.key,w.props,null,T.mode,D),D.ref=Ll(T,k,w),D.return=T,D)}function c(T,k,w,D){return k===null||k.tag!==4||k.stateNode.containerInfo!==w.containerInfo||k.stateNode.implementation!==w.implementation?(k=k0(w,T.mode,D),k.return=T,k):(k=s(k,w.children||[]),k.return=T,k)}function u(T,k,w,D,U){return k===null||k.tag!==7?(k=Aa(w,T.mode,D,U),k.return=T,k):(k=s(k,w),k.return=T,k)}function h(T,k,w){if(typeof k=="string"&&k!==""||typeof k=="number")return k=T0(""+k,T.mode,w),k.return=T,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Xu:return w=Vf(k.type,k.key,k.props,null,T.mode,w),w.ref=Ll(T,null,k),w.return=T,w;case _o:return k=k0(k,T.mode,w),k.return=T,k;case Ei:var D=k._init;return h(T,D(k._payload),w)}if(Wl(k)||Dl(k))return k=Aa(k,T.mode,w,null),k.return=T,k;of(T,k)}return null}function p(T,k,w,D){var U=k!==null?k.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return U!==null?null:o(T,k,""+w,D);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Xu:return w.key===U?l(T,k,w,D):null;case _o:return w.key===U?c(T,k,w,D):null;case Ei:return U=w._init,p(T,k,U(w._payload),D)}if(Wl(w)||Dl(w))return U!==null?null:u(T,k,w,D,null);of(T,w)}return null}function m(T,k,w,D,U){if(typeof D=="string"&&D!==""||typeof D=="number")return T=T.get(w)||null,o(k,T,""+D,U);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case Xu:return T=T.get(D.key===null?w:D.key)||null,l(k,T,D,U);case _o:return T=T.get(D.key===null?w:D.key)||null,c(k,T,D,U);case Ei:var V=D._init;return m(T,k,w,V(D._payload),U)}if(Wl(D)||Dl(D))return T=T.get(w)||null,u(k,T,D,U,null);of(k,D)}return null}function x(T,k,w,D){for(var U=null,V=null,g=k,E=k=0,S=null;g!==null&&E<w.length;E++){g.index>E?(S=g,g=null):S=g.sibling;var C=p(T,g,w[E],D);if(C===null){g===null&&(g=S);break}t&&g&&C.alternate===null&&e(T,g),k=i(C,k,E),V===null?U=C:V.sibling=C,V=C,g=S}if(E===w.length)return r(T,g),jt&&fa(T,E),U;if(g===null){for(;E<w.length;E++)g=h(T,w[E],D),g!==null&&(k=i(g,k,E),V===null?U=g:V.sibling=g,V=g);return jt&&fa(T,E),U}for(g=n(T,g);E<w.length;E++)S=m(g,T,E,w[E],D),S!==null&&(t&&S.alternate!==null&&g.delete(S.key===null?E:S.key),k=i(S,k,E),V===null?U=S:V.sibling=S,V=S);return t&&g.forEach(function(P){return e(T,P)}),jt&&fa(T,E),U}function v(T,k,w,D){var U=Dl(w);if(typeof U!="function")throw Error(xe(150));if(w=U.call(w),w==null)throw Error(xe(151));for(var V=U=null,g=k,E=k=0,S=null,C=w.next();g!==null&&!C.done;E++,C=w.next()){g.index>E?(S=g,g=null):S=g.sibling;var P=p(T,g,C.value,D);if(P===null){g===null&&(g=S);break}t&&g&&P.alternate===null&&e(T,g),k=i(P,k,E),V===null?U=P:V.sibling=P,V=P,g=S}if(C.done)return r(T,g),jt&&fa(T,E),U;if(g===null){for(;!C.done;E++,C=w.next())C=h(T,C.value,D),C!==null&&(k=i(C,k,E),V===null?U=C:V.sibling=C,V=C);return jt&&fa(T,E),U}for(g=n(T,g);!C.done;E++,C=w.next())C=m(g,T,E,C.value,D),C!==null&&(t&&C.alternate!==null&&g.delete(C.key===null?E:C.key),k=i(C,k,E),V===null?U=C:V.sibling=C,V=C);return t&&g.forEach(function(R){return e(T,R)}),jt&&fa(T,E),U}function y(T,k,w,D){if(typeof w=="object"&&w!==null&&w.type===yo&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Xu:e:{for(var U=w.key,V=k;V!==null;){if(V.key===U){if(U=w.type,U===yo){if(V.tag===7){r(T,V.sibling),k=s(V,w.props.children),k.return=T,T=k;break e}}else if(V.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ei&&m1(U)===V.type){r(T,V.sibling),k=s(V,w.props),k.ref=Ll(T,V,w),k.return=T,T=k;break e}r(T,V);break}else e(T,V);V=V.sibling}w.type===yo?(k=Aa(w.props.children,T.mode,D,w.key),k.return=T,T=k):(D=Vf(w.type,w.key,w.props,null,T.mode,D),D.ref=Ll(T,k,w),D.return=T,T=D)}return a(T);case _o:e:{for(V=w.key;k!==null;){if(k.key===V)if(k.tag===4&&k.stateNode.containerInfo===w.containerInfo&&k.stateNode.implementation===w.implementation){r(T,k.sibling),k=s(k,w.children||[]),k.return=T,T=k;break e}else{r(T,k);break}else e(T,k);k=k.sibling}k=k0(w,T.mode,D),k.return=T,T=k}return a(T);case Ei:return V=w._init,y(T,k,V(w._payload),D)}if(Wl(w))return x(T,k,w,D);if(Dl(w))return v(T,k,w,D);of(T,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,k!==null&&k.tag===6?(r(T,k.sibling),k=s(k,w),k.return=T,T=k):(r(T,k),k=T0(w,T.mode,D),k.return=T,T=k),a(T)):r(T,k)}return y}var Xo=QE(!0),JE=QE(!1),ch=na(null),uh=null,Co=null,sg=null;function ig(){sg=Co=uh=null}function ag(t){var e=ch.current;Ot(ch),t._currentValue=e}function Np(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Mo(t,e){uh=t,sg=Co=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(cn=!0),t.firstContext=null)}function jn(t){var e=t._currentValue;if(sg!==t)if(t={context:t,memoizedValue:e,next:null},Co===null){if(uh===null)throw Error(xe(308));Co=t,uh.dependencies={lanes:0,firstContext:t}}else Co=Co.next=t;return e}var xa=null;function og(t){xa===null?xa=[t]:xa.push(t)}function ZE(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,og(e)):(r.next=s.next,s.next=r),e.interleaved=r,ri(t,n)}function ri(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ti=!1;function lg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function e2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ui(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,xt&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,ri(t,r)}return s=n.interleaved,s===null?(e.next=e,og(n)):(e.next=s.next,s.next=e),n.interleaved=e,ri(t,r)}function Ff(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Km(t,r)}}function g1(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function fh(t,e,r,n){var s=t.updateQueue;Ti=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?i=c:a.next=c,a=l;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;a=0,u=c=l=null,o=i;do{var p=o.lane,m=o.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=t,v=o;switch(p=e,m=r,v.tag){case 1:if(x=v.payload,typeof x=="function"){h=x.call(m,h,p);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,p=typeof x=="function"?x.call(m,h,p):x,p==null)break e;h=Bt({},h,p);break e;case 2:Ti=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[o]:p.push(o))}else m={eventTime:m,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=m,l=h):u=u.next=m,a|=p;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;p=o,o=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ba|=a,t.lanes=a,t.memoizedState=h}}function v1(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(xe(191,s));s.call(n)}}}var pu={},ys=na(pu),jc=na(pu),Vc=na(pu);function _a(t){if(t===pu)throw Error(xe(174));return t}function cg(t,e){switch(Nt(Vc,e),Nt(jc,t),Nt(ys,pu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:up(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=up(e,t)}Ot(ys),Nt(ys,e)}function Yo(){Ot(ys),Ot(jc),Ot(Vc)}function t2(t){_a(Vc.current);var e=_a(ys.current),r=up(e,t.type);e!==r&&(Nt(jc,t),Nt(ys,r))}function ug(t){jc.current===t&&(Ot(ys),Ot(jc))}var Vt=na(0);function hh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var v0=[];function fg(){for(var t=0;t<v0.length;t++)v0[t]._workInProgressVersionPrimary=null;v0.length=0}var bf=fi.ReactCurrentDispatcher,x0=fi.ReactCurrentBatchConfig,Fa=0,Ut=null,or=null,pr=null,dh=!1,lc=!1,Uc=0,R4=0;function Dr(){throw Error(xe(321))}function hg(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!as(t[r],e[r]))return!1;return!0}function dg(t,e,r,n,s,i){if(Fa=i,Ut=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,bf.current=t===null||t.memoizedState===null?F4:b4,t=r(n,s),lc){i=0;do{if(lc=!1,Uc=0,25<=i)throw Error(xe(301));i+=1,pr=or=null,e.updateQueue=null,bf.current=O4,t=r(n,s)}while(lc)}if(bf.current=ph,e=or!==null&&or.next!==null,Fa=0,pr=or=Ut=null,dh=!1,e)throw Error(xe(300));return t}function pg(){var t=Uc!==0;return Uc=0,t}function gs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pr===null?Ut.memoizedState=pr=t:pr=pr.next=t,pr}function Vn(){if(or===null){var t=Ut.alternate;t=t!==null?t.memoizedState:null}else t=or.next;var e=pr===null?Ut.memoizedState:pr.next;if(e!==null)pr=e,or=t;else{if(t===null)throw Error(xe(310));or=t,t={memoizedState:or.memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},pr===null?Ut.memoizedState=pr=t:pr=pr.next=t}return pr}function Bc(t,e){return typeof e=="function"?e(t):e}function _0(t){var e=Vn(),r=e.queue;if(r===null)throw Error(xe(311));r.lastRenderedReducer=t;var n=or,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=a=null,l=null,c=i;do{var u=c.lane;if((Fa&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Ut.lanes|=u,ba|=u}c=c.next}while(c!==null&&c!==i);l===null?a=n:l.next=o,as(n,e.memoizedState)||(cn=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Ut.lanes|=i,ba|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function y0(t){var e=Vn(),r=e.queue;if(r===null)throw Error(xe(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);as(i,e.memoizedState)||(cn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function r2(){}function n2(t,e){var r=Ut,n=Vn(),s=e(),i=!as(n.memoizedState,s);if(i&&(n.memoizedState=s,cn=!0),n=n.queue,mg(a2.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||pr!==null&&pr.memoizedState.tag&1){if(r.flags|=2048,zc(9,i2.bind(null,r,n,s,e),void 0,null),mr===null)throw Error(xe(349));Fa&30||s2(r,e,s)}return s}function s2(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ut.updateQueue,e===null?(e={lastEffect:null,stores:null},Ut.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function i2(t,e,r,n){e.value=r,e.getSnapshot=n,o2(e)&&l2(t)}function a2(t,e,r){return r(function(){o2(e)&&l2(t)})}function o2(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!as(t,r)}catch{return!0}}function l2(t){var e=ri(t,1);e!==null&&ns(e,t,1,-1)}function x1(t){var e=gs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bc,lastRenderedState:t},e.queue=t,t=t.dispatch=D4.bind(null,Ut,t),[e.memoizedState,t]}function zc(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ut.updateQueue,e===null?(e={lastEffect:null,stores:null},Ut.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function c2(){return Vn().memoizedState}function Of(t,e,r,n){var s=gs();Ut.flags|=t,s.memoizedState=zc(1|e,r,void 0,n===void 0?null:n)}function ld(t,e,r,n){var s=Vn();n=n===void 0?null:n;var i=void 0;if(or!==null){var a=or.memoizedState;if(i=a.destroy,n!==null&&hg(n,a.deps)){s.memoizedState=zc(e,r,i,n);return}}Ut.flags|=t,s.memoizedState=zc(1|e,r,i,n)}function _1(t,e){return Of(8390656,8,t,e)}function mg(t,e){return ld(2048,8,t,e)}function u2(t,e){return ld(4,2,t,e)}function f2(t,e){return ld(4,4,t,e)}function h2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function d2(t,e,r){return r=r!=null?r.concat([t]):null,ld(4,4,h2.bind(null,e,t),r)}function gg(){}function p2(t,e){var r=Vn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&hg(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function m2(t,e){var r=Vn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&hg(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function g2(t,e,r){return Fa&21?(as(r,e)||(r=wE(),Ut.lanes|=r,ba|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,cn=!0),t.memoizedState=r)}function N4(t,e){var r=It;It=r!==0&&4>r?r:4,t(!0);var n=x0.transition;x0.transition={};try{t(!1),e()}finally{It=r,x0.transition=n}}function v2(){return Vn().memoizedState}function P4(t,e,r){var n=zi(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},x2(t))_2(e,r);else if(r=ZE(t,e,r,n),r!==null){var s=Qr();ns(r,t,n,s),y2(r,e,n)}}function D4(t,e,r){var n=zi(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(x2(t))_2(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,r);if(s.hasEagerState=!0,s.eagerState=o,as(o,a)){var l=e.interleaved;l===null?(s.next=s,og(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=ZE(t,e,s,n),r!==null&&(s=Qr(),ns(r,t,n,s),y2(r,e,n))}}function x2(t){var e=t.alternate;return t===Ut||e!==null&&e===Ut}function _2(t,e){lc=dh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function y2(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Km(t,r)}}var ph={readContext:jn,useCallback:Dr,useContext:Dr,useEffect:Dr,useImperativeHandle:Dr,useInsertionEffect:Dr,useLayoutEffect:Dr,useMemo:Dr,useReducer:Dr,useRef:Dr,useState:Dr,useDebugValue:Dr,useDeferredValue:Dr,useTransition:Dr,useMutableSource:Dr,useSyncExternalStore:Dr,useId:Dr,unstable_isNewReconciler:!1},F4={readContext:jn,useCallback:function(t,e){return gs().memoizedState=[t,e===void 0?null:e],t},useContext:jn,useEffect:_1,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Of(4194308,4,h2.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Of(4194308,4,t,e)},useInsertionEffect:function(t,e){return Of(4,2,t,e)},useMemo:function(t,e){var r=gs();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=gs();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=P4.bind(null,Ut,t),[n.memoizedState,t]},useRef:function(t){var e=gs();return t={current:t},e.memoizedState=t},useState:x1,useDebugValue:gg,useDeferredValue:function(t){return gs().memoizedState=t},useTransition:function(){var t=x1(!1),e=t[0];return t=N4.bind(null,t[1]),gs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ut,s=gs();if(jt){if(r===void 0)throw Error(xe(407));r=r()}else{if(r=e(),mr===null)throw Error(xe(349));Fa&30||s2(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,_1(a2.bind(null,n,i,t),[t]),n.flags|=2048,zc(9,i2.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=gs(),e=mr.identifierPrefix;if(jt){var r=$s,n=zs;r=(n&~(1<<32-rs(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Uc++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=R4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},b4={readContext:jn,useCallback:p2,useContext:jn,useEffect:mg,useImperativeHandle:d2,useInsertionEffect:u2,useLayoutEffect:f2,useMemo:m2,useReducer:_0,useRef:c2,useState:function(){return _0(Bc)},useDebugValue:gg,useDeferredValue:function(t){var e=Vn();return g2(e,or.memoizedState,t)},useTransition:function(){var t=_0(Bc)[0],e=Vn().memoizedState;return[t,e]},useMutableSource:r2,useSyncExternalStore:n2,useId:v2,unstable_isNewReconciler:!1},O4={readContext:jn,useCallback:p2,useContext:jn,useEffect:mg,useImperativeHandle:d2,useInsertionEffect:u2,useLayoutEffect:f2,useMemo:m2,useReducer:y0,useRef:c2,useState:function(){return y0(Bc)},useDebugValue:gg,useDeferredValue:function(t){var e=Vn();return or===null?e.memoizedState=t:g2(e,or.memoizedState,t)},useTransition:function(){var t=y0(Bc)[0],e=Vn().memoizedState;return[t,e]},useMutableSource:r2,useSyncExternalStore:n2,useId:v2,unstable_isNewReconciler:!1};function Kn(t,e){if(t&&t.defaultProps){e=Bt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Pp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Bt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var cd={isMounted:function(t){return(t=t._reactInternals)?Ga(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Qr(),s=zi(t),i=Xs(n,s);i.payload=e,r!=null&&(i.callback=r),e=Ui(t,i,s),e!==null&&(ns(e,t,s,n),Ff(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Qr(),s=zi(t),i=Xs(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=Ui(t,i,s),e!==null&&(ns(e,t,s,n),Ff(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Qr(),n=zi(t),s=Xs(r,n);s.tag=2,e!=null&&(s.callback=e),e=Ui(t,s,n),e!==null&&(ns(e,t,n,r),Ff(e,t,n))}};function y1(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!bc(r,n)||!bc(s,i):!0}function w2(t,e,r){var n=!1,s=Xi,i=e.contextType;return typeof i=="object"&&i!==null?i=jn(i):(s=fn(e)?Pa:$r.current,n=e.contextTypes,i=(n=n!=null)?Ko(t,s):Xi),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=cd,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function w1(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&cd.enqueueReplaceState(e,e.state,null)}function Dp(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},lg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=jn(i):(i=fn(e)?Pa:$r.current,s.context=Ko(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Pp(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&cd.enqueueReplaceState(s,s.state,null),fh(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Qo(t,e){try{var r="",n=e;do r+=cC(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function w0(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Fp(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var M4=typeof WeakMap=="function"?WeakMap:Map;function E2(t,e,r){r=Xs(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){gh||(gh=!0,$p=n),Fp(t,e)},r}function T2(t,e,r){r=Xs(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Fp(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Fp(t,e),typeof n!="function"&&(Bi===null?Bi=new Set([this]):Bi.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function E1(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new M4;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=Y4.bind(null,t,e,r),e.then(t,t))}function T1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function k1(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Xs(-1,1),e.tag=2,Ui(r,e,1))),r.lanes|=1),t)}var L4=fi.ReactCurrentOwner,cn=!1;function Kr(t,e,r,n){e.child=t===null?JE(e,null,r,n):Xo(e,t.child,r,n)}function S1(t,e,r,n,s){r=r.render;var i=e.ref;return Mo(e,s),n=dg(t,e,r,n,i,s),r=pg(),t!==null&&!cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ni(t,e,s)):(jt&&r&&tg(e),e.flags|=1,Kr(t,e,n,s),e.child)}function A1(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!kg(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,k2(t,e,i,n,s)):(t=Vf(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:bc,r(a,n)&&t.ref===e.ref)return ni(t,e,s)}return e.flags|=1,t=$i(i,n),t.ref=e.ref,t.return=e,e.child=t}function k2(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(bc(i,n)&&t.ref===e.ref)if(cn=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(cn=!0);else return e.lanes=t.lanes,ni(t,e,s)}return bp(t,e,r,n,s)}function S2(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nt(No,mn),mn|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Nt(No,mn),mn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Nt(No,mn),mn|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,Nt(No,mn),mn|=n;return Kr(t,e,s,r),e.child}function A2(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function bp(t,e,r,n,s){var i=fn(r)?Pa:$r.current;return i=Ko(e,i),Mo(e,s),r=dg(t,e,r,n,i,s),n=pg(),t!==null&&!cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ni(t,e,s)):(jt&&n&&tg(e),e.flags|=1,Kr(t,e,r,s),e.child)}function I1(t,e,r,n,s){if(fn(r)){var i=!0;ah(e)}else i=!1;if(Mo(e,s),e.stateNode===null)Mf(t,e),w2(e,r,n),Dp(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=jn(c):(c=fn(r)?Pa:$r.current,c=Ko(e,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&w1(e,a,n,c),Ti=!1;var p=e.memoizedState;a.state=p,fh(e,n,a,s),l=e.memoizedState,o!==n||p!==l||un.current||Ti?(typeof u=="function"&&(Pp(e,r,u,n),l=e.memoizedState),(o=Ti||y1(e,r,o,n,p,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,e2(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Kn(e.type,o),a.props=c,h=e.pendingProps,p=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=jn(l):(l=fn(r)?Pa:$r.current,l=Ko(e,l));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||p!==l)&&w1(e,a,n,l),Ti=!1,p=e.memoizedState,a.state=p,fh(e,n,a,s);var x=e.memoizedState;o!==h||p!==x||un.current||Ti?(typeof m=="function"&&(Pp(e,r,m,n),x=e.memoizedState),(c=Ti||y1(e,r,c,n,p,x,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,x,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,x,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=x),a.props=n,a.state=x,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),n=!1)}return Op(t,e,r,n,i,s)}function Op(t,e,r,n,s,i){A2(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&h1(e,r,!1),ni(t,e,i);n=e.stateNode,L4.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Xo(e,t.child,null,i),e.child=Xo(e,null,o,i)):Kr(t,e,o,i),e.memoizedState=n.state,s&&h1(e,r,!0),e.child}function I2(t){var e=t.stateNode;e.pendingContext?f1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&f1(t,e.context,!1),cg(t,e.containerInfo)}function C1(t,e,r,n,s){return qo(),ng(s),e.flags|=256,Kr(t,e,r,n),e.child}var Mp={dehydrated:null,treeContext:null,retryLane:0};function Lp(t){return{baseLanes:t,cachePool:null,transitions:null}}function C2(t,e,r){var n=e.pendingProps,s=Vt.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Nt(Vt,s&1),t===null)return Rp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=hd(a,n,0,null),t=Aa(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Lp(r),e.memoizedState=Mp,t):vg(e,a));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return j4(t,e,a,n,o,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=$i(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=$i(o,i):(i=Aa(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?Lp(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=Mp,n}return i=t.child,t=i.sibling,n=$i(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function vg(t,e){return e=hd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function lf(t,e,r,n){return n!==null&&ng(n),Xo(e,t.child,null,r),t=vg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function j4(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=w0(Error(xe(422))),lf(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=hd({mode:"visible",children:n.children},s,0,null),i=Aa(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Xo(e,t.child,null,a),e.child.memoizedState=Lp(a),e.memoizedState=Mp,i);if(!(e.mode&1))return lf(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(xe(419)),n=w0(i,n,void 0),lf(t,e,a,n)}if(o=(a&t.childLanes)!==0,cn||o){if(n=mr,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ri(t,s),ns(n,t,s,-1))}return Tg(),n=w0(Error(xe(421))),lf(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Q4.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,_n=Vi(s.nextSibling),wn=e,jt=!0,Yn=null,t!==null&&(Dn[Fn++]=zs,Dn[Fn++]=$s,Dn[Fn++]=Da,zs=t.id,$s=t.overflow,Da=e),e=vg(e,n.children),e.flags|=4096,e)}function R1(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Np(t.return,e,r)}function E0(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function R2(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(Kr(t,e,n.children,r),n=Vt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&R1(t,r,e);else if(t.tag===19)R1(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Nt(Vt,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&hh(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),E0(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&hh(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}E0(e,!0,r,null,i);break;case"together":E0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Mf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ni(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ba|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(xe(153));if(e.child!==null){for(t=e.child,r=$i(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=$i(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function V4(t,e,r){switch(e.tag){case 3:I2(e),qo();break;case 5:t2(e);break;case 1:fn(e.type)&&ah(e);break;case 4:cg(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Nt(ch,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Nt(Vt,Vt.current&1),e.flags|=128,null):r&e.child.childLanes?C2(t,e,r):(Nt(Vt,Vt.current&1),t=ni(t,e,r),t!==null?t.sibling:null);Nt(Vt,Vt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return R2(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Nt(Vt,Vt.current),n)break;return null;case 22:case 23:return e.lanes=0,S2(t,e,r)}return ni(t,e,r)}var N2,jp,P2,D2;N2=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};jp=function(){};P2=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,_a(ys.current);var i=null;switch(r){case"input":s=ap(t,s),n=ap(t,n),i=[];break;case"select":s=Bt({},s,{value:void 0}),n=Bt({},n,{value:void 0}),i=[];break;case"textarea":s=cp(t,s),n=cp(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=sh)}fp(r,n);var a;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ic.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ic.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ft("scroll",t),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};D2=function(t,e,r,n){r!==n&&(e.flags|=4)};function jl(t,e){if(!jt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Fr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function U4(t,e,r){var n=e.pendingProps;switch(rg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fr(e),null;case 1:return fn(e.type)&&ih(),Fr(e),null;case 3:return n=e.stateNode,Yo(),Ot(un),Ot($r),fg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(af(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Yn!==null&&(Gp(Yn),Yn=null))),jp(t,e),Fr(e),null;case 5:ug(e);var s=_a(Vc.current);if(r=e.type,t!==null&&e.stateNode!=null)P2(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(xe(166));return Fr(e),null}if(t=_a(ys.current),af(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[vs]=e,n[Lc]=i,t=(e.mode&1)!==0,r){case"dialog":Ft("cancel",n),Ft("close",n);break;case"iframe":case"object":case"embed":Ft("load",n);break;case"video":case"audio":for(s=0;s<Kl.length;s++)Ft(Kl[s],n);break;case"source":Ft("error",n);break;case"img":case"image":case"link":Ft("error",n),Ft("load",n);break;case"details":Ft("toggle",n);break;case"input":jx(n,i),Ft("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ft("invalid",n);break;case"textarea":Ux(n,i),Ft("invalid",n)}fp(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&sf(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&sf(n.textContent,o,t),s=["children",""+o]):Ic.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ft("scroll",n)}switch(r){case"input":Yu(n),Vx(n,i,!0);break;case"textarea":Yu(n),Bx(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=sh)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=aE(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[vs]=e,t[Lc]=n,N2(t,e,!1,!1),e.stateNode=t;e:{switch(a=hp(r,n),r){case"dialog":Ft("cancel",t),Ft("close",t),s=n;break;case"iframe":case"object":case"embed":Ft("load",t),s=n;break;case"video":case"audio":for(s=0;s<Kl.length;s++)Ft(Kl[s],t);s=n;break;case"source":Ft("error",t),s=n;break;case"img":case"image":case"link":Ft("error",t),Ft("load",t),s=n;break;case"details":Ft("toggle",t),s=n;break;case"input":jx(t,n),s=ap(t,n),Ft("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Bt({},n,{value:void 0}),Ft("invalid",t);break;case"textarea":Ux(t,n),s=cp(t,n),Ft("invalid",t);break;default:s=n}fp(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?cE(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&oE(t,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Cc(t,l):typeof l=="number"&&Cc(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ic.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ft("scroll",t):l!=null&&Bm(t,i,l,a))}switch(r){case"input":Yu(t),Vx(t,n,!1);break;case"textarea":Yu(t),Bx(t);break;case"option":n.value!=null&&t.setAttribute("value",""+qi(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?Do(t,!!n.multiple,i,!1):n.defaultValue!=null&&Do(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=sh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Fr(e),null;case 6:if(t&&e.stateNode!=null)D2(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(xe(166));if(r=_a(Vc.current),_a(ys.current),af(e)){if(n=e.stateNode,r=e.memoizedProps,n[vs]=e,(i=n.nodeValue!==r)&&(t=wn,t!==null))switch(t.tag){case 3:sf(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&sf(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[vs]=e,e.stateNode=n}return Fr(e),null;case 13:if(Ot(Vt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(jt&&_n!==null&&e.mode&1&&!(e.flags&128))YE(),qo(),e.flags|=98560,i=!1;else if(i=af(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(xe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(xe(317));i[vs]=e}else qo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Fr(e),i=!1}else Yn!==null&&(Gp(Yn),Yn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Vt.current&1?lr===0&&(lr=3):Tg())),e.updateQueue!==null&&(e.flags|=4),Fr(e),null);case 4:return Yo(),jp(t,e),t===null&&Oc(e.stateNode.containerInfo),Fr(e),null;case 10:return ag(e.type._context),Fr(e),null;case 17:return fn(e.type)&&ih(),Fr(e),null;case 19:if(Ot(Vt),i=e.memoizedState,i===null)return Fr(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)jl(i,!1);else{if(lr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=hh(t),a!==null){for(e.flags|=128,jl(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Nt(Vt,Vt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Xt()>Jo&&(e.flags|=128,n=!0,jl(i,!1),e.lanes=4194304)}else{if(!n)if(t=hh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),jl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!jt)return Fr(e),null}else 2*Xt()-i.renderingStartTime>Jo&&r!==1073741824&&(e.flags|=128,n=!0,jl(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Xt(),e.sibling=null,r=Vt.current,Nt(Vt,n?r&1|2:r&1),e):(Fr(e),null);case 22:case 23:return Eg(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?mn&1073741824&&(Fr(e),e.subtreeFlags&6&&(e.flags|=8192)):Fr(e),null;case 24:return null;case 25:return null}throw Error(xe(156,e.tag))}function B4(t,e){switch(rg(e),e.tag){case 1:return fn(e.type)&&ih(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Yo(),Ot(un),Ot($r),fg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ug(e),null;case 13:if(Ot(Vt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(xe(340));qo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ot(Vt),null;case 4:return Yo(),null;case 10:return ag(e.type._context),null;case 22:case 23:return Eg(),null;case 24:return null;default:return null}}var cf=!1,jr=!1,z4=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function Ro(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ht(t,e,n)}else r.current=null}function Vp(t,e,r){try{r()}catch(n){Ht(t,e,n)}}var N1=!1;function $4(t,e){if(Ep=th,t=LE(),eg(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,h=t,p=null;t:for(;;){for(var m;h!==r||s!==0&&h.nodeType!==3||(o=a+s),h!==i||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===t)break t;if(p===r&&++c===s&&(o=a),p===i&&++u===n&&(l=a),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Tp={focusedElem:t,selectionRange:r},th=!1,Ne=e;Ne!==null;)if(e=Ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ne=t;else for(;Ne!==null;){e=Ne;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,y=x.memoizedState,T=e.stateNode,k=T.getSnapshotBeforeUpdate(e.elementType===e.type?v:Kn(e.type,v),y);T.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xe(163))}}catch(D){Ht(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Ne=t;break}Ne=e.return}return x=N1,N1=!1,x}function cc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Vp(e,r,i)}s=s.next}while(s!==n)}}function ud(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Up(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function F2(t){var e=t.alternate;e!==null&&(t.alternate=null,F2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[vs],delete e[Lc],delete e[Ap],delete e[S4],delete e[A4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function b2(t){return t.tag===5||t.tag===3||t.tag===4}function P1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||b2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Bp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=sh));else if(n!==4&&(t=t.child,t!==null))for(Bp(t,e,r),t=t.sibling;t!==null;)Bp(t,e,r),t=t.sibling}function zp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(zp(t,e,r),t=t.sibling;t!==null;)zp(t,e,r),t=t.sibling}var _r=null,qn=!1;function xi(t,e,r){for(r=r.child;r!==null;)O2(t,e,r),r=r.sibling}function O2(t,e,r){if(_s&&typeof _s.onCommitFiberUnmount=="function")try{_s.onCommitFiberUnmount(rd,r)}catch{}switch(r.tag){case 5:jr||Ro(r,e);case 6:var n=_r,s=qn;_r=null,xi(t,e,r),_r=n,qn=s,_r!==null&&(qn?(t=_r,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):_r.removeChild(r.stateNode));break;case 18:_r!==null&&(qn?(t=_r,r=r.stateNode,t.nodeType===8?m0(t.parentNode,r):t.nodeType===1&&m0(t,r),Dc(t)):m0(_r,r.stateNode));break;case 4:n=_r,s=qn,_r=r.stateNode.containerInfo,qn=!0,xi(t,e,r),_r=n,qn=s;break;case 0:case 11:case 14:case 15:if(!jr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Vp(r,e,a),s=s.next}while(s!==n)}xi(t,e,r);break;case 1:if(!jr&&(Ro(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ht(r,e,o)}xi(t,e,r);break;case 21:xi(t,e,r);break;case 22:r.mode&1?(jr=(n=jr)||r.memoizedState!==null,xi(t,e,r),jr=n):xi(t,e,r);break;default:xi(t,e,r)}}function D1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new z4),e.forEach(function(n){var s=J4.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Hn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:_r=o.stateNode,qn=!1;break e;case 3:_r=o.stateNode.containerInfo,qn=!0;break e;case 4:_r=o.stateNode.containerInfo,qn=!0;break e}o=o.return}if(_r===null)throw Error(xe(160));O2(i,a,s),_r=null,qn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Ht(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)M2(e,t),e=e.sibling}function M2(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Hn(e,t),ds(t),n&4){try{cc(3,t,t.return),ud(3,t)}catch(v){Ht(t,t.return,v)}try{cc(5,t,t.return)}catch(v){Ht(t,t.return,v)}}break;case 1:Hn(e,t),ds(t),n&512&&r!==null&&Ro(r,r.return);break;case 5:if(Hn(e,t),ds(t),n&512&&r!==null&&Ro(r,r.return),t.flags&32){var s=t.stateNode;try{Cc(s,"")}catch(v){Ht(t,t.return,v)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&sE(s,i),hp(o,a);var c=hp(o,i);for(a=0;a<l.length;a+=2){var u=l[a],h=l[a+1];u==="style"?cE(s,h):u==="dangerouslySetInnerHTML"?oE(s,h):u==="children"?Cc(s,h):Bm(s,u,h,c)}switch(o){case"input":op(s,i);break;case"textarea":iE(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Do(s,!!i.multiple,m,!1):p!==!!i.multiple&&(i.defaultValue!=null?Do(s,!!i.multiple,i.defaultValue,!0):Do(s,!!i.multiple,i.multiple?[]:"",!1))}s[Lc]=i}catch(v){Ht(t,t.return,v)}}break;case 6:if(Hn(e,t),ds(t),n&4){if(t.stateNode===null)throw Error(xe(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(v){Ht(t,t.return,v)}}break;case 3:if(Hn(e,t),ds(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Dc(e.containerInfo)}catch(v){Ht(t,t.return,v)}break;case 4:Hn(e,t),ds(t);break;case 13:Hn(e,t),ds(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(yg=Xt())),n&4&&D1(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(jr=(c=jr)||u,Hn(e,t),jr=c):Hn(e,t),ds(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Ne=t,u=t.child;u!==null;){for(h=Ne=u;Ne!==null;){switch(p=Ne,m=p.child,p.tag){case 0:case 11:case 14:case 15:cc(4,p,p.return);break;case 1:Ro(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){n=p,r=p.return;try{e=n,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(v){Ht(n,r,v)}}break;case 5:Ro(p,p.return);break;case 22:if(p.memoizedState!==null){b1(h);continue}}m!==null?(m.return=p,Ne=m):b1(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=lE("display",a))}catch(v){Ht(t,t.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){Ht(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Hn(e,t),ds(t),n&4&&D1(t);break;case 21:break;default:Hn(e,t),ds(t)}}function ds(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(b2(r)){var n=r;break e}r=r.return}throw Error(xe(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Cc(s,""),n.flags&=-33);var i=P1(t);zp(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,o=P1(t);Bp(t,o,a);break;default:throw Error(xe(161))}}catch(l){Ht(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function H4(t,e,r){Ne=t,L2(t)}function L2(t,e,r){for(var n=(t.mode&1)!==0;Ne!==null;){var s=Ne,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||cf;if(!a){var o=s.alternate,l=o!==null&&o.memoizedState!==null||jr;o=cf;var c=jr;if(cf=a,(jr=l)&&!c)for(Ne=s;Ne!==null;)a=Ne,l=a.child,a.tag===22&&a.memoizedState!==null?O1(s):l!==null?(l.return=a,Ne=l):O1(s);for(;i!==null;)Ne=i,L2(i),i=i.sibling;Ne=s,cf=o,jr=c}F1(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ne=i):F1(t)}}function F1(t){for(;Ne!==null;){var e=Ne;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jr||ud(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!jr)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Kn(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&v1(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}v1(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Dc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xe(163))}jr||e.flags&512&&Up(e)}catch(p){Ht(e,e.return,p)}}if(e===t){Ne=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function b1(t){for(;Ne!==null;){var e=Ne;if(e===t){Ne=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function O1(t){for(;Ne!==null;){var e=Ne;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{ud(4,e)}catch(l){Ht(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){Ht(e,s,l)}}var i=e.return;try{Up(e)}catch(l){Ht(e,i,l)}break;case 5:var a=e.return;try{Up(e)}catch(l){Ht(e,a,l)}}}catch(l){Ht(e,e.return,l)}if(e===t){Ne=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ne=o;break}Ne=e.return}}var W4=Math.ceil,mh=fi.ReactCurrentDispatcher,xg=fi.ReactCurrentOwner,On=fi.ReactCurrentBatchConfig,xt=0,mr=null,rr=null,kr=0,mn=0,No=na(0),lr=0,$c=null,ba=0,fd=0,_g=0,uc=null,on=null,yg=0,Jo=1/0,Us=null,gh=!1,$p=null,Bi=null,uf=!1,Pi=null,vh=0,fc=0,Hp=null,Lf=-1,jf=0;function Qr(){return xt&6?Xt():Lf!==-1?Lf:Lf=Xt()}function zi(t){return t.mode&1?xt&2&&kr!==0?kr&-kr:C4.transition!==null?(jf===0&&(jf=wE()),jf):(t=It,t!==0||(t=window.event,t=t===void 0?16:CE(t.type)),t):1}function ns(t,e,r,n){if(50<fc)throw fc=0,Hp=null,Error(xe(185));fu(t,r,n),(!(xt&2)||t!==mr)&&(t===mr&&(!(xt&2)&&(fd|=r),lr===4&&Si(t,kr)),hn(t,n),r===1&&xt===0&&!(e.mode&1)&&(Jo=Xt()+500,od&&sa()))}function hn(t,e){var r=t.callbackNode;CC(t,e);var n=eh(t,t===mr?kr:0);if(n===0)r!==null&&Hx(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Hx(r),e===1)t.tag===0?I4(M1.bind(null,t)):KE(M1.bind(null,t)),T4(function(){!(xt&6)&&sa()}),r=null;else{switch(EE(n)){case 1:r=Gm;break;case 4:r=_E;break;case 16:r=Zf;break;case 536870912:r=yE;break;default:r=Zf}r=W2(r,j2.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function j2(t,e){if(Lf=-1,jf=0,xt&6)throw Error(xe(327));var r=t.callbackNode;if(Lo()&&t.callbackNode!==r)return null;var n=eh(t,t===mr?kr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=xh(t,n);else{e=n;var s=xt;xt|=2;var i=U2();(mr!==t||kr!==e)&&(Us=null,Jo=Xt()+500,Sa(t,e));do try{q4();break}catch(o){V2(t,o)}while(!0);ig(),mh.current=i,xt=s,rr!==null?e=0:(mr=null,kr=0,e=lr)}if(e!==0){if(e===2&&(s=vp(t),s!==0&&(n=s,e=Wp(t,s))),e===1)throw r=$c,Sa(t,0),Si(t,n),hn(t,Xt()),r;if(e===6)Si(t,n);else{if(s=t.current.alternate,!(n&30)&&!G4(s)&&(e=xh(t,n),e===2&&(i=vp(t),i!==0&&(n=i,e=Wp(t,i))),e===1))throw r=$c,Sa(t,0),Si(t,n),hn(t,Xt()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(xe(345));case 2:ha(t,on,Us);break;case 3:if(Si(t,n),(n&130023424)===n&&(e=yg+500-Xt(),10<e)){if(eh(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Qr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Sp(ha.bind(null,t,on,Us),e);break}ha(t,on,Us);break;case 4:if(Si(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-rs(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=Xt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*W4(n/1960))-n,10<n){t.timeoutHandle=Sp(ha.bind(null,t,on,Us),n);break}ha(t,on,Us);break;case 5:ha(t,on,Us);break;default:throw Error(xe(329))}}}return hn(t,Xt()),t.callbackNode===r?j2.bind(null,t):null}function Wp(t,e){var r=uc;return t.current.memoizedState.isDehydrated&&(Sa(t,e).flags|=256),t=xh(t,e),t!==2&&(e=on,on=r,e!==null&&Gp(e)),t}function Gp(t){on===null?on=t:on.push.apply(on,t)}function G4(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!as(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Si(t,e){for(e&=~_g,e&=~fd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-rs(e),n=1<<r;t[r]=-1,e&=~n}}function M1(t){if(xt&6)throw Error(xe(327));Lo();var e=eh(t,0);if(!(e&1))return hn(t,Xt()),null;var r=xh(t,e);if(t.tag!==0&&r===2){var n=vp(t);n!==0&&(e=n,r=Wp(t,n))}if(r===1)throw r=$c,Sa(t,0),Si(t,e),hn(t,Xt()),r;if(r===6)throw Error(xe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ha(t,on,Us),hn(t,Xt()),null}function wg(t,e){var r=xt;xt|=1;try{return t(e)}finally{xt=r,xt===0&&(Jo=Xt()+500,od&&sa())}}function Oa(t){Pi!==null&&Pi.tag===0&&!(xt&6)&&Lo();var e=xt;xt|=1;var r=On.transition,n=It;try{if(On.transition=null,It=1,t)return t()}finally{It=n,On.transition=r,xt=e,!(xt&6)&&sa()}}function Eg(){mn=No.current,Ot(No)}function Sa(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,E4(r)),rr!==null)for(r=rr.return;r!==null;){var n=r;switch(rg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ih();break;case 3:Yo(),Ot(un),Ot($r),fg();break;case 5:ug(n);break;case 4:Yo();break;case 13:Ot(Vt);break;case 19:Ot(Vt);break;case 10:ag(n.type._context);break;case 22:case 23:Eg()}r=r.return}if(mr=t,rr=t=$i(t.current,null),kr=mn=e,lr=0,$c=null,_g=fd=ba=0,on=uc=null,xa!==null){for(e=0;e<xa.length;e++)if(r=xa[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}xa=null}return t}function V2(t,e){do{var r=rr;try{if(ig(),bf.current=ph,dh){for(var n=Ut.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}dh=!1}if(Fa=0,pr=or=Ut=null,lc=!1,Uc=0,xg.current=null,r===null||r.return===null){lr=1,$c=e,rr=null;break}e:{var i=t,a=r.return,o=r,l=e;if(e=kr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=T1(a);if(m!==null){m.flags&=-257,k1(m,a,o,i,e),m.mode&1&&E1(i,c,e),e=m,l=c;var x=e.updateQueue;if(x===null){var v=new Set;v.add(l),e.updateQueue=v}else x.add(l);break e}else{if(!(e&1)){E1(i,c,e),Tg();break e}l=Error(xe(426))}}else if(jt&&o.mode&1){var y=T1(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),k1(y,a,o,i,e),ng(Qo(l,o));break e}}i=l=Qo(l,o),lr!==4&&(lr=2),uc===null?uc=[i]:uc.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=E2(i,l,e);g1(i,T);break e;case 1:o=l;var k=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof k.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Bi===null||!Bi.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=T2(i,o,e);g1(i,D);break e}}i=i.return}while(i!==null)}z2(r)}catch(U){e=U,rr===r&&r!==null&&(rr=r=r.return);continue}break}while(!0)}function U2(){var t=mh.current;return mh.current=ph,t===null?ph:t}function Tg(){(lr===0||lr===3||lr===2)&&(lr=4),mr===null||!(ba&268435455)&&!(fd&268435455)||Si(mr,kr)}function xh(t,e){var r=xt;xt|=2;var n=U2();(mr!==t||kr!==e)&&(Us=null,Sa(t,e));do try{K4();break}catch(s){V2(t,s)}while(!0);if(ig(),xt=r,mh.current=n,rr!==null)throw Error(xe(261));return mr=null,kr=0,lr}function K4(){for(;rr!==null;)B2(rr)}function q4(){for(;rr!==null&&!_C();)B2(rr)}function B2(t){var e=H2(t.alternate,t,mn);t.memoizedProps=t.pendingProps,e===null?z2(t):rr=e,xg.current=null}function z2(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=B4(r,e),r!==null){r.flags&=32767,rr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{lr=6,rr=null;return}}else if(r=U4(r,e,mn),r!==null){rr=r;return}if(e=e.sibling,e!==null){rr=e;return}rr=e=t}while(e!==null);lr===0&&(lr=5)}function ha(t,e,r){var n=It,s=On.transition;try{On.transition=null,It=1,X4(t,e,r,n)}finally{On.transition=s,It=n}return null}function X4(t,e,r,n){do Lo();while(Pi!==null);if(xt&6)throw Error(xe(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(xe(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(RC(t,i),t===mr&&(rr=mr=null,kr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||uf||(uf=!0,W2(Zf,function(){return Lo(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=On.transition,On.transition=null;var a=It;It=1;var o=xt;xt|=4,xg.current=null,$4(t,r),M2(r,t),m4(Tp),th=!!Ep,Tp=Ep=null,t.current=r,H4(r),yC(),xt=o,It=a,On.transition=i}else t.current=r;if(uf&&(uf=!1,Pi=t,vh=s),i=t.pendingLanes,i===0&&(Bi=null),TC(r.stateNode),hn(t,Xt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(gh)throw gh=!1,t=$p,$p=null,t;return vh&1&&t.tag!==0&&Lo(),i=t.pendingLanes,i&1?t===Hp?fc++:(fc=0,Hp=t):fc=0,sa(),null}function Lo(){if(Pi!==null){var t=EE(vh),e=On.transition,r=It;try{if(On.transition=null,It=16>t?16:t,Pi===null)var n=!1;else{if(t=Pi,Pi=null,vh=0,xt&6)throw Error(xe(331));var s=xt;for(xt|=4,Ne=t.current;Ne!==null;){var i=Ne,a=i.child;if(Ne.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ne=c;Ne!==null;){var u=Ne;switch(u.tag){case 0:case 11:case 15:cc(8,u,i)}var h=u.child;if(h!==null)h.return=u,Ne=h;else for(;Ne!==null;){u=Ne;var p=u.sibling,m=u.return;if(F2(u),u===c){Ne=null;break}if(p!==null){p.return=m,Ne=p;break}Ne=m}}}var x=i.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var y=v.sibling;v.sibling=null,v=y}while(v!==null)}}Ne=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Ne=a;else e:for(;Ne!==null;){if(i=Ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:cc(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,Ne=T;break e}Ne=i.return}}var k=t.current;for(Ne=k;Ne!==null;){a=Ne;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,Ne=w;else e:for(a=k;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:ud(9,o)}}catch(U){Ht(o,o.return,U)}if(o===a){Ne=null;break e}var D=o.sibling;if(D!==null){D.return=o.return,Ne=D;break e}Ne=o.return}}if(xt=s,sa(),_s&&typeof _s.onPostCommitFiberRoot=="function")try{_s.onPostCommitFiberRoot(rd,t)}catch{}n=!0}return n}finally{It=r,On.transition=e}}return!1}function L1(t,e,r){e=Qo(r,e),e=E2(t,e,1),t=Ui(t,e,1),e=Qr(),t!==null&&(fu(t,1,e),hn(t,e))}function Ht(t,e,r){if(t.tag===3)L1(t,t,r);else for(;e!==null;){if(e.tag===3){L1(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Bi===null||!Bi.has(n))){t=Qo(r,t),t=T2(e,t,1),e=Ui(e,t,1),t=Qr(),e!==null&&(fu(e,1,t),hn(e,t));break}}e=e.return}}function Y4(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Qr(),t.pingedLanes|=t.suspendedLanes&r,mr===t&&(kr&r)===r&&(lr===4||lr===3&&(kr&130023424)===kr&&500>Xt()-yg?Sa(t,0):_g|=r),hn(t,e)}function $2(t,e){e===0&&(t.mode&1?(e=Zu,Zu<<=1,!(Zu&130023424)&&(Zu=4194304)):e=1);var r=Qr();t=ri(t,e),t!==null&&(fu(t,e,r),hn(t,r))}function Q4(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),$2(t,r)}function J4(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(xe(314))}n!==null&&n.delete(e),$2(t,r)}var H2;H2=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||un.current)cn=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return cn=!1,V4(t,e,r);cn=!!(t.flags&131072)}else cn=!1,jt&&e.flags&1048576&&qE(e,lh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Mf(t,e),t=e.pendingProps;var s=Ko(e,$r.current);Mo(e,r),s=dg(null,e,n,t,s,r);var i=pg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,fn(n)?(i=!0,ah(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,lg(e),s.updater=cd,e.stateNode=s,s._reactInternals=e,Dp(e,n,t,r),e=Op(null,e,n,!0,i,r)):(e.tag=0,jt&&i&&tg(e),Kr(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Mf(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=eR(n),t=Kn(n,t),s){case 0:e=bp(null,e,n,t,r);break e;case 1:e=I1(null,e,n,t,r);break e;case 11:e=S1(null,e,n,t,r);break e;case 14:e=A1(null,e,n,Kn(n.type,t),r);break e}throw Error(xe(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Kn(n,s),bp(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Kn(n,s),I1(t,e,n,s,r);case 3:e:{if(I2(e),t===null)throw Error(xe(387));n=e.pendingProps,i=e.memoizedState,s=i.element,e2(t,e),fh(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Qo(Error(xe(423)),e),e=C1(t,e,n,r,s);break e}else if(n!==s){s=Qo(Error(xe(424)),e),e=C1(t,e,n,r,s);break e}else for(_n=Vi(e.stateNode.containerInfo.firstChild),wn=e,jt=!0,Yn=null,r=JE(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(qo(),n===s){e=ni(t,e,r);break e}Kr(t,e,n,r)}e=e.child}return e;case 5:return t2(e),t===null&&Rp(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,kp(n,s)?a=null:i!==null&&kp(n,i)&&(e.flags|=32),A2(t,e),Kr(t,e,a,r),e.child;case 6:return t===null&&Rp(e),null;case 13:return C2(t,e,r);case 4:return cg(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Xo(e,null,n,r):Kr(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Kn(n,s),S1(t,e,n,s,r);case 7:return Kr(t,e,e.pendingProps,r),e.child;case 8:return Kr(t,e,e.pendingProps.children,r),e.child;case 12:return Kr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Nt(ch,n._currentValue),n._currentValue=a,i!==null)if(as(i.value,a)){if(i.children===s.children&&!un.current){e=ni(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=Xs(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Np(i.return,r,e),o.lanes|=r;break}l=l.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(xe(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Np(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Kr(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Mo(e,r),s=jn(s),n=n(s),e.flags|=1,Kr(t,e,n,r),e.child;case 14:return n=e.type,s=Kn(n,e.pendingProps),s=Kn(n.type,s),A1(t,e,n,s,r);case 15:return k2(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Kn(n,s),Mf(t,e),e.tag=1,fn(n)?(t=!0,ah(e)):t=!1,Mo(e,r),w2(e,n,s),Dp(e,n,s,r),Op(null,e,n,!0,t,r);case 19:return R2(t,e,r);case 22:return S2(t,e,r)}throw Error(xe(156,e.tag))};function W2(t,e){return xE(t,e)}function Z4(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bn(t,e,r,n){return new Z4(t,e,r,n)}function kg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function eR(t){if(typeof t=="function")return kg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$m)return 11;if(t===Hm)return 14}return 2}function $i(t,e){var r=t.alternate;return r===null?(r=bn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Vf(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")kg(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case yo:return Aa(r.children,s,i,e);case zm:a=8,s|=8;break;case rp:return t=bn(12,r,e,s|2),t.elementType=rp,t.lanes=i,t;case np:return t=bn(13,r,e,s),t.elementType=np,t.lanes=i,t;case sp:return t=bn(19,r,e,s),t.elementType=sp,t.lanes=i,t;case tE:return hd(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Zw:a=10;break e;case eE:a=9;break e;case $m:a=11;break e;case Hm:a=14;break e;case Ei:a=16,n=null;break e}throw Error(xe(130,t==null?t:typeof t,""))}return e=bn(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function Aa(t,e,r,n){return t=bn(7,t,n,e),t.lanes=r,t}function hd(t,e,r,n){return t=bn(22,t,n,e),t.elementType=tE,t.lanes=r,t.stateNode={isHidden:!1},t}function T0(t,e,r){return t=bn(6,t,null,e),t.lanes=r,t}function k0(t,e,r){return e=bn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function tR(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=s0(0),this.expirationTimes=s0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=s0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Sg(t,e,r,n,s,i,a,o,l){return t=new tR(t,e,r,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=bn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},lg(i),t}function rR(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_o,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function G2(t){if(!t)return Xi;t=t._reactInternals;e:{if(Ga(t)!==t||t.tag!==1)throw Error(xe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(fn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(xe(171))}if(t.tag===1){var r=t.type;if(fn(r))return GE(t,r,e)}return e}function K2(t,e,r,n,s,i,a,o,l){return t=Sg(r,n,!0,t,s,i,a,o,l),t.context=G2(null),r=t.current,n=Qr(),s=zi(r),i=Xs(n,s),i.callback=e??null,Ui(r,i,s),t.current.lanes=s,fu(t,s,n),hn(t,n),t}function dd(t,e,r,n){var s=e.current,i=Qr(),a=zi(s);return r=G2(r),e.context===null?e.context=r:e.pendingContext=r,e=Xs(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Ui(s,e,a),t!==null&&(ns(t,s,a,i),Ff(t,s,a)),a}function _h(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function j1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Ag(t,e){j1(t,e),(t=t.alternate)&&j1(t,e)}function nR(){return null}var q2=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ig(t){this._internalRoot=t}pd.prototype.render=Ig.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(xe(409));dd(t,e,null,null)};pd.prototype.unmount=Ig.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Oa(function(){dd(null,t,null,null)}),e[ti]=null}};function pd(t){this._internalRoot=t}pd.prototype.unstable_scheduleHydration=function(t){if(t){var e=SE();t={blockedOn:null,target:t,priority:e};for(var r=0;r<ki.length&&e!==0&&e<ki[r].priority;r++);ki.splice(r,0,t),r===0&&IE(t)}};function Cg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function md(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function V1(){}function sR(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=_h(a);i.call(c)}}var a=K2(e,n,t,0,null,!1,!1,"",V1);return t._reactRootContainer=a,t[ti]=a.current,Oc(t.nodeType===8?t.parentNode:t),Oa(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=_h(l);o.call(c)}}var l=Sg(t,0,!1,null,null,!1,!1,"",V1);return t._reactRootContainer=l,t[ti]=l.current,Oc(t.nodeType===8?t.parentNode:t),Oa(function(){dd(e,l,r,n)}),l}function gd(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var l=_h(a);o.call(l)}}dd(e,a,t,s)}else a=sR(r,e,t,s,n);return _h(a)}TE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Gl(e.pendingLanes);r!==0&&(Km(e,r|1),hn(e,Xt()),!(xt&6)&&(Jo=Xt()+500,sa()))}break;case 13:Oa(function(){var n=ri(t,1);if(n!==null){var s=Qr();ns(n,t,1,s)}}),Ag(t,1)}};qm=function(t){if(t.tag===13){var e=ri(t,134217728);if(e!==null){var r=Qr();ns(e,t,134217728,r)}Ag(t,134217728)}};kE=function(t){if(t.tag===13){var e=zi(t),r=ri(t,e);if(r!==null){var n=Qr();ns(r,t,e,n)}Ag(t,e)}};SE=function(){return It};AE=function(t,e){var r=It;try{return It=t,e()}finally{It=r}};pp=function(t,e,r){switch(e){case"input":if(op(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=ad(n);if(!s)throw Error(xe(90));nE(n),op(n,s)}}}break;case"textarea":iE(t,r);break;case"select":e=r.value,e!=null&&Do(t,!!r.multiple,e,!1)}};hE=wg;dE=Oa;var iR={usingClientEntryPoint:!1,Events:[du,ko,ad,uE,fE,wg]},Vl={findFiberByHostInstance:va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},aR={bundleType:Vl.bundleType,version:Vl.version,rendererPackageName:Vl.rendererPackageName,rendererConfig:Vl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=gE(t),t===null?null:t.stateNode},findFiberByHostInstance:Vl.findFiberByHostInstance||nR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ff=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ff.isDisabled&&ff.supportsFiber)try{rd=ff.inject(aR),_s=ff}catch{}}kn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iR;kn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cg(e))throw Error(xe(200));return rR(t,e,null,r)};kn.createRoot=function(t,e){if(!Cg(t))throw Error(xe(299));var r=!1,n="",s=q2;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Sg(t,1,!1,null,null,r,!1,n,s),t[ti]=e.current,Oc(t.nodeType===8?t.parentNode:t),new Ig(e)};kn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(xe(188)):(t=Object.keys(t).join(","),Error(xe(268,t)));return t=gE(e),t=t===null?null:t.stateNode,t};kn.flushSync=function(t){return Oa(t)};kn.hydrate=function(t,e,r){if(!md(e))throw Error(xe(200));return gd(null,t,e,!0,r)};kn.hydrateRoot=function(t,e,r){if(!Cg(t))throw Error(xe(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=q2;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=K2(e,null,t,1,r??null,s,!1,i,a),t[ti]=e.current,Oc(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new pd(e)};kn.render=function(t,e,r){if(!md(e))throw Error(xe(200));return gd(null,t,e,!1,r)};kn.unmountComponentAtNode=function(t){if(!md(t))throw Error(xe(40));return t._reactRootContainer?(Oa(function(){gd(null,null,t,!1,function(){t._reactRootContainer=null,t[ti]=null})}),!0):!1};kn.unstable_batchedUpdates=wg;kn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!md(r))throw Error(xe(200));if(t==null||t._reactInternals===void 0)throw Error(xe(38));return gd(t,e,r,!1,n)};kn.version="18.3.1-next-f1338f8080-20240426";function X2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(X2)}catch(t){console.error(t)}}X2(),Xw.exports=kn;var Rg=Xw.exports;const oR=Mw(Rg),lR=Ow({__proto__:null,default:oR},[Rg]);var U1=Rg;ep.createRoot=U1.createRoot,ep.hydrateRoot=U1.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mt(){return Mt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mt.apply(this,arguments)}var tr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(tr||(tr={}));const B1="popstate";function cR(t){t===void 0&&(t={});function e(n,s){let{pathname:i,search:a,hash:o}=n.location;return Hc("",{pathname:i,search:a,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Ma(s)}return fR(e,r,null,t)}function et(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Zo(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function uR(){return Math.random().toString(36).substr(2,8)}function z1(t,e){return{usr:t.state,key:t.key,idx:e}}function Hc(t,e,r,n){return r===void 0&&(r=null),Mt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ia(e):e,{state:r,key:e&&e.key||n||uR()})}function Ma(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ia(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function fR(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,a=s.history,o=tr.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(Mt({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function h(){o=tr.Pop;let y=u(),T=y==null?null:y-c;c=y,l&&l({action:o,location:v.location,delta:T})}function p(y,T){o=tr.Push;let k=Hc(v.location,y,T);c=u()+1;let w=z1(k,c),D=v.createHref(k);try{a.pushState(w,"",D)}catch(U){if(U instanceof DOMException&&U.name==="DataCloneError")throw U;s.location.assign(D)}i&&l&&l({action:o,location:v.location,delta:1})}function m(y,T){o=tr.Replace;let k=Hc(v.location,y,T);c=u();let w=z1(k,c),D=v.createHref(k);a.replaceState(w,"",D),i&&l&&l({action:o,location:v.location,delta:0})}function x(y){let T=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof y=="string"?y:Ma(y);return k=k.replace(/ $/,"%20"),et(T,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,T)}let v={get action(){return o},get location(){return t(s,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(B1,h),l=y,()=>{s.removeEventListener(B1,h),l=null}},createHref(y){return e(s,y)},createURL:x,encodeLocation(y){let T=x(y);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:p,replace:m,go(y){return a.go(y)}};return v}var At;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(At||(At={}));const hR=new Set(["lazy","caseSensitive","path","id","index","children"]);function dR(t){return t.index===!0}function yh(t,e,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),t.map((s,i)=>{let a=[...r,String(i)],o=typeof s.id=="string"?s.id:a.join("-");if(et(s.index!==!0||!s.children,"Cannot specify children on an index route"),et(!n[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),dR(s)){let l=Mt({},s,e(s),{id:o});return n[o]=l,l}else{let l=Mt({},s,e(s),{id:o,children:void 0});return n[o]=l,s.children&&(l.children=yh(s.children,e,a,n)),l}})}function pa(t,e,r){return r===void 0&&(r="/"),Uf(t,e,r,!1)}function Uf(t,e,r,n){let s=typeof e=="string"?ia(e):e,i=si(s.pathname||"/",r);if(i==null)return null;let a=Y2(t);mR(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=AR(i);o=kR(a[l],c,n)}return o}function pR(t,e){let{route:r,pathname:n,params:s}=t;return{id:r.id,pathname:n,params:s,data:e[r.id],handle:r.handle}}function Y2(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,a,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};l.relativePath.startsWith("/")&&(et(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Ys([n,l.relativePath]),u=r.concat(l);i.children&&i.children.length>0&&(et(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),Y2(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:ER(c,i.index),routesMeta:u})};return t.forEach((i,a)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,a);else for(let l of Q2(i.path))s(i,a,l)}),e}function Q2(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let a=Q2(n.join("/")),o=[];return o.push(...a.map(l=>l===""?i:[i,l].join("/"))),s&&o.push(...a),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function mR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:TR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const gR=/^:[\w-]+$/,vR=3,xR=2,_R=1,yR=10,wR=-2,$1=t=>t==="*";function ER(t,e){let r=t.split("/"),n=r.length;return r.some($1)&&(n+=wR),e&&(n+=xR),r.filter(s=>!$1(s)).reduce((s,i)=>s+(gR.test(i)?vR:i===""?_R:yR),n)}function TR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function kR(t,e,r){r===void 0&&(r=!1);let{routesMeta:n}=t,s={},i="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=wh({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),p=l.route;if(!h&&c&&r&&!n[n.length-1].route.index&&(h=wh({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(s,h.params),a.push({params:s,pathname:Ys([i,h.pathname]),pathnameBase:RR(Ys([i,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(i=Ys([i,h.pathnameBase]))}return a}function wh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=SR(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,u,h)=>{let{paramName:p,isOptional:m}=u;if(p==="*"){let v=o[h]||"";a=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const x=o[h];return m&&!x?c[p]=void 0:c[p]=(x||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:a,pattern:t}}function SR(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Zo(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function AR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Zo(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function si(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function IR(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?ia(t):t;return{pathname:r?r.startsWith("/")?r:CR(r,e):e,search:NR(n),hash:PR(s)}}function CR(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function S0(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function J2(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function vd(t,e){let r=J2(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function xd(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=ia(t):(s=Mt({},t),et(!s.pathname||!s.pathname.includes("?"),S0("?","pathname","search",s)),et(!s.pathname||!s.pathname.includes("#"),S0("#","pathname","hash",s)),et(!s.search||!s.search.includes("#"),S0("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,o;if(a==null)o=r;else{let h=e.length-1;if(!n&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),h-=1;s.pathname=p.join("/")}o=h>=0?e[h]:"/"}let l=IR(s,o),c=a&&a!=="/"&&a.endsWith("/"),u=(i||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Ys=t=>t.join("/").replace(/\/\/+/g,"/"),RR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),NR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,PR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Eh{constructor(e,r,n,s){s===void 0&&(s=!1),this.status=e,this.statusText=r||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function Wc(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Z2=["post","put","patch","delete"],DR=new Set(Z2),FR=["get",...Z2],bR=new Set(FR),OR=new Set([301,302,303,307,308]),MR=new Set([307,308]),A0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},LR={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Ul={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Ng=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jR=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),eT="remix-router-transitions";function VR(t){const e=t.window?t.window:typeof window<"u"?window:void 0,r=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",n=!r;et(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let H=t.detectErrorBoundary;s=J=>({hasErrorBoundary:H(J)})}else s=jR;let i={},a=yh(t.routes,s,void 0,i),o,l=t.basename||"/",c=t.dataStrategy||$R,u=t.patchRoutesOnNavigation,h=Mt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),p=null,m=new Set,x=null,v=null,y=null,T=t.hydrationData!=null,k=pa(a,t.history.location,l),w=!1,D=null;if(k==null&&!u){let H=sn(404,{pathname:t.history.location.pathname}),{matches:J,route:se}=e_(a);k=J,D={[se.id]:H}}k&&!t.hydrationData&&Ls(k,a,t.history.location.pathname).active&&(k=null);let U;if(k)if(k.some(H=>H.route.lazy))U=!1;else if(!k.some(H=>H.route.loader))U=!0;else if(h.v7_partialHydration){let H=t.hydrationData?t.hydrationData.loaderData:null,J=t.hydrationData?t.hydrationData.errors:null;if(J){let se=k.findIndex(he=>J[he.route.id]!==void 0);U=k.slice(0,se+1).every(he=>!qp(he.route,H,J))}else U=k.every(se=>!qp(se.route,H,J))}else U=t.hydrationData!=null;else if(U=!1,k=[],h.v7_partialHydration){let H=Ls(null,a,t.history.location.pathname);H.active&&H.matches&&(w=!0,k=H.matches)}let V,g={historyAction:t.history.action,location:t.history.location,matches:k,initialized:U,navigation:A0,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||D,fetchers:new Map,blockers:new Map},E=tr.Pop,S=!1,C,P=!1,R=new Map,b=null,ce=!1,fe=!1,Ae=[],_e=new Set,oe=new Map,K=0,de=-1,Te=new Map,B=new Set,ee=new Map,q=new Map,W=new Set,ae=new Map,ve=new Map,Ce;function Ee(){if(p=t.history.listen(H=>{let{action:J,location:se,delta:he}=H;if(Ce){Ce(),Ce=void 0;return}Zo(ve.size===0||he!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ie=mi({currentLocation:g.location,nextLocation:se,historyAction:J});if(Ie&&he!=null){let I=new Promise(L=>{Ce=L});t.history.go(he*-1),us(Ie,{state:"blocked",location:se,proceed(){us(Ie,{state:"proceeding",proceed:void 0,reset:void 0,location:se}),I.then(()=>t.history.go(he))},reset(){let L=new Map(g.blockers);L.set(Ie,Ul),z({blockers:L})}});return}return Me(J,se)}),r){nN(e,R);let H=()=>sN(e,R);e.addEventListener("pagehide",H),b=()=>e.removeEventListener("pagehide",H)}return g.initialized||Me(tr.Pop,g.location,{initialHydration:!0}),V}function pe(){p&&p(),b&&b(),m.clear(),C&&C.abort(),g.fetchers.forEach((H,J)=>kt(J)),g.blockers.forEach((H,J)=>bs(J))}function He(H){return m.add(H),()=>m.delete(H)}function z(H,J){J===void 0&&(J={}),g=Mt({},g,H);let se=[],he=[];h.v7_fetcherPersist&&g.fetchers.forEach((Ie,I)=>{Ie.state==="idle"&&(W.has(I)?he.push(I):se.push(I))}),W.forEach(Ie=>{!g.fetchers.has(Ie)&&!oe.has(Ie)&&he.push(Ie)}),[...m].forEach(Ie=>Ie(g,{deletedFetchers:he,viewTransitionOpts:J.viewTransitionOpts,flushSync:J.flushSync===!0})),h.v7_fetcherPersist?(se.forEach(Ie=>g.fetchers.delete(Ie)),he.forEach(Ie=>kt(Ie))):he.forEach(Ie=>W.delete(Ie))}function ct(H,J,se){var he,Ie;let{flushSync:I}=se===void 0?{}:se,L=g.actionData!=null&&g.navigation.formMethod!=null&&Xn(g.navigation.formMethod)&&g.navigation.state==="loading"&&((he=H.state)==null?void 0:he._isRedirect)!==!0,N;J.actionData?Object.keys(J.actionData).length>0?N=J.actionData:N=null:L?N=g.actionData:N=null;let F=J.loaderData?J1(g.loaderData,J.loaderData,J.matches||[],J.errors):g.loaderData,O=g.blockers;O.size>0&&(O=new Map(O),O.forEach((re,te)=>O.set(te,Ul)));let M=S===!0||g.navigation.formMethod!=null&&Xn(g.navigation.formMethod)&&((Ie=H.state)==null?void 0:Ie._isRedirect)!==!0;o&&(a=o,o=void 0),ce||E===tr.Pop||(E===tr.Push?t.history.push(H,H.state):E===tr.Replace&&t.history.replace(H,H.state));let G;if(E===tr.Pop){let re=R.get(g.location.pathname);re&&re.has(H.pathname)?G={currentLocation:g.location,nextLocation:H}:R.has(H.pathname)&&(G={currentLocation:H,nextLocation:g.location})}else if(P){let re=R.get(g.location.pathname);re?re.add(H.pathname):(re=new Set([H.pathname]),R.set(g.location.pathname,re)),G={currentLocation:g.location,nextLocation:H}}z(Mt({},J,{actionData:N,loaderData:F,historyAction:E,location:H,initialized:!0,navigation:A0,revalidation:"idle",restoreScrollPosition:Ms(H,J.matches||g.matches),preventScrollReset:M,blockers:O}),{viewTransitionOpts:G,flushSync:I===!0}),E=tr.Pop,S=!1,P=!1,ce=!1,fe=!1,Ae=[]}async function Ye(H,J){if(typeof H=="number"){t.history.go(H);return}let se=Kp(g.location,g.matches,l,h.v7_prependBasename,H,h.v7_relativeSplatPath,J==null?void 0:J.fromRouteId,J==null?void 0:J.relative),{path:he,submission:Ie,error:I}=H1(h.v7_normalizeFormMethod,!1,se,J),L=g.location,N=Hc(g.location,he,J&&J.state);N=Mt({},N,t.history.encodeLocation(N));let F=J&&J.replace!=null?J.replace:void 0,O=tr.Push;F===!0?O=tr.Replace:F===!1||Ie!=null&&Xn(Ie.formMethod)&&Ie.formAction===g.location.pathname+g.location.search&&(O=tr.Replace);let M=J&&"preventScrollReset"in J?J.preventScrollReset===!0:void 0,G=(J&&J.flushSync)===!0,re=mi({currentLocation:L,nextLocation:N,historyAction:O});if(re){us(re,{state:"blocked",location:N,proceed(){us(re,{state:"proceeding",proceed:void 0,reset:void 0,location:N}),Ye(H,J)},reset(){let te=new Map(g.blockers);te.set(re,Ul),z({blockers:te})}});return}return await Me(O,N,{submission:Ie,pendingError:I,preventScrollReset:M,replace:J&&J.replace,enableViewTransition:J&&J.viewTransition,flushSync:G})}function at(){if(ut(),z({revalidation:"loading"}),g.navigation.state!=="submitting"){if(g.navigation.state==="idle"){Me(g.historyAction,g.location,{startUninterruptedRevalidation:!0});return}Me(E||g.historyAction,g.navigation.location,{overrideNavigation:g.navigation,enableViewTransition:P===!0})}}async function Me(H,J,se){C&&C.abort(),C=null,E=H,ce=(se&&se.startUninterruptedRevalidation)===!0,ao(g.location,g.matches),S=(se&&se.preventScrollReset)===!0,P=(se&&se.enableViewTransition)===!0;let he=o||a,Ie=se&&se.overrideNavigation,I=se!=null&&se.initialHydration&&g.matches&&g.matches.length>0&&!w?g.matches:pa(he,J,l),L=(se&&se.flushSync)===!0;if(I&&g.initialized&&!fe&&XR(g.location,J)&&!(se&&se.submission&&Xn(se.submission.formMethod))){ct(J,{matches:I},{flushSync:L});return}let N=Ls(I,he,J.pathname);if(N.active&&N.matches&&(I=N.matches),!I){let{error:Z,notFoundMatches:Q,route:le}=zn(J.pathname);ct(J,{matches:Q,loaderData:{},errors:{[le.id]:Z}},{flushSync:L});return}C=new AbortController;let F=ho(t.history,J,C.signal,se&&se.submission),O;if(se&&se.pendingError)O=[ma(I).route.id,{type:At.error,error:se.pendingError}];else if(se&&se.submission&&Xn(se.submission.formMethod)){let Z=await Y(F,J,se.submission,I,N.active,{replace:se.replace,flushSync:L});if(Z.shortCircuited)return;if(Z.pendingActionResult){let[Q,le]=Z.pendingActionResult;if(gn(le)&&Wc(le.error)&&le.error.status===404){C=null,ct(J,{matches:Z.matches,loaderData:{},errors:{[Q]:le.error}});return}}I=Z.matches||I,O=Z.pendingActionResult,Ie=I0(J,se.submission),L=!1,N.active=!1,F=ho(t.history,F.url,F.signal)}let{shortCircuited:M,matches:G,loaderData:re,errors:te}=await ke(F,J,I,N.active,Ie,se&&se.submission,se&&se.fetcherSubmission,se&&se.replace,se&&se.initialHydration===!0,L,O);M||(C=null,ct(J,Mt({matches:G||I},Z1(O),{loaderData:re,errors:te})))}async function Y(H,J,se,he,Ie,I){I===void 0&&(I={}),ut();let L=tN(J,se);if(z({navigation:L},{flushSync:I.flushSync===!0}),Ie){let O=await In(he,J.pathname,H.signal);if(O.type==="aborted")return{shortCircuited:!0};if(O.type==="error"){let M=ma(O.partialMatches).route.id;return{matches:O.partialMatches,pendingActionResult:[M,{type:At.error,error:O.error}]}}else if(O.matches)he=O.matches;else{let{notFoundMatches:M,error:G,route:re}=zn(J.pathname);return{matches:M,pendingActionResult:[re.id,{type:At.error,error:G}]}}}let N,F=ql(he,J);if(!F.route.action&&!F.route.lazy)N={type:At.error,error:sn(405,{method:H.method,pathname:J.pathname,routeId:F.route.id})};else if(N=(await Qe("action",g,H,[F],he,null))[F.route.id],H.signal.aborted)return{shortCircuited:!0};if(ya(N)){let O;return I&&I.replace!=null?O=I.replace:O=X1(N.response.headers.get("Location"),new URL(H.url),l)===g.location.pathname+g.location.search,await qe(H,N,!0,{submission:se,replace:O}),{shortCircuited:!0}}if(Di(N))throw sn(400,{type:"defer-action"});if(gn(N)){let O=ma(he,F.route.id);return(I&&I.replace)!==!0&&(E=tr.Push),{matches:he,pendingActionResult:[O.route.id,N]}}return{matches:he,pendingActionResult:[F.route.id,N]}}async function ke(H,J,se,he,Ie,I,L,N,F,O,M){let G=Ie||I0(J,I),re=I||L||r_(G),te=!ce&&(!h.v7_partialHydration||!F);if(he){if(te){let Tt=be(M);z(Mt({navigation:G},Tt!==void 0?{actionData:Tt}:{}),{flushSync:O})}let Ze=await In(se,J.pathname,H.signal);if(Ze.type==="aborted")return{shortCircuited:!0};if(Ze.type==="error"){let Tt=ma(Ze.partialMatches).route.id;return{matches:Ze.partialMatches,loaderData:{},errors:{[Tt]:Ze.error}}}else if(Ze.matches)se=Ze.matches;else{let{error:Tt,notFoundMatches:vr,route:Cn}=zn(J.pathname);return{matches:vr,loaderData:{},errors:{[Cn.id]:Tt}}}}let Z=o||a,[Q,le]=G1(t.history,g,se,re,J,h.v7_partialHydration&&F===!0,h.v7_skipActionErrorRevalidation,fe,Ae,_e,W,ee,B,Z,l,M);if(Os(Ze=>!(se&&se.some(Tt=>Tt.route.id===Ze))||Q&&Q.some(Tt=>Tt.route.id===Ze)),de=++K,Q.length===0&&le.length===0){let Ze=Fs();return ct(J,Mt({matches:se,loaderData:{},errors:M&&gn(M[1])?{[M[0]]:M[1].error}:null},Z1(M),Ze?{fetchers:new Map(g.fetchers)}:{}),{flushSync:O}),{shortCircuited:!0}}if(te){let Ze={};if(!he){Ze.navigation=G;let Tt=be(M);Tt!==void 0&&(Ze.actionData=Tt)}le.length>0&&(Ze.fetchers=je(le)),z(Ze,{flushSync:O})}le.forEach(Ze=>{Et(Ze.key),Ze.controller&&oe.set(Ze.key,Ze.controller)});let ye=()=>le.forEach(Ze=>Et(Ze.key));C&&C.signal.addEventListener("abort",ye);let{loaderResults:Re,fetcherResults:me}=await Fe(g,se,Q,le,H);if(H.signal.aborted)return{shortCircuited:!0};C&&C.signal.removeEventListener("abort",ye),le.forEach(Ze=>oe.delete(Ze.key));let we=hf(Re);if(we)return await qe(H,we.result,!0,{replace:N}),{shortCircuited:!0};if(we=hf(me),we)return B.add(we.key),await qe(H,we.result,!0,{replace:N}),{shortCircuited:!0};let{loaderData:Le,errors:gt}=Q1(g,se,Re,M,le,me,ae);ae.forEach((Ze,Tt)=>{Ze.subscribe(vr=>{(vr||Ze.done)&&ae.delete(Tt)})}),h.v7_partialHydration&&F&&g.errors&&(gt=Mt({},g.errors,gt));let nt=Fs(),St=io(de),nn=nt||St||le.length>0;return Mt({matches:se,loaderData:Le,errors:gt},nn?{fetchers:new Map(g.fetchers)}:{})}function be(H){if(H&&!gn(H[1]))return{[H[0]]:H[1].data};if(g.actionData)return Object.keys(g.actionData).length===0?null:g.actionData}function je(H){return H.forEach(J=>{let se=g.fetchers.get(J.key),he=Bl(void 0,se?se.data:void 0);g.fetchers.set(J.key,he)}),new Map(g.fetchers)}function tt(H,J,se,he){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Et(H);let Ie=(he&&he.flushSync)===!0,I=o||a,L=Kp(g.location,g.matches,l,h.v7_prependBasename,se,h.v7_relativeSplatPath,J,he==null?void 0:he.relative),N=pa(I,L,l),F=Ls(N,I,L);if(F.active&&F.matches&&(N=F.matches),!N){Be(H,J,sn(404,{pathname:L}),{flushSync:Ie});return}let{path:O,submission:M,error:G}=H1(h.v7_normalizeFormMethod,!0,L,he);if(G){Be(H,J,G,{flushSync:Ie});return}let re=ql(N,O),te=(he&&he.preventScrollReset)===!0;if(M&&Xn(M.formMethod)){mt(H,J,O,re,N,F.active,Ie,te,M);return}ee.set(H,{routeId:J,path:O}),Je(H,J,O,re,N,F.active,Ie,te,M)}async function mt(H,J,se,he,Ie,I,L,N,F){ut(),ee.delete(H);function O(ft){if(!ft.route.action&&!ft.route.lazy){let hs=sn(405,{method:F.formMethod,pathname:se,routeId:J});return Be(H,J,hs,{flushSync:L}),!0}return!1}if(!I&&O(he))return;let M=g.fetchers.get(H);rt(H,rN(F,M),{flushSync:L});let G=new AbortController,re=ho(t.history,se,G.signal,F);if(I){let ft=await In(Ie,new URL(re.url).pathname,re.signal,H);if(ft.type==="aborted")return;if(ft.type==="error"){Be(H,J,ft.error,{flushSync:L});return}else if(ft.matches){if(Ie=ft.matches,he=ql(Ie,se),O(he))return}else{Be(H,J,sn(404,{pathname:se}),{flushSync:L});return}}oe.set(H,G);let te=K,Q=(await Qe("action",g,re,[he],Ie,H))[he.route.id];if(re.signal.aborted){oe.get(H)===G&&oe.delete(H);return}if(h.v7_fetcherPersist&&W.has(H)){if(ya(Q)||gn(Q)){rt(H,wi(void 0));return}}else{if(ya(Q))if(oe.delete(H),de>te){rt(H,wi(void 0));return}else return B.add(H),rt(H,Bl(F)),qe(re,Q,!1,{fetcherSubmission:F,preventScrollReset:N});if(gn(Q)){Be(H,J,Q.error);return}}if(Di(Q))throw sn(400,{type:"defer-action"});let le=g.navigation.location||g.location,ye=ho(t.history,le,G.signal),Re=o||a,me=g.navigation.state!=="idle"?pa(Re,g.navigation.location,l):g.matches;et(me,"Didn't find any matches after fetcher action");let we=++K;Te.set(H,we);let Le=Bl(F,Q.data);g.fetchers.set(H,Le);let[gt,nt]=G1(t.history,g,me,F,le,!1,h.v7_skipActionErrorRevalidation,fe,Ae,_e,W,ee,B,Re,l,[he.route.id,Q]);nt.filter(ft=>ft.key!==H).forEach(ft=>{let hs=ft.key,kl=g.fetchers.get(hs),Mu=Bl(void 0,kl?kl.data:void 0);g.fetchers.set(hs,Mu),Et(hs),ft.controller&&oe.set(hs,ft.controller)}),z({fetchers:new Map(g.fetchers)});let St=()=>nt.forEach(ft=>Et(ft.key));G.signal.addEventListener("abort",St);let{loaderResults:nn,fetcherResults:Ze}=await Fe(g,me,gt,nt,ye);if(G.signal.aborted)return;G.signal.removeEventListener("abort",St),Te.delete(H),oe.delete(H),nt.forEach(ft=>oe.delete(ft.key));let Tt=hf(nn);if(Tt)return qe(ye,Tt.result,!1,{preventScrollReset:N});if(Tt=hf(Ze),Tt)return B.add(Tt.key),qe(ye,Tt.result,!1,{preventScrollReset:N});let{loaderData:vr,errors:Cn}=Q1(g,me,nn,void 0,nt,Ze,ae);if(g.fetchers.has(H)){let ft=wi(Q.data);g.fetchers.set(H,ft)}io(we),g.navigation.state==="loading"&&we>de?(et(E,"Expected pending action"),C&&C.abort(),ct(g.navigation.location,{matches:me,loaderData:vr,errors:Cn,fetchers:new Map(g.fetchers)})):(z({errors:Cn,loaderData:J1(g.loaderData,vr,me,Cn),fetchers:new Map(g.fetchers)}),fe=!1)}async function Je(H,J,se,he,Ie,I,L,N,F){let O=g.fetchers.get(H);rt(H,Bl(F,O?O.data:void 0),{flushSync:L});let M=new AbortController,G=ho(t.history,se,M.signal);if(I){let Q=await In(Ie,new URL(G.url).pathname,G.signal,H);if(Q.type==="aborted")return;if(Q.type==="error"){Be(H,J,Q.error,{flushSync:L});return}else if(Q.matches)Ie=Q.matches,he=ql(Ie,se);else{Be(H,J,sn(404,{pathname:se}),{flushSync:L});return}}oe.set(H,M);let re=K,Z=(await Qe("loader",g,G,[he],Ie,H))[he.route.id];if(Di(Z)&&(Z=await Pg(Z,G.signal,!0)||Z),oe.get(H)===M&&oe.delete(H),!G.signal.aborted){if(W.has(H)){rt(H,wi(void 0));return}if(ya(Z))if(de>re){rt(H,wi(void 0));return}else{B.add(H),await qe(G,Z,!1,{preventScrollReset:N});return}if(gn(Z)){Be(H,J,Z.error);return}et(!Di(Z),"Unhandled fetcher deferred data"),rt(H,wi(Z.data))}}async function qe(H,J,se,he){let{submission:Ie,fetcherSubmission:I,preventScrollReset:L,replace:N}=he===void 0?{}:he;J.response.headers.has("X-Remix-Revalidate")&&(fe=!0);let F=J.response.headers.get("Location");et(F,"Expected a Location header on the redirect Response"),F=X1(F,new URL(H.url),l);let O=Hc(g.location,F,{_isRedirect:!0});if(r){let Q=!1;if(J.response.headers.has("X-Remix-Reload-Document"))Q=!0;else if(Ng.test(F)){const le=t.history.createURL(F);Q=le.origin!==e.location.origin||si(le.pathname,l)==null}if(Q){N?e.location.replace(F):e.location.assign(F);return}}C=null;let M=N===!0||J.response.headers.has("X-Remix-Replace")?tr.Replace:tr.Push,{formMethod:G,formAction:re,formEncType:te}=g.navigation;!Ie&&!I&&G&&re&&te&&(Ie=r_(g.navigation));let Z=Ie||I;if(MR.has(J.response.status)&&Z&&Xn(Z.formMethod))await Me(M,O,{submission:Mt({},Z,{formAction:F}),preventScrollReset:L||S,enableViewTransition:se?P:void 0});else{let Q=I0(O,Ie);await Me(M,O,{overrideNavigation:Q,fetcherSubmission:I,preventScrollReset:L||S,enableViewTransition:se?P:void 0})}}async function Qe(H,J,se,he,Ie,I){let L,N={};try{L=await HR(c,H,J,se,he,Ie,I,i,s)}catch(F){return he.forEach(O=>{N[O.route.id]={type:At.error,error:F}}),N}for(let[F,O]of Object.entries(L))if(YR(O)){let M=O.result;N[F]={type:At.redirect,response:KR(M,se,F,Ie,l,h.v7_relativeSplatPath)}}else N[F]=await GR(O);return N}async function Fe(H,J,se,he,Ie){let I=H.matches,L=Qe("loader",H,Ie,se,J,null),N=Promise.all(he.map(async M=>{if(M.matches&&M.match&&M.controller){let re=(await Qe("loader",H,ho(t.history,M.path,M.controller.signal),[M.match],M.matches,M.key))[M.match.route.id];return{[M.key]:re}}else return Promise.resolve({[M.key]:{type:At.error,error:sn(404,{pathname:M.path})}})})),F=await L,O=(await N).reduce((M,G)=>Object.assign(M,G),{});return await Promise.all([ZR(J,F,Ie.signal,I,H.loaderData),eN(J,O,he)]),{loaderResults:F,fetcherResults:O}}function ut(){fe=!0,Ae.push(...Os()),ee.forEach((H,J)=>{oe.has(J)&&_e.add(J),Et(J)})}function rt(H,J,se){se===void 0&&(se={}),g.fetchers.set(H,J),z({fetchers:new Map(g.fetchers)},{flushSync:(se&&se.flushSync)===!0})}function Be(H,J,se,he){he===void 0&&(he={});let Ie=ma(g.matches,J);kt(H),z({errors:{[Ie.route.id]:se},fetchers:new Map(g.fetchers)},{flushSync:(he&&he.flushSync)===!0})}function Ve(H){return q.set(H,(q.get(H)||0)+1),W.has(H)&&W.delete(H),g.fetchers.get(H)||LR}function kt(H){let J=g.fetchers.get(H);oe.has(H)&&!(J&&J.state==="loading"&&Te.has(H))&&Et(H),ee.delete(H),Te.delete(H),B.delete(H),h.v7_fetcherPersist&&W.delete(H),_e.delete(H),g.fetchers.delete(H)}function Yt(H){let J=(q.get(H)||0)-1;J<=0?(q.delete(H),W.add(H),h.v7_fetcherPersist||kt(H)):q.set(H,J),z({fetchers:new Map(g.fetchers)})}function Et(H){let J=oe.get(H);J&&(J.abort(),oe.delete(H))}function dn(H){for(let J of H){let se=Ve(J),he=wi(se.data);g.fetchers.set(J,he)}}function Fs(){let H=[],J=!1;for(let se of B){let he=g.fetchers.get(se);et(he,"Expected fetcher: "+se),he.state==="loading"&&(B.delete(se),H.push(se),J=!0)}return dn(H),J}function io(H){let J=[];for(let[se,he]of Te)if(he<H){let Ie=g.fetchers.get(se);et(Ie,"Expected fetcher: "+se),Ie.state==="loading"&&(Et(se),Te.delete(se),J.push(se))}return dn(J),J.length>0}function Tl(H,J){let se=g.blockers.get(H)||Ul;return ve.get(H)!==J&&ve.set(H,J),se}function bs(H){g.blockers.delete(H),ve.delete(H)}function us(H,J){let se=g.blockers.get(H)||Ul;et(se.state==="unblocked"&&J.state==="blocked"||se.state==="blocked"&&J.state==="blocked"||se.state==="blocked"&&J.state==="proceeding"||se.state==="blocked"&&J.state==="unblocked"||se.state==="proceeding"&&J.state==="unblocked","Invalid blocker state transition: "+se.state+" -> "+J.state);let he=new Map(g.blockers);he.set(H,J),z({blockers:he})}function mi(H){let{currentLocation:J,nextLocation:se,historyAction:he}=H;if(ve.size===0)return;ve.size>1&&Zo(!1,"A router only supports one blocker at a time");let Ie=Array.from(ve.entries()),[I,L]=Ie[Ie.length-1],N=g.blockers.get(I);if(!(N&&N.state==="proceeding")&&L({currentLocation:J,nextLocation:se,historyAction:he}))return I}function zn(H){let J=sn(404,{pathname:H}),se=o||a,{matches:he,route:Ie}=e_(se);return Os(),{notFoundMatches:he,route:Ie,error:J}}function Os(H){let J=[];return ae.forEach((se,he)=>{(!H||H(he))&&(se.cancel(),J.push(he),ae.delete(he))}),J}function fs(H,J,se){if(x=H,y=J,v=se||null,!T&&g.navigation===A0){T=!0;let he=Ms(g.location,g.matches);he!=null&&z({restoreScrollPosition:he})}return()=>{x=null,y=null,v=null}}function An(H,J){return v&&v(H,J.map(he=>pR(he,g.loaderData)))||H.key}function ao(H,J){if(x&&y){let se=An(H,J);x[se]=y()}}function Ms(H,J){if(x){let se=An(H,J),he=x[se];if(typeof he=="number")return he}return null}function Ls(H,J,se){if(u)if(H){if(Object.keys(H[0].params).length>0)return{active:!0,matches:Uf(J,se,l,!0)}}else return{active:!0,matches:Uf(J,se,l,!0)||[]};return{active:!1,matches:null}}async function In(H,J,se,he){if(!u)return{type:"success",matches:H};let Ie=H;for(;;){let I=o==null,L=o||a,N=i;try{await u({signal:se,path:J,matches:Ie,fetcherKey:he,patch:(M,G)=>{se.aborted||q1(M,G,L,N,s)}})}catch(M){return{type:"error",error:M,partialMatches:Ie}}finally{I&&!se.aborted&&(a=[...a])}if(se.aborted)return{type:"aborted"};let F=pa(L,J,l);if(F)return{type:"success",matches:F};let O=Uf(L,J,l,!0);if(!O||Ie.length===O.length&&Ie.every((M,G)=>M.route.id===O[G].route.id))return{type:"success",matches:null};Ie=O}}function oo(H){i={},o=yh(H,s,void 0,i)}function ir(H,J){let se=o==null;q1(H,J,o||a,i,s),se&&(a=[...a],z({}))}return V={get basename(){return l},get future(){return h},get state(){return g},get routes(){return a},get window(){return e},initialize:Ee,subscribe:He,enableScrollRestoration:fs,navigate:Ye,fetch:tt,revalidate:at,createHref:H=>t.history.createHref(H),encodeLocation:H=>t.history.encodeLocation(H),getFetcher:Ve,deleteFetcher:Yt,dispose:pe,getBlocker:Tl,deleteBlocker:bs,patchRoutes:ir,_internalFetchControllers:oe,_internalActiveDeferreds:ae,_internalSetRoutes:oo},V}function UR(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Kp(t,e,r,n,s,i,a,o){let l,c;if(a){l=[];for(let h of e)if(l.push(h),h.route.id===a){c=h;break}}else l=e,c=e[e.length-1];let u=xd(s||".",vd(l,i),si(t.pathname,r)||t.pathname,o==="path");if(s==null&&(u.search=t.search,u.hash=t.hash),(s==null||s===""||s===".")&&c){let h=Dg(u.search);if(c.route.index&&!h)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&h){let p=new URLSearchParams(u.search),m=p.getAll("index");p.delete("index"),m.filter(v=>v).forEach(v=>p.append("index",v));let x=p.toString();u.search=x?"?"+x:""}}return n&&r!=="/"&&(u.pathname=u.pathname==="/"?r:Ys([r,u.pathname])),Ma(u)}function H1(t,e,r,n){if(!n||!UR(n))return{path:r};if(n.formMethod&&!JR(n.formMethod))return{path:r,error:sn(405,{method:n.formMethod})};let s=()=>({path:r,error:sn(400,{type:"invalid-body"})}),i=n.formMethod||"get",a=t?i.toUpperCase():i.toLowerCase(),o=nT(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Xn(a))return s();let p=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((m,x)=>{let[v,y]=x;return""+m+v+"="+y+`
`},""):String(n.body);return{path:r,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:p}}}else if(n.formEncType==="application/json"){if(!Xn(a))return s();try{let p=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:p,text:void 0}}}catch{return s()}}}et(typeof FormData=="function","FormData is not available in this environment");let l,c;if(n.formData)l=Xp(n.formData),c=n.formData;else if(n.body instanceof FormData)l=Xp(n.body),c=n.body;else if(n.body instanceof URLSearchParams)l=n.body,c=Y1(l);else if(n.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(n.body),c=Y1(l)}catch{return s()}let u={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(Xn(u.formMethod))return{path:r,submission:u};let h=ia(r);return e&&h.search&&Dg(h.search)&&l.append("index",""),h.search="?"+l,{path:Ma(h),submission:u}}function W1(t,e,r){r===void 0&&(r=!1);let n=t.findIndex(s=>s.route.id===e);return n>=0?t.slice(0,r?n+1:n):t}function G1(t,e,r,n,s,i,a,o,l,c,u,h,p,m,x,v){let y=v?gn(v[1])?v[1].error:v[1].data:void 0,T=t.createURL(e.location),k=t.createURL(s),w=r;i&&e.errors?w=W1(r,Object.keys(e.errors)[0],!0):v&&gn(v[1])&&(w=W1(r,v[0]));let D=v?v[1].statusCode:void 0,U=a&&D&&D>=400,V=w.filter((E,S)=>{let{route:C}=E;if(C.lazy)return!0;if(C.loader==null)return!1;if(i)return qp(C,e.loaderData,e.errors);if(BR(e.loaderData,e.matches[S],E)||l.some(b=>b===E.route.id))return!0;let P=e.matches[S],R=E;return K1(E,Mt({currentUrl:T,currentParams:P.params,nextUrl:k,nextParams:R.params},n,{actionResult:y,actionStatus:D,defaultShouldRevalidate:U?!1:o||T.pathname+T.search===k.pathname+k.search||T.search!==k.search||tT(P,R)}))}),g=[];return h.forEach((E,S)=>{if(i||!r.some(ce=>ce.route.id===E.routeId)||u.has(S))return;let C=pa(m,E.path,x);if(!C){g.push({key:S,routeId:E.routeId,path:E.path,matches:null,match:null,controller:null});return}let P=e.fetchers.get(S),R=ql(C,E.path),b=!1;p.has(S)?b=!1:c.has(S)?(c.delete(S),b=!0):P&&P.state!=="idle"&&P.data===void 0?b=o:b=K1(R,Mt({currentUrl:T,currentParams:e.matches[e.matches.length-1].params,nextUrl:k,nextParams:r[r.length-1].params},n,{actionResult:y,actionStatus:D,defaultShouldRevalidate:U?!1:o})),b&&g.push({key:S,routeId:E.routeId,path:E.path,matches:C,match:R,controller:new AbortController})}),[V,g]}function qp(t,e,r){if(t.lazy)return!0;if(!t.loader)return!1;let n=e!=null&&e[t.id]!==void 0,s=r!=null&&r[t.id]!==void 0;return!n&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!n&&!s}function BR(t,e,r){let n=!e||r.route.id!==e.route.id,s=t[r.route.id]===void 0;return n||s}function tT(t,e){let r=t.route.path;return t.pathname!==e.pathname||r!=null&&r.endsWith("*")&&t.params["*"]!==e.params["*"]}function K1(t,e){if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate(e);if(typeof r=="boolean")return r}return e.defaultShouldRevalidate}function q1(t,e,r,n,s){var i;let a;if(t){let c=n[t];et(c,"No route found to patch children into: routeId = "+t),c.children||(c.children=[]),a=c.children}else a=r;let o=e.filter(c=>!a.some(u=>rT(c,u))),l=yh(o,s,[t||"_","patch",String(((i=a)==null?void 0:i.length)||"0")],n);a.push(...l)}function rT(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((r,n)=>{var s;return(s=e.children)==null?void 0:s.some(i=>rT(r,i))}):!1}async function zR(t,e,r){if(!t.lazy)return;let n=await t.lazy();if(!t.lazy)return;let s=r[t.id];et(s,"No route found in manifest");let i={};for(let a in n){let l=s[a]!==void 0&&a!=="hasErrorBoundary";Zo(!l,'Route "'+s.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!l&&!hR.has(a)&&(i[a]=n[a])}Object.assign(s,i),Object.assign(s,Mt({},e(s),{lazy:void 0}))}async function $R(t){let{matches:e}=t,r=e.filter(s=>s.shouldLoad);return(await Promise.all(r.map(s=>s.resolve()))).reduce((s,i,a)=>Object.assign(s,{[r[a].route.id]:i}),{})}async function HR(t,e,r,n,s,i,a,o,l,c){let u=i.map(m=>m.route.lazy?zR(m.route,l,o):void 0),h=i.map((m,x)=>{let v=u[x],y=s.some(k=>k.route.id===m.route.id);return Mt({},m,{shouldLoad:y,resolve:async k=>(k&&n.method==="GET"&&(m.route.lazy||m.route.loader)&&(y=!0),y?WR(e,n,m,v,k,c):Promise.resolve({type:At.data,result:void 0}))})}),p=await t({matches:h,request:n,params:i[0].params,fetcherKey:a,context:c});try{await Promise.all(u)}catch{}return p}async function WR(t,e,r,n,s,i){let a,o,l=c=>{let u,h=new Promise((x,v)=>u=v);o=()=>u(),e.signal.addEventListener("abort",o);let p=x=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+r.route.id+"]"))):c({request:e,params:r.params,context:i},...x!==void 0?[x]:[]),m=(async()=>{try{return{type:"data",result:await(s?s(v=>p(v)):p())}}catch(x){return{type:"error",result:x}}})();return Promise.race([m,h])};try{let c=r.route[t];if(n)if(c){let u,[h]=await Promise.all([l(c).catch(p=>{u=p}),n]);if(u!==void 0)throw u;a=h}else if(await n,c=r.route[t],c)a=await l(c);else if(t==="action"){let u=new URL(e.url),h=u.pathname+u.search;throw sn(405,{method:e.method,pathname:h,routeId:r.route.id})}else return{type:At.data,result:void 0};else if(c)a=await l(c);else{let u=new URL(e.url),h=u.pathname+u.search;throw sn(404,{pathname:h})}et(a.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:At.error,result:c}}finally{o&&e.signal.removeEventListener("abort",o)}return a}async function GR(t){let{result:e,type:r}=t;if(sT(e)){let h;try{let p=e.headers.get("Content-Type");p&&/\bapplication\/json\b/.test(p)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(p){return{type:At.error,error:p}}return r===At.error?{type:At.error,error:new Eh(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:At.data,data:h,statusCode:e.status,headers:e.headers}}if(r===At.error){if(t_(e)){var n,s;if(e.data instanceof Error){var i,a;return{type:At.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}}return{type:At.error,error:new Eh(((n=e.init)==null?void 0:n.status)||500,void 0,e.data),statusCode:Wc(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:At.error,error:e,statusCode:Wc(e)?e.status:void 0}}if(QR(e)){var o,l;return{type:At.deferred,deferredData:e,statusCode:(o=e.init)==null?void 0:o.status,headers:((l=e.init)==null?void 0:l.headers)&&new Headers(e.init.headers)}}if(t_(e)){var c,u;return{type:At.data,data:e.data,statusCode:(c=e.init)==null?void 0:c.status,headers:(u=e.init)!=null&&u.headers?new Headers(e.init.headers):void 0}}return{type:At.data,data:e}}function KR(t,e,r,n,s,i){let a=t.headers.get("Location");if(et(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!Ng.test(a)){let o=n.slice(0,n.findIndex(l=>l.route.id===r)+1);a=Kp(new URL(e.url),o,s,!0,a,i),t.headers.set("Location",a)}return t}function X1(t,e,r){if(Ng.test(t)){let n=t,s=n.startsWith("//")?new URL(e.protocol+n):new URL(n),i=si(s.pathname,r)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function ho(t,e,r,n){let s=t.createURL(nT(e)).toString(),i={signal:r};if(n&&Xn(n.formMethod)){let{formMethod:a,formEncType:o}=n;i.method=a.toUpperCase(),o==="application/json"?(i.headers=new Headers({"Content-Type":o}),i.body=JSON.stringify(n.json)):o==="text/plain"?i.body=n.text:o==="application/x-www-form-urlencoded"&&n.formData?i.body=Xp(n.formData):i.body=n.formData}return new Request(s,i)}function Xp(t){let e=new URLSearchParams;for(let[r,n]of t.entries())e.append(r,typeof n=="string"?n:n.name);return e}function Y1(t){let e=new FormData;for(let[r,n]of t.entries())e.append(r,n);return e}function qR(t,e,r,n,s){let i={},a=null,o,l=!1,c={},u=r&&gn(r[1])?r[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let p=h.route.id,m=e[p];if(et(!ya(m),"Cannot handle redirect results in processLoaderData"),gn(m)){let x=m.error;u!==void 0&&(x=u,u=void 0),a=a||{};{let v=ma(t,p);a[v.route.id]==null&&(a[v.route.id]=x)}i[p]=void 0,l||(l=!0,o=Wc(m.error)?m.error.status:500),m.headers&&(c[p]=m.headers)}else Di(m)?(n.set(p,m.deferredData),i[p]=m.deferredData.data,m.statusCode!=null&&m.statusCode!==200&&!l&&(o=m.statusCode),m.headers&&(c[p]=m.headers)):(i[p]=m.data,m.statusCode&&m.statusCode!==200&&!l&&(o=m.statusCode),m.headers&&(c[p]=m.headers))}),u!==void 0&&r&&(a={[r[0]]:u},i[r[0]]=void 0),{loaderData:i,errors:a,statusCode:o||200,loaderHeaders:c}}function Q1(t,e,r,n,s,i,a){let{loaderData:o,errors:l}=qR(e,r,n,a);return s.forEach(c=>{let{key:u,match:h,controller:p}=c,m=i[u];if(et(m,"Did not find corresponding fetcher result"),!(p&&p.signal.aborted))if(gn(m)){let x=ma(t.matches,h==null?void 0:h.route.id);l&&l[x.route.id]||(l=Mt({},l,{[x.route.id]:m.error})),t.fetchers.delete(u)}else if(ya(m))et(!1,"Unhandled fetcher revalidation redirect");else if(Di(m))et(!1,"Unhandled fetcher deferred data");else{let x=wi(m.data);t.fetchers.set(u,x)}}),{loaderData:o,errors:l}}function J1(t,e,r,n){let s=Mt({},e);for(let i of r){let a=i.route.id;if(e.hasOwnProperty(a)?e[a]!==void 0&&(s[a]=e[a]):t[a]!==void 0&&i.route.loader&&(s[a]=t[a]),n&&n.hasOwnProperty(a))break}return s}function Z1(t){return t?gn(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function ma(t,e){return(e?t.slice(0,t.findIndex(n=>n.route.id===e)+1):[...t]).reverse().find(n=>n.route.hasErrorBoundary===!0)||t[0]}function e_(t){let e=t.length===1?t[0]:t.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function sn(t,e){let{pathname:r,routeId:n,method:s,type:i,message:a}=e===void 0?{}:e,o="Unknown Server Error",l="Unknown @remix-run/router error";return t===400?(o="Bad Request",s&&r&&n?l="You made a "+s+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":i==="defer-action"?l="defer() is not supported in actions":i==="invalid-body"&&(l="Unable to encode submission body")):t===403?(o="Forbidden",l='Route "'+n+'" does not match URL "'+r+'"'):t===404?(o="Not Found",l='No route matches URL "'+r+'"'):t===405&&(o="Method Not Allowed",s&&r&&n?l="You made a "+s.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":s&&(l='Invalid request method "'+s.toUpperCase()+'"')),new Eh(t||500,o,new Error(l),!0)}function hf(t){let e=Object.entries(t);for(let r=e.length-1;r>=0;r--){let[n,s]=e[r];if(ya(s))return{key:n,result:s}}}function nT(t){let e=typeof t=="string"?ia(t):t;return Ma(Mt({},e,{hash:""}))}function XR(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function YR(t){return sT(t.result)&&OR.has(t.result.status)}function Di(t){return t.type===At.deferred}function gn(t){return t.type===At.error}function ya(t){return(t&&t.type)===At.redirect}function t_(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function QR(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function sT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function JR(t){return bR.has(t.toLowerCase())}function Xn(t){return DR.has(t.toLowerCase())}async function ZR(t,e,r,n,s){let i=Object.entries(e);for(let a=0;a<i.length;a++){let[o,l]=i[a],c=t.find(p=>(p==null?void 0:p.route.id)===o);if(!c)continue;let u=n.find(p=>p.route.id===c.route.id),h=u!=null&&!tT(u,c)&&(s&&s[c.route.id])!==void 0;Di(l)&&h&&await Pg(l,r,!1).then(p=>{p&&(e[o]=p)})}}async function eN(t,e,r){for(let n=0;n<r.length;n++){let{key:s,routeId:i,controller:a}=r[n],o=e[s];t.find(c=>(c==null?void 0:c.route.id)===i)&&Di(o)&&(et(a,"Expected an AbortController for revalidating fetcher deferred result"),await Pg(o,a.signal,!0).then(c=>{c&&(e[s]=c)}))}}async function Pg(t,e,r){if(r===void 0&&(r=!1),!await t.deferredData.resolveData(e)){if(r)try{return{type:At.data,data:t.deferredData.unwrappedData}}catch(s){return{type:At.error,error:s}}return{type:At.data,data:t.deferredData.data}}}function Dg(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function ql(t,e){let r=typeof e=="string"?ia(e).search:e.search;if(t[t.length-1].route.index&&Dg(r||""))return t[t.length-1];let n=J2(t);return n[n.length-1]}function r_(t){let{formMethod:e,formAction:r,formEncType:n,text:s,formData:i,json:a}=t;if(!(!e||!r||!n)){if(s!=null)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:r,formEncType:n,formData:i,json:void 0,text:void 0};if(a!==void 0)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:a,text:void 0}}}function I0(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function tN(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Bl(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function rN(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function wi(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function nN(t,e){try{let r=t.sessionStorage.getItem(eT);if(r){let n=JSON.parse(r);for(let[s,i]of Object.entries(n||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function sN(t,e){if(e.size>0){let r={};for(let[n,s]of e)r[n]=[...s];try{t.sessionStorage.setItem(eT,JSON.stringify(r))}catch(n){Zo(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Th(){return Th=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Th.apply(this,arguments)}const mu=X.createContext(null),Fg=X.createContext(null),hi=X.createContext(null),bg=X.createContext(null),Cs=X.createContext({outlet:null,matches:[],isDataRoute:!1}),iT=X.createContext(null);function iN(t,e){let{relative:r}=e===void 0?{}:e;pl()||et(!1);let{basename:n,navigator:s}=X.useContext(hi),{hash:i,pathname:a,search:o}=_d(t,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:Ys([n,a])),s.createHref({pathname:l,search:o,hash:i})}function pl(){return X.useContext(bg)!=null}function Ka(){return pl()||et(!1),X.useContext(bg).location}function aT(t){X.useContext(hi).static||X.useLayoutEffect(t)}function qa(){let{isDataRoute:t}=X.useContext(Cs);return t?yN():aN()}function aN(){pl()||et(!1);let t=X.useContext(mu),{basename:e,future:r,navigator:n}=X.useContext(hi),{matches:s}=X.useContext(Cs),{pathname:i}=Ka(),a=JSON.stringify(vd(s,r.v7_relativeSplatPath)),o=X.useRef(!1);return aT(()=>{o.current=!0}),X.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=xd(c,JSON.parse(a),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ys([e,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[e,n,a,i,t])}const oN=X.createContext(null);function lN(t){let e=X.useContext(Cs).outlet;return e&&X.createElement(oN.Provider,{value:t},e)}function cN(){let{matches:t}=X.useContext(Cs),e=t[t.length-1];return e?e.params:{}}function _d(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=X.useContext(hi),{matches:s}=X.useContext(Cs),{pathname:i}=Ka(),a=JSON.stringify(vd(s,n.v7_relativeSplatPath));return X.useMemo(()=>xd(t,JSON.parse(a),i,r==="path"),[t,a,i,r])}function uN(t,e,r,n){pl()||et(!1);let{navigator:s}=X.useContext(hi),{matches:i}=X.useContext(Cs),a=i[i.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let c=Ka(),u;u=c;let h=u.pathname||"/",p=h;if(l!=="/"){let v=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=pa(t,{pathname:p});return mN(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:Ys([l,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:Ys([l,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,r,n)}function fN(){let t=_N(),e=Wc(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},e),r?X.createElement("pre",{style:s},r):null,null)}const hN=X.createElement(fN,null);class dN extends X.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?X.createElement(Cs.Provider,{value:this.props.routeContext},X.createElement(iT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function pN(t){let{routeContext:e,match:r,children:n}=t,s=X.useContext(mu);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),X.createElement(Cs.Provider,{value:e},n)}function mN(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=(s=r)==null?void 0:s.errors;if(o!=null){let u=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);u>=0||et(!1),a=a.slice(0,Math.min(a.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<a.length;u++){let h=a[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:p,errors:m}=r,x=h.route.loader&&p[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||x){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((u,h,p)=>{let m,x=!1,v=null,y=null;r&&(m=o&&h.route.id?o[h.route.id]:void 0,v=h.route.errorElement||hN,l&&(c<0&&p===0?(wN("route-fallback"),x=!0,y=null):c===p&&(x=!0,y=h.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,p+1)),k=()=>{let w;return m?w=v:x?w=y:h.route.Component?w=X.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=u,X.createElement(pN,{match:h,routeContext:{outlet:u,matches:T,isDataRoute:r!=null},children:w})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?X.createElement(dN,{location:r.location,revalidation:r.revalidation,component:v,error:m,children:k(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):k()},null)}var oT=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(oT||{}),lT=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(lT||{});function gN(t){let e=X.useContext(mu);return e||et(!1),e}function vN(t){let e=X.useContext(Fg);return e||et(!1),e}function xN(t){let e=X.useContext(Cs);return e||et(!1),e}function cT(t){let e=xN(),r=e.matches[e.matches.length-1];return r.route.id||et(!1),r.route.id}function _N(){var t;let e=X.useContext(iT),r=vN(lT.UseRouteError),n=cT();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function yN(){let{router:t}=gN(oT.UseNavigateStable),e=cT(),r=X.useRef(!1);return aT(()=>{r.current=!0}),X.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Th({fromRouteId:e},i)))},[t,e])}const n_={};function wN(t,e,r){n_[t]||(n_[t]=!0)}function EN(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function TN(t){let{to:e,replace:r,state:n,relative:s}=t;pl()||et(!1);let{future:i,static:a}=X.useContext(hi),{matches:o}=X.useContext(Cs),{pathname:l}=Ka(),c=qa(),u=xd(e,vd(o,i.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(u);return X.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:s}),[c,h,s,r,n]),null}function uT(t){return lN(t.context)}function kN(t){let{basename:e="/",children:r=null,location:n,navigationType:s=tr.Pop,navigator:i,static:a=!1,future:o}=t;pl()&&et(!1);let l=e.replace(/^\/*/,"/"),c=X.useMemo(()=>({basename:l,navigator:i,static:a,future:Th({v7_relativeSplatPath:!1},o)}),[l,o,i,a]);typeof n=="string"&&(n=ia(n));let{pathname:u="/",search:h="",hash:p="",state:m=null,key:x="default"}=n,v=X.useMemo(()=>{let y=si(u,l);return y==null?null:{location:{pathname:y,search:h,hash:p,state:m,key:x},navigationType:s}},[l,u,h,p,m,x,s]);return v==null?null:X.createElement(hi.Provider,{value:c},X.createElement(bg.Provider,{children:r,value:v}))}new Promise(()=>{});function SN(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:X.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:X.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:X.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function el(){return el=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},el.apply(this,arguments)}function fT(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function AN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function IN(t,e){return t.button===0&&(!e||e==="_self")&&!AN(t)}const CN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],RN=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],NN="6";try{window.__reactRouterVersion=NN}catch{}function PN(t,e){return VR({basename:void 0,future:el({},void 0,{v7_prependBasename:!0}),history:cR({window:void 0}),hydrationData:DN(),routes:t,mapRouteProperties:SN,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function DN(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=el({},e,{errors:FN(e.errors)})),e}function FN(t){if(!t)return null;let e=Object.entries(t),r={};for(let[n,s]of e)if(s&&s.__type==="RouteErrorResponse")r[n]=new Eh(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let a=new i(s.message);a.stack="",r[n]=a}catch{}}if(r[n]==null){let i=new Error(s.message);i.stack="",r[n]=i}}else r[n]=s;return r}const hT=X.createContext({isTransitioning:!1}),bN=X.createContext(new Map),ON="startTransition",s_=YI[ON],MN="flushSync",i_=lR[MN];function LN(t){s_?s_(t):t()}function zl(t){i_?i_(t):t()}let jN=class{constructor(){this.status="pending",this.promise=new Promise((e,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}};function VN(t){let{fallbackElement:e,router:r,future:n}=t,[s,i]=X.useState(r.state),[a,o]=X.useState(),[l,c]=X.useState({isTransitioning:!1}),[u,h]=X.useState(),[p,m]=X.useState(),[x,v]=X.useState(),y=X.useRef(new Map),{v7_startTransition:T}=n||{},k=X.useCallback(E=>{T?LN(E):E()},[T]),w=X.useCallback((E,S)=>{let{deletedFetchers:C,flushSync:P,viewTransitionOpts:R}=S;E.fetchers.forEach((ce,fe)=>{ce.data!==void 0&&y.current.set(fe,ce.data)}),C.forEach(ce=>y.current.delete(ce));let b=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!R||b){P?zl(()=>i(E)):k(()=>i(E));return}if(P){zl(()=>{p&&(u&&u.resolve(),p.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:R.currentLocation,nextLocation:R.nextLocation})});let ce=r.window.document.startViewTransition(()=>{zl(()=>i(E))});ce.finished.finally(()=>{zl(()=>{h(void 0),m(void 0),o(void 0),c({isTransitioning:!1})})}),zl(()=>m(ce));return}p?(u&&u.resolve(),p.skipTransition(),v({state:E,currentLocation:R.currentLocation,nextLocation:R.nextLocation})):(o(E),c({isTransitioning:!0,flushSync:!1,currentLocation:R.currentLocation,nextLocation:R.nextLocation}))},[r.window,p,u,y,k]);X.useLayoutEffect(()=>r.subscribe(w),[r,w]),X.useEffect(()=>{l.isTransitioning&&!l.flushSync&&h(new jN)},[l]),X.useEffect(()=>{if(u&&a&&r.window){let E=a,S=u.promise,C=r.window.document.startViewTransition(async()=>{k(()=>i(E)),await S});C.finished.finally(()=>{h(void 0),m(void 0),o(void 0),c({isTransitioning:!1})}),m(C)}},[k,a,u,r.window]),X.useEffect(()=>{u&&a&&s.location.key===a.location.key&&u.resolve()},[u,p,s.location,a]),X.useEffect(()=>{!l.isTransitioning&&x&&(o(x.state),c({isTransitioning:!0,flushSync:!1,currentLocation:x.currentLocation,nextLocation:x.nextLocation}),v(void 0))},[l.isTransitioning,x]),X.useEffect(()=>{},[]);let D=X.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:E=>r.navigate(E),push:(E,S,C)=>r.navigate(E,{state:S,preventScrollReset:C==null?void 0:C.preventScrollReset}),replace:(E,S,C)=>r.navigate(E,{replace:!0,state:S,preventScrollReset:C==null?void 0:C.preventScrollReset})}),[r]),U=r.basename||"/",V=X.useMemo(()=>({router:r,navigator:D,static:!1,basename:U}),[r,D,U]),g=X.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return X.useEffect(()=>EN(n,r.future),[n,r.future]),X.createElement(X.Fragment,null,X.createElement(mu.Provider,{value:V},X.createElement(Fg.Provider,{value:s},X.createElement(bN.Provider,{value:y.current},X.createElement(hT.Provider,{value:l},X.createElement(kN,{basename:U,location:s.location,navigationType:s.historyAction,navigator:D,future:g},s.initialized||r.future.v7_partialHydration?X.createElement(UN,{routes:r.routes,future:r.future,state:s}):e))))),null)}const UN=X.memo(BN);function BN(t){let{routes:e,future:r,state:n}=t;return uN(e,void 0,n,r)}const zN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$N=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vt=X.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:i,replace:a,state:o,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,p=fT(e,CN),{basename:m}=X.useContext(hi),x,v=!1;if(typeof c=="string"&&$N.test(c)&&(x=c,zN))try{let w=new URL(window.location.href),D=c.startsWith("//")?new URL(w.protocol+c):new URL(c),U=si(D.pathname,m);D.origin===w.origin&&U!=null?c=U+D.search+D.hash:v=!0}catch{}let y=iN(c,{relative:s}),T=WN(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:s,viewTransition:h});function k(w){n&&n(w),w.defaultPrevented||T(w)}return X.createElement("a",el({},p,{href:x||y,onClick:v||i?n:k,ref:r,target:l}))}),ua=X.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:s=!1,className:i="",end:a=!1,style:o,to:l,viewTransition:c,children:u}=e,h=fT(e,RN),p=_d(l,{relative:h.relative}),m=Ka(),x=X.useContext(Fg),{navigator:v,basename:y}=X.useContext(hi),T=x!=null&&GN(p)&&c===!0,k=v.encodeLocation?v.encodeLocation(p).pathname:p.pathname,w=m.pathname,D=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;s||(w=w.toLowerCase(),D=D?D.toLowerCase():null,k=k.toLowerCase()),D&&y&&(D=si(D,y)||D);const U=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let V=w===k||!a&&w.startsWith(k)&&w.charAt(U)==="/",g=D!=null&&(D===k||!a&&D.startsWith(k)&&D.charAt(k.length)==="/"),E={isActive:V,isPending:g,isTransitioning:T},S=V?n:void 0,C;typeof i=="function"?C=i(E):C=[i,V?"active":null,g?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let P=typeof o=="function"?o(E):o;return X.createElement(vt,el({},h,{"aria-current":S,className:C,ref:r,style:P,to:l,viewTransition:c}),typeof u=="function"?u(E):u)});var Yp;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Yp||(Yp={}));var a_;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(a_||(a_={}));function HN(t){let e=X.useContext(mu);return e||et(!1),e}function WN(t,e){let{target:r,replace:n,state:s,preventScrollReset:i,relative:a,viewTransition:o}=e===void 0?{}:e,l=qa(),c=Ka(),u=_d(t,{relative:a});return X.useCallback(h=>{if(IN(h,r)){h.preventDefault();let p=n!==void 0?n:Ma(c)===Ma(u);l(t,{replace:p,state:s,preventScrollReset:i,relative:a,viewTransition:o})}},[c,l,u,n,s,r,t,i,a,o])}function GN(t,e){e===void 0&&(e={});let r=X.useContext(hT);r==null&&et(!1);let{basename:n}=HN(Yp.useViewTransitionState),s=_d(t,{relative:e.relative});if(!r.isTransitioning)return!1;let i=si(r.currentLocation.pathname,n)||r.currentLocation.pathname,a=si(r.nextLocation.pathname,n)||r.nextLocation.pathname;return wh(s.pathname,a)!=null||wh(s.pathname,i)!=null}var o_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},KN=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},pT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,h=(i&3)<<4|o>>4;let p=(o&15)<<2|c>>6,m=c&63;l||(m=64,a||(p=64)),n.push(r[u],r[h],r[p],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(dT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):KN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||c==null||h==null)throw new qN;const p=i<<2|o>>4;if(n.push(p),c!==64){const m=o<<4&240|c>>2;if(n.push(m),h!==64){const x=c<<6&192|h;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class qN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const XN=function(t){const e=dT(t);return pT.encodeByteArray(e,!0)},kh=function(t){return XN(t).replace(/\./g,"")},mT=function(t){try{return pT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN=()=>YN().__FIREBASE_DEFAULTS__,JN=()=>{if(typeof process>"u"||typeof o_>"u")return;const t=o_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ZN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&mT(t[1]);return e&&JSON.parse(e)},yd=()=>{try{return QN()||JN()||ZN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},gT=t=>{var e,r;return(r=(e=yd())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Og=t=>{const e=gT(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},vT=()=>{var t;return(t=yd())===null||t===void 0?void 0:t.config},xT=t=>{var e;return(e=yd())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[kh(JSON.stringify(r)),kh(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Hr())}function rP(){var t;const e=(t=yd())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sP(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function iP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function aP(){const t=Hr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function oP(){return!rP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function lP(){try{return typeof indexedDB=="object"}catch{return!1}}function cP(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uP="FirebaseError";class Rs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=uP,Object.setPrototypeOf(this,Rs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gu.prototype.create)}}class gu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?fP(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new Rs(s,o,n)}}function fP(t,e){return t.replace(hP,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const hP=/\{\$([^}]+)}/g;function dP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Sh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(l_(i)&&l_(a)){if(!Sh(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function l_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function pP(t,e){const r=new mP(t,e);return r.subscribe.bind(r)}class mP{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");gP(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=C0),s.error===void 0&&(s.error=C0),s.complete===void 0&&(s.complete=C0);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gP(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function C0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sr(t){return t&&t._delegate?t._delegate:t}class ii{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const da="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new eP;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_P(e))try{this.getOrInitializeService({instanceIdentifier:da})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=da){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=da){return this.instances.has(e)}getOptions(e=da){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:xP(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=da){return this.component?this.component.multipleInstances?e:da:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xP(t){return t===da?void 0:t}function _P(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new vP(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ot;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ot||(ot={}));const wP={debug:ot.DEBUG,verbose:ot.VERBOSE,info:ot.INFO,warn:ot.WARN,error:ot.ERROR,silent:ot.SILENT},EP=ot.INFO,TP={[ot.DEBUG]:"log",[ot.VERBOSE]:"log",[ot.INFO]:"info",[ot.WARN]:"warn",[ot.ERROR]:"error"},kP=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=TP[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Mg{constructor(e){this.name=e,this._logLevel=EP,this._logHandler=kP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ot))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ot.DEBUG,...e),this._logHandler(this,ot.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ot.VERBOSE,...e),this._logHandler(this,ot.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ot.INFO,...e),this._logHandler(this,ot.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ot.WARN,...e),this._logHandler(this,ot.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ot.ERROR,...e),this._logHandler(this,ot.ERROR,...e)}}const SP=(t,e)=>e.some(r=>t instanceof r);let c_,u_;function AP(){return c_||(c_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function IP(){return u_||(u_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yT=new WeakMap,Qp=new WeakMap,wT=new WeakMap,R0=new WeakMap,Lg=new WeakMap;function CP(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(Hi(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&yT.set(r,t)}).catch(()=>{}),Lg.set(e,t),e}function RP(t){if(Qp.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Qp.set(t,e)}let Jp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Qp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||wT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Hi(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function NP(t){Jp=t(Jp)}function PP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(N0(this),e,...r);return wT.set(n,e.sort?e.sort():[e]),Hi(n)}:IP().includes(t)?function(...e){return t.apply(N0(this),e),Hi(yT.get(this))}:function(...e){return Hi(t.apply(N0(this),e))}}function DP(t){return typeof t=="function"?PP(t):(t instanceof IDBTransaction&&RP(t),SP(t,AP())?new Proxy(t,Jp):t)}function Hi(t){if(t instanceof IDBRequest)return CP(t);if(R0.has(t))return R0.get(t);const e=DP(t);return e!==t&&(R0.set(t,e),Lg.set(e,t)),e}const N0=t=>Lg.get(t);function FP(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=Hi(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Hi(a.result),l.oldVersion,l.newVersion,Hi(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const bP=["get","getKey","getAll","getAllKeys","count"],OP=["put","add","delete","clear"],P0=new Map;function f_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(P0.get(e))return P0.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=OP.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||bP.includes(r)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return P0.set(e,i),i}NP(t=>({...t,get:(e,r,n)=>f_(e,r)||t.get(e,r,n),has:(e,r)=>!!f_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(LP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function LP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Zp="@firebase/app",h_="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai=new Mg("@firebase/app"),jP="@firebase/app-compat",VP="@firebase/analytics-compat",UP="@firebase/analytics",BP="@firebase/app-check-compat",zP="@firebase/app-check",$P="@firebase/auth",HP="@firebase/auth-compat",WP="@firebase/database",GP="@firebase/data-connect",KP="@firebase/database-compat",qP="@firebase/functions",XP="@firebase/functions-compat",YP="@firebase/installations",QP="@firebase/installations-compat",JP="@firebase/messaging",ZP="@firebase/messaging-compat",eD="@firebase/performance",tD="@firebase/performance-compat",rD="@firebase/remote-config",nD="@firebase/remote-config-compat",sD="@firebase/storage",iD="@firebase/storage-compat",aD="@firebase/firestore",oD="@firebase/vertexai-preview",lD="@firebase/firestore-compat",cD="firebase",uD="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const em="[DEFAULT]",fD={[Zp]:"fire-core",[jP]:"fire-core-compat",[UP]:"fire-analytics",[VP]:"fire-analytics-compat",[zP]:"fire-app-check",[BP]:"fire-app-check-compat",[$P]:"fire-auth",[HP]:"fire-auth-compat",[WP]:"fire-rtdb",[GP]:"fire-data-connect",[KP]:"fire-rtdb-compat",[qP]:"fire-fn",[XP]:"fire-fn-compat",[YP]:"fire-iid",[QP]:"fire-iid-compat",[JP]:"fire-fcm",[ZP]:"fire-fcm-compat",[eD]:"fire-perf",[tD]:"fire-perf-compat",[rD]:"fire-rc",[nD]:"fire-rc-compat",[sD]:"fire-gcs",[iD]:"fire-gcs-compat",[aD]:"fire-fst",[lD]:"fire-fst-compat",[oD]:"fire-vertex","fire-js":"fire-js",[cD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=new Map,hD=new Map,tm=new Map;function d_(t,e){try{t.container.addComponent(e)}catch(r){ai.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Yi(t){const e=t.name;if(tm.has(e))return ai.debug(`There were multiple attempts to register component ${e}.`),!1;tm.set(e,t);for(const r of Ah.values())d_(r,t);for(const r of hD.values())d_(r,t);return!0}function xu(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Hs(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Wi=new gu("app","Firebase",dD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ii("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa=uD;function ET(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:em,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Wi.create("bad-app-name",{appName:String(s)});if(r||(r=vT()),!r)throw Wi.create("no-options");const i=Ah.get(s);if(i){if(Sh(r,i.options)&&Sh(n,i.config))return i;throw Wi.create("duplicate-app",{appName:s})}const a=new yP(s);for(const l of tm.values())a.addComponent(l);const o=new pD(r,n,a);return Ah.set(s,o),o}function wd(t=em){const e=Ah.get(t);if(!e&&t===em&&vT())return ET();if(!e)throw Wi.create("no-app",{appName:t});return e}function Mn(t,e,r){var n;let s=(n=fD[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${s}" with version "${e}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ai.warn(o.join(" "));return}Yi(new ii(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD="firebase-heartbeat-database",gD=1,Gc="firebase-heartbeat-store";let D0=null;function TT(){return D0||(D0=FP(mD,gD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Gc)}catch(r){console.warn(r)}}}}).catch(t=>{throw Wi.create("idb-open",{originalErrorMessage:t.message})})),D0}async function vD(t){try{const r=(await TT()).transaction(Gc),n=await r.objectStore(Gc).get(kT(t));return await r.done,n}catch(e){if(e instanceof Rs)ai.warn(e.message);else{const r=Wi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ai.warn(r.message)}}}async function p_(t,e){try{const n=(await TT()).transaction(Gc,"readwrite");await n.objectStore(Gc).put(e,kT(t)),await n.done}catch(r){if(r instanceof Rs)ai.warn(r.message);else{const n=Wi.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ai.warn(n.message)}}}function kT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD=1024,_D=30*24*60*60*1e3;class yD{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new ED(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=m_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=_D}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ai.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=m_(),{heartbeatsToSend:n,unsentEntries:s}=wD(this._heartbeatsCache.heartbeats),i=kh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return ai.warn(r),""}}}function m_(){return new Date().toISOString().substring(0,10)}function wD(t,e=xD){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),g_(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),g_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class ED{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return lP()?cP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await vD(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return p_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return p_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function g_(t){return kh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TD(t){Yi(new ii("platform-logger",e=>new MP(e),"PRIVATE")),Yi(new ii("heartbeat",e=>new yD(e),"PRIVATE")),Mn(Zp,h_,t),Mn(Zp,h_,"esm2017"),Mn("fire-js","")}TD("");function jg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function ST(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const kD=ST,AT=new gu("auth","Firebase",ST());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih=new Mg("@firebase/auth");function SD(t,...e){Ih.logLevel<=ot.WARN&&Ih.warn(`Auth (${Xa}): ${t}`,...e)}function Bf(t,...e){Ih.logLevel<=ot.ERROR&&Ih.error(`Auth (${Xa}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(t,...e){throw Ug(t,...e)}function ss(t,...e){return Ug(t,...e)}function Vg(t,e,r){const n=Object.assign(Object.assign({},kD()),{[e]:r});return new gu("auth","Firebase",n).create(e,{appName:t.name})}function Ia(t){return Vg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function AD(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&ks(t,"argument-error"),Vg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ug(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return AT.create(t,...e)}function ze(t,e,...r){if(!t)throw Ug(e,...r)}function Ws(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Bf(e),new Error(e)}function oi(t,e){t||Ws(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rm(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function ID(){return v_()==="http:"||v_()==="https:"}function v_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ID()||sP()||"connection"in navigator)?navigator.onLine:!0}function RD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e,r){this.shortDelay=e,this.longDelay=r,oi(r>e,"Short delay should be less than long delay!"),this.isMobile=tP()||iP()}get(){return CD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bg(t,e){oi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ws("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ws("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ws("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=new _u(3e4,6e4);function zg(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ml(t,e,r,n,s={}){return CT(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=vu(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},i);return nP()||(c.referrerPolicy="no-referrer"),IT.fetch()(RT(t,t.config.apiHost,r,o),c)})}async function CT(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},ND),e);try{const s=new FD(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw df(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw df(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw df(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw df(t,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Vg(t,u,c);ks(t,u)}}catch(s){if(s instanceof Rs)throw s;ks(t,"network-request-failed",{message:String(s)})}}async function DD(t,e,r,n,s={}){const i=await ml(t,e,r,n,s);return"mfaPendingCredential"in i&&ks(t,"multi-factor-auth-required",{_serverResponse:i}),i}function RT(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?Bg(t.config,s):`${t.config.apiScheme}://${s}`}class FD{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ss(this.auth,"network-request-failed")),PD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function df(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=ss(t,e,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bD(t,e){return ml(t,"POST","/v1/accounts:delete",e)}async function NT(t,e){return ml(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function PT(t,e=!1){const r=sr(t),n=await r.getIdToken(e),s=$g(n);ze(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:hc(F0(s.auth_time)),issuedAtTime:hc(F0(s.iat)),expirationTime:hc(F0(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function F0(t){return Number(t)*1e3}function $g(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Bf("JWT malformed, contained fewer than 3 sections"),null;try{const s=mT(r);return s?JSON.parse(s):(Bf("Failed to decode base64 JWT payload"),null)}catch(s){return Bf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function x_(t){const e=$g(t);return ze(e,"internal-error"),ze(typeof e.exp<"u","internal-error"),ze(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kc(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Rs&&OD(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function OD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=hc(this.lastLoginAt),this.creationTime=hc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ch(t){var e;const r=t.auth,n=await t.getIdToken(),s=await Kc(t,NT(r,{idToken:n}));ze(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?DT(i.providerUserInfo):[],o=jD(t.providerData,a),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new nm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function LD(t){const e=sr(t);await Ch(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function jD(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function DT(t){return t.map(e=>{var{providerId:r}=e,n=jg(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VD(t,e){const r=await CT(t,{},async()=>{const n=vu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=RT(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",IT.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function UD(t,e){return ml(t,"POST","/v2/accounts:revokeToken",zg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ze(e.idToken,"internal-error"),ze(typeof e.idToken<"u","internal-error"),ze(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):x_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ze(e.length!==0,"internal-error");const r=x_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ze(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await VD(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new jo;return n&&(ze(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(ze(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(ze(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jo,this.toJSON())}_performRefresh(){return Ws("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _i(t,e){ze(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Gs{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=jg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new MD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new nm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Kc(this,this.stsTokenManager.getToken(this.auth,e));return ze(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return PT(this,e)}reload(){return LD(this)}_assign(e){this!==e&&(ze(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Gs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){ze(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Ch(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Hs(this.auth.app))return Promise.reject(Ia(this.auth));const e=await this.getIdToken();return await Kc(this,bD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,a,o,l,c,u;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,p=(s=r.email)!==null&&s!==void 0?s:void 0,m=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,x=(a=r.photoURL)!==null&&a!==void 0?a:void 0,v=(o=r.tenantId)!==null&&o!==void 0?o:void 0,y=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,T=(c=r.createdAt)!==null&&c!==void 0?c:void 0,k=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:w,emailVerified:D,isAnonymous:U,providerData:V,stsTokenManager:g}=r;ze(w&&g,e,"internal-error");const E=jo.fromJSON(this.name,g);ze(typeof w=="string",e,"internal-error"),_i(h,e.name),_i(p,e.name),ze(typeof D=="boolean",e,"internal-error"),ze(typeof U=="boolean",e,"internal-error"),_i(m,e.name),_i(x,e.name),_i(v,e.name),_i(y,e.name),_i(T,e.name),_i(k,e.name);const S=new Gs({uid:w,auth:e,email:p,emailVerified:D,displayName:h,isAnonymous:U,photoURL:x,phoneNumber:m,tenantId:v,stsTokenManager:E,createdAt:T,lastLoginAt:k});return V&&Array.isArray(V)&&(S.providerData=V.map(C=>Object.assign({},C))),y&&(S._redirectEventId=y),S}static async _fromIdTokenResponse(e,r,n=!1){const s=new jo;s.updateFromServerResponse(r);const i=new Gs({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Ch(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];ze(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?DT(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new jo;o.updateFromIdToken(n);const l=new Gs({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new nm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const __=new Map;function Ks(t){oi(t instanceof Function,"Expected a class definition");let e=__.get(t);return e?(oi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,__.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}FT.type="NONE";const y_=FT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zf(t,e,r){return`firebase:${t}:${e}:${r}`}class Vo{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=zf(this.userKey,s.apiKey,i),this.fullPersistenceKey=zf("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Gs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Vo(Ks(y_),e,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Ks(y_);const a=zf(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const h=Gs._fromJSON(e,u);c!==i&&(o=h),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Vo(i,e,n):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new Vo(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(LT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(bT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(VT(e))return"Blackberry";if(UT(e))return"Webos";if(OT(e))return"Safari";if((e.includes("chrome/")||MT(e))&&!e.includes("edge/"))return"Chrome";if(jT(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function bT(t=Hr()){return/firefox\//i.test(t)}function OT(t=Hr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function MT(t=Hr()){return/crios\//i.test(t)}function LT(t=Hr()){return/iemobile/i.test(t)}function jT(t=Hr()){return/android/i.test(t)}function VT(t=Hr()){return/blackberry/i.test(t)}function UT(t=Hr()){return/webos/i.test(t)}function Hg(t=Hr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function BD(t=Hr()){var e;return Hg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function zD(){return aP()&&document.documentMode===10}function BT(t=Hr()){return Hg(t)||jT(t)||UT(t)||VT(t)||/windows phone/i.test(t)||LT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zT(t,e=[]){let r;switch(t){case"Browser":r=w_(Hr());break;case"Worker":r=`${w_(Hr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Xa}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HD(t,e={}){return ml(t,"GET","/v2/passwordPolicy",zg(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD=6;class GD{constructor(e){var r,n,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:WD,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new E_(this),this.idTokenSubscription=new E_(this),this.beforeStateQueue=new $D(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=AT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ks(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await Vo.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await NT(this,{idToken:e}),n=await Gs._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Hs(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ze(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Ch(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=RD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Hs(this.app))return Promise.reject(Ia(this));const r=e?sr(e):null;return r&&ze(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ze(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Hs(this.app)?Promise.reject(Ia(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Hs(this.app)?Promise.reject(Ia(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ks(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await HD(this),r=new GD(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new gu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await UD(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ks(e)||this._popupRedirectResolver;ze(r,this,"argument-error"),this.redirectPersistenceManager=await Vo.create(this,[Ks(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ze(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ze(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&SD(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Ed(t){return sr(t)}class E_{constructor(e){this.auth=e,this.observer=null,this.addObserver=pP(r=>this.observer=r)}get next(){return ze(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function qD(t){Wg=t}function XD(t){return Wg.loadJS(t)}function YD(){return Wg.gapiScript}function QD(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JD(t,e){const r=xu(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(Sh(i,e??{}))return s;ks(s,"already-initialized")}return r.initialize({options:e})}function ZD(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ks);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function eF(t,e,r){const n=Ed(t);ze(n._canInitEmulator,n,"emulator-config-failed"),ze(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=$T(e),{host:a,port:o}=tF(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${i}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),rF()}function $T(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function tF(t){const e=$T(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:T_(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:T_(a)}}}function T_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function rF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ws("not implemented")}_getIdTokenResponse(e){return Ws("not implemented")}_linkToIdToken(e,r){return Ws("not implemented")}_getReauthenticationResolver(e){return Ws("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uo(t,e){return DD(t,"POST","/v1/accounts:signInWithIdp",zg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nF="http://localhost";class La extends HT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new La(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ks("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=jg(r,["providerId","signInMethod"]);if(!n||!s)return null;const a=new La(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Uo(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Uo(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Uo(e,r)}buildRequest(){const e={requestUri:nF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=vu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu extends Gg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai extends yu{constructor(){super("facebook.com")}static credential(e){return La._fromParams({providerId:Ai.PROVIDER_ID,signInMethod:Ai.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ai.credentialFromTaggedObject(e)}static credentialFromError(e){return Ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ai.credential(e.oauthAccessToken)}catch{return null}}}Ai.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ai.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs extends yu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return La._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return xs.credentialFromTaggedObject(e)}static credentialFromError(e){return xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return xs.credential(r,n)}catch{return null}}}xs.GOOGLE_SIGN_IN_METHOD="google.com";xs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends yu{constructor(){super("github.com")}static credential(e){return La._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ii.credential(e.oauthAccessToken)}catch{return null}}}Ii.GITHUB_SIGN_IN_METHOD="github.com";Ii.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends yu{constructor(){super("twitter.com")}static credential(e,r){return La._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Ci.credential(r,n)}catch{return null}}}Ci.TWITTER_SIGN_IN_METHOD="twitter.com";Ci.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await Gs._fromIdTokenResponse(e,n,s),a=k_(n);return new tl({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=k_(n);return new tl({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function k_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh extends Rs{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Rh.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Rh(e,r,n,s)}}function WT(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Rh._fromErrorAndOperation(t,i,e,n):i})}async function sF(t,e,r=!1){const n=await Kc(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return tl._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iF(t,e,r=!1){const{auth:n}=t;if(Hs(n.app))return Promise.reject(Ia(n));const s="reauthenticate";try{const i=await Kc(t,WT(n,s,e,t),r);ze(i.idToken,n,"internal-error");const a=$g(i.idToken);ze(a,n,"internal-error");const{sub:o}=a;return ze(t.uid===o,n,"user-mismatch"),tl._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ks(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aF(t,e,r=!1){if(Hs(t.app))return Promise.reject(Ia(t));const n="signIn",s=await WT(t,n,e),i=await tl._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}function oF(t,e,r,n){return sr(t).onIdTokenChanged(e,r,n)}function lF(t,e,r){return sr(t).beforeAuthStateChanged(e,r)}function GT(t,e,r,n){return sr(t).onAuthStateChanged(e,r,n)}function cF(t){return sr(t).signOut()}const Nh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Nh,"1"),this.storage.removeItem(Nh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uF=1e3,fF=10;class qT extends KT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=BT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);zD()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,fF):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},uF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}qT.type="LOCAL";const hF=qT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT extends KT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}XT.type="SESSION";const YT=XT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new Td(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async c=>c(r.origin,i)),l=await dF(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Td.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const c=Kg("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(h){const p=h;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(p.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ws(){return window}function mF(t){ws().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QT(){return typeof ws().WorkerGlobalScope<"u"&&typeof ws().importScripts=="function"}async function gF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function xF(){return QT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JT="firebaseLocalStorageDb",_F=1,Ph="firebaseLocalStorage",ZT="fbase_key";class wu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function kd(t,e){return t.transaction([Ph],e?"readwrite":"readonly").objectStore(Ph)}function yF(){const t=indexedDB.deleteDatabase(JT);return new wu(t).toPromise()}function sm(){const t=indexedDB.open(JT,_F);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Ph,{keyPath:ZT})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Ph)?e(n):(n.close(),await yF(),e(await sm()))})})}async function S_(t,e,r){const n=kd(t,!0).put({[ZT]:e,value:r});return new wu(n).toPromise()}async function wF(t,e){const r=kd(t,!1).get(e),n=await new wu(r).toPromise();return n===void 0?null:n.value}function A_(t,e){const r=kd(t,!0).delete(e);return new wu(r).toPromise()}const EF=800,TF=3;class ek{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await sm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>TF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return QT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Td._getInstance(xF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await gF(),!this.activeServiceWorker)return;this.sender=new pF(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await sm();return await S_(e,Nh,"1"),await A_(e,Nh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>S_(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>wF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>A_(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=kd(s,!1).getAll();return new wu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),EF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ek.type="LOCAL";const kF=ek;new _u(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tk(t,e){return e?Ks(e):(ze(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg extends HT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Uo(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Uo(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Uo(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function SF(t){return aF(t.auth,new qg(t),t.bypassAuthState)}function AF(t){const{auth:e,user:r}=t;return ze(r,e,"internal-error"),iF(r,new qg(t),t.bypassAuthState)}async function IF(t){const{auth:e,user:r}=t;return ze(r,e,"internal-error"),sF(r,new qg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return SF;case"linkViaPopup":case"linkViaRedirect":return IF;case"reauthViaPopup":case"reauthViaRedirect":return AF;default:ks(this.auth,"internal-error")}}resolve(e){oi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){oi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CF=new _u(2e3,1e4);async function nk(t,e,r){if(Hs(t.app))return Promise.reject(ss(t,"operation-not-supported-in-this-environment"));const n=Ed(t);AD(t,e,Gg);const s=tk(n,r);return new wa(n,"signInViaPopup",e,s).executeNotNull()}class wa extends rk{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,wa.currentPopupAction&&wa.currentPopupAction.cancel(),wa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ze(e,this.auth,"internal-error"),e}async onExecution(){oi(this.filter.length===1,"Popup operations only handle one event");const e=Kg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ss(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ss(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ss(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,CF.get())};e()}}wa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RF="pendingRedirect",$f=new Map;class NF extends rk{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=$f.get(this.auth._key());if(!e){try{const n=await PF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}$f.set(this.auth._key(),e)}return this.bypassAuthState||$f.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PF(t,e){const r=bF(e),n=FF(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function DF(t,e){$f.set(t._key(),e)}function FF(t){return Ks(t._redirectPersistence)}function bF(t){return zf(RF,t.config.apiKey,t.name)}async function OF(t,e,r=!1){if(Hs(t.app))return Promise.reject(Ia(t));const n=Ed(t),s=tk(n,e),a=await new NF(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MF=10*60*1e3;class LF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!jF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!sk(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ss(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=MF&&this.cachedEventUids.clear(),this.cachedEventUids.has(I_(e))}saveEventToCache(e){this.cachedEventUids.add(I_(e)),this.lastProcessedEventTime=Date.now()}}function I_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function sk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function jF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VF(t,e={}){return ml(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,BF=/^https?/;async function zF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await VF(t);for(const r of e)try{if($F(r))return}catch{}ks(t,"unauthorized-domain")}function $F(t){const e=rm(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!BF.test(r))return!1;if(UF.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HF=new _u(3e4,6e4);function C_(){const t=ws().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function WF(t){return new Promise((e,r)=>{var n,s,i;function a(){C_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{C_(),r(ss(t,"network-request-failed"))},timeout:HF.get()})}if(!((s=(n=ws().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=ws().gapi)===null||i===void 0)&&i.load)a();else{const o=QD("iframefcb");return ws()[o]=()=>{gapi.load?a():r(ss(t,"network-request-failed"))},XD(`${YD()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Hf=null,e})}let Hf=null;function GF(t){return Hf=Hf||WF(t),Hf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF=new _u(5e3,15e3),qF="__/auth/iframe",XF="emulator/auth/iframe",YF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},QF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function JF(t){const e=t.config;ze(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Bg(e,XF):`https://${t.config.authDomain}/${qF}`,n={apiKey:e.apiKey,appName:t.name,v:Xa},s=QF.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${vu(n).slice(1)}`}async function ZF(t){const e=await GF(t),r=ws().gapi;return ze(r,t,"internal-error"),e.open({where:document.body,url:JF(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:YF,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=ss(t,"network-request-failed"),o=ws().setTimeout(()=>{i(a)},KF.get());function l(){ws().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},tb=500,rb=600,nb="_blank",sb="http://localhost";class R_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ib(t,e,r,n=tb,s=rb){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},eb),{width:n.toString(),height:s.toString(),top:i,left:a}),c=Hr().toLowerCase();r&&(o=MT(c)?nb:r),bT(c)&&(e=e||sb,l.scrollbars="yes");const u=Object.entries(l).reduce((p,[m,x])=>`${p}${m}=${x},`,"");if(BD(c)&&o!=="_self")return ab(e||"",o),new R_(null);const h=window.open(e||"",o,u);ze(h,t,"popup-blocked");try{h.focus()}catch{}return new R_(h)}function ab(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ob="__/auth/handler",lb="emulator/auth/handler",cb=encodeURIComponent("fac");async function N_(t,e,r,n,s,i){ze(t.config.authDomain,t,"auth-domain-config-required"),ze(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Xa,eventId:s};if(e instanceof Gg){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",dP(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))a[u]=h}if(e instanceof yu){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(a.scopes=u.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${cb}=${encodeURIComponent(l)}`:"";return`${ub(t)}?${vu(o).slice(1)}${c}`}function ub({config:t}){return t.emulator?Bg(t,lb):`https://${t.authDomain}/${ob}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0="webStorageSupport";class fb{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=YT,this._completeRedirectFn=OF,this._overrideRedirectResult=DF}async _openPopup(e,r,n,s){var i;oi((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await N_(e,r,n,rm(),s);return ib(e,a,Kg())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await N_(e,r,n,rm(),s);return mF(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(oi(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await ZF(e),n=new LF(e);return r.register("authEvent",s=>(ze(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(b0,{type:b0},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[b0];a!==void 0&&r(!!a),ks(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=zF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return BT()||OT()||Hg()}}const hb=fb;var P_="@firebase/auth",D_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ze(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pb(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mb(t){Yi(new ii("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;ze(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zT(t)},c=new KD(n,s,i,l);return ZD(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Yi(new ii("auth-internal",e=>{const r=Ed(e.getProvider("auth").getImmediate());return(n=>new db(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Mn(P_,D_,pb(t)),Mn(P_,D_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb=5*60,vb=xT("authIdTokenMaxAge")||gb;let F_=null;const xb=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>vb)return;const s=r==null?void 0:r.token;F_!==s&&(F_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function _b(t=wd()){const e=xu(t,"auth");if(e.isInitialized())return e.getImmediate();const r=JD(t,{popupRedirectResolver:hb,persistence:[kF,hF,YT]}),n=xT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=xb(i.toString());lF(r,a,()=>a(r.currentUser)),oF(r,o=>a(o))}}const s=gT("auth");return s&&eF(r,`http://${s}`),r}function yb(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}qD({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=ss("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",yb().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mb("Browser");var b_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ca,ik;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(g,E){function S(){}S.prototype=E.prototype,g.D=E.prototype,g.prototype=new S,g.prototype.constructor=g,g.C=function(C,P,R){for(var b=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)b[ce-2]=arguments[ce];return E.prototype[P].apply(C,b)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(g,E,S){S||(S=0);var C=Array(16);if(typeof E=="string")for(var P=0;16>P;++P)C[P]=E.charCodeAt(S++)|E.charCodeAt(S++)<<8|E.charCodeAt(S++)<<16|E.charCodeAt(S++)<<24;else for(P=0;16>P;++P)C[P]=E[S++]|E[S++]<<8|E[S++]<<16|E[S++]<<24;E=g.g[0],S=g.g[1],P=g.g[2];var R=g.g[3],b=E+(R^S&(P^R))+C[0]+3614090360&4294967295;E=S+(b<<7&4294967295|b>>>25),b=R+(P^E&(S^P))+C[1]+3905402710&4294967295,R=E+(b<<12&4294967295|b>>>20),b=P+(S^R&(E^S))+C[2]+606105819&4294967295,P=R+(b<<17&4294967295|b>>>15),b=S+(E^P&(R^E))+C[3]+3250441966&4294967295,S=P+(b<<22&4294967295|b>>>10),b=E+(R^S&(P^R))+C[4]+4118548399&4294967295,E=S+(b<<7&4294967295|b>>>25),b=R+(P^E&(S^P))+C[5]+1200080426&4294967295,R=E+(b<<12&4294967295|b>>>20),b=P+(S^R&(E^S))+C[6]+2821735955&4294967295,P=R+(b<<17&4294967295|b>>>15),b=S+(E^P&(R^E))+C[7]+4249261313&4294967295,S=P+(b<<22&4294967295|b>>>10),b=E+(R^S&(P^R))+C[8]+1770035416&4294967295,E=S+(b<<7&4294967295|b>>>25),b=R+(P^E&(S^P))+C[9]+2336552879&4294967295,R=E+(b<<12&4294967295|b>>>20),b=P+(S^R&(E^S))+C[10]+4294925233&4294967295,P=R+(b<<17&4294967295|b>>>15),b=S+(E^P&(R^E))+C[11]+2304563134&4294967295,S=P+(b<<22&4294967295|b>>>10),b=E+(R^S&(P^R))+C[12]+1804603682&4294967295,E=S+(b<<7&4294967295|b>>>25),b=R+(P^E&(S^P))+C[13]+4254626195&4294967295,R=E+(b<<12&4294967295|b>>>20),b=P+(S^R&(E^S))+C[14]+2792965006&4294967295,P=R+(b<<17&4294967295|b>>>15),b=S+(E^P&(R^E))+C[15]+1236535329&4294967295,S=P+(b<<22&4294967295|b>>>10),b=E+(P^R&(S^P))+C[1]+4129170786&4294967295,E=S+(b<<5&4294967295|b>>>27),b=R+(S^P&(E^S))+C[6]+3225465664&4294967295,R=E+(b<<9&4294967295|b>>>23),b=P+(E^S&(R^E))+C[11]+643717713&4294967295,P=R+(b<<14&4294967295|b>>>18),b=S+(R^E&(P^R))+C[0]+3921069994&4294967295,S=P+(b<<20&4294967295|b>>>12),b=E+(P^R&(S^P))+C[5]+3593408605&4294967295,E=S+(b<<5&4294967295|b>>>27),b=R+(S^P&(E^S))+C[10]+38016083&4294967295,R=E+(b<<9&4294967295|b>>>23),b=P+(E^S&(R^E))+C[15]+3634488961&4294967295,P=R+(b<<14&4294967295|b>>>18),b=S+(R^E&(P^R))+C[4]+3889429448&4294967295,S=P+(b<<20&4294967295|b>>>12),b=E+(P^R&(S^P))+C[9]+568446438&4294967295,E=S+(b<<5&4294967295|b>>>27),b=R+(S^P&(E^S))+C[14]+3275163606&4294967295,R=E+(b<<9&4294967295|b>>>23),b=P+(E^S&(R^E))+C[3]+4107603335&4294967295,P=R+(b<<14&4294967295|b>>>18),b=S+(R^E&(P^R))+C[8]+1163531501&4294967295,S=P+(b<<20&4294967295|b>>>12),b=E+(P^R&(S^P))+C[13]+2850285829&4294967295,E=S+(b<<5&4294967295|b>>>27),b=R+(S^P&(E^S))+C[2]+4243563512&4294967295,R=E+(b<<9&4294967295|b>>>23),b=P+(E^S&(R^E))+C[7]+1735328473&4294967295,P=R+(b<<14&4294967295|b>>>18),b=S+(R^E&(P^R))+C[12]+2368359562&4294967295,S=P+(b<<20&4294967295|b>>>12),b=E+(S^P^R)+C[5]+4294588738&4294967295,E=S+(b<<4&4294967295|b>>>28),b=R+(E^S^P)+C[8]+2272392833&4294967295,R=E+(b<<11&4294967295|b>>>21),b=P+(R^E^S)+C[11]+1839030562&4294967295,P=R+(b<<16&4294967295|b>>>16),b=S+(P^R^E)+C[14]+4259657740&4294967295,S=P+(b<<23&4294967295|b>>>9),b=E+(S^P^R)+C[1]+2763975236&4294967295,E=S+(b<<4&4294967295|b>>>28),b=R+(E^S^P)+C[4]+1272893353&4294967295,R=E+(b<<11&4294967295|b>>>21),b=P+(R^E^S)+C[7]+4139469664&4294967295,P=R+(b<<16&4294967295|b>>>16),b=S+(P^R^E)+C[10]+3200236656&4294967295,S=P+(b<<23&4294967295|b>>>9),b=E+(S^P^R)+C[13]+681279174&4294967295,E=S+(b<<4&4294967295|b>>>28),b=R+(E^S^P)+C[0]+3936430074&4294967295,R=E+(b<<11&4294967295|b>>>21),b=P+(R^E^S)+C[3]+3572445317&4294967295,P=R+(b<<16&4294967295|b>>>16),b=S+(P^R^E)+C[6]+76029189&4294967295,S=P+(b<<23&4294967295|b>>>9),b=E+(S^P^R)+C[9]+3654602809&4294967295,E=S+(b<<4&4294967295|b>>>28),b=R+(E^S^P)+C[12]+3873151461&4294967295,R=E+(b<<11&4294967295|b>>>21),b=P+(R^E^S)+C[15]+530742520&4294967295,P=R+(b<<16&4294967295|b>>>16),b=S+(P^R^E)+C[2]+3299628645&4294967295,S=P+(b<<23&4294967295|b>>>9),b=E+(P^(S|~R))+C[0]+4096336452&4294967295,E=S+(b<<6&4294967295|b>>>26),b=R+(S^(E|~P))+C[7]+1126891415&4294967295,R=E+(b<<10&4294967295|b>>>22),b=P+(E^(R|~S))+C[14]+2878612391&4294967295,P=R+(b<<15&4294967295|b>>>17),b=S+(R^(P|~E))+C[5]+4237533241&4294967295,S=P+(b<<21&4294967295|b>>>11),b=E+(P^(S|~R))+C[12]+1700485571&4294967295,E=S+(b<<6&4294967295|b>>>26),b=R+(S^(E|~P))+C[3]+2399980690&4294967295,R=E+(b<<10&4294967295|b>>>22),b=P+(E^(R|~S))+C[10]+4293915773&4294967295,P=R+(b<<15&4294967295|b>>>17),b=S+(R^(P|~E))+C[1]+2240044497&4294967295,S=P+(b<<21&4294967295|b>>>11),b=E+(P^(S|~R))+C[8]+1873313359&4294967295,E=S+(b<<6&4294967295|b>>>26),b=R+(S^(E|~P))+C[15]+4264355552&4294967295,R=E+(b<<10&4294967295|b>>>22),b=P+(E^(R|~S))+C[6]+2734768916&4294967295,P=R+(b<<15&4294967295|b>>>17),b=S+(R^(P|~E))+C[13]+1309151649&4294967295,S=P+(b<<21&4294967295|b>>>11),b=E+(P^(S|~R))+C[4]+4149444226&4294967295,E=S+(b<<6&4294967295|b>>>26),b=R+(S^(E|~P))+C[11]+3174756917&4294967295,R=E+(b<<10&4294967295|b>>>22),b=P+(E^(R|~S))+C[2]+718787259&4294967295,P=R+(b<<15&4294967295|b>>>17),b=S+(R^(P|~E))+C[9]+3951481745&4294967295,g.g[0]=g.g[0]+E&4294967295,g.g[1]=g.g[1]+(P+(b<<21&4294967295|b>>>11))&4294967295,g.g[2]=g.g[2]+P&4294967295,g.g[3]=g.g[3]+R&4294967295}n.prototype.u=function(g,E){E===void 0&&(E=g.length);for(var S=E-this.blockSize,C=this.B,P=this.h,R=0;R<E;){if(P==0)for(;R<=S;)s(this,g,R),R+=this.blockSize;if(typeof g=="string"){for(;R<E;)if(C[P++]=g.charCodeAt(R++),P==this.blockSize){s(this,C),P=0;break}}else for(;R<E;)if(C[P++]=g[R++],P==this.blockSize){s(this,C),P=0;break}}this.h=P,this.o+=E},n.prototype.v=function(){var g=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);g[0]=128;for(var E=1;E<g.length-8;++E)g[E]=0;var S=8*this.o;for(E=g.length-8;E<g.length;++E)g[E]=S&255,S/=256;for(this.u(g),g=Array(16),E=S=0;4>E;++E)for(var C=0;32>C;C+=8)g[S++]=this.g[E]>>>C&255;return g};function i(g,E){var S=o;return Object.prototype.hasOwnProperty.call(S,g)?S[g]:S[g]=E(g)}function a(g,E){this.h=E;for(var S=[],C=!0,P=g.length-1;0<=P;P--){var R=g[P]|0;C&&R==E||(S[P]=R,C=!1)}this.g=S}var o={};function l(g){return-128<=g&&128>g?i(g,function(E){return new a([E|0],0>E?-1:0)}):new a([g|0],0>g?-1:0)}function c(g){if(isNaN(g)||!isFinite(g))return h;if(0>g)return y(c(-g));for(var E=[],S=1,C=0;g>=S;C++)E[C]=g/S|0,S*=4294967296;return new a(E,0)}function u(g,E){if(g.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(g.charAt(0)=="-")return y(u(g.substring(1),E));if(0<=g.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(E,8)),C=h,P=0;P<g.length;P+=8){var R=Math.min(8,g.length-P),b=parseInt(g.substring(P,P+R),E);8>R?(R=c(Math.pow(E,R)),C=C.j(R).add(c(b))):(C=C.j(S),C=C.add(c(b)))}return C}var h=l(0),p=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(v(this))return-y(this).m();for(var g=0,E=1,S=0;S<this.g.length;S++){var C=this.i(S);g+=(0<=C?C:4294967296+C)*E,E*=4294967296}return g},t.toString=function(g){if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(x(this))return"0";if(v(this))return"-"+y(this).toString(g);for(var E=c(Math.pow(g,6)),S=this,C="";;){var P=D(S,E).g;S=T(S,P.j(E));var R=((0<S.g.length?S.g[0]:S.h)>>>0).toString(g);if(S=P,x(S))return R+C;for(;6>R.length;)R="0"+R;C=R+C}},t.i=function(g){return 0>g?0:g<this.g.length?this.g[g]:this.h};function x(g){if(g.h!=0)return!1;for(var E=0;E<g.g.length;E++)if(g.g[E]!=0)return!1;return!0}function v(g){return g.h==-1}t.l=function(g){return g=T(this,g),v(g)?-1:x(g)?0:1};function y(g){for(var E=g.g.length,S=[],C=0;C<E;C++)S[C]=~g.g[C];return new a(S,~g.h).add(p)}t.abs=function(){return v(this)?y(this):this},t.add=function(g){for(var E=Math.max(this.g.length,g.g.length),S=[],C=0,P=0;P<=E;P++){var R=C+(this.i(P)&65535)+(g.i(P)&65535),b=(R>>>16)+(this.i(P)>>>16)+(g.i(P)>>>16);C=b>>>16,R&=65535,b&=65535,S[P]=b<<16|R}return new a(S,S[S.length-1]&-2147483648?-1:0)};function T(g,E){return g.add(y(E))}t.j=function(g){if(x(this)||x(g))return h;if(v(this))return v(g)?y(this).j(y(g)):y(y(this).j(g));if(v(g))return y(this.j(y(g)));if(0>this.l(m)&&0>g.l(m))return c(this.m()*g.m());for(var E=this.g.length+g.g.length,S=[],C=0;C<2*E;C++)S[C]=0;for(C=0;C<this.g.length;C++)for(var P=0;P<g.g.length;P++){var R=this.i(C)>>>16,b=this.i(C)&65535,ce=g.i(P)>>>16,fe=g.i(P)&65535;S[2*C+2*P]+=b*fe,k(S,2*C+2*P),S[2*C+2*P+1]+=R*fe,k(S,2*C+2*P+1),S[2*C+2*P+1]+=b*ce,k(S,2*C+2*P+1),S[2*C+2*P+2]+=R*ce,k(S,2*C+2*P+2)}for(C=0;C<E;C++)S[C]=S[2*C+1]<<16|S[2*C];for(C=E;C<2*E;C++)S[C]=0;return new a(S,0)};function k(g,E){for(;(g[E]&65535)!=g[E];)g[E+1]+=g[E]>>>16,g[E]&=65535,E++}function w(g,E){this.g=g,this.h=E}function D(g,E){if(x(E))throw Error("division by zero");if(x(g))return new w(h,h);if(v(g))return E=D(y(g),E),new w(y(E.g),y(E.h));if(v(E))return E=D(g,y(E)),new w(y(E.g),E.h);if(30<g.g.length){if(v(g)||v(E))throw Error("slowDivide_ only works with positive integers.");for(var S=p,C=E;0>=C.l(g);)S=U(S),C=U(C);var P=V(S,1),R=V(C,1);for(C=V(C,2),S=V(S,2);!x(C);){var b=R.add(C);0>=b.l(g)&&(P=P.add(S),R=b),C=V(C,1),S=V(S,1)}return E=T(g,P.j(E)),new w(P,E)}for(P=h;0<=g.l(E);){for(S=Math.max(1,Math.floor(g.m()/E.m())),C=Math.ceil(Math.log(S)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),R=c(S),b=R.j(E);v(b)||0<b.l(g);)S-=C,R=c(S),b=R.j(E);x(R)&&(R=p),P=P.add(R),g=T(g,b)}return new w(P,g)}t.A=function(g){return D(this,g).h},t.and=function(g){for(var E=Math.max(this.g.length,g.g.length),S=[],C=0;C<E;C++)S[C]=this.i(C)&g.i(C);return new a(S,this.h&g.h)},t.or=function(g){for(var E=Math.max(this.g.length,g.g.length),S=[],C=0;C<E;C++)S[C]=this.i(C)|g.i(C);return new a(S,this.h|g.h)},t.xor=function(g){for(var E=Math.max(this.g.length,g.g.length),S=[],C=0;C<E;C++)S[C]=this.i(C)^g.i(C);return new a(S,this.h^g.h)};function U(g){for(var E=g.g.length+1,S=[],C=0;C<E;C++)S[C]=g.i(C)<<1|g.i(C-1)>>>31;return new a(S,g.h)}function V(g,E){var S=E>>5;E%=32;for(var C=g.g.length-S,P=[],R=0;R<C;R++)P[R]=0<E?g.i(R+S)>>>E|g.i(R+S+1)<<32-E:g.i(R+S);return new a(P,g.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,ik=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,Ca=a}).apply(typeof b_<"u"?b_:typeof self<"u"?self:typeof window<"u"?window:{});var pf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ak,Xl,ok,Wf,im,lk,ck,uk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,_,A){return f==Array.prototype||f==Object.prototype||(f[_]=A.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof pf=="object"&&pf];for(var _=0;_<f.length;++_){var A=f[_];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function s(f,_){if(_)e:{var A=n;f=f.split(".");for(var j=0;j<f.length-1;j++){var ne=f[j];if(!(ne in A))break e;A=A[ne]}f=f[f.length-1],j=A[f],_=_(j),_!=j&&_!=null&&e(A,f,{configurable:!0,writable:!0,value:_})}}function i(f,_){f instanceof String&&(f+="");var A=0,j=!1,ne={next:function(){if(!j&&A<f.length){var ie=A++;return{value:_(ie,f[ie]),done:!1}}return j=!0,{done:!0,value:void 0}}};return ne[Symbol.iterator]=function(){return ne},ne}s("Array.prototype.values",function(f){return f||function(){return i(this,function(_,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(f){var _=typeof f;return _=_!="object"?_:f?Array.isArray(f)?"array":_:"null",_=="array"||_=="object"&&typeof f.length=="number"}function c(f){var _=typeof f;return _=="object"&&f!=null||_=="function"}function u(f,_,A){return f.call.apply(f.bind,arguments)}function h(f,_,A){if(!f)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var ne=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ne,j),f.apply(_,ne)}}return function(){return f.apply(_,arguments)}}function p(f,_,A){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,p.apply(null,arguments)}function m(f,_){var A=Array.prototype.slice.call(arguments,1);return function(){var j=A.slice();return j.push.apply(j,arguments),f.apply(this,j)}}function x(f,_){function A(){}A.prototype=_.prototype,f.aa=_.prototype,f.prototype=new A,f.prototype.constructor=f,f.Qb=function(j,ne,ie){for(var Se=Array(arguments.length-2),Rt=2;Rt<arguments.length;Rt++)Se[Rt-2]=arguments[Rt];return _.prototype[ne].apply(j,Se)}}function v(f){const _=f.length;if(0<_){const A=Array(_);for(let j=0;j<_;j++)A[j]=f[j];return A}return[]}function y(f,_){for(let A=1;A<arguments.length;A++){const j=arguments[A];if(l(j)){const ne=f.length||0,ie=j.length||0;f.length=ne+ie;for(let Se=0;Se<ie;Se++)f[ne+Se]=j[Se]}else f.push(j)}}class T{constructor(_,A){this.i=_,this.j=A,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function k(f){return/^[\s\xa0]*$/.test(f)}function w(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function D(f){return D[" "](f),f}D[" "]=function(){};var U=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function V(f,_,A){for(const j in f)_.call(A,f[j],j,f)}function g(f,_){for(const A in f)_.call(void 0,f[A],A,f)}function E(f){const _={};for(const A in f)_[A]=f[A];return _}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(f,_){let A,j;for(let ne=1;ne<arguments.length;ne++){j=arguments[ne];for(A in j)f[A]=j[A];for(let ie=0;ie<S.length;ie++)A=S[ie],Object.prototype.hasOwnProperty.call(j,A)&&(f[A]=j[A])}}function P(f){var _=1;f=f.split(":");const A=[];for(;0<_&&f.length;)A.push(f.shift()),_--;return f.length&&A.push(f.join(":")),A}function R(f){o.setTimeout(()=>{throw f},0)}function b(){var f=K;let _=null;return f.g&&(_=f.g,f.g=f.g.next,f.g||(f.h=null),_.next=null),_}class ce{constructor(){this.h=this.g=null}add(_,A){const j=fe.get();j.set(_,A),this.h?this.h.next=j:this.g=j,this.h=j}}var fe=new T(()=>new Ae,f=>f.reset());class Ae{constructor(){this.next=this.g=this.h=null}set(_,A){this.h=_,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let _e,oe=!1,K=new ce,de=()=>{const f=o.Promise.resolve(void 0);_e=()=>{f.then(Te)}};var Te=()=>{for(var f;f=b();){try{f.h.call(f.g)}catch(A){R(A)}var _=fe;_.j(f),100>_.h&&(_.h++,f.next=_.g,_.g=f)}oe=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ee(f,_){this.type=f,this.g=this.target=_,this.defaultPrevented=!1}ee.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,_=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const A=()=>{};o.addEventListener("test",A,_),o.removeEventListener("test",A,_)}catch{}return f}();function W(f,_){if(ee.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var A=this.type=f.type,j=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=_,_=f.relatedTarget){if(U){e:{try{D(_.nodeName);var ne=!0;break e}catch{}ne=!1}ne||(_=null)}}else A=="mouseover"?_=f.fromElement:A=="mouseout"&&(_=f.toElement);this.relatedTarget=_,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:ae[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&W.aa.h.call(this)}}x(W,ee);var ae={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ve="closure_listenable_"+(1e6*Math.random()|0),Ce=0;function Ee(f,_,A,j,ne){this.listener=f,this.proxy=null,this.src=_,this.type=A,this.capture=!!j,this.ha=ne,this.key=++Ce,this.da=this.fa=!1}function pe(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function He(f){this.src=f,this.g={},this.h=0}He.prototype.add=function(f,_,A,j,ne){var ie=f.toString();f=this.g[ie],f||(f=this.g[ie]=[],this.h++);var Se=ct(f,_,j,ne);return-1<Se?(_=f[Se],A||(_.fa=!1)):(_=new Ee(_,this.src,ie,!!j,ne),_.fa=A,f.push(_)),_};function z(f,_){var A=_.type;if(A in f.g){var j=f.g[A],ne=Array.prototype.indexOf.call(j,_,void 0),ie;(ie=0<=ne)&&Array.prototype.splice.call(j,ne,1),ie&&(pe(_),f.g[A].length==0&&(delete f.g[A],f.h--))}}function ct(f,_,A,j){for(var ne=0;ne<f.length;++ne){var ie=f[ne];if(!ie.da&&ie.listener==_&&ie.capture==!!A&&ie.ha==j)return ne}return-1}var Ye="closure_lm_"+(1e6*Math.random()|0),at={};function Me(f,_,A,j,ne){if(Array.isArray(_)){for(var ie=0;ie<_.length;ie++)Me(f,_[ie],A,j,ne);return null}return A=Qe(A),f&&f[ve]?f.K(_,A,c(j)?!!j.capture:!1,ne):Y(f,_,A,!1,j,ne)}function Y(f,_,A,j,ne,ie){if(!_)throw Error("Invalid event type");var Se=c(ne)?!!ne.capture:!!ne,Rt=Je(f);if(Rt||(f[Ye]=Rt=new He(f)),A=Rt.add(_,A,j,Se,ie),A.proxy)return A;if(j=ke(),A.proxy=j,j.src=f,j.listener=A,f.addEventListener)q||(ne=Se),ne===void 0&&(ne=!1),f.addEventListener(_.toString(),j,ne);else if(f.attachEvent)f.attachEvent(tt(_.toString()),j);else if(f.addListener&&f.removeListener)f.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return A}function ke(){function f(A){return _.call(f.src,f.listener,A)}const _=mt;return f}function be(f,_,A,j,ne){if(Array.isArray(_))for(var ie=0;ie<_.length;ie++)be(f,_[ie],A,j,ne);else j=c(j)?!!j.capture:!!j,A=Qe(A),f&&f[ve]?(f=f.i,_=String(_).toString(),_ in f.g&&(ie=f.g[_],A=ct(ie,A,j,ne),-1<A&&(pe(ie[A]),Array.prototype.splice.call(ie,A,1),ie.length==0&&(delete f.g[_],f.h--)))):f&&(f=Je(f))&&(_=f.g[_.toString()],f=-1,_&&(f=ct(_,A,j,ne)),(A=-1<f?_[f]:null)&&je(A))}function je(f){if(typeof f!="number"&&f&&!f.da){var _=f.src;if(_&&_[ve])z(_.i,f);else{var A=f.type,j=f.proxy;_.removeEventListener?_.removeEventListener(A,j,f.capture):_.detachEvent?_.detachEvent(tt(A),j):_.addListener&&_.removeListener&&_.removeListener(j),(A=Je(_))?(z(A,f),A.h==0&&(A.src=null,_[Ye]=null)):pe(f)}}}function tt(f){return f in at?at[f]:at[f]="on"+f}function mt(f,_){if(f.da)f=!0;else{_=new W(_,this);var A=f.listener,j=f.ha||f.src;f.fa&&je(f),f=A.call(j,_)}return f}function Je(f){return f=f[Ye],f instanceof He?f:null}var qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qe(f){return typeof f=="function"?f:(f[qe]||(f[qe]=function(_){return f.handleEvent(_)}),f[qe])}function Fe(){B.call(this),this.i=new He(this),this.M=this,this.F=null}x(Fe,B),Fe.prototype[ve]=!0,Fe.prototype.removeEventListener=function(f,_,A,j){be(this,f,_,A,j)};function ut(f,_){var A,j=f.F;if(j)for(A=[];j;j=j.F)A.push(j);if(f=f.M,j=_.type||_,typeof _=="string")_=new ee(_,f);else if(_ instanceof ee)_.target=_.target||f;else{var ne=_;_=new ee(j,f),C(_,ne)}if(ne=!0,A)for(var ie=A.length-1;0<=ie;ie--){var Se=_.g=A[ie];ne=rt(Se,j,!0,_)&&ne}if(Se=_.g=f,ne=rt(Se,j,!0,_)&&ne,ne=rt(Se,j,!1,_)&&ne,A)for(ie=0;ie<A.length;ie++)Se=_.g=A[ie],ne=rt(Se,j,!1,_)&&ne}Fe.prototype.N=function(){if(Fe.aa.N.call(this),this.i){var f=this.i,_;for(_ in f.g){for(var A=f.g[_],j=0;j<A.length;j++)pe(A[j]);delete f.g[_],f.h--}}this.F=null},Fe.prototype.K=function(f,_,A,j){return this.i.add(String(f),_,!1,A,j)},Fe.prototype.L=function(f,_,A,j){return this.i.add(String(f),_,!0,A,j)};function rt(f,_,A,j){if(_=f.i.g[String(_)],!_)return!0;_=_.concat();for(var ne=!0,ie=0;ie<_.length;++ie){var Se=_[ie];if(Se&&!Se.da&&Se.capture==A){var Rt=Se.listener,xr=Se.ha||Se.src;Se.fa&&z(f.i,Se),ne=Rt.call(xr,j)!==!1&&ne}}return ne&&!j.defaultPrevented}function Be(f,_,A){if(typeof f=="function")A&&(f=p(f,A));else if(f&&typeof f.handleEvent=="function")f=p(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:o.setTimeout(f,_||0)}function Ve(f){f.g=Be(()=>{f.g=null,f.i&&(f.i=!1,Ve(f))},f.l);const _=f.h;f.h=null,f.m.apply(null,_)}class kt extends B{constructor(_,A){super(),this.m=_,this.l=A,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Ve(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yt(f){B.call(this),this.h=f,this.g={}}x(Yt,B);var Et=[];function dn(f){V(f.g,function(_,A){this.g.hasOwnProperty(A)&&je(_)},f),f.g={}}Yt.prototype.N=function(){Yt.aa.N.call(this),dn(this)},Yt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fs=o.JSON.stringify,io=o.JSON.parse,Tl=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function bs(){}bs.prototype.h=null;function us(f){return f.h||(f.h=f.i())}function mi(){}var zn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Os(){ee.call(this,"d")}x(Os,ee);function fs(){ee.call(this,"c")}x(fs,ee);var An={},ao=null;function Ms(){return ao=ao||new Fe}An.La="serverreachability";function Ls(f){ee.call(this,An.La,f)}x(Ls,ee);function In(f){const _=Ms();ut(_,new Ls(_))}An.STAT_EVENT="statevent";function oo(f,_){ee.call(this,An.STAT_EVENT,f),this.stat=_}x(oo,ee);function ir(f){const _=Ms();ut(_,new oo(_,f))}An.Ma="timingevent";function H(f,_){ee.call(this,An.Ma,f),this.size=_}x(H,ee);function J(f,_){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},_)}function se(){this.g=!0}se.prototype.xa=function(){this.g=!1};function he(f,_,A,j,ne,ie){f.info(function(){if(f.g)if(ie)for(var Se="",Rt=ie.split("&"),xr=0;xr<Rt.length;xr++){var yt=Rt[xr].split("=");if(1<yt.length){var Nr=yt[0];yt=yt[1];var Pr=Nr.split("_");Se=2<=Pr.length&&Pr[1]=="type"?Se+(Nr+"="+yt+"&"):Se+(Nr+"=redacted&")}}else Se=null;else Se=ie;return"XMLHTTP REQ ("+j+") [attempt "+ne+"]: "+_+`
`+A+`
`+Se})}function Ie(f,_,A,j,ne,ie,Se){f.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+ne+"]: "+_+`
`+A+`
`+ie+" "+Se})}function I(f,_,A,j){f.info(function(){return"XMLHTTP TEXT ("+_+"): "+N(f,A)+(j?" "+j:"")})}function L(f,_){f.info(function(){return"TIMEOUT: "+_})}se.prototype.info=function(){};function N(f,_){if(!f.g)return _;if(!_)return null;try{var A=JSON.parse(_);if(A){for(f=0;f<A.length;f++)if(Array.isArray(A[f])){var j=A[f];if(!(2>j.length)){var ne=j[1];if(Array.isArray(ne)&&!(1>ne.length)){var ie=ne[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(var Se=1;Se<ne.length;Se++)ne[Se]=""}}}}return Fs(A)}catch{return _}}var F={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},O={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},M;function G(){}x(G,bs),G.prototype.g=function(){return new XMLHttpRequest},G.prototype.i=function(){return{}},M=new G;function re(f,_,A,j){this.j=f,this.i=_,this.l=A,this.R=j||1,this.U=new Yt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new te}function te(){this.i=null,this.g="",this.h=!1}var Z={},Q={};function le(f,_,A){f.L=1,f.v=Vu(js(_)),f.m=A,f.P=!0,ye(f,null)}function ye(f,_){f.F=Date.now(),we(f),f.A=js(f.v);var A=f.A,j=f.R;Array.isArray(j)||(j=[String(j)]),ux(A.i,"t",j),f.C=0,A=f.j.J,f.h=new te,f.g=Cx(f.j,A?_:null,!f.m),0<f.O&&(f.M=new kt(p(f.Y,f,f.g),f.O)),_=f.U,A=f.g,j=f.ca;var ne="readystatechange";Array.isArray(ne)||(ne&&(Et[0]=ne.toString()),ne=Et);for(var ie=0;ie<ne.length;ie++){var Se=Me(A,ne[ie],j||_.handleEvent,!1,_.h||_);if(!Se)break;_.g[Se.key]=Se}_=f.H?E(f.H):{},f.m?(f.u||(f.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,_)):(f.u="GET",f.g.ea(f.A,f.u,null,_)),In(),he(f.i,f.u,f.A,f.l,f.R,f.m)}re.prototype.ca=function(f){f=f.target;const _=this.M;_&&Vs(f)==3?_.j():this.Y(f)},re.prototype.Y=function(f){try{if(f==this.g)e:{const Pr=Vs(this.g);var _=this.g.Ba();const uo=this.g.Z();if(!(3>Pr)&&(Pr!=3||this.g&&(this.h.h||this.g.oa()||vx(this.g)))){this.J||Pr!=4||_==7||(_==8||0>=uo?In(3):In(2)),gt(this);var A=this.g.Z();this.X=A;t:if(Re(this)){var j=vx(this.g);f="";var ne=j.length,ie=Vs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){St(this),nt(this);var Se="";break t}this.h.i=new o.TextDecoder}for(_=0;_<ne;_++)this.h.h=!0,f+=this.h.i.decode(j[_],{stream:!(ie&&_==ne-1)});j.length=0,this.h.g+=f,this.C=0,Se=this.h.g}else Se=this.g.oa();if(this.o=A==200,Ie(this.i,this.u,this.A,this.l,this.R,Pr,A),this.o){if(this.T&&!this.K){t:{if(this.g){var Rt,xr=this.g;if((Rt=xr.g?xr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(Rt)){var yt=Rt;break t}}yt=null}if(A=yt)I(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nn(this,A);else{this.o=!1,this.s=3,ir(12),St(this),nt(this);break e}}if(this.P){A=!0;let $n;for(;!this.J&&this.C<Se.length;)if($n=me(this,Se),$n==Q){Pr==4&&(this.s=4,ir(14),A=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if($n==Z){this.s=4,ir(15),I(this.i,this.l,Se,"[Invalid Chunk]"),A=!1;break}else I(this.i,this.l,$n,null),nn(this,$n);if(Re(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pr!=4||Se.length!=0||this.h.h||(this.s=1,ir(16),A=!1),this.o=this.o&&A,!A)I(this.i,this.l,Se,"[Invalid Chunked Response]"),St(this),nt(this);else if(0<Se.length&&!this.W){this.W=!0;var Nr=this.j;Nr.g==this&&Nr.ba&&!Nr.M&&(Nr.j.info("Great, no buffering proxy detected. Bytes received: "+Se.length),Qd(Nr),Nr.M=!0,ir(11))}}else I(this.i,this.l,Se,null),nn(this,Se);Pr==4&&St(this),this.o&&!this.J&&(Pr==4?kx(this.j,this):(this.o=!1,we(this)))}else FI(this.g),A==400&&0<Se.indexOf("Unknown SID")?(this.s=3,ir(12)):(this.s=0,ir(13)),St(this),nt(this)}}}catch{}finally{}};function Re(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function me(f,_){var A=f.C,j=_.indexOf(`
`,A);return j==-1?Q:(A=Number(_.substring(A,j)),isNaN(A)?Z:(j+=1,j+A>_.length?Q:(_=_.slice(j,j+A),f.C=j+A,_)))}re.prototype.cancel=function(){this.J=!0,St(this)};function we(f){f.S=Date.now()+f.I,Le(f,f.I)}function Le(f,_){if(f.B!=null)throw Error("WatchDog timer not null");f.B=J(p(f.ba,f),_)}function gt(f){f.B&&(o.clearTimeout(f.B),f.B=null)}re.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(L(this.i,this.A),this.L!=2&&(In(),ir(17)),St(this),this.s=2,nt(this)):Le(this,this.S-f)};function nt(f){f.j.G==0||f.J||kx(f.j,f)}function St(f){gt(f);var _=f.M;_&&typeof _.ma=="function"&&_.ma(),f.M=null,dn(f.U),f.g&&(_=f.g,f.g=null,_.abort(),_.ma())}function nn(f,_){try{var A=f.j;if(A.G!=0&&(A.g==f||ft(A.h,f))){if(!f.K&&ft(A.h,f)&&A.G==3){try{var j=A.Da.g.parse(_)}catch{j=null}if(Array.isArray(j)&&j.length==3){var ne=j;if(ne[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<f.F)Wu(A),$u(A);else break e;Yd(A),ir(18)}}else A.za=ne[1],0<A.za-A.T&&37500>ne[2]&&A.F&&A.v==0&&!A.C&&(A.C=J(p(A.Za,A),6e3));if(1>=Cn(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else ca(A,11)}else if((f.K||A.g==f)&&Wu(A),!k(_))for(ne=A.Da.g.parse(_),_=0;_<ne.length;_++){let yt=ne[_];if(A.T=yt[0],yt=yt[1],A.G==2)if(yt[0]=="c"){A.K=yt[1],A.ia=yt[2];const Nr=yt[3];Nr!=null&&(A.la=Nr,A.j.info("VER="+A.la));const Pr=yt[4];Pr!=null&&(A.Aa=Pr,A.j.info("SVER="+A.Aa));const uo=yt[5];uo!=null&&typeof uo=="number"&&0<uo&&(j=1.5*uo,A.L=j,A.j.info("backChannelRequestTimeoutMs_="+j)),j=A;const $n=f.g;if($n){const Ku=$n.g?$n.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ku){var ie=j.h;ie.g||Ku.indexOf("spdy")==-1&&Ku.indexOf("quic")==-1&&Ku.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(hs(ie,ie.h),ie.h=null))}if(j.D){const Jd=$n.g?$n.g.getResponseHeader("X-HTTP-Session-Id"):null;Jd&&(j.ya=Jd,Dt(j.I,j.D,Jd))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-f.F,A.j.info("Handshake RTT: "+A.R+"ms")),j=A;var Se=f;if(j.qa=Ix(j,j.J?j.ia:null,j.W),Se.K){kl(j.h,Se);var Rt=Se,xr=j.L;xr&&(Rt.I=xr),Rt.B&&(gt(Rt),we(Rt)),j.g=Se}else Ex(j);0<A.i.length&&Hu(A)}else yt[0]!="stop"&&yt[0]!="close"||ca(A,7);else A.G==3&&(yt[0]=="stop"||yt[0]=="close"?yt[0]=="stop"?ca(A,7):Xd(A):yt[0]!="noop"&&A.l&&A.l.ta(yt),A.v=0)}}In(4)}catch{}}var Ze=class{constructor(f,_){this.g=f,this.map=_}};function Tt(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function vr(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Cn(f){return f.h?1:f.g?f.g.size:0}function ft(f,_){return f.h?f.h==_:f.g?f.g.has(_):!1}function hs(f,_){f.g?f.g.add(_):f.h=_}function kl(f,_){f.h&&f.h==_?f.h=null:f.g&&f.g.has(_)&&f.g.delete(_)}Tt.prototype.cancel=function(){if(this.i=Mu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Mu(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let _=f.i;for(const A of f.g.values())_=_.concat(A.D);return _}return v(f.i)}function xI(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var _=[],A=f.length,j=0;j<A;j++)_.push(f[j]);return _}_=[],A=0;for(j in f)_[A++]=f[j];return _}function _I(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var _=[];f=f.length;for(var A=0;A<f;A++)_.push(A);return _}_=[],A=0;for(const j in f)_[A++]=j;return _}}}function sx(f,_){if(f.forEach&&typeof f.forEach=="function")f.forEach(_,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,_,void 0);else for(var A=_I(f),j=xI(f),ne=j.length,ie=0;ie<ne;ie++)_.call(void 0,j[ie],A&&A[ie],f)}var ix=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yI(f,_){if(f){f=f.split("&");for(var A=0;A<f.length;A++){var j=f[A].indexOf("="),ne=null;if(0<=j){var ie=f[A].substring(0,j);ne=f[A].substring(j+1)}else ie=f[A];_(ie,ne?decodeURIComponent(ne.replace(/\+/g," ")):"")}}}function la(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof la){this.h=f.h,Lu(this,f.j),this.o=f.o,this.g=f.g,ju(this,f.s),this.l=f.l;var _=f.i,A=new Il;A.i=_.i,_.g&&(A.g=new Map(_.g),A.h=_.h),ax(this,A),this.m=f.m}else f&&(_=String(f).match(ix))?(this.h=!1,Lu(this,_[1]||"",!0),this.o=Sl(_[2]||""),this.g=Sl(_[3]||"",!0),ju(this,_[4]),this.l=Sl(_[5]||"",!0),ax(this,_[6]||"",!0),this.m=Sl(_[7]||"")):(this.h=!1,this.i=new Il(null,this.h))}la.prototype.toString=function(){var f=[],_=this.j;_&&f.push(Al(_,ox,!0),":");var A=this.g;return(A||_=="file")&&(f.push("//"),(_=this.o)&&f.push(Al(_,ox,!0),"@"),f.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&f.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&f.push("/"),f.push(Al(A,A.charAt(0)=="/"?TI:EI,!0))),(A=this.i.toString())&&f.push("?",A),(A=this.m)&&f.push("#",Al(A,SI)),f.join("")};function js(f){return new la(f)}function Lu(f,_,A){f.j=A?Sl(_,!0):_,f.j&&(f.j=f.j.replace(/:$/,""))}function ju(f,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);f.s=_}else f.s=null}function ax(f,_,A){_ instanceof Il?(f.i=_,AI(f.i,f.h)):(A||(_=Al(_,kI)),f.i=new Il(_,f.h))}function Dt(f,_,A){f.i.set(_,A)}function Vu(f){return Dt(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Sl(f,_){return f?_?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Al(f,_,A){return typeof f=="string"?(f=encodeURI(f).replace(_,wI),A&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function wI(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var ox=/[#\/\?@]/g,EI=/[#\?:]/g,TI=/[#\?]/g,kI=/[#\?@]/g,SI=/#/g;function Il(f,_){this.h=this.g=null,this.i=f||null,this.j=!!_}function gi(f){f.g||(f.g=new Map,f.h=0,f.i&&yI(f.i,function(_,A){f.add(decodeURIComponent(_.replace(/\+/g," ")),A)}))}t=Il.prototype,t.add=function(f,_){gi(this),this.i=null,f=lo(this,f);var A=this.g.get(f);return A||this.g.set(f,A=[]),A.push(_),this.h+=1,this};function lx(f,_){gi(f),_=lo(f,_),f.g.has(_)&&(f.i=null,f.h-=f.g.get(_).length,f.g.delete(_))}function cx(f,_){return gi(f),_=lo(f,_),f.g.has(_)}t.forEach=function(f,_){gi(this),this.g.forEach(function(A,j){A.forEach(function(ne){f.call(_,ne,j,this)},this)},this)},t.na=function(){gi(this);const f=Array.from(this.g.values()),_=Array.from(this.g.keys()),A=[];for(let j=0;j<_.length;j++){const ne=f[j];for(let ie=0;ie<ne.length;ie++)A.push(_[j])}return A},t.V=function(f){gi(this);let _=[];if(typeof f=="string")cx(this,f)&&(_=_.concat(this.g.get(lo(this,f))));else{f=Array.from(this.g.values());for(let A=0;A<f.length;A++)_=_.concat(f[A])}return _},t.set=function(f,_){return gi(this),this.i=null,f=lo(this,f),cx(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[_]),this.h+=1,this},t.get=function(f,_){return f?(f=this.V(f),0<f.length?String(f[0]):_):_};function ux(f,_,A){lx(f,_),0<A.length&&(f.i=null,f.g.set(lo(f,_),v(A)),f.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],_=Array.from(this.g.keys());for(var A=0;A<_.length;A++){var j=_[A];const ie=encodeURIComponent(String(j)),Se=this.V(j);for(j=0;j<Se.length;j++){var ne=ie;Se[j]!==""&&(ne+="="+encodeURIComponent(String(Se[j]))),f.push(ne)}}return this.i=f.join("&")};function lo(f,_){return _=String(_),f.j&&(_=_.toLowerCase()),_}function AI(f,_){_&&!f.j&&(gi(f),f.i=null,f.g.forEach(function(A,j){var ne=j.toLowerCase();j!=ne&&(lx(this,j),ux(this,ne,A))},f)),f.j=_}function II(f,_){const A=new se;if(o.Image){const j=new Image;j.onload=m(vi,A,"TestLoadImage: loaded",!0,_,j),j.onerror=m(vi,A,"TestLoadImage: error",!1,_,j),j.onabort=m(vi,A,"TestLoadImage: abort",!1,_,j),j.ontimeout=m(vi,A,"TestLoadImage: timeout",!1,_,j),o.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=f}else _(!1)}function CI(f,_){const A=new se,j=new AbortController,ne=setTimeout(()=>{j.abort(),vi(A,"TestPingServer: timeout",!1,_)},1e4);fetch(f,{signal:j.signal}).then(ie=>{clearTimeout(ne),ie.ok?vi(A,"TestPingServer: ok",!0,_):vi(A,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(ne),vi(A,"TestPingServer: error",!1,_)})}function vi(f,_,A,j,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),j(A)}catch{}}function RI(){this.g=new Tl}function NI(f,_,A){const j=A||"";try{sx(f,function(ne,ie){let Se=ne;c(ne)&&(Se=Fs(ne)),_.push(j+ie+"="+encodeURIComponent(Se))})}catch(ne){throw _.push(j+"type="+encodeURIComponent("_badmap")),ne}}function Uu(f){this.l=f.Ub||null,this.j=f.eb||!1}x(Uu,bs),Uu.prototype.g=function(){return new Bu(this.l,this.j)},Uu.prototype.i=function(f){return function(){return f}}({});function Bu(f,_){Fe.call(this),this.D=f,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Bu,Fe),t=Bu.prototype,t.open=function(f,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=_,this.readyState=1,Rl(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(_.body=f),(this.D||o).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Cl(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Rl(this)),this.g&&(this.readyState=3,Rl(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;fx(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function fx(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var _=f.value?f.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!f.done}))&&(this.response=this.responseText+=_)}f.done?Cl(this):Rl(this),this.readyState==3&&fx(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,Cl(this))},t.Qa=function(f){this.g&&(this.response=f,Cl(this))},t.ga=function(){this.g&&Cl(this)};function Cl(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Rl(f)}t.setRequestHeader=function(f,_){this.u.append(f,_)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],_=this.h.entries();for(var A=_.next();!A.done;)A=A.value,f.push(A[0]+": "+A[1]),A=_.next();return f.join(`\r
`)};function Rl(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Bu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function hx(f){let _="";return V(f,function(A,j){_+=j,_+=":",_+=A,_+=`\r
`}),_}function qd(f,_,A){e:{for(j in A){var j=!1;break e}j=!0}j||(A=hx(A),typeof f=="string"?A!=null&&encodeURIComponent(String(A)):Dt(f,_,A))}function $t(f){Fe.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x($t,Fe);var PI=/^https?$/i,DI=["POST","PUT"];t=$t.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,_,A,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);_=_?_.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():M.g(),this.v=this.o?us(this.o):us(M),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(_,String(f),!0),this.B=!1}catch(ie){dx(this,ie);return}if(f=A||"",A=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var ne in j)A.set(ne,j[ne]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const ie of j.keys())A.set(ie,j.get(ie));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(A.keys()).find(ie=>ie.toLowerCase()=="content-type"),ne=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(DI,_,void 0))||j||ne||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,Se]of A)this.g.setRequestHeader(ie,Se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{gx(this),this.u=!0,this.g.send(f),this.u=!1}catch(ie){dx(this,ie)}};function dx(f,_){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=_,f.m=5,px(f),zu(f)}function px(f){f.A||(f.A=!0,ut(f,"complete"),ut(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,ut(this,"complete"),ut(this,"abort"),zu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zu(this,!0)),$t.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?mx(this):this.bb())},t.bb=function(){mx(this)};function mx(f){if(f.h&&typeof a<"u"&&(!f.v[1]||Vs(f)!=4||f.Z()!=2)){if(f.u&&Vs(f)==4)Be(f.Ea,0,f);else if(ut(f,"readystatechange"),Vs(f)==4){f.h=!1;try{const Se=f.Z();e:switch(Se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var A;if(!(A=_)){var j;if(j=Se===0){var ne=String(f.D).match(ix)[1]||null;!ne&&o.self&&o.self.location&&(ne=o.self.location.protocol.slice(0,-1)),j=!PI.test(ne?ne.toLowerCase():"")}A=j}if(A)ut(f,"complete"),ut(f,"success");else{f.m=6;try{var ie=2<Vs(f)?f.g.statusText:""}catch{ie=""}f.l=ie+" ["+f.Z()+"]",px(f)}}finally{zu(f)}}}}function zu(f,_){if(f.g){gx(f);const A=f.g,j=f.v[0]?()=>{}:null;f.g=null,f.v=null,_||ut(f,"ready");try{A.onreadystatechange=j}catch{}}}function gx(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Vs(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Vs(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var _=this.g.responseText;return f&&_.indexOf(f)==0&&(_=_.substring(f.length)),io(_)}};function vx(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function FI(f){const _={};f=(f.g&&2<=Vs(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<f.length;j++){if(k(f[j]))continue;var A=P(f[j]);const ne=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const ie=_[ne]||[];_[ne]=ie,ie.push(A)}g(_,function(j){return j.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Nl(f,_,A){return A&&A.internalChannelParams&&A.internalChannelParams[f]||_}function xx(f){this.Aa=0,this.i=[],this.j=new se,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Nl("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Nl("baseRetryDelayMs",5e3,f),this.cb=Nl("retryDelaySeedMs",1e4,f),this.Wa=Nl("forwardChannelMaxRetries",2,f),this.wa=Nl("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Tt(f&&f.concurrentRequestLimit),this.Da=new RI,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=xx.prototype,t.la=8,t.G=1,t.connect=function(f,_,A,j){ir(0),this.W=f,this.H=_||{},A&&j!==void 0&&(this.H.OSID=A,this.H.OAID=j),this.F=this.X,this.I=Ix(this,null,this.W),Hu(this)};function Xd(f){if(_x(f),f.G==3){var _=f.U++,A=js(f.I);if(Dt(A,"SID",f.K),Dt(A,"RID",_),Dt(A,"TYPE","terminate"),Pl(f,A),_=new re(f,f.j,_),_.L=2,_.v=Vu(js(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(_.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=_.v,A=!0),A||(_.g=Cx(_.j,null),_.g.ea(_.v)),_.F=Date.now(),we(_)}Ax(f)}function $u(f){f.g&&(Qd(f),f.g.cancel(),f.g=null)}function _x(f){$u(f),f.u&&(o.clearTimeout(f.u),f.u=null),Wu(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function Hu(f){if(!vr(f.h)&&!f.s){f.s=!0;var _=f.Ga;_e||de(),oe||(_e(),oe=!0),K.add(_,f),f.B=0}}function bI(f,_){return Cn(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=_.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=J(p(f.Ga,f,_),Sx(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const ne=new re(this,this.j,f);let ie=this.o;if(this.S&&(ie?(ie=E(ie),C(ie,this.S)):ie=this.S),this.m!==null||this.O||(ne.H=ie,ie=null),this.P)e:{for(var _=0,A=0;A<this.i.length;A++){t:{var j=this.i[A];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(_+=j,4096<_){_=A;break e}if(_===4096||A===this.i.length-1){_=A+1;break e}}_=1e3}else _=1e3;_=wx(this,ne,_),A=js(this.I),Dt(A,"RID",f),Dt(A,"CVER",22),this.D&&Dt(A,"X-HTTP-Session-Id",this.D),Pl(this,A),ie&&(this.O?_="headers="+encodeURIComponent(String(hx(ie)))+"&"+_:this.m&&qd(A,this.m,ie)),hs(this.h,ne),this.Ua&&Dt(A,"TYPE","init"),this.P?(Dt(A,"$req",_),Dt(A,"SID","null"),ne.T=!0,le(ne,A,null)):le(ne,A,_),this.G=2}}else this.G==3&&(f?yx(this,f):this.i.length==0||vr(this.h)||yx(this))};function yx(f,_){var A;_?A=_.l:A=f.U++;const j=js(f.I);Dt(j,"SID",f.K),Dt(j,"RID",A),Dt(j,"AID",f.T),Pl(f,j),f.m&&f.o&&qd(j,f.m,f.o),A=new re(f,f.j,A,f.B+1),f.m===null&&(A.H=f.o),_&&(f.i=_.D.concat(f.i)),_=wx(f,A,1e3),A.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),hs(f.h,A),le(A,j,_)}function Pl(f,_){f.H&&V(f.H,function(A,j){Dt(_,j,A)}),f.l&&sx({},function(A,j){Dt(_,j,A)})}function wx(f,_,A){A=Math.min(f.i.length,A);var j=f.l?p(f.l.Na,f.l,f):null;e:{var ne=f.i;let ie=-1;for(;;){const Se=["count="+A];ie==-1?0<A?(ie=ne[0].g,Se.push("ofs="+ie)):ie=0:Se.push("ofs="+ie);let Rt=!0;for(let xr=0;xr<A;xr++){let yt=ne[xr].g;const Nr=ne[xr].map;if(yt-=ie,0>yt)ie=Math.max(0,ne[xr].g-100),Rt=!1;else try{NI(Nr,Se,"req"+yt+"_")}catch{j&&j(Nr)}}if(Rt){j=Se.join("&");break e}}}return f=f.i.splice(0,A),_.D=f,j}function Ex(f){if(!f.g&&!f.u){f.Y=1;var _=f.Fa;_e||de(),oe||(_e(),oe=!0),K.add(_,f),f.v=0}}function Yd(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=J(p(f.Fa,f),Sx(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,Tx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=J(p(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ir(10),$u(this),Tx(this))};function Qd(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function Tx(f){f.g=new re(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var _=js(f.qa);Dt(_,"RID","rpc"),Dt(_,"SID",f.K),Dt(_,"AID",f.T),Dt(_,"CI",f.F?"0":"1"),!f.F&&f.ja&&Dt(_,"TO",f.ja),Dt(_,"TYPE","xmlhttp"),Pl(f,_),f.m&&f.o&&qd(_,f.m,f.o),f.L&&(f.g.I=f.L);var A=f.g;f=f.ia,A.L=1,A.v=Vu(js(_)),A.m=null,A.P=!0,ye(A,f)}t.Za=function(){this.C!=null&&(this.C=null,$u(this),Yd(this),ir(19))};function Wu(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function kx(f,_){var A=null;if(f.g==_){Wu(f),Qd(f),f.g=null;var j=2}else if(ft(f.h,_))A=_.D,kl(f.h,_),j=1;else return;if(f.G!=0){if(_.o)if(j==1){A=_.m?_.m.length:0,_=Date.now()-_.F;var ne=f.B;j=Ms(),ut(j,new H(j,A)),Hu(f)}else Ex(f);else if(ne=_.s,ne==3||ne==0&&0<_.X||!(j==1&&bI(f,_)||j==2&&Yd(f)))switch(A&&0<A.length&&(_=f.h,_.i=_.i.concat(A)),ne){case 1:ca(f,5);break;case 4:ca(f,10);break;case 3:ca(f,6);break;default:ca(f,2)}}}function Sx(f,_){let A=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(A*=2),A*_}function ca(f,_){if(f.j.info("Error code "+_),_==2){var A=p(f.fb,f),j=f.Xa;const ne=!j;j=new la(j||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Lu(j,"https"),Vu(j),ne?II(j.toString(),A):CI(j.toString(),A)}else ir(2);f.G=0,f.l&&f.l.sa(_),Ax(f),_x(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),ir(2)):(this.j.info("Failed to ping google.com"),ir(1))};function Ax(f){if(f.G=0,f.ka=[],f.l){const _=Mu(f.h);(_.length!=0||f.i.length!=0)&&(y(f.ka,_),y(f.ka,f.i),f.h.i.length=0,v(f.i),f.i.length=0),f.l.ra()}}function Ix(f,_,A){var j=A instanceof la?js(A):new la(A);if(j.g!="")_&&(j.g=_+"."+j.g),ju(j,j.s);else{var ne=o.location;j=ne.protocol,_=_?_+"."+ne.hostname:ne.hostname,ne=+ne.port;var ie=new la(null);j&&Lu(ie,j),_&&(ie.g=_),ne&&ju(ie,ne),A&&(ie.l=A),j=ie}return A=f.D,_=f.ya,A&&_&&Dt(j,A,_),Dt(j,"VER",f.la),Pl(f,j),j}function Cx(f,_,A){if(_&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=f.Ca&&!f.pa?new $t(new Uu({eb:A})):new $t(f.pa),_.Ha(f.J),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Rx(){}t=Rx.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Gu(){}Gu.prototype.g=function(f,_){return new pn(f,_)};function pn(f,_){Fe.call(this),this.g=new xx(_),this.l=f,this.h=_&&_.messageUrlParams||null,f=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(f?f["X-WebChannel-Content-Type"]=_.messageContentType:f={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(f?f["X-WebChannel-Client-Profile"]=_.va:f={"X-WebChannel-Client-Profile":_.va}),this.g.S=f,(f=_&&_.Sb)&&!k(f)&&(this.g.m=f),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!k(_)&&(this.g.D=_,f=this.h,f!==null&&_ in f&&(f=this.h,_ in f&&delete f[_])),this.j=new co(this)}x(pn,Fe),pn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},pn.prototype.close=function(){Xd(this.g)},pn.prototype.o=function(f){var _=this.g;if(typeof f=="string"){var A={};A.__data__=f,f=A}else this.u&&(A={},A.__data__=Fs(f),f=A);_.i.push(new Ze(_.Ya++,f)),_.G==3&&Hu(_)},pn.prototype.N=function(){this.g.l=null,delete this.j,Xd(this.g),delete this.g,pn.aa.N.call(this)};function Nx(f){Os.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var _=f.__sm__;if(_){e:{for(const A in _){f=A;break e}f=void 0}(this.i=f)&&(f=this.i,_=_!==null&&f in _?_[f]:void 0),this.data=_}else this.data=f}x(Nx,Os);function Px(){fs.call(this),this.status=1}x(Px,fs);function co(f){this.g=f}x(co,Rx),co.prototype.ua=function(){ut(this.g,"a")},co.prototype.ta=function(f){ut(this.g,new Nx(f))},co.prototype.sa=function(f){ut(this.g,new Px)},co.prototype.ra=function(){ut(this.g,"b")},Gu.prototype.createWebChannel=Gu.prototype.g,pn.prototype.send=pn.prototype.o,pn.prototype.open=pn.prototype.m,pn.prototype.close=pn.prototype.close,uk=function(){return new Gu},ck=function(){return Ms()},lk=An,im={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},F.NO_ERROR=0,F.TIMEOUT=8,F.HTTP_ERROR=6,Wf=F,O.COMPLETE="complete",ok=O,mi.EventType=zn,zn.OPEN="a",zn.CLOSE="b",zn.ERROR="c",zn.MESSAGE="d",Fe.prototype.listen=Fe.prototype.K,Xl=mi,$t.prototype.listenOnce=$t.prototype.L,$t.prototype.getLastError=$t.prototype.Ka,$t.prototype.getLastErrorCode=$t.prototype.Ba,$t.prototype.getStatus=$t.prototype.Z,$t.prototype.getResponseJson=$t.prototype.Oa,$t.prototype.getResponseText=$t.prototype.oa,$t.prototype.send=$t.prototype.ea,$t.prototype.setWithCredentials=$t.prototype.Ha,ak=$t}).apply(typeof pf<"u"?pf:typeof self<"u"?self:typeof window<"u"?window:{});const O_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mr.UNAUTHENTICATED=new Mr(null),Mr.GOOGLE_CREDENTIALS=new Mr("google-credentials-uid"),Mr.FIRST_PARTY=new Mr("first-party-uid"),Mr.MOCK_USER=new Mr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja=new Mg("@firebase/firestore");function $l(){return ja.logLevel}function De(t,...e){if(ja.logLevel<=ot.DEBUG){const r=e.map(Xg);ja.debug(`Firestore (${gl}): ${t}`,...r)}}function li(t,...e){if(ja.logLevel<=ot.ERROR){const r=e.map(Xg);ja.error(`Firestore (${gl}): ${t}`,...r)}}function rl(t,...e){if(ja.logLevel<=ot.WARN){const r=e.map(Xg);ja.warn(`Firestore (${gl}): ${t}`,...r)}}function Xg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $e(t="Unexpected state"){const e=`FIRESTORE (${gl}) INTERNAL ASSERTION FAILED: `+t;throw li(e),new Error(e)}function Ct(t,e){t||$e()}function Ke(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Pe extends Rs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class wb{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Mr.UNAUTHENTICATED))}shutdown(){}}class Eb{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Tb{constructor(e){this.t=e,this.currentUser=Mr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Ct(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let i=new Qs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Qs,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{De("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(De("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Qs)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(De("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ct(typeof n.accessToken=="string"),new fk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ct(e===null||typeof e=="string"),new Mr(e)}}class kb{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Mr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Sb{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new kb(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Mr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ab{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ib{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Ct(this.o===void 0);const n=i=>{i.error!=null&&De("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,De("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{De("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):De("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Ct(typeof r.token=="string"),this.R=r.token,new Ab(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cb(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=Cb(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function wt(t,e){return t<e?-1:t>e?1:0}function nl(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Pe(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Pe(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Pe(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Pe(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ur.fromMillis(Date.now())}static fromDate(e){return ur.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new ur(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?wt(this.nanoseconds,e.nanoseconds):wt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e){this.timestamp=e}static fromTimestamp(e){return new We(e)}static min(){return new We(new ur(0,0))}static max(){return new We(new ur(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,r,n){r===void 0?r=0:r>e.length&&$e(),n===void 0?n=e.length-r:n>e.length-r&&$e(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return qc.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof qc?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),a=r.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class bt extends qc{construct(e,r,n){return new bt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Pe(ue.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new bt(r)}static emptyPath(){return new bt([])}}const Rb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Er extends qc{construct(e,r,n){return new Er(e,r,n)}static isValidIdentifier(e){return Rb.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Er.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Er(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new Pe(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Pe(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Pe(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new Pe(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Er(r)}static emptyPath(){return new Er([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.path=e}static fromPath(e){return new Oe(bt.fromString(e))}static fromName(e){return new Oe(bt.fromString(e).popFirst(5))}static empty(){return new Oe(bt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&bt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return bt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Oe(new bt(e.slice()))}}function Nb(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=We.fromTimestamp(n===1e9?new ur(r+1,0):new ur(r,n));return new Qi(s,Oe.empty(),e)}function Pb(t){return new Qi(t.readTime,t.key,-1)}class Qi{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Qi(We.min(),Oe.empty(),-1)}static max(){return new Qi(We.max(),Oe.empty(),-1)}}function Db(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Oe.comparator(t.documentKey,e.documentKey),r!==0?r:wt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class bb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eu(t){if(t.code!==ue.FAILED_PRECONDITION||t.message!==Fb)throw t;De("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&$e(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ge((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof ge?r:ge.resolve(r)}catch(r){return ge.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):ge.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):ge.reject(r)}static resolve(e){return new ge((r,n)=>{r(e)})}static reject(e){return new ge((r,n)=>{n(e)})}static waitFor(e){return new ge((r,n)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&r()},l=>n(l))}),a=!0,i===s&&r()})}static or(e){let r=ge.resolve(!1);for(const n of e)r=r.next(s=>s?ge.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new ge((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const c=l;r(e[c]).next(u=>{a[c]=u,++o,o===i&&n(a)},u=>s(u))}})}static doWhile(e,r){return new ge((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function Ob(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Tu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Yg.oe=-1;function Sd(t){return t==null}function Dh(t){return t===0&&1/t==-1/0}function Mb(t){return typeof t=="number"&&Number.isInteger(t)&&!Dh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M_(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ya(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function dk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e,r){this.comparator=e,this.root=r||yr.EMPTY}insert(e,r){return new zt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,yr.BLACK,null,null))}remove(e){return new zt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new mf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new mf(this.root,e,this.comparator,!1)}getReverseIterator(){return new mf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new mf(this.root,e,this.comparator,!0)}}class mf{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class yr{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??yr.RED,this.left=s??yr.EMPTY,this.right=i??yr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new yr(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return yr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return yr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,yr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,yr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $e();const e=this.left.check();if(e!==this.right.check())throw $e();return e+(this.isRed()?0:1)}}yr.EMPTY=null,yr.RED=!0,yr.BLACK=!1;yr.EMPTY=new class{constructor(){this.size=0}get key(){throw $e()}get value(){throw $e()}get color(){throw $e()}get left(){throw $e()}get right(){throw $e()}copy(e,r,n,s,i){return this}insert(e,r,n){return new yr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.comparator=e,this.data=new zt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new L_(this.data.getIterator())}getIteratorFrom(e){return new L_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Sr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Sr(this.comparator);return r.data=e,r}}class L_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.fields=e,e.sort(Er.comparator)}static empty(){return new yn([])}unionWith(e){let r=new Sr(Er.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new yn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return nl(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new pk("Invalid base64 string: "+i):i}}(e);return new Rr(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new Rr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return wt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Rr.EMPTY_BYTE_STRING=new Rr("");const Lb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ji(t){if(Ct(!!t),typeof t=="string"){let e=0;const r=Lb.exec(t);if(Ct(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:qt(t.seconds),nanos:qt(t.nanos)}}function qt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Va(t){return typeof t=="string"?Rr.fromBase64String(t):Rr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Jg(t){const e=t.mapValue.fields.__previous_value__;return Qg(e)?Jg(e):e}function Xc(t){const e=Ji(t.mapValue.fields.__local_write_time__.timestampValue);return new ur(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,r,n,s,i,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Yc{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Yc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Yc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gf={mapValue:{}};function Ua(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Qg(t)?4:Ub(t)?9007199254740991:Vb(t)?10:11:$e()}function Ss(t,e){if(t===e)return!0;const r=Ua(t);if(r!==Ua(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xc(t).isEqual(Xc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Ji(s.timestampValue),o=Ji(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Va(s.bytesValue).isEqual(Va(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return qt(s.geoPointValue.latitude)===qt(i.geoPointValue.latitude)&&qt(s.geoPointValue.longitude)===qt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return qt(s.integerValue)===qt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=qt(s.doubleValue),o=qt(i.doubleValue);return a===o?Dh(a)===Dh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return nl(t.arrayValue.values||[],e.arrayValue.values||[],Ss);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(M_(a)!==M_(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Ss(a[l],o[l])))return!1;return!0}(t,e);default:return $e()}}function Qc(t,e){return(t.values||[]).find(r=>Ss(r,e))!==void 0}function sl(t,e){if(t===e)return 0;const r=Ua(t),n=Ua(e);if(r!==n)return wt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return wt(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=qt(i.integerValue||i.doubleValue),l=qt(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return j_(t.timestampValue,e.timestampValue);case 4:return j_(Xc(t),Xc(e));case 5:return wt(t.stringValue,e.stringValue);case 6:return function(i,a){const o=Va(i),l=Va(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=wt(o[c],l[c]);if(u!==0)return u}return wt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=wt(qt(i.latitude),qt(a.latitude));return o!==0?o:wt(qt(i.longitude),qt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return V_(t.arrayValue,e.arrayValue);case 10:return function(i,a){var o,l,c,u;const h=i.fields||{},p=a.fields||{},m=(o=h.value)===null||o===void 0?void 0:o.arrayValue,x=(l=p.value)===null||l===void 0?void 0:l.arrayValue,v=wt(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((u=x==null?void 0:x.values)===null||u===void 0?void 0:u.length)||0);return v!==0?v:V_(m,x)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===gf.mapValue&&a===gf.mapValue)return 0;if(i===gf.mapValue)return 1;if(a===gf.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const p=wt(l[h],u[h]);if(p!==0)return p;const m=sl(o[l[h]],c[u[h]]);if(m!==0)return m}return wt(l.length,u.length)}(t.mapValue,e.mapValue);default:throw $e()}}function j_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return wt(t,e);const r=Ji(t),n=Ji(e),s=wt(r.seconds,n.seconds);return s!==0?s:wt(r.nanos,n.nanos)}function V_(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=sl(r[s],n[s]);if(i)return i}return wt(r.length,n.length)}function il(t){return am(t)}function am(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ji(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Va(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Oe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=am(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${am(r.fields[a])}`;return s+"}"}(t.mapValue):$e()}function U_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function om(t){return!!t&&"integerValue"in t}function Zg(t){return!!t&&"arrayValue"in t}function B_(t){return!!t&&"nullValue"in t}function z_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Gf(t){return!!t&&"mapValue"in t}function Vb(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function dc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ya(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=dc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=dc(t.arrayValue.values[r]);return e}return Object.assign({},t)}function Ub(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.value=e}static empty(){return new ln({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Gf(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=dc(r)}setAll(e){let r=Er.emptyPath(),n={},s=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=dc(a):s.push(o.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());Gf(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ss(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Gf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){Ya(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new ln(dc(this.value))}}function mk(t){const e=[];return Ya(t.fields,(r,n)=>{const s=new Er([r]);if(Gf(n)){const i=mk(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new yn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Vr(e,0,We.min(),We.min(),We.min(),ln.empty(),0)}static newFoundDocument(e,r,n,s){return new Vr(e,1,r,We.min(),n,s,0)}static newNoDocument(e,r){return new Vr(e,2,r,We.min(),We.min(),ln.empty(),0)}static newUnknownDocument(e,r){return new Vr(e,3,r,We.min(),We.min(),ln.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(We.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ln.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ln.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=We.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,r){this.position=e,this.inclusive=r}}function $_(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=Oe.comparator(Oe.fromName(a.referenceValue),r.key):n=sl(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function H_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ss(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,r="asc"){this.field=e,this.dir=r}}function Bb(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{}class nr extends gk{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new $b(e,r,n):r==="array-contains"?new Gb(e,n):r==="in"?new Kb(e,n):r==="not-in"?new qb(e,n):r==="array-contains-any"?new Xb(e,n):new nr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Hb(e,n):new Wb(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(sl(r,this.value)):r!==null&&Ua(this.value)===Ua(r)&&this.matchesComparison(sl(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $e()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class os extends gk{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new os(e,r)}matches(e){return vk(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function vk(t){return t.op==="and"}function xk(t){return zb(t)&&vk(t)}function zb(t){for(const e of t.filters)if(e instanceof os)return!1;return!0}function lm(t){if(t instanceof nr)return t.field.canonicalString()+t.op.toString()+il(t.value);if(xk(t))return t.filters.map(e=>lm(e)).join(",");{const e=t.filters.map(r=>lm(r)).join(",");return`${t.op}(${e})`}}function _k(t,e){return t instanceof nr?function(n,s){return s instanceof nr&&n.op===s.op&&n.field.isEqual(s.field)&&Ss(n.value,s.value)}(t,e):t instanceof os?function(n,s){return s instanceof os&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,o)=>i&&_k(a,s.filters[o]),!0):!1}(t,e):void $e()}function yk(t){return t instanceof nr?function(r){return`${r.field.canonicalString()} ${r.op} ${il(r.value)}`}(t):t instanceof os?function(r){return r.op.toString()+" {"+r.getFilters().map(yk).join(" ,")+"}"}(t):"Filter"}class $b extends nr{constructor(e,r,n){super(e,r,n),this.key=Oe.fromName(n.referenceValue)}matches(e){const r=Oe.comparator(e.key,this.key);return this.matchesComparison(r)}}class Hb extends nr{constructor(e,r){super(e,"in",r),this.keys=wk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class Wb extends nr{constructor(e,r){super(e,"not-in",r),this.keys=wk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function wk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Oe.fromName(n.referenceValue))}class Gb extends nr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Zg(r)&&Qc(r.arrayValue,this.value)}}class Kb extends nr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Qc(this.value.arrayValue,r)}}class qb extends nr{constructor(e,r){super(e,"not-in",r)}matches(e){if(Qc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Qc(this.value.arrayValue,r)}}class Xb extends nr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Zg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Qc(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.ue=null}}function W_(t,e=null,r=[],n=[],s=null,i=null,a=null){return new Yb(t,e,r,n,s,i,a)}function ev(t){const e=Ke(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>lm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Sd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>il(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>il(n)).join(",")),e.ue=r}return e.ue}function tv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Bb(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!_k(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!H_(t.startAt,e.startAt)&&H_(t.endAt,e.endAt)}function cm(t){return Oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Qb(t,e,r,n,s,i,a,o){return new ku(t,e,r,n,s,i,a,o)}function rv(t){return new ku(t)}function G_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Ek(t){return t.collectionGroup!==null}function pc(t){const e=Ke(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Sr(Er.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new bh(i,n))}),r.has(Er.keyField().canonicalString())||e.ce.push(new bh(Er.keyField(),n))}return e.ce}function Es(t){const e=Ke(t);return e.le||(e.le=Jb(e,pc(t))),e.le}function Jb(t,e){if(t.limitType==="F")return W_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new bh(s.field,i)});const r=t.endAt?new Fh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Fh(t.startAt.position,t.startAt.inclusive):null;return W_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function um(t,e){const r=t.filters.concat([e]);return new ku(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function fm(t,e,r){return new ku(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Ad(t,e){return tv(Es(t),Es(e))&&t.limitType===e.limitType}function Tk(t){return`${ev(Es(t))}|lt:${t.limitType}`}function mo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>yk(s)).join(", ")}]`),Sd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>il(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>il(s)).join(",")),`Target(${n})`}(Es(t))}; limitType=${t.limitType})`}function Id(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Oe.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of pc(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,o,l){const c=$_(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,pc(n),s)||n.endAt&&!function(a,o,l){const c=$_(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,pc(n),s))}(t,e)}function Zb(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function kk(t){return(e,r)=>{let n=!1;for(const s of pc(t)){const i=e3(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function e3(t,e,r){const n=t.field.isKeyField()?Oe.comparator(e.key,r.key):function(i,a,o){const l=a.data.field(i),c=o.data.field(i);return l!==null&&c!==null?sl(l,c):$e()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return $e()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ya(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return dk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3=new zt(Oe.comparator);function ci(){return t3}const Sk=new zt(Oe.comparator);function Yl(...t){let e=Sk;for(const r of t)e=e.insert(r.key,r);return e}function Ak(t){let e=Sk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ea(){return mc()}function Ik(){return mc()}function mc(){return new vl(t=>t.toString(),(t,e)=>t.isEqual(e))}const r3=new zt(Oe.comparator),n3=new Sr(Oe.comparator);function it(...t){let e=n3;for(const r of t)e=e.add(r);return e}const s3=new Sr(wt);function i3(){return s3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dh(e)?"-0":e}}function Ck(t){return{integerValue:""+t}}function a3(t,e){return Mb(e)?Ck(e):nv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(){this._=void 0}}function o3(t,e,r){return t instanceof Jc?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Qg(i)&&(i=Jg(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(r,e):t instanceof Zc?Nk(t,e):t instanceof eu?Pk(t,e):function(s,i){const a=Rk(s,i),o=K_(a)+K_(s.Pe);return om(a)&&om(s.Pe)?Ck(o):nv(s.serializer,o)}(t,e)}function l3(t,e,r){return t instanceof Zc?Nk(t,e):t instanceof eu?Pk(t,e):r}function Rk(t,e){return t instanceof Oh?function(n){return om(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class Jc extends Cd{}class Zc extends Cd{constructor(e){super(),this.elements=e}}function Nk(t,e){const r=Dk(e);for(const n of t.elements)r.some(s=>Ss(s,n))||r.push(n);return{arrayValue:{values:r}}}class eu extends Cd{constructor(e){super(),this.elements=e}}function Pk(t,e){let r=Dk(e);for(const n of t.elements)r=r.filter(s=>!Ss(s,n));return{arrayValue:{values:r}}}class Oh extends Cd{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function K_(t){return qt(t.integerValue||t.doubleValue)}function Dk(t){return Zg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3{constructor(e,r){this.field=e,this.transform=r}}function u3(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Zc&&s instanceof Zc||n instanceof eu&&s instanceof eu?nl(n.elements,s.elements,Ss):n instanceof Oh&&s instanceof Oh?Ss(n.Pe,s.Pe):n instanceof Jc&&s instanceof Jc}(t.transform,e.transform)}class f3{constructor(e,r){this.version=e,this.transformResults=r}}class Ln{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Ln}static exists(e){return new Ln(void 0,e)}static updateTime(e){return new Ln(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Kf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Rd{}function Fk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new sv(t.key,Ln.none()):new Su(t.key,t.data,Ln.none());{const r=t.data,n=ln.empty();let s=new Sr(Er.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new aa(t.key,n,new yn(s.toArray()),Ln.none())}}function h3(t,e,r){t instanceof Su?function(s,i,a){const o=s.value.clone(),l=X_(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof aa?function(s,i,a){if(!Kf(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=X_(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(bk(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function gc(t,e,r,n){return t instanceof Su?function(i,a,o,l){if(!Kf(i.precondition,a))return o;const c=i.value.clone(),u=Y_(i.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof aa?function(i,a,o,l){if(!Kf(i.precondition,a))return o;const c=Y_(i.fieldTransforms,l,a),u=a.data;return u.setAll(bk(i)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(i,a,o){return Kf(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function d3(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=Rk(n.transform,s||null);i!=null&&(r===null&&(r=ln.empty()),r.set(n.field,i))}return r||null}function q_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&nl(n,s,(i,a)=>u3(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Su extends Rd{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class aa extends Rd{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function bk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function X_(t,e,r){const n=new Map;Ct(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,l3(a,o,r[s]))}return n}function Y_(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,o3(i,a,e))}return n}class sv extends Rd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class p3 extends Rd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&h3(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=gc(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=gc(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Ik();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const l=Fk(a,o);l!==null&&n.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(We.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),it())}isEqual(e){return this.batchId===e.batchId&&nl(this.mutations,e.mutations,(r,n)=>q_(r,n))&&nl(this.baseMutations,e.baseMutations,(r,n)=>q_(r,n))}}class iv{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){Ct(e.mutations.length===n.length);let s=function(){return r3}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new iv(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v3{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt,ht;function x3(t){switch(t){default:return $e();case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0}}function Ok(t){if(t===void 0)return li("GRPC error has no .code"),ue.UNKNOWN;switch(t){case Jt.OK:return ue.OK;case Jt.CANCELLED:return ue.CANCELLED;case Jt.UNKNOWN:return ue.UNKNOWN;case Jt.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case Jt.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case Jt.INTERNAL:return ue.INTERNAL;case Jt.UNAVAILABLE:return ue.UNAVAILABLE;case Jt.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case Jt.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case Jt.NOT_FOUND:return ue.NOT_FOUND;case Jt.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case Jt.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case Jt.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case Jt.ABORTED:return ue.ABORTED;case Jt.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case Jt.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case Jt.DATA_LOSS:return ue.DATA_LOSS;default:return $e()}}(ht=Jt||(Jt={}))[ht.OK=0]="OK",ht[ht.CANCELLED=1]="CANCELLED",ht[ht.UNKNOWN=2]="UNKNOWN",ht[ht.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ht[ht.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ht[ht.NOT_FOUND=5]="NOT_FOUND",ht[ht.ALREADY_EXISTS=6]="ALREADY_EXISTS",ht[ht.PERMISSION_DENIED=7]="PERMISSION_DENIED",ht[ht.UNAUTHENTICATED=16]="UNAUTHENTICATED",ht[ht.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ht[ht.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ht[ht.ABORTED=10]="ABORTED",ht[ht.OUT_OF_RANGE=11]="OUT_OF_RANGE",ht[ht.UNIMPLEMENTED=12]="UNIMPLEMENTED",ht[ht.INTERNAL=13]="INTERNAL",ht[ht.UNAVAILABLE=14]="UNAVAILABLE",ht[ht.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _3(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y3=new Ca([4294967295,4294967295],0);function Q_(t){const e=_3().encode(t),r=new ik;return r.update(e),new Uint8Array(r.digest())}function J_(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ca([r,n],0),new Ca([s,i],0)]}class av{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Ql(`Invalid padding: ${r}`);if(n<0)throw new Ql(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ql(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Ql(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Ca.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(Ca.fromNumber(n)));return s.compare(y3)===1&&(s=new Ca([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=Q_(e),[n,s]=J_(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);if(!this.de(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new av(i,s,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=Q_(e),[n,s]=J_(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Ql extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Au.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Nd(We.min(),s,new zt(wt),ci(),it())}}class Au{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Au(n,r,it(),it(),it())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class Mk{constructor(e,r){this.targetId=e,this.me=r}}class Lk{constructor(e,r,n=Rr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class Z_{constructor(){this.fe=0,this.ge=ty(),this.pe=Rr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=it(),r=it(),n=it();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:$e()}}),new Au(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=ty()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ct(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class w3{constructor(e){this.Le=e,this.Be=new Map,this.ke=ci(),this.qe=ey(),this.Qe=new zt(wt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:$e()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(cm(i))if(n===0){const a=new Oe(i.path);this.Ue(r,a,Vr.newNoDocument(a,We.min()))}else Ct(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=Va(n).toUint8Array()}catch(l){if(l instanceof pk)return rl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new av(a,s,i)}catch(l){return rl(l instanceof Ql?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,a)=>{const o=this.Je(a);if(o){if(i.current&&cm(o.target)){const l=new Oe(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Vr.newNoDocument(l,e))}i.be&&(r.set(a,i.ve()),i.Ce())}});let n=it();this.qe.forEach((i,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new Nd(e,r,this.Qe,this.ke,n);return this.ke=ci(),this.qe=ey(),this.Qe=new zt(wt),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new Z_,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Sr(wt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||De("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Z_),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function ey(){return new zt(Oe.comparator)}function ty(){return new zt(Oe.comparator)}const E3={asc:"ASCENDING",desc:"DESCENDING"},T3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},k3={and:"AND",or:"OR"};class S3{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function hm(t,e){return t.useProto3Json||Sd(e)?e:{value:e}}function Mh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function jk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function A3(t,e){return Mh(t,e.toTimestamp())}function Ts(t){return Ct(!!t),We.fromTimestamp(function(r){const n=Ji(r);return new ur(n.seconds,n.nanos)}(t))}function ov(t,e){return dm(t,e).canonicalString()}function dm(t,e){const r=function(s){return new bt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Vk(t){const e=bt.fromString(t);return Ct(Hk(e)),e}function pm(t,e){return ov(t.databaseId,e.path)}function O0(t,e){const r=Vk(e);if(r.get(1)!==t.databaseId.projectId)throw new Pe(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Pe(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Oe(Bk(r))}function Uk(t,e){return ov(t.databaseId,e)}function I3(t){const e=Vk(t);return e.length===4?bt.emptyPath():Bk(e)}function mm(t){return new bt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Bk(t){return Ct(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function ry(t,e,r){return{name:pm(t,e),fields:r.value.mapValue.fields}}function C3(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:$e()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(Ct(u===void 0||typeof u=="string"),Rr.fromBase64String(u||"")):(Ct(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Rr.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const u=c.code===void 0?ue.UNKNOWN:Ok(c.code);return new Pe(u,c.message||"")}(a);r=new Lk(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=O0(t,n.document.name),i=Ts(n.document.updateTime),a=n.document.createTime?Ts(n.document.createTime):We.min(),o=new ln({mapValue:{fields:n.document.fields}}),l=Vr.newFoundDocument(s,i,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new qf(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=O0(t,n.document),i=n.readTime?Ts(n.readTime):We.min(),a=Vr.newNoDocument(s,i),o=n.removedTargetIds||[];r=new qf([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=O0(t,n.document),i=n.removedTargetIds||[];r=new qf([],i,s,null)}else{if(!("filter"in e))return $e();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new v3(s,i),o=n.targetId;r=new Mk(o,a)}}return r}function R3(t,e){let r;if(e instanceof Su)r={update:ry(t,e.key,e.value)};else if(e instanceof sv)r={delete:pm(t,e.key)};else if(e instanceof aa)r={update:ry(t,e.key,e.data),updateMask:j3(e.fieldMask)};else{if(!(e instanceof p3))return $e();r={verify:pm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const o=a.transform;if(o instanceof Jc)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Zc)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof eu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Oh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw $e()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:A3(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:$e()}(t,e.precondition)),r}function N3(t,e){return t&&t.length>0?(Ct(e!==void 0),t.map(r=>function(s,i){let a=s.updateTime?Ts(s.updateTime):Ts(i);return a.isEqual(We.min())&&(a=Ts(i)),new f3(a,s.transformResults||[])}(r,e))):[]}function P3(t,e){return{documents:[Uk(t,e.path)]}}function D3(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Uk(t,s);const i=function(c){if(c.length!==0)return $k(os.create(c,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(c){if(c.length!==0)return c.map(u=>function(p){return{field:go(p.field),direction:O3(p.dir)}}(u))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=hm(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:s}}function F3(t){let e=I3(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Ct(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];r.where&&(i=function(h){const p=zk(h);return p instanceof os&&xk(p)?p.getFilters():[p]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(p=>function(x){return new bh(vo(x.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(p))}(r.orderBy));let o=null;r.limit&&(o=function(h){let p;return p=typeof h=="object"?h.value:h,Sd(p)?null:p}(r.limit));let l=null;r.startAt&&(l=function(h){const p=!!h.before,m=h.values||[];return new Fh(m,p)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const p=!h.before,m=h.values||[];return new Fh(m,p)}(r.endAt)),Qb(e,s,a,i,o,"F",l,c)}function b3(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $e()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function zk(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=vo(r.unaryFilter.field);return nr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=vo(r.unaryFilter.field);return nr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=vo(r.unaryFilter.field);return nr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=vo(r.unaryFilter.field);return nr.create(a,"!=",{nullValue:"NULL_VALUE"});default:return $e()}}(t):t.fieldFilter!==void 0?function(r){return nr.create(vo(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $e()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return os.create(r.compositeFilter.filters.map(n=>zk(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return $e()}}(r.compositeFilter.op))}(t):$e()}function O3(t){return E3[t]}function M3(t){return T3[t]}function L3(t){return k3[t]}function go(t){return{fieldPath:t.canonicalString()}}function vo(t){return Er.fromServerFormat(t.fieldPath)}function $k(t){return t instanceof nr?function(r){if(r.op==="=="){if(z_(r.value))return{unaryFilter:{field:go(r.field),op:"IS_NAN"}};if(B_(r.value))return{unaryFilter:{field:go(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(z_(r.value))return{unaryFilter:{field:go(r.field),op:"IS_NOT_NAN"}};if(B_(r.value))return{unaryFilter:{field:go(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:go(r.field),op:M3(r.op),value:r.value}}}(t):t instanceof os?function(r){const n=r.getFilters().map(s=>$k(s));return n.length===1?n[0]:{compositeFilter:{op:L3(r.op),filters:n}}}(t):$e()}function j3(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Hk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e,r,n,s,i=We.min(),a=We.min(),o=Rr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Fi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Fi(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{constructor(e){this.ct=e}}function U3(t){const e=F3({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?fm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B3{constructor(){this.un=new z3}addToCollectionParentIndex(e,r){return this.un.add(r),ge.resolve()}getCollectionParents(e,r){return ge.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return ge.resolve()}deleteFieldIndex(e,r){return ge.resolve()}deleteAllFieldIndexes(e){return ge.resolve()}createTargetIndexes(e,r){return ge.resolve()}getDocumentsMatchingTarget(e,r){return ge.resolve(null)}getIndexType(e,r){return ge.resolve(0)}getFieldIndexes(e,r){return ge.resolve([])}getNextCollectionGroupToUpdate(e){return ge.resolve(null)}getMinOffset(e,r){return ge.resolve(Qi.min())}getMinOffsetFromCollectionGroup(e,r){return ge.resolve(Qi.min())}updateCollectionGroup(e,r,n){return ge.resolve()}updateIndexEntries(e,r){return ge.resolve()}}class z3{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Sr(bt.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Sr(bt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new al(0)}static kn(){return new al(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $3{constructor(){this.changes=new vl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Vr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ge.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&gc(n.mutation,s,yn.empty(),ur.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,it()).next(()=>n))}getLocalViewOfDocuments(e,r,n=it()){const s=Ea();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=Yl();return i.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Ea();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,it()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,s){let i=ci();const a=mc(),o=function(){return mc()}();return r.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof aa)?i=i.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),gc(u.mutation,c,u.mutation.getFieldMask(),ur.now())):a.set(c.key,yn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var h;return o.set(c,new H3(u,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=mc();let s=new zt((a,o)=>a-o),i=it();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||yn.empty();u=o.applyToLocalView(c,u),n.set(l,u);const h=(s.get(o.batchId)||it()).add(l);s=s.insert(o.batchId,h)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,h=Ik();u.forEach(p=>{if(!i.has(p)){const m=Fk(r.get(p),n.get(p));m!==null&&h.set(p,m),i=i.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return ge.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return Oe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Ek(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):ge.resolve(Ea());let o=-1,l=i;return a.next(c=>ge.forEach(c,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),i.get(u)?ge.resolve():this.remoteDocumentCache.getEntry(e,u).next(p=>{l=l.insert(u,p)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,it())).next(u=>({batchId:o,changes:Ak(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Oe(r)).next(n=>{let s=Yl();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=Yl();return this.indexManager.getCollectionParents(e,i).next(o=>ge.forEach(o,l=>{const c=function(h,p){return new ku(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(u=>{u.forEach((h,p)=>{a=a.insert(h,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,Vr.newInvalidDocument(u)))});let o=Yl();return a.forEach((l,c)=>{const u=i.get(l);u!==void 0&&gc(u.mutation,c,yn.empty(),ur.now()),Id(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return ge.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Ts(s.createTime)}}(r)),ge.resolve()}getNamedQuery(e,r){return ge.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:U3(s.bundledQuery),readTime:Ts(s.readTime)}}(r)),ge.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K3{constructor(){this.overlays=new zt(Oe.comparator),this.Ir=new Map}getOverlay(e,r){return ge.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ea();return ge.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),ge.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),ge.resolve()}getOverlaysForCollection(e,r,n){const s=Ea(),i=r.length+1,a=new Oe(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>n&&s.set(l.getKey(),l)}return ge.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new zt((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=i.get(c.largestBatchId);u===null&&(u=Ea(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Ea(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=s)););return ge.resolve(o)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new g3(r,n));let i=this.Ir.get(r);i===void 0&&(i=it(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(){this.sessionToken=Rr.EMPTY_BYTE_STRING}getSessionToken(e){return ge.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ge.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(){this.Tr=new Sr(hr.Er),this.dr=new Sr(hr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new hr(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new hr(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Oe(new bt([])),n=new hr(r,e),s=new hr(r,e+1),i=[];return this.dr.forEachInRange([n,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Oe(new bt([])),n=new hr(r,e),s=new hr(r,e+1);let i=it();return this.dr.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new hr(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class hr{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Oe.comparator(e.key,r.key)||wt(e.wr,r.wr)}static Ar(e,r){return wt(e.wr,r.wr)||Oe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X3{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Sr(hr.Er)}checkEmpty(e){return ge.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new m3(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.br=this.br.add(new hr(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return ge.resolve(a)}lookupMutationBatch(e,r){return ge.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return ge.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ge.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ge.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new hr(r,0),s=new hr(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],a=>{const o=this.Dr(a.wr);i.push(o)}),ge.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Sr(wt);return r.forEach(s=>{const i=new hr(s,0),a=new hr(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],o=>{n=n.add(o.wr)})}),ge.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;Oe.isDocumentKey(i)||(i=i.child(""));const a=new hr(new Oe(i),0);let o=new Sr(wt);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.wr)),!0)},a),ge.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){Ct(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return ge.forEach(r.mutations,s=>{const i=new hr(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new hr(r,0),s=this.br.firstAfterOrEqual(n);return ge.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ge.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y3{constructor(e){this.Mr=e,this.docs=function(){return new zt(Oe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ge.resolve(n?n.document.mutableCopy():Vr.newInvalidDocument(r))}getEntries(e,r){let n=ci();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Vr.newInvalidDocument(s))}),ge.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=ci();const a=r.path,o=new Oe(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Db(Pb(u),n)<=0||(s.has(u.key)||Id(r,u))&&(i=i.insert(u.key,u.mutableCopy()))}return ge.resolve(i)}getAllFromCollectionGroup(e,r,n,s){$e()}Or(e,r){return ge.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new Q3(this)}getSize(e){return ge.resolve(this.size)}}class Q3 extends $3{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),ge.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3{constructor(e){this.persistence=e,this.Nr=new vl(r=>ev(r),tv),this.lastRemoteSnapshotVersion=We.min(),this.highestTargetId=0,this.Lr=0,this.Br=new lv,this.targetCount=0,this.kr=al.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),ge.resolve()}getLastRemoteSnapshotVersion(e){return ge.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ge.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ge.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),ge.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new al(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,ge.resolve()}updateTargetData(e,r){return this.Kn(r),ge.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,ge.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),ge.waitFor(i).next(()=>s)}getTargetCount(e){return ge.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return ge.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),ge.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),ge.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),ge.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return ge.resolve(n)}containsKey(e,r){return ge.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Yg(0),this.Kr=!1,this.Kr=!0,this.$r=new q3,this.referenceDelegate=e(this),this.Ur=new J3(this),this.indexManager=new B3,this.remoteDocumentCache=function(s){return new Y3(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new V3(r),this.Gr=new G3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new K3,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new X3(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){De("MemoryPersistence","Starting transaction:",e);const s=new eO(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return ge.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class eO extends bb{constructor(e){super(),this.currentSequenceNumber=e}}class cv{constructor(e){this.persistence=e,this.Jr=new lv,this.Yr=null}static Zr(e){return new cv(e)}get Xr(){if(this.Yr)return this.Yr;throw $e()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),ge.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),ge.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),ge.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ge.forEach(this.Xr,n=>{const s=Oe.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,We.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return ge.or([()=>ge.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=it(),s=it();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new uv(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return oP()?8:Ob(Hr())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new tO;return this.Xi(e,r,a).next(o=>{if(i.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?($l()<=ot.DEBUG&&De("QueryEngine","SDK will not create cache indexes for query:",mo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ge.resolve()):($l()<=ot.DEBUG&&De("QueryEngine","Query:",mo(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?($l()<=ot.DEBUG&&De("QueryEngine","The SDK decides to create cache indexes for query:",mo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Es(r))):ge.resolve())}Yi(e,r){if(G_(r))return ge.resolve(null);let n=Es(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=fm(r,null,"F"),n=Es(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=it(...i);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,fm(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,s){return G_(r)||s.isEqual(We.min())?ge.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const a=this.ts(r,i);return this.ns(r,a,n,s)?ge.resolve(null):($l()<=ot.DEBUG&&De("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),mo(r)),this.rs(e,a,r,Nb(s,-1)).next(o=>o))})}ts(e,r){let n=new Sr(kk(e));return r.forEach((s,i)=>{Id(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return $l()<=ot.DEBUG&&De("QueryEngine","Using full collection scan to execute query:",mo(r)),this.Ji.getDocumentsMatchingQuery(e,r,Qi.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new zt(wt),this._s=new vl(i=>ev(i),tv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new W3(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function sO(t,e,r,n){return new nO(t,e,r,n)}async function Wk(t,e){const r=Ke(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],o=[];let l=it();for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function iO(t,e){const r=Ke(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const h=c.batch,p=h.keys();let m=ge.resolve();return p.forEach(x=>{m=m.next(()=>u.getEntry(l,x)).next(v=>{const y=c.docVersions.get(x);Ct(y!==null),v.version.compareTo(y)<0&&(h.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),u.addEntry(v)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=it();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function Gk(t){const e=Ke(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function aO(t,e){const r=Ke(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];e.targetChanges.forEach((u,h)=>{const p=s.get(h);if(!p)return;o.push(r.Ur.removeMatchingKeys(i,u.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(i,u.addedDocuments,h)));let m=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Rr.EMPTY_BYTE_STRING,We.min()).withLastLimboFreeSnapshotVersion(We.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,n)),s=s.insert(h,m),function(v,y,T){return v.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(p,m,u)&&o.push(r.Ur.updateTargetData(i,m))});let l=ci(),c=it();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,u))}),o.push(oO(i,a,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(We.min())){const u=r.Ur.getLastRemoteSnapshotVersion(i).next(h=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));o.push(u)}return ge.waitFor(o).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(r.os=s,i))}function oO(t,e,r){let n=it(),s=it();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=ci();return r.forEach((o,l)=>{const c=i.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(We.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):De("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:s}})}function lO(t,e){const r=Ke(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function cO(t,e){const r=Ke(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,ge.resolve(s)):r.Ur.allocateTargetId(n).next(a=>(s=new Fi(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function gm(t,e,r){const n=Ke(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Tu(a))throw a;De("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function ny(t,e,r){const n=Ke(t);let s=We.min(),i=it();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const h=Ke(l),p=h._s.get(u);return p!==void 0?ge.resolve(h.os.get(p)):h.Ur.getTargetData(c,u)}(n,a,Es(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{i=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?s:We.min(),r?i:it())).next(o=>(uO(n,Zb(e),o),{documents:o,Ts:i})))}function uO(t,e,r){let n=t.us.get(e)||We.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class sy{constructor(){this.activeTargetIds=i3()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fO{constructor(){this.so=new sy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new sy,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){De("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){De("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vf=null;function M0(){return vf===null?vf=function(){return 268435456+Math.round(2147483648*Math.random())}():vf++,"0x"+vf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br="WebChannelConnection";class mO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,a){const o=M0(),l=this.xo(r,n.toUriEncodedString());De("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,a),this.No(r,l,c,s).then(u=>(De("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw rl("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(r,n,s,i,a,o){return this.Mo(r,n,s,i,a)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+gl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,a)=>r[a]=i),s&&s.headers.forEach((i,a)=>r[a]=i)}xo(r,n){const s=dO[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=M0();return new Promise((a,o)=>{const l=new ak;l.setWithCredentials(!0),l.listenOnce(ok.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Wf.NO_ERROR:const u=l.getResponseJson();De(br,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),a(u);break;case Wf.TIMEOUT:De(br,`RPC '${e}' ${i} timed out`),o(new Pe(ue.DEADLINE_EXCEEDED,"Request time out"));break;case Wf.HTTP_ERROR:const h=l.getStatus();if(De(br,`RPC '${e}' ${i} failed with status:`,h,"response text:",l.getResponseText()),h>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const m=p==null?void 0:p.error;if(m&&m.status&&m.message){const x=function(y){const T=y.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(T)>=0?T:ue.UNKNOWN}(m.status);o(new Pe(x,m.message))}else o(new Pe(ue.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Pe(ue.UNAVAILABLE,"Connection failed."));break;default:$e()}}finally{De(br,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);De(br,`RPC '${e}' ${i} sending request:`,s),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const s=M0(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=uk(),o=ck(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=i.join("");De(br,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=a.createWebChannel(u,l);let p=!1,m=!1;const x=new pO({Io:y=>{m?De(br,`Not sending because RPC '${e}' stream ${s} is closed:`,y):(p||(De(br,`Opening RPC '${e}' stream ${s} transport.`),h.open(),p=!0),De(br,`RPC '${e}' stream ${s} sending:`,y),h.send(y))},To:()=>h.close()}),v=(y,T,k)=>{y.listen(T,w=>{try{k(w)}catch(D){setTimeout(()=>{throw D},0)}})};return v(h,Xl.EventType.OPEN,()=>{m||(De(br,`RPC '${e}' stream ${s} transport opened.`),x.yo())}),v(h,Xl.EventType.CLOSE,()=>{m||(m=!0,De(br,`RPC '${e}' stream ${s} transport closed`),x.So())}),v(h,Xl.EventType.ERROR,y=>{m||(m=!0,rl(br,`RPC '${e}' stream ${s} transport errored:`,y),x.So(new Pe(ue.UNAVAILABLE,"The operation could not be completed")))}),v(h,Xl.EventType.MESSAGE,y=>{var T;if(!m){const k=y.data[0];Ct(!!k);const w=k,D=w.error||((T=w[0])===null||T===void 0?void 0:T.error);if(D){De(br,`RPC '${e}' stream ${s} received error:`,D);const U=D.status;let V=function(S){const C=Jt[S];if(C!==void 0)return Ok(C)}(U),g=D.message;V===void 0&&(V=ue.INTERNAL,g="Unknown error status: "+U+" with message "+D.message),m=!0,x.So(new Pe(V,g)),h.close()}else De(br,`RPC '${e}' stream ${s} received:`,k),x.bo(k)}}),v(o,lk.STAT_EVENT,y=>{y.stat===im.PROXY?De(br,`RPC '${e}' stream ${s} detected buffering proxy`):y.stat===im.NOPROXY&&De(br,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}function L0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pd(t){return new S3(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&De("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e,r,n,s,i,a,o,l){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Kk(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===ue.RESOURCE_EXHAUSTED?(li(r.toString()),li("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new Pe(ue.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return De("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(De("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class gO extends qk{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=C3(this.serializer,e),n=function(i){if(!("targetChange"in i))return We.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?We.min():a.readTime?Ts(a.readTime):We.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=mm(this.serializer),r.addTarget=function(i,a){let o;const l=a.target;if(o=cm(l)?{documents:P3(i,l)}:{query:D3(i,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=jk(i,a.resumeToken);const c=hm(i,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(We.min())>0){o.readTime=Mh(i,a.snapshotVersion.toTimestamp());const c=hm(i,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=b3(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=mm(this.serializer),r.removeTarget=e,this.a_(r)}}class vO extends qk{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Ct(!!e.streamToken),this.lastStreamToken=e.streamToken,Ct(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ct(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=N3(e.writeResults,e.commitTime),n=Ts(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=mm(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>R3(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Pe(ue.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,dm(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Pe(ue.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,dm(r,n),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Pe(ue.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class _O{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(li(r),this.D_=!1):De("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{n.enqueueAndForget(async()=>{Qa(this)&&(De("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Ke(l);c.L_.add(4),await Iu(c),c.q_.set("Unknown"),c.L_.delete(4),await Dd(c)}(this))})}),this.q_=new _O(n,s)}}async function Dd(t){if(Qa(t))for(const e of t.B_)await e(!0)}async function Iu(t){for(const e of t.B_)await e(!1)}function Xk(t,e){const r=Ke(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),pv(r)?dv(r):xl(r).r_()&&hv(r,e))}function fv(t,e){const r=Ke(t),n=xl(r);r.N_.delete(e),n.r_()&&Yk(r,e),r.N_.size===0&&(n.r_()?n.o_():Qa(r)&&r.q_.set("Unknown"))}function hv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(We.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}xl(t).A_(e)}function Yk(t,e){t.Q_.xe(e),xl(t).R_(e)}function dv(t){t.Q_=new w3({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),xl(t).start(),t.q_.v_()}function pv(t){return Qa(t)&&!xl(t).n_()&&t.N_.size>0}function Qa(t){return Ke(t).L_.size===0}function Qk(t){t.Q_=void 0}async function wO(t){t.q_.set("Online")}async function EO(t){t.N_.forEach((e,r)=>{hv(t,e)})}async function TO(t,e){Qk(t),pv(t)?(t.q_.M_(e),dv(t)):t.q_.set("Unknown")}async function kO(t,e,r){if(t.q_.set("Online"),e instanceof Lk&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.N_.delete(o),s.Q_.removeTarget(o))}(t,e)}catch(n){De("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Lh(t,n)}else if(e instanceof qf?t.Q_.Ke(e):e instanceof Mk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(We.min()))try{const n=await Gk(t.localStore);r.compareTo(n)>=0&&await function(i,a){const o=i.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.N_.get(c);u&&i.N_.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=i.N_.get(l);if(!u)return;i.N_.set(l,u.withResumeToken(Rr.EMPTY_BYTE_STRING,u.snapshotVersion)),Yk(i,l);const h=new Fi(u.target,l,c,u.sequenceNumber);hv(i,h)}),i.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){De("RemoteStore","Failed to raise snapshot:",n),await Lh(t,n)}}async function Lh(t,e,r){if(!Tu(e))throw e;t.L_.add(1),await Iu(t),t.q_.set("Offline"),r||(r=()=>Gk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{De("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Dd(t)})}function Jk(t,e){return e().catch(r=>Lh(t,r,e))}async function Fd(t){const e=Ke(t),r=Zi(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;SO(e);)try{const s=await lO(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,AO(e,s)}catch(s){await Lh(e,s)}Zk(e)&&eS(e)}function SO(t){return Qa(t)&&t.O_.length<10}function AO(t,e){t.O_.push(e);const r=Zi(t);r.r_()&&r.V_&&r.m_(e.mutations)}function Zk(t){return Qa(t)&&!Zi(t).n_()&&t.O_.length>0}function eS(t){Zi(t).start()}async function IO(t){Zi(t).p_()}async function CO(t){const e=Zi(t);for(const r of t.O_)e.m_(r.mutations)}async function RO(t,e,r){const n=t.O_.shift(),s=iv.from(n,e,r);await Jk(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Fd(t)}async function NO(t,e){e&&Zi(t).V_&&await async function(n,s){if(function(a){return x3(a)&&a!==ue.ABORTED}(s.code)){const i=n.O_.shift();Zi(n).s_(),await Jk(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Fd(n)}}(t,e),Zk(t)&&eS(t)}async function ay(t,e){const r=Ke(t);r.asyncQueue.verifyOperationInProgress(),De("RemoteStore","RemoteStore received new credentials");const n=Qa(r);r.L_.add(3),await Iu(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Dd(r)}async function PO(t,e){const r=Ke(t);e?(r.L_.delete(2),await Dd(r)):e||(r.L_.add(2),await Iu(r),r.q_.set("Unknown"))}function xl(t){return t.K_||(t.K_=function(r,n,s){const i=Ke(r);return i.w_(),new gO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:wO.bind(null,t),Ro:EO.bind(null,t),mo:TO.bind(null,t),d_:kO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),pv(t)?dv(t):t.q_.set("Unknown")):(await t.K_.stop(),Qk(t))})),t.K_}function Zi(t){return t.U_||(t.U_=function(r,n,s){const i=Ke(r);return i.w_(),new vO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:IO.bind(null,t),mo:NO.bind(null,t),f_:CO.bind(null,t),g_:RO.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Fd(t)):(await t.U_.stop(),t.O_.length>0&&(De("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Qs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new mv(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Pe(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gv(t,e){if(li("AsyncQueue",`${e}: ${t}`),Tu(t))return new Pe(ue.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Oe.comparator(r.key,n.key):(r,n)=>Oe.comparator(r.key,n.key),this.keyedMap=Yl(),this.sortedSet=new zt(this.comparator)}static emptySet(e){return new Bo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Bo)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Bo;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(){this.W_=new zt(Oe.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):$e():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class ol{constructor(e,r,n,s,i,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new ol(e,r,Bo.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ad(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class FO{constructor(){this.queries=ly(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Ke(r),i=s.queries;s.queries=ly(),i.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Pe(ue.ABORTED,"Firestore shutting down"))}}function ly(){return new vl(t=>Tk(t),Ad)}async function tS(t,e){const r=Ke(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new DO,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=gv(a,`Initialization of query '${mo(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&vv(r)}async function rS(t,e){const r=Ke(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function bO(t,e){const r=Ke(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.j_)o.X_(s)&&(n=!0);a.z_=s}}n&&vv(r)}function OO(t,e,r){const n=Ke(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function vv(t){t.Y_.forEach(e=>{e.next()})}var vm,cy;(cy=vm||(vm={})).ea="default",cy.Cache="cache";class nS{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new ol(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=ol.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==vm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e){this.key=e}}class iS{constructor(e){this.key=e}}class MO{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=it(),this.mutatedKeys=it(),this.Aa=kk(e),this.Ra=new Bo(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new oy,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const p=s.get(u),m=Id(this.query,h)?h:null,x=!!p&&this.mutatedKeys.has(p.key),v=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let y=!1;p&&m?p.data.isEqual(m.data)?x!==v&&(n.track({type:3,doc:m}),y=!0):this.ga(p,m)||(n.track({type:2,doc:m}),y=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(o=!0)):!p&&m?(n.track({type:0,doc:m}),y=!0):p&&!m&&(n.track({type:1,doc:p}),y=!0,(l||c)&&(o=!0)),y&&(m?(a=a.add(m),i=v?i.add(u):i.delete(u)):(a=a.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),i=i.delete(u.key),n.track({type:1,doc:u})}return{Ra:a,fa:n,ns:o,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((u,h)=>function(m,x){const v=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $e()}};return v(m)-v(x)}(u.type,h.type)||this.Aa(u.doc,h.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new ol(this.query,e.Ra,i,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new oy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=it(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new iS(n))}),this.da.forEach(n=>{e.has(n)||r.push(new sS(n))}),r}ba(e){this.Ta=e.Ts,this.da=it();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return ol.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class LO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class jO{constructor(e){this.key=e,this.va=!1}}class VO{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new vl(o=>Tk(o),Ad),this.Ma=new Map,this.xa=new Set,this.Oa=new zt(Oe.comparator),this.Na=new Map,this.La=new lv,this.Ba={},this.ka=new Map,this.qa=al.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function UO(t,e,r=!0){const n=fS(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await aS(n,e,r,!0),s}async function BO(t,e){const r=fS(t);await aS(r,e,!0,!1)}async function aS(t,e,r,n){const s=await cO(t.localStore,Es(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await zO(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&Xk(t.remoteStore,s),o}async function zO(t,e,r,n,s){t.Ka=(h,p,m)=>async function(v,y,T,k){let w=y.view.ma(T);w.ns&&(w=await ny(v.localStore,y.query,!1).then(({documents:g})=>y.view.ma(g,w)));const D=k&&k.targetChanges.get(y.targetId),U=k&&k.targetMismatches.get(y.targetId)!=null,V=y.view.applyChanges(w,v.isPrimaryClient,D,U);return fy(v,y.targetId,V.wa),V.snapshot}(t,h,p,m);const i=await ny(t.localStore,e,!0),a=new MO(e,i.Ts),o=a.ma(i.documents),l=Au.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=a.applyChanges(o,t.isPrimaryClient,l);fy(t,r,c.wa);const u=new LO(e,r,a);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function $O(t,e,r){const n=Ke(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(a=>!Ad(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await gm(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&fv(n.remoteStore,s.targetId),xm(n,s.targetId)}).catch(Eu)):(xm(n,s.targetId),await gm(n.localStore,s.targetId,!0))}async function HO(t,e){const r=Ke(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),fv(r.remoteStore,n.targetId))}async function WO(t,e,r){const n=JO(t);try{const s=await function(a,o){const l=Ke(a),c=ur.now(),u=o.reduce((m,x)=>m.add(x.key),it());let h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let x=ci(),v=it();return l.cs.getEntries(m,u).next(y=>{x=y,x.forEach((T,k)=>{k.isValidDocument()||(v=v.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,x)).next(y=>{h=y;const T=[];for(const k of o){const w=d3(k,h.get(k.key).overlayedDocument);w!=null&&T.push(new aa(k.key,w,mk(w.value.mapValue),Ln.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,T,o)}).next(y=>{p=y;const T=y.applyToLocalDocumentSet(h,v);return l.documentOverlayCache.saveOverlays(m,y.batchId,T)})}).then(()=>({batchId:p.batchId,changes:Ak(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new zt(wt)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,s.batchId,r),await Cu(n,s.changes),await Fd(n.remoteStore)}catch(s){const i=gv(s,"Failed to persist write");r.reject(i)}}async function oS(t,e){const r=Ke(t);try{const n=await aO(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Na.get(i);a&&(Ct(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?Ct(a.va):s.removedDocuments.size>0&&(Ct(a.va),a.va=!1))}),await Cu(r,n,e)}catch(n){await Eu(n)}}function uy(t,e,r){const n=Ke(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,a)=>{const o=a.view.Z_(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const l=Ke(a);l.onlineState=o;let c=!1;l.queries.forEach((u,h)=>{for(const p of h.j_)p.Z_(o)&&(c=!0)}),c&&vv(l)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function GO(t,e,r){const n=Ke(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let a=new zt(Oe.comparator);a=a.insert(i,Vr.newNoDocument(i,We.min()));const o=it().add(i),l=new Nd(We.min(),new Map,new zt(wt),a,o);await oS(n,l),n.Oa=n.Oa.remove(i),n.Na.delete(e),xv(n)}else await gm(n.localStore,e,!1).then(()=>xm(n,e,r)).catch(Eu)}async function KO(t,e){const r=Ke(t),n=e.batch.batchId;try{const s=await iO(r.localStore,e);cS(r,n,null),lS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Cu(r,s)}catch(s){await Eu(s)}}async function qO(t,e,r){const n=Ke(t);try{const s=await function(a,o){const l=Ke(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(Ct(h!==null),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);cS(n,e,r),lS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Cu(n,s)}catch(s){await Eu(s)}}function lS(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function cS(t,e,r){const n=Ke(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function xm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||uS(t,n)})}function uS(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(fv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),xv(t))}function fy(t,e,r){for(const n of r)n instanceof sS?(t.La.addReference(n.key,e),XO(t,n)):n instanceof iS?(De("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||uS(t,n.key)):$e()}function XO(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(De("SyncEngine","New document in limbo: "+r),t.xa.add(n),xv(t))}function xv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Oe(bt.fromString(e)),n=t.qa.next();t.Na.set(n,new jO(r)),t.Oa=t.Oa.insert(r,n),Xk(t.remoteStore,new Fi(Es(rv(r.path)),n,"TargetPurposeLimboResolution",Yg.oe))}}async function Cu(t,e,r){const n=Ke(t),s=[],i=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=uv.Wi(l.targetId,c);i.push(h)}}))}),await Promise.all(a),n.Ca.d_(s),await async function(l,c){const u=Ke(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ge.forEach(c,p=>ge.forEach(p.$i,m=>u.persistence.referenceDelegate.addReference(h,p.targetId,m)).next(()=>ge.forEach(p.Ui,m=>u.persistence.referenceDelegate.removeReference(h,p.targetId,m)))))}catch(h){if(!Tu(h))throw h;De("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const p=h.targetId;if(!h.fromCache){const m=u.os.get(p),x=m.snapshotVersion,v=m.withLastLimboFreeSnapshotVersion(x);u.os=u.os.insert(p,v)}}}(n.localStore,i))}async function YO(t,e){const r=Ke(t);if(!r.currentUser.isEqual(e)){De("SyncEngine","User change. New user:",e.toKey());const n=await Wk(r.localStore,e);r.currentUser=e,function(i,a){i.ka.forEach(o=>{o.forEach(l=>{l.reject(new Pe(ue.CANCELLED,a))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Cu(r,n.hs)}}function QO(t,e){const r=Ke(t),n=r.Na.get(e);if(n&&n.va)return it().add(n.key);{let s=it();const i=r.Ma.get(e);if(!i)return s;for(const a of i){const o=r.Fa.get(a);s=s.unionWith(o.view.Va)}return s}}function fS(t){const e=Ke(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=oS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=QO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=GO.bind(null,e),e.Ca.d_=bO.bind(null,e.eventManager),e.Ca.$a=OO.bind(null,e.eventManager),e}function JO(t){const e=Ke(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=KO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qO.bind(null,e),e}class jh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Pd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return sO(this.persistence,new rO,e.initialUser,this.serializer)}Ga(e){return new Z3(cv.Zr,this.serializer)}Wa(e){return new fO}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jh.provider={build:()=>new jh};class _m{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>uy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=YO.bind(null,this.syncEngine),await PO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new FO}()}createDatastore(e){const r=Pd(e.databaseInfo.databaseId),n=function(i){return new mO(i)}(e.databaseInfo);return function(i,a,o,l){return new xO(i,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,o){return new yO(n,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>uy(this.syncEngine,r,0),function(){return iy.D()?new iy:new hO}())}createSyncEngine(e,r){return function(s,i,a,o,l,c,u){const h=new VO(s,i,a,o,l,c);return u&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Ke(s);De("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Iu(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}_m.provider={build:()=>new _m};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):li("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Mr.UNAUTHENTICATED,this.clientId=hk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{De("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(De("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=gv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function j0(t,e){t.asyncQueue.verifyOperationInProgress(),De("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await Wk(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function hy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await eM(t);De("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>ay(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>ay(e.remoteStore,s)),t._onlineComponents=e}async function eM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){De("FirestoreClient","Using user provided OfflineComponentProvider");try{await j0(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===ue.FAILED_PRECONDITION||s.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;rl("Error using user provided cache. Falling back to memory cache: "+r),await j0(t,new jh)}}else De("FirestoreClient","Using default OfflineComponentProvider"),await j0(t,new jh);return t._offlineComponents}async function dS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(De("FirestoreClient","Using user provided OnlineComponentProvider"),await hy(t,t._uninitializedComponentsProvider._online)):(De("FirestoreClient","Using default OnlineComponentProvider"),await hy(t,new _m))),t._onlineComponents}function tM(t){return dS(t).then(e=>e.syncEngine)}async function pS(t){const e=await dS(t),r=e.eventManager;return r.onListen=UO.bind(null,e.syncEngine),r.onUnlisten=$O.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=BO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=HO.bind(null,e.syncEngine),r}function rM(t,e,r={}){const n=new Qs;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new hS({next:p=>{u.Za(),a.enqueueAndForget(()=>rS(i,h));const m=p.docs.has(o);!m&&p.fromCache?c.reject(new Pe(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&l&&l.source==="server"?c.reject(new Pe(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new nS(rv(o.path),u,{includeMetadataChanges:!0,_a:!0});return tS(i,h)}(await pS(t),t.asyncQueue,e,r,n)),n.promise}function nM(t,e,r={}){const n=new Qs;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new hS({next:p=>{u.Za(),a.enqueueAndForget(()=>rS(i,h)),p.fromCache&&l.source==="server"?c.reject(new Pe(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new nS(o,u,{includeMetadataChanges:!0,_a:!0});return tS(i,h)}(await pS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gS(t,e,r){if(!r)throw new Pe(ue.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function sM(t,e,r,n){if(e===!0&&n===!0)throw new Pe(ue.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function py(t){if(!Oe.isDocumentKey(t))throw new Pe(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function my(t){if(Oe.isDocumentKey(t))throw new Pe(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function bd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":$e()}function ls(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Pe(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=bd(t);throw new Pe(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Pe(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Pe(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mS((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Pe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Pe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Pe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Od{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Pe(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Pe(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gy(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new wb;switch(n.type){case"firstParty":return new Sb(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Pe(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=dy.get(r);n&&(De("ComponentProvider","Removing Datastore"),dy.delete(r),n.terminate())}(this),Promise.resolve()}}function iM(t,e,r,n={}){var s;const i=(t=ls(t,Od))._getSettings(),a=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&rl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Mr.MOCK_USER;else{o=_T(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Pe(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Mr(c)}t._authCredentials=new Eb(new fk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new _l(this.firestore,e,this._query)}}class Jr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Gi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jr(this.firestore,e,this._key)}}class Gi extends _l{constructor(e,r,n){super(e,r,rv(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jr(this.firestore,null,new Oe(e))}withConverter(e){return new Gi(this.firestore,e,this._path)}}function Ta(t,e,...r){if(t=sr(t),gS("collection","path",e),t instanceof Od){const n=bt.fromString(e,...r);return my(n),new Gi(t,null,n)}{if(!(t instanceof Jr||t instanceof Gi))throw new Pe(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(bt.fromString(e,...r));return my(n),new Gi(t.firestore,null,n)}}function cs(t,e,...r){if(t=sr(t),arguments.length===1&&(e=hk.newId()),gS("doc","path",e),t instanceof Od){const n=bt.fromString(e,...r);return py(n),new Jr(t,null,new Oe(n))}{if(!(t instanceof Jr||t instanceof Gi))throw new Pe(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(bt.fromString(e,...r));return py(n),new Jr(t.firestore,t instanceof Gi?t.converter:null,new Oe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Kk(this,"async_queue_retry"),this.Vu=()=>{const n=L0();n&&De("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=L0();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=L0();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Qs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Tu(e))throw e;De("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw li("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=mv.createAndSchedule(this,e,r,n,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&$e()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}class Ja extends Od{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new vy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vy(e),this._firestoreClient=void 0,await e}}}function aM(t,e){const r=typeof t=="object"?t:wd(),n=typeof t=="string"?t:"(default)",s=xu(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=Og("firestore");i&&iM(s,...i)}return s}function _v(t){if(t._terminated)throw new Pe(ue.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||oM(t),t._firestoreClient}function oM(t){var e,r,n;const s=t._freezeSettings(),i=function(o,l,c,u){return new jb(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,mS(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new ZO(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ll(Rr.fromBase64String(e))}catch(r){throw new Pe(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ll(Rr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Pe(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Er(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Pe(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Pe(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return wt(this._lat,e._lat)||wt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM=/^__.*__$/;class cM{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new aa(e,this.data,this.fieldMask,r,this.fieldTransforms):new Su(e,this.data,r,this.fieldTransforms)}}class vS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new aa(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function xS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $e()}}class Ev{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Ev(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Vh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(xS(this.Cu)&&lM.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class uM{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Pd(e)}Qu(e,r,n,s=!1){return new Ev({Cu:e,methodName:r,qu:n,path:Er.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function jd(t){const e=t._freezeSettings(),r=Pd(t._databaseId);return new uM(t._databaseId,!!e.ignoreUndefinedProperties,r)}function _S(t,e,r,n,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,r,s);kv("Data must be an object, but it was:",a,n);const o=yS(n,a);let l,c;if(i.merge)l=new yn(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const p=ym(e,h,r);if(!a.contains(p))throw new Pe(ue.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);ES(u,p)||u.push(p)}l=new yn(u),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new cM(new ln(o),l,c)}class Vd extends Ld{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Vd}}class Tv extends Ld{_toFieldTransform(e){return new c3(e.path,new Jc)}isEqual(e){return e instanceof Tv}}function fM(t,e,r,n){const s=t.Qu(1,e,r);kv("Data must be an object, but it was:",s,n);const i=[],a=ln.empty();Ya(n,(l,c)=>{const u=Sv(e,l,r);c=sr(c);const h=s.Nu(u);if(c instanceof Vd)i.push(u);else{const p=Ru(c,h);p!=null&&(i.push(u),a.set(u,p))}});const o=new yn(i);return new vS(a,o,s.fieldTransforms)}function hM(t,e,r,n,s,i){const a=t.Qu(1,e,r),o=[ym(e,n,r)],l=[s];if(i.length%2!=0)throw new Pe(ue.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)o.push(ym(e,i[p])),l.push(i[p+1]);const c=[],u=ln.empty();for(let p=o.length-1;p>=0;--p)if(!ES(c,o[p])){const m=o[p];let x=l[p];x=sr(x);const v=a.Nu(m);if(x instanceof Vd)c.push(m);else{const y=Ru(x,v);y!=null&&(c.push(m),u.set(m,y))}}const h=new yn(c);return new vS(u,h,a.fieldTransforms)}function dM(t,e,r,n=!1){return Ru(r,t.Qu(n?4:3,e))}function Ru(t,e){if(wS(t=sr(t)))return kv("Unsupported field value:",e,t),yS(t,e);if(t instanceof Ld)return function(n,s){if(!xS(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const o of n){let l=Ru(o,s.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=sr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return a3(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=ur.fromDate(n);return{timestampValue:Mh(s.serializer,i)}}if(n instanceof ur){const i=new ur(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Mh(s.serializer,i)}}if(n instanceof yv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ll)return{bytesValue:jk(s.serializer,n._byteString)};if(n instanceof Jr){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ov(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof wv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return nv(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${bd(n)}`)}(t,e)}function yS(t,e){const r={};return dk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ya(t,(n,s)=>{const i=Ru(s,e.Mu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function wS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ur||t instanceof yv||t instanceof ll||t instanceof Jr||t instanceof Ld||t instanceof wv)}function kv(t,e,r){if(!wS(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=bd(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function ym(t,e,r){if((e=sr(e))instanceof Md)return e._internalPath;if(typeof e=="string")return Sv(t,e);throw Vh("Field path arguments must be of type string or ",t,!1,void 0,r)}const pM=new RegExp("[~\\*/\\[\\]]");function Sv(t,e,r){if(e.search(pM)>=0)throw Vh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Md(...e.split("."))._internalPath}catch{throw Vh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Vh(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${n}`),a&&(l+=` in document ${s}`),l+=")"),new Pe(ue.INVALID_ARGUMENT,o+t+l)}function ES(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Jr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new mM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Av("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class mM extends TS{data(){return super.data()}}function Av(t,e){return typeof e=="string"?Sv(t,e):e instanceof Md?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gM(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Pe(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Iv{}class vM extends Iv{}function V0(t,e,...r){let n=[];e instanceof Iv&&n.push(e),n=n.concat(r),function(i){const a=i.filter(l=>l instanceof Cv).length,o=i.filter(l=>l instanceof Ud).length;if(a>1||a>0&&o>0)throw new Pe(ue.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Ud extends vM{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Ud(e,r,n)}_apply(e){const r=this._parse(e);return kS(e._query,r),new _l(e.firestore,e.converter,um(e._query,r))}_parse(e){const r=jd(e.firestore);return function(i,a,o,l,c,u,h){let p;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Pe(ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){_y(h,u);const m=[];for(const x of h)m.push(xy(l,i,x));p={arrayValue:{values:m}}}else p=xy(l,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||_y(h,u),p=dM(o,a,h,u==="in"||u==="not-in");return nr.create(c,u,p)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function U0(t,e,r){const n=e,s=Av("where",t);return Ud._create(s,n,r)}class Cv extends Iv{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Cv(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:os.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)kS(a,l),a=um(a,l)}(e._query,r),new _l(e.firestore,e.converter,um(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function xy(t,e,r){if(typeof(r=sr(r))=="string"){if(r==="")throw new Pe(ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ek(e)&&r.indexOf("/")!==-1)throw new Pe(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(bt.fromString(r));if(!Oe.isDocumentKey(n))throw new Pe(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return U_(t,new Oe(n))}if(r instanceof Jr)return U_(t,r._key);throw new Pe(ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bd(r)}.`)}function _y(t,e){if(!Array.isArray(t)||t.length===0)throw new Pe(ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function kS(t,e){const r=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Pe(ue.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Pe(ue.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class xM{convertValue(e,r="none"){switch(Ua(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Va(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw $e()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ya(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(a=>qt(a.doubleValue));return new wv(i)}convertGeoPoint(e){return new yv(qt(e.latitude),qt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Jg(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Xc(e));default:return null}}convertTimestamp(e){const r=Ji(e);return new ur(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=bt.fromString(e);Ct(Hk(n));const s=new Yc(n.get(1),n.get(3)),i=new Oe(n.popFirst(5));return s.isEqual(r)||li(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class AS extends TS{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Xf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Av("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Xf extends AS{data(e={}){return super.data(e)}}class _M{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Jl(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Xf(this._firestore,this._userDataWriter,n.key,n,new Jl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Pe(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const l=new Xf(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Jl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const l=new Xf(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Jl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:yM(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function yM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $e()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ba(t){t=ls(t,Jr);const e=ls(t.firestore,Ja);return rM(_v(e),t._key).then(r=>EM(e,t,r))}class IS extends xM{constructor(e){super(),this.firestore=e}convertBytes(e){return new ll(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Jr(this.firestore,null,r)}}function zo(t){t=ls(t,_l);const e=ls(t.firestore,Ja),r=_v(e),n=new IS(e);return gM(t._query),nM(r,t._query).then(s=>new _M(e,n,t,s))}function Uh(t,e,r){t=ls(t,Jr);const n=ls(t.firestore,Ja),s=SS(t.converter,e,r);return Bd(n,[_S(jd(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,Ln.none())])}function Rv(t,e,r,...n){t=ls(t,Jr);const s=ls(t.firestore,Ja),i=jd(s);let a;return a=typeof(e=sr(e))=="string"||e instanceof Md?hM(i,"updateDoc",t._key,e,r,n):fM(i,"updateDoc",t._key,e),Bd(s,[a.toMutation(t._key,Ln.exists(!0))])}function wM(t){return Bd(ls(t.firestore,Ja),[new sv(t._key,Ln.none())])}function yy(t,e){const r=ls(t.firestore,Ja),n=cs(t),s=SS(t.converter,e);return Bd(r,[_S(jd(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Ln.exists(!1))]).then(()=>n)}function Bd(t,e){return function(n,s){const i=new Qs;return n.asyncQueue.enqueueAndForget(async()=>WO(await tM(n),s,i)),i.promise}(_v(t),e)}function EM(t,e,r){const n=r.docs.get(e._key),s=new IS(t);return new AS(t,s,e._key,n,new Jl(r.hasPendingWrites,r.fromCache),e.converter)}function TM(){return new Tv("serverTimestamp")}(function(e,r=!0){(function(s){gl=s})(Xa),Yi(new ii("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new Ja(new Tb(n.getProvider("auth-internal")),new Ib(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Pe(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yc(c.options.projectId,u)}(a,s),a);return i=Object.assign({useFetchStreams:r},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Mn(O_,"4.7.3",e),Mn(O_,"4.7.3","esm2017")})();var kM="firebase",SM="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mn(kM,SM,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CS="firebasestorage.googleapis.com",AM="storageBucket",IM=2*60*1e3,CM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns extends Rs{constructor(e,r,n=0){super(B0(e),`Firebase Storage: ${r} (${B0(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ns.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return B0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var As;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(As||(As={}));function B0(t){return"storage/"+t}function RM(){const t="An unknown error occurred, please check the error payload for server response.";return new Ns(As.UNKNOWN,t)}function NM(){return new Ns(As.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function PM(){return new Ns(As.CANCELED,"User canceled the upload/download.")}function DM(t){return new Ns(As.INVALID_URL,"Invalid URL '"+t+"'.")}function FM(t){return new Ns(As.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function wy(t){return new Ns(As.INVALID_ARGUMENT,t)}function RS(){return new Ns(As.APP_DELETED,"The Firebase app was deleted.")}function bM(t){return new Ns(As.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Zn.makeFromUrl(e,r)}catch{return new Zn(e,"")}if(n.path==="")return n;throw FM(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+s+a,"i"),l={bucket:1,path:3};function c(D){D.path_=decodeURIComponent(D.path)}const u="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${u}/b/${s}/o${p}`,"i"),x={bucket:1,path:3},v=r===CS?"(?:storage.googleapis.com|storage.cloud.google.com)":r,y="([^?#]*)",T=new RegExp(`^https?://${v}/${s}/${y}`,"i"),w=[{regex:o,indices:l,postModify:i},{regex:m,indices:x,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let D=0;D<w.length;D++){const U=w[D],V=U.regex.exec(e);if(V){const g=V[U.indices.bucket];let E=V[U.indices.path];E||(E=""),n=new Zn(g,E),U.postModify(n);break}}if(n==null)throw DM(e);return n}}class OM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MM(t,e,r){let n=1,s=null,i=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(...y){c||(c=!0,e.apply(null,y))}function h(y){s=setTimeout(()=>{s=null,t(m,l())},y)}function p(){i&&clearTimeout(i)}function m(y,...T){if(c){p();return}if(y){p(),u.call(null,y,...T);return}if(l()||a){p(),u.call(null,y,...T);return}n<64&&(n*=2);let w;o===1?(o=2,w=0):w=(n+Math.random())*1e3,h(w)}let x=!1;function v(y){x||(x=!0,p(),!c&&(s!==null?(y||(o=2),clearTimeout(s),h(0)):y||(o=1)))}return h(0),i=setTimeout(()=>{a=!0,v(!0)},r),v}function LM(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jM(t){return t!==void 0}function Ey(t,e,r,n){if(n<e)throw wy(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw wy(`Invalid value for '${t}'. Expected ${r} or less.`)}function VM(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var Bh;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Bh||(Bh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UM(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(e,r,n,s,i,a,o,l,c,u,h,p=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,x)=>{this.resolve_=m,this.reject_=x,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new xf(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const o=i.getErrorCode()===Bh.NO_ERROR,l=i.getStatus();if(!o||UM(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===Bh.ABORT;n(!1,new xf(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new xf(c,i))})},r=(n,s)=>{const i=this.resolve_,a=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());jM(l)?i(l):i()}catch(l){a(l)}else if(o!==null){const l=RM();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(s.canceled){const l=this.appDelete_?RS():PM();a(l)}else{const l=NM();a(l)}};this.canceled_?r(!1,new xf(!1,null,!0)):this.backoffId_=MM(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&LM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class xf{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function zM(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function $M(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function HM(t,e){e&&(t["X-Firebase-GMPID"]=e)}function WM(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function GM(t,e,r,n,s,i,a=!0){const o=VM(t.urlParams),l=t.url+o,c=Object.assign({},t.headers);return HM(c,e),zM(c,r),$M(c,i),WM(c,n),new BM(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KM(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function qM(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e,r){this._service=e,r instanceof Zn?this._location=r:this._location=Zn.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new zh(e,r)}get root(){const e=new Zn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return qM(this._location.path)}get storage(){return this._service}get parent(){const e=KM(this._location.path);if(e===null)return null;const r=new Zn(this._location.bucket,e);return new zh(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw bM(e)}}function Ty(t,e){const r=e==null?void 0:e[AM];return r==null?null:Zn.makeFromBucketSpec(r,t)}function XM(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:_T(s,t.app.options.projectId))}class YM{constructor(e,r,n,s,i){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=CS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=IM,this._maxUploadRetryTime=CM,this._requests=new Set,s!=null?this._bucket=Zn.makeFromBucketSpec(s,this._host):this._bucket=Ty(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Zn.makeFromBucketSpec(this._url,e):this._bucket=Ty(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ey("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ey("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new zh(this,e)}_makeRequest(e,r,n,s,i=!0){if(this._deleted)return new OM(RS());{const a=GM(e,this._appId,n,s,r,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const ky="@firebase/storage",Sy="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS="storage";function QM(t=wd(),e){t=sr(t);const n=xu(t,NS).getImmediate({identifier:e}),s=Og("storage");return s&&JM(n,...s),n}function JM(t,e,r,n={}){XM(t,e,r,n)}function ZM(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new YM(r,n,s,e,Xa)}function e6(){Yi(new ii(NS,ZM,"PUBLIC").setMultipleInstances(!0)),Mn(ky,Sy,""),Mn(ky,Sy,"esm2017")}e6();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PS="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(e,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wm="us-central1";class r6{constructor(e,r,n,s,i=wm,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new t6(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(i);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=wm}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function n6(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}const Ay="@firebase/functions",Iy="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6="auth-internal",i6="app-check-internal",a6="messaging-internal";function o6(t,e){const r=(n,{instanceIdentifier:s})=>{const i=n.getProvider("app").getImmediate(),a=n.getProvider(s6),o=n.getProvider(a6),l=n.getProvider(i6);return new r6(i,a,o,l,s,t)};Yi(new ii(PS,r,"PUBLIC").setMultipleInstances(!0)),Mn(Ay,Iy,e),Mn(Ay,Iy,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l6(t=wd(),e=wm){const n=xu(sr(t),PS).getImmediate({identifier:e}),s=Og("functions");return s&&c6(n,...s),n}function c6(t,e,r){n6(sr(t),e,r)}o6(fetch.bind(self));const u6={apiKey:"AIzaSyAnEPcQISz9FY68mib-0StN6NQtTF3oz1c",authDomain:"xmas-movies.firebaseapp.com",projectId:"xmas-movies",storageBucket:"xmas-movies.firebasestorage.app",messagingSenderId:"721037810395",appId:"1:721037810395:web:1126b377adcc225c944afe"},zd=ET(u6),vc=_b(zd),DS=new xs;DS.setCustomParameters({prompt:"select_account"});const f6=DS,Tr=aM(zd);QM(zd);l6(zd);const FS=X.createContext(void 0),di=()=>{const t=X.useContext(FS);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},h6=({children:t})=>{const[e,r]=X.useState(null),[n,s]=X.useState(null),[i,a]=X.useState(!0),[o,l]=X.useState(null);X.useEffect(()=>{const p=GT(vc,async m=>{if(r(m),l(null),m)try{const x=cs(Tr,"users",m.uid),v=await Ba(x);if(v.exists())await Uh(x,{lastLoginAt:TM()},{merge:!0}),s(v.data());else{const y={email:m.email||"",displayName:m.displayName||"User",photoURL:m.photoURL||void 0,createdAt:new Date,lastLoginAt:new Date};await Uh(x,y),s({id:m.uid,...y})}}catch(x){console.error("Error fetching user profile:",x),l("Failed to load user profile")}else s(null);a(!1)});return()=>p()},[]);const h={currentUser:e,userProfile:n,isLoading:i,error:o,signInWithGoogle:async()=>{try{l(null),a(!0);const p=new xs;await nk(vc,p)}catch(p){console.error("Login error:",p),l(p.message||"Failed to sign in")}finally{a(!1)}},signOut:async()=>{try{await cF(vc)}catch(p){console.error("Sign out error:",p),l(p.message||"Failed to sign out")}}};return d.jsx(FS.Provider,{value:h,children:t})},$d=()=>{const[t,e]=X.useState(!1),[r,n]=X.useState(!0),[s,i]=X.useState(null),[a,o]=X.useState(null);return X.useEffect(()=>{const l=GT(vc,async c=>{if(n(!0),i(null),!c){e(!1),o(null),n(!1);return}o({uid:c.uid,email:c.email});try{if((await PT(c)).claims.admin===!0){e(!0),n(!1);return}const p=cs(Tr,"admins",c.uid),m=await Ba(p);e(m.exists())}catch(u){console.error("Error checking admin status:",u),i("Failed to verify admin status"),e(!1)}finally{n(!1)}});return()=>l()},[]),{isAdmin:t,loading:r,error:s,currentUser:a}},d6=({snowflakeCount:t=100,mobileSnowflakeCount:e=50})=>{const[r,n]=X.useState(!1),[s,i]=X.useState(t),a=X.useRef(null),o=X.useRef([]),l=X.useRef(0);return X.useEffect(()=>{const c=()=>{const u=window.matchMedia("(max-width: 768px)").matches;n(u),i(u?e:t)};return c(),window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}},[t,e]),X.useEffect(()=>{const c=a.current;if(!c)return;const u=c.getContext("2d");if(!u)return;const h=()=>{c.width=window.innerWidth,c.height=window.innerHeight},p=()=>{o.current=[];for(let y=0;y<s;y++)o.current.push({x:Math.random()*c.width,y:Math.random()*c.height,size:r?Math.random()*3+1:Math.random()*4+1,speed:r?Math.random()*.8+.3:Math.random()*1+.5,opacity:r?Math.random()*.5+.2:Math.random()*.6+.3,wind:r?Math.random()*.3-.15:Math.random()*.5-.25})},m=y=>{u.beginPath(),u.arc(y.x,y.y,y.size,0,Math.PI*2),u.fillStyle=`rgba(255, 255, 255, ${y.opacity})`,u.fill()},x=y=>{y.y+=y.speed,y.x+=y.wind,y.y>c.height&&(y.y=-10,y.x=Math.random()*c.width),y.x>c.width?y.x=0:y.x<0&&(y.x=c.width)},v=()=>{u.clearRect(0,0,c.width,c.height),o.current.forEach(y=>{m(y),x(y)}),l.current=requestAnimationFrame(v)};return window.addEventListener("resize",h),h(),p(),v(),()=>{window.removeEventListener("resize",h),cancelAnimationFrame(l.current)}},[s]),d.jsx("canvas",{ref:a,className:"fixed top-0 left-0 w-full h-full pointer-events-none z-10","aria-hidden":"true"})},p6=()=>{const[t,e]=X.useState(!1),[r,n]=X.useState(null),[s,i]=X.useState(!1);X.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;i(l);const c=u=>{u.preventDefault(),n(u),e(!0)};return window.addEventListener("beforeinstallprompt",c),window.matchMedia("(display-mode: standalone)").matches&&e(!1),()=>{window.removeEventListener("beforeinstallprompt",c)}},[]);const a=async()=>{if(!r)return;r.prompt();const{outcome:l}=await r.userChoice;n(null),e(!1),console.log(`User ${l==="accepted"?"accepted":"dismissed"} the install prompt`)},o=()=>{e(!1),localStorage.setItem("installPromptDismissed","true")};return t?d.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-green-800 text-white p-4 shadow-lg z-50 flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"mr-3 text-2xl",children:d.jsx("i",{className:"fas fa-gift"})}),d.jsx("div",{children:s?d.jsxs("p",{children:["Install this app on your device: tap ",d.jsx("i",{className:"fas fa-share"}),' and then "Add to Home Screen"']}):d.jsx("p",{children:"Add Christmas Movies to your home screen!"})})]}),d.jsxs("div",{className:"flex items-center",children:[!s&&d.jsx("button",{onClick:a,className:"bg-red-700 hover:bg-red-800 text-white py-1 px-4 rounded-full mr-2",children:"Install"}),d.jsx("button",{onClick:o,className:"bg-transparent hover:bg-green-700 text-white py-1 px-2 rounded-full",children:d.jsx("i",{className:"fas fa-times"})})]})]}):null};function m6(){const{currentUser:t}=di(),{isAdmin:e}=$d(),[r,n]=X.useState(!1),s=Ka();X.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]),X.useEffect(()=>{r&&n(!1)},[s.pathname]);const i=()=>{n(!r)};return d.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-xmas-bg to-xmas-card bg-opacity-95",children:[d.jsx(d6,{snowflakeCount:150,mobileSnowflakeCount:40}),d.jsx(p6,{}),d.jsxs("div",{className:"navbar bg-gradient-to-r from-xmas-card via-xmas-card to-xmas-bg border-b border-xmas-gold px-2 sm:px-4 shadow-lg relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),d.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-8 snow-accumulation-fast"}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("button",{className:"btn btn-ghost btn-sm md:hidden relative z-10",onClick:i,"aria-label":"Toggle navigation menu",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),d.jsxs(vt,{to:"/",className:"hidden sm:flex items-center group",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-xmas-gold to-xmas-line rounded-full opacity-70 group-hover:opacity-100 blur transition duration-200"}),d.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 bg-xmas-card rounded-full border border-xmas-gold overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})})]}),d.jsx("div",{className:"ml-3 font-christmas text-xl sm:text-2xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),d.jsxs(vt,{to:"/",className:"sm:hidden flex items-center",children:[d.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),d.jsx("span",{className:"ml-2 font-christmas text-lg text-xmas-gold",children:"Christmas Movies"})]})]}),d.jsx("div",{className:"flex-1"}),d.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t&&d.jsxs(vt,{to:"/profile",className:"btn btn-primary btn-sm hidden md:flex",children:[d.jsx("i",{className:"fas fa-user-circle mr-1"})," Profile"]}),t?d.jsxs("div",{className:"dropdown dropdown-end",children:[d.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar cursor-pointer",children:d.jsx("div",{className:"w-10 rounded-full border border-xmas-gold",children:t.photoURL?d.jsx("img",{src:t.photoURL,alt:"Profile"}):d.jsx("div",{className:"bg-xmas-card flex items-center justify-center h-full",children:d.jsx("i",{className:"fas fa-user text-xmas-gold"})})})}),d.jsxs("ul",{tabIndex:0,className:"dropdown-content menu menu-sm mt-3 z-[1] p-2 shadow bg-xmas-card rounded-box w-52 border border-xmas-gold",children:[d.jsx("li",{children:d.jsxs(vt,{to:"/profile",className:"justify-between",children:["Profile",d.jsx("i",{className:"fas fa-user-circle"})]})}),d.jsx("li",{children:d.jsxs(vt,{to:"/movies",children:["My Movies",d.jsx("i",{className:"fas fa-film"})]})}),d.jsx("li",{children:d.jsxs(vt,{to:"/random",children:["Random Movie",d.jsx("i",{className:"fas fa-random"})]})}),d.jsx("li",{children:d.jsxs(vt,{to:"/import",children:["Import Movies",d.jsx("i",{className:"fas fa-file-import"})]})}),e&&d.jsx("li",{children:d.jsxs(vt,{to:"/admin",className:"text-xmas-gold",children:["Admin Dashboard",d.jsx("i",{className:"fas fa-crown"})]})})]})]}):d.jsxs(vt,{to:"/login",className:"btn btn-primary btn-sm",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-1"})," Sign In"]})]})]}),d.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-70 z-20 transition-opacity duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:i}),d.jsxs("div",{className:`fixed top-0 left-0 h-full w-72 bg-gradient-to-b from-xmas-bg to-xmas-card border-r border-xmas-gold z-30 transform transition-transform duration-300 ease-in-out md:hidden shadow-xl ${r?"translate-x-0":"-translate-x-full"}`,children:[d.jsxs("div",{className:"relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),d.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-xmas-gold bg-xmas-card bg-opacity-80",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold shadow-lg overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),d.jsx("div",{className:"ml-3 font-christmas text-xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),d.jsx("button",{className:"btn btn-ghost btn-sm text-xmas-text hover:text-xmas-line",onClick:i,"aria-label":"Close navigation menu",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),d.jsx("div",{className:"overflow-y-auto h-full pb-20",children:d.jsx("div",{className:"p-4 pt-6",children:d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"font-christmas text-xl text-xmas-gold mb-4 pl-2 border-l-2 border-xmas-line",children:"Navigation"}),d.jsxs("ul",{className:"space-y-3",children:[d.jsx("li",{children:d.jsx(ua,{to:"/",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-home mr-3 text-xmas-gold"}),d.jsx("span",{children:"Home"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})}),t?d.jsxs(d.Fragment,{children:[d.jsx("li",{children:d.jsx(ua,{to:"/movies",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-film mr-3 text-xmas-gold"}),d.jsx("span",{children:"My Movies"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(ua,{to:"/random",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-random mr-3 text-xmas-gold"}),d.jsx("span",{children:"Random Movie"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(ua,{to:"/import",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-file-import mr-3 text-xmas-gold"}),d.jsx("span",{children:"Import Movies"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(ua,{to:"/profile",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-user-circle mr-3 text-xmas-gold"}),d.jsx("span",{children:"Profile"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})}),e&&d.jsx("li",{children:d.jsx(ua,{to:"/admin",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-crown mr-3 text-xmas-gold"}),d.jsx("span",{children:"Admin Dashboard"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})})]}):d.jsx("li",{children:d.jsx(ua,{to:"/login",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-3 text-xmas-gold"}),d.jsx("span",{children:"Sign In"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})})]})]})})})]}),d.jsx("main",{className:"p-4",children:d.jsx(uT,{})}),d.jsx("div",{className:"fixed bottom-0 left-0 w-full pointer-events-none",children:d.jsx("div",{className:"container mx-auto",children:d.jsxs("div",{className:"relative h-16",children:[d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-40"}),d.jsx("div",{className:"absolute bottom-4 left-4 opacity-30",children:d.jsx("i",{className:"fas fa-tree text-4xl text-xmas-gold"})}),d.jsx("div",{className:"absolute bottom-4 right-4 opacity-30",children:d.jsx("i",{className:"fas fa-star text-4xl text-xmas-gold"})})]})})})]})}const Cy=({children:t})=>{const{currentUser:e,isLoading:r}=di();return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):e?t?d.jsx(d.Fragment,{children:t}):d.jsx(uT,{}):d.jsx(TN,{to:"/login"})},g6=()=>{const{currentUser:t}=di();return d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"text-center mb-12",children:[d.jsx("h1",{className:"font-christmas text-5xl md:text-7xl text-xmas-line mb-4",children:"My Christmas Movie"}),d.jsx("p",{className:"text-xl md:text-2xl text-xmas-snow mb-8",children:"Track, rate, and discover your favorite Christmas movies!"}),d.jsx("div",{className:"flex flex-col md:flex-row justify-center gap-6 mb-12",children:t?d.jsxs(d.Fragment,{children:[d.jsxs(vt,{to:"/movies",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-film mr-2"})," My Movies"]}),d.jsxs(vt,{to:"/random",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]}):d.jsxs(vt,{to:"/login",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In"]})})]}),d.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:d.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-20 snow-accumulation snow-accumulation-slow relative",children:[d.jsx("h2",{className:"font-christmas text-3xl text-xmas-line mb-6 text-center",children:"Features"}),d.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-search"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Find Movies"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Search and discover Christmas movies using TMDB integration"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-star"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Rate & Review"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Keep track of movies you've watched and rate them"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-random"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Random Picker"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Can't decide what to watch? Let our random movie picker help!"})]})]})]}),d.jsx("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 snow-accumulation snow-accumulation-fast relative",children:d.jsxs("div",{className:"mb-6 text-center",children:[d.jsxs("h2",{className:"font-christmas text-3xl md:text-4xl text-xmas-gold inline-block relative",children:[d.jsx("span",{className:"relative z-10",children:"Import Your Collection"}),d.jsx("span",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-xmas-gold opacity-30 rounded-full"})]}),d.jsx("p",{className:"mt-4 mb-6",children:"Already have a list of Christmas movies? Import them from Excel or search TMDB!"}),t?d.jsxs(vt,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]}):d.jsxs(vt,{to:"/login",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In to Import"]})]})}),d.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:d.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),d.jsx("footer",{className:"text-center text-xmas-mute mt-12 pb-8",children:d.jsxs("p",{children:[" ",new Date().getFullYear()," Christmas Movie Database"]})})]})},v6=()=>{const t=qa(),{currentUser:e,isLoading:r,error:n,signInWithGoogle:s}=di();X.useEffect(()=>{e&&!r&&t("/movies")},[e,r,t]);const i=async()=>{try{await s()}catch(a){console.error("Login failed:",a)}};return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsx("div",{className:"container mx-auto px-4 py-12",children:d.jsxs("div",{className:"max-w-md mx-auto",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Christmas Movie Database"}),d.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage your Christmas movie collection"})]}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[n&&d.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:d.jsx("p",{className:"text-error",children:n})}),d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access your Christmas movie collection."}),d.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Track, rate, and discover Christmas movies!"}),d.jsxs("button",{onClick:i,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[d.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                  s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                  s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),d.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                  l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),d.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                  c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),d.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                  c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})]})]}),d.jsx("div",{className:"text-center mt-6",children:d.jsx("p",{className:"text-sm text-xmas-mute",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})},x6=5*60*1e3;let Qn=null;const _6=(t,e,r)=>{Qn={userMovies:e,movies:r,timestamp:Date.now(),userId:t}},y6=t=>!Qn||Qn.userId!==t||Date.now()-Qn.timestamp>x6?null:{userMovies:Qn.userMovies,movies:Qn.movies},w6=()=>{Qn=null},E6=(t,e,r)=>{Qn&&Qn.userId===t&&(Qn.userMovies[e]=r,Qn.timestamp=Date.now())},Em=async(t,e,r)=>{const n=cs(Tr,`users/${t}/movies`,e);if((await Ba(n)).exists()){const o={...r,updatedAt:new Date};r.rating===null&&(o.rating=null),r.watchedDate===null&&(o.watchedDate=null),r.review===null&&(o.review=null),await Rv(n,o)}else{const o={userId:t,movieId:e,watched:r.watched||!1,favorite:r.favorite||!1,addedAt:new Date,updatedAt:new Date,...r};await Uh(n,o)}const i=await Ba(n),a={id:i.id,...i.data()};return E6(t,e,a),a},Tm=async(t,e)=>{const r=cs(Tr,`users/${t}/movies`,e),n=await Ba(r);return n.exists()?{id:n.id,...n.data()}:null},bS=async t=>{const e=Ta(Tr,`users/${t}/movies`),r=await zo(e),n=[];return r.forEach(s=>{n.push({id:s.id,...s.data()})}),n},T6=async(t,e)=>{const r=cs(Tr,`users/${t}/movies`,e);await wM(r),w6()},Nv=async t=>{const e=y6(t);if(e)return e;const r=await bS(t),n={},s=[];r.forEach(o=>{n[o.movieId]=o,s.push(o.movieId)});const i=[];if(s.length>0)for(let l=0;l<s.length;l+=10){const u=s.slice(l,l+10).map(p=>Ba(cs(Tr,"movies",p)).then(m=>m.exists()?{id:m.id,...m.data()}:null).catch(m=>(console.error(`Error fetching movie ${p}:`,m),null))),h=await Promise.all(u);i.push(...h.filter(Boolean))}const a={userMovies:n,movies:i};return _6(t,n,i),a},k6=()=>{const{currentUser:t}=di(),[e,r]=X.useState([]),[n,s]=X.useState({}),[i,a]=X.useState(!0),[o,l]=X.useState(!0),[c,u]=X.useState(null),[h,p]=X.useState("all"),[m,x]=X.useState({option:"title",direction:"asc"}),[v,y]=X.useState(""),[T,k]=X.useState("all");X.useEffect(()=>{(async()=>{if(t)try{l(!0);const{userMovies:E,movies:S}=await Nv(t.uid);s(E),r(S)}catch(E){console.error("Error fetching movies:",E),u("Failed to load movies")}finally{l(!1),a(!1)}})()},[t]);const w=g=>{x(E=>E.option===g?{option:g,direction:E.direction==="asc"?"desc":"asc"}:{option:g,direction:"asc"})},D=X.useCallback(g=>{if(!v.trim())return!0;const E=v.toLowerCase().trim(),S=n[g.id];switch(T){case"title":return g.title.toLowerCase().includes(E)||g.sortTitle&&g.sortTitle.toLowerCase().includes(E)||g.originalTitle&&g.originalTitle.toLowerCase().includes(E);case"year":return g.releaseDate&&g.releaseDate.substring(0,4).includes(E);case"all":default:return g.title.toLowerCase().includes(E)||g.sortTitle&&g.sortTitle.toLowerCase().includes(E)||g.originalTitle&&g.originalTitle.toLowerCase().includes(E)||g.releaseDate&&g.releaseDate.substring(0,4).includes(E)||g.overview&&g.overview.toLowerCase().includes(E)||g.genres&&g.genres.some(C=>C.toLowerCase().includes(E))||g.directors&&g.directors.some(C=>C.toLowerCase().includes(E))||g.cast&&g.cast.some(C=>C.toLowerCase().includes(E))||S&&S.review&&S.review.toLowerCase().includes(E)}},[v,T,n]),U=X.useMemo(()=>{if(o)return[];a(!0);const g=e.filter(E=>{const S=n[E.id];let C=!0;switch(h){case"watched":C=S&&S.watched;break;case"unwatched":C=!S||!S.watched;break;case"favorites":C=S&&S.favorite;break}return C&&D(E)}).sort((E,S)=>{const C=n[E.id],P=n[S.id],R=m.direction==="asc"?1:-1;switch(m.option){case"title":const b=E.sortTitle||E.title,ce=S.sortTitle||S.title;return b.localeCompare(ce)*R;case"year":const fe=E.releaseDate?parseInt(E.releaseDate.substring(0,4)):0,Ae=S.releaseDate?parseInt(S.releaseDate.substring(0,4)):0;return(fe-Ae)*R;case"rating":const _e=(C==null?void 0:C.rating)||0,oe=(P==null?void 0:P.rating)||0;return(_e-oe)*R;case"watched":const K=C!=null&&C.watched?1:0,de=P!=null&&P.watched?1:0;return(K-de)*R;case"added":const Te=C!=null&&C.addedAt?C.addedAt.getTime():0,B=P!=null&&P.addedAt?P.addedAt.getTime():0;return(Te-B)*R;default:return 0}});return a(!1),g},[e,n,h,m,v,T,o]),V=U;return o?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 sm:mb-8 gap-3",children:[d.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line",children:"My Christmas Movies"}),d.jsxs("div",{className:"flex gap-2 w-full sm:w-auto justify-center",children:[d.jsxs(vt,{to:"/random",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-random mr-1 sm:mr-2"})," ",d.jsx("span",{className:"hidden xs:inline",children:"Random Movie"}),d.jsx("span",{className:"xs:hidden",children:"Random"})]}),d.jsxs(vt,{to:"/import",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-file-import mr-1 sm:mr-2"})," ",d.jsx("span",{className:"hidden xs:inline",children:"Import Movies"}),d.jsx("span",{className:"xs:hidden",children:"Import"})]})]})]}),c&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:c})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[d.jsxs("div",{className:"relative flex-grow",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:d.jsx("i",{className:"fas fa-search text-gray-400"})}),d.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"Search movies...",value:v,onChange:g=>y(g.target.value)}),v&&d.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>y(""),children:d.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),d.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-36",value:T,onChange:g=>k(g.target.value),children:[d.jsx("option",{value:"all",children:"All Fields"}),d.jsx("option",{value:"title",children:"Title Only"}),d.jsx("option",{value:"year",children:"Year Only"})]})]}),d.jsxs("div",{className:"tabs tabs-boxed mb-3 text-xs sm:text-sm overflow-x-auto",children:[d.jsx("button",{className:`tab ${h==="all"?"tab-active":""}`,onClick:()=>p("all"),children:"All Movies"}),d.jsx("button",{className:`tab ${h==="watched"?"tab-active":""}`,onClick:()=>p("watched"),children:"Watched"}),d.jsx("button",{className:`tab ${h==="unwatched"?"tab-active":""}`,onClick:()=>p("unwatched"),children:"Unwatched"}),d.jsxs("button",{className:`tab ${h==="favorites"?"tab-active":""}`,onClick:()=>p("favorites"),children:[d.jsx("span",{className:"hidden sm:inline",children:"Favorites"}),d.jsx("span",{className:"sm:hidden",children:"Favs"})]})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-1 mb-3 bg-xmas-card bg-opacity-50 p-2 rounded-lg overflow-x-auto",children:[d.jsx("span",{className:"text-xs sm:text-sm font-medium mr-1",children:"Sort:"}),d.jsxs("div",{className:"flex flex-nowrap gap-1 overflow-x-auto",children:[d.jsxs("button",{className:`btn btn-xs ${m.option==="title"?"btn-primary":"btn-ghost"}`,onClick:()=>w("title"),children:["Title ",m.option==="title"&&d.jsx("i",{className:`fas fa-sort-${m.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${m.option==="year"?"btn-primary":"btn-ghost"}`,onClick:()=>w("year"),children:["Year ",m.option==="year"&&d.jsx("i",{className:`fas fa-sort-${m.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${m.option==="rating"?"btn-primary":"btn-ghost"}`,onClick:()=>w("rating"),children:["Rating ",m.option==="rating"&&d.jsx("i",{className:`fas fa-sort-${m.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${m.option==="watched"?"btn-primary":"btn-ghost"}`,onClick:()=>w("watched"),children:[d.jsx("span",{className:"hidden sm:inline",children:"Watched Status"}),d.jsx("span",{className:"sm:hidden",children:"Watched"}),m.option==="watched"&&d.jsx("i",{className:`fas fa-sort-${m.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${m.option==="added"?"btn-primary":"btn-ghost"}`,onClick:()=>w("added"),children:[d.jsx("span",{className:"hidden sm:inline",children:"Date Added"}),d.jsx("span",{className:"sm:hidden",children:"Added"}),m.option==="added"&&d.jsx("i",{className:`fas fa-sort-${m.direction==="asc"?"up":"down"} ml-1`})]})]})]}),d.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center mb-3 text-xs sm:text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:U.length})," ",U.length===1?"movie":"movies"," found",v&&d.jsxs("span",{className:"ml-1 text-xmas-mute",children:["for: ",d.jsxs("span",{className:"font-medium",children:['"',v,'"']})]})]}),m.option&&d.jsxs("div",{className:"text-xmas-mute",children:["Sorted by ",d.jsx("span",{className:"font-medium",children:m.option})," (",m.direction==="asc"?"asc":"desc",")"]})]}),i&&!o&&d.jsx("div",{className:"flex justify-center items-center py-4",children:d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-xmas-gold"})}),U.length===0?d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[d.jsx("h3",{className:"text-xl mb-4",children:"No movies found"}),d.jsx("p",{className:"mb-4",children:h==="all"?"You haven't added any Christmas movies yet.":`You don't have any ${h} Christmas movies.`}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[d.jsxs(vt,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]}),e.length>0&&d.jsxs(vt,{to:"/random",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]})]}):d.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:V.map(g=>{var S;const E=n[g.id];return d.jsx(vt,{to:`/movies/${g.id}`,className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:d.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[d.jsxs("div",{className:"relative",children:[g.posterUrl?d.jsx("img",{src:g.posterUrl,alt:g.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),E&&E.watched&&d.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:d.jsx("i",{className:"fas fa-check text-xs text-white"})}),E&&E.favorite&&d.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:d.jsx("i",{className:"fas fa-star text-sm"})})]}),d.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[d.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:g.title}),d.jsxs("div",{className:"flex justify-between items-center mt-1",children:[d.jsx("p",{className:"text-xs text-gray-400",children:(S=g.releaseDate)==null?void 0:S.substring(0,4)}),E&&E.rating&&d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"text-yellow-400 mr-0.5",children:d.jsx("i",{className:"fas fa-star text-xs"})}),d.jsx("span",{className:"text-xs",children:E.rating})]})]})]})]})},g.id)})})]})},S6=()=>{const{movieId:t}=cN(),e=qa(),{currentUser:r}=di(),[n,s]=X.useState(null),[i,a]=X.useState(null),[o,l]=X.useState(!0),[c,u]=X.useState(null),[h,p]=X.useState(!1),[m,x]=X.useState(!1),[v,y]=X.useState(""),[T,k]=X.useState(null),[w,D]=X.useState(""),[U,V]=X.useState(!1);X.useEffect(()=>{(async()=>{if(!(!r||!t))try{l(!0);const C=await Ba(cs(Tr,"movies",t));if(!C.exists()){u("Movie not found"),l(!1);return}const P={id:C.id,...C.data()};s(P);const R=await Tm(r.uid,t);if(R){a(R),x(R.watched);let b="";if(R.watchedDate)try{if(R.watchedDate instanceof Date)b=R.watchedDate.toISOString().split("T")[0];else{const ce=R.watchedDate;if(typeof ce=="object"&&ce!==null&&"seconds"in ce){const fe=ce;b=new Date(fe.seconds*1e3).toISOString().split("T")[0]}else{const fe=new Date(R.watchedDate);isNaN(fe.getTime())||(b=fe.toISOString().split("T")[0])}}}catch(ce){console.error("Error parsing watchedDate:",ce)}y(b),k(R.rating||null),D(R.review||""),V(R.favorite)}}catch(C){console.error("Error fetching movie data:",C),u("Failed to load movie data")}finally{l(!1)}})()},[r,t]);const g=async()=>{if(!(!r||!t||!n))try{p(!0);const S={userId:r.uid,movieId:t,watched:m,favorite:U,updatedAt:new Date};if(m&&v)try{S.watchedDate=new Date(v),isNaN(S.watchedDate.getTime())&&delete S.watchedDate}catch(P){console.error("Error parsing watchedDate for save:",P),delete S.watchedDate}else m||(S.watchedDate=null);S.rating=T,S.review=w||null;const C=await Em(r.uid,t,S);a(C)}catch(S){console.error("Error saving movie data:",S),u("Failed to save movie data")}finally{p(!1)}},E=async()=>{if(!(!r||!t||!window.confirm("Are you sure you want to remove this movie from your collection?")))try{p(!0),await T6(r.uid,t),e("/movies")}catch(S){console.error("Error deleting movie:",S),u("Failed to delete movie"),p(!1)}};return o?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):n?d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"mb-4",children:d.jsxs(vt,{to:"/movies",className:"btn btn-ghost",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),c&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:c})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"md:col-span-1",children:[d.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:n.posterUrl?d.jsx("img",{src:n.posterUrl,alt:n.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),d.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[d.jsxs("button",{className:`btn ${U?"btn-warning":"btn-outline"} w-full`,onClick:()=>V(!U),children:[d.jsx("i",{className:`fas fa-star mr-2 ${U?"text-white":""}`}),U?"Favorited":"Add to Favorites"]}),d.jsxs("button",{className:`btn ${m?"btn-success":"btn-outline"} w-full`,onClick:()=>x(!m),children:[d.jsx("i",{className:`fas fa-check mr-2 ${m?"text-white":""}`}),m?"Watched":"Mark as Watched"]}),d.jsxs("button",{className:"btn btn-error btn-outline w-full",onClick:E,disabled:h,children:[d.jsx("i",{className:"fas fa-trash mr-2"}),"Remove from Collection"]})]})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:n.title}),n.releaseDate&&d.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(n.releaseDate).getFullYear()}),n.genres&&n.genres.length>0&&d.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:n.genres.map((S,C)=>d.jsx("span",{className:"badge badge-outline",children:S},C))}),n.runtime&&d.jsxs("p",{className:"mb-4",children:[d.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(n.runtime/60),"h ",n.runtime%60,"m"]}),n.overview&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),d.jsx("p",{className:"text-gray-300",children:n.overview})]}),n.directors&&n.directors.length>0&&d.jsxs("div",{className:"mb-4",children:[d.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",n.directors.length>1?"s":""]}),d.jsx("p",{children:n.directors.join(", ")})]}),n.cast&&n.cast.length>0&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),d.jsx("p",{children:n.cast.slice(0,10).join(", ")})]}),d.jsx("div",{className:"divider"}),d.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold mb-4",children:"Your Rating & Review"}),m&&d.jsxs("div",{className:"form-control mb-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Date Watched"})}),d.jsx("input",{type:"date",className:"input input-bordered",value:v,onChange:S=>y(S.target.value)})]}),d.jsxs("div",{className:"form-control mb-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Your Rating"})}),d.jsx("div",{className:"rating rating-lg",children:[1,2,3,4,5,6,7,8,9,10].map(S=>d.jsx("input",{type:"radio",name:"rating",className:`mask mask-star-2 ${S<=5?"bg-orange-400":"bg-yellow-400"}`,checked:T===S,onChange:()=>k(S)},S))}),T&&d.jsx("div",{className:"mt-2",children:d.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>k(null),children:"Clear Rating"})})]}),d.jsxs("div",{className:"form-control mb-6",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Your Review"})}),d.jsx("textarea",{className:"textarea textarea-bordered h-32",placeholder:"Write your thoughts about this movie...",value:w,onChange:S=>D(S.target.value)})]}),d.jsx("div",{className:"flex justify-end",children:d.jsx("button",{className:"btn btn-primary",onClick:g,disabled:h,children:h?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Saving..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-save mr-2"}),"Save Changes"]})})})]})]})]}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"alert alert-error",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:"Movie not found"})]}),d.jsx("div",{className:"mt-4",children:d.jsx(vt,{to:"/movies",className:"btn btn-primary",children:"Back to Movies"})})]})},OS=t=>{const e=t.trim();return/^The\s+/i.test(e)?e.replace(/^The\s+/i,"").trim():/^A\s+/i.test(e)?e.replace(/^A\s+/i,"").trim():/^An\s+/i.test(e)?e.replace(/^An\s+/i,"").trim():e},MS="https://api.themoviedb.org/3",A6="https://image.tmdb.org/t/p/w500",I6="https://image.tmdb.org/t/p/original",z0=async(t,e)=>{try{const r=await fetch(`${MS}/search/movie?api_key=${e}&query=${encodeURIComponent(t)}&include_adult=false`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()}catch(r){throw console.error("Error searching TMDB:",r),r}},$0=async(t,e)=>{try{const r=await fetch(`${MS}/movie/${t}?api_key=${e}&append_to_response=credits`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()}catch(r){throw console.error("Error fetching movie details:",r),r}},Ry=t=>{var e,r,n;return{tmdbId:t.id,title:t.title,sortTitle:OS(t.title),originalTitle:t.original_title,releaseDate:t.release_date,posterUrl:t.poster_path?`${A6}${t.poster_path}`:void 0,backdropUrl:t.backdrop_path?`${I6}${t.backdrop_path}`:void 0,overview:t.overview,runtime:t.runtime,genres:((e=t.genres)==null?void 0:e.map(s=>s.name))||[],directors:((r=t.credits)==null?void 0:r.crew.filter(s=>s.job==="Director").map(s=>s.name))||[],cast:((n=t.credits)==null?void 0:n.cast.slice(0,10).map(s=>s.name))||[],isChristmas:!0}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var LS=1252,C6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Pv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Dv=function(t){C6.indexOf(t)!=-1&&(LS=Pv[0]=t)};function R6(){Dv(1252)}var es=function(t){Dv(t)};function jS(){es(1200),R6()}function Ny(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function N6(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function VS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Zl=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?N6(t.slice(2)):e==254&&r==255?VS(t.slice(2)):e==65279?t.slice(1):t},_f=function(e){return String.fromCharCode(e)},Py=function(e){return String.fromCharCode(e)},tu,bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Dy(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),i=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=bi.charAt(i)+bi.charAt(a)+bi.charAt(o)+bi.charAt(l);return e}function Tn(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)i=bi.indexOf(t.charAt(c++)),a=bi.indexOf(t.charAt(c++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=bi.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=bi.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var lt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Za=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ea(t){return lt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Fy(t){return lt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Jn=function(e){return lt?Za(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function eo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Fv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Fv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Ri=lt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Za(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function P6(t){for(var e=[],r=0,n=t.length+250,s=ea(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=ea(65535),n=65530)}return e.push(s.slice(0,r)),Ri(e)}var Zr=/\u0000/g,ec=/[\u0001-\u0006]/g;function $o(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ts(t,e){var r=""+t;return r.length>=e?r:Wt("0",e-r.length)+r}function bv(t,e){var r=""+t;return r.length>=e?r:Wt(" ",e-r.length)+r}function $h(t,e){var r=""+t;return r.length>=e?r:r+Wt(" ",e-r.length)}function D6(t,e){var r=""+Math.round(t);return r.length>=e?r:Wt("0",e-r.length)+r}function F6(t,e){var r=""+t;return r.length>=e?r:Wt("0",e-r.length)+r}var by=Math.pow(2,32);function po(t,e){if(t>by||t<-by)return D6(t,e);var r=Math.round(t);return F6(r,e)}function Hh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Oy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],H0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function b6(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Xe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},My={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},O6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Wh(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,l=1,c=0,u=0,h=Math.floor(s);c<e&&(h=Math.floor(s),o=h*a+i,u=h*c+l,!(s-h<5e-8));)s=1/(s-h),i=a,a=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=i):(u=c,o=a)),!r)return[0,n*o,u];var p=Math.floor(n*o/u);return[p,n*o-p*u,u]}function ka(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=B6(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var US=new Date(1899,11,31,0,0,0),M6=US.getTime(),L6=new Date(1900,2,1,0,0,0);function BS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=L6&&(r+=24*60*60*1e3),(r-(M6+(t.getTimezoneOffset()-US.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ov(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function j6(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function V6(t){var e=t<0?12:11,r=Ov(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function U6(t){var e=Ov(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function ru(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=V6(t):e===10?r=t.toFixed(10).substr(0,12):r=U6(t),Ov(j6(r.toUpperCase()))}function za(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):ru(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Un(14,BS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function B6(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function z6(t,e,r,n){var s="",i=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return H0[r.m-1][1];case 5:return H0[r.m-1][0];default:return H0[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Oy[r.q][0];default:return Oy[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ts(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=ts(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?ts(l,c):"";return u}function Oi(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var zS=/%/g;function $6(t,e,r){var n=e.replace(zS,""),s=e.length-n.length;return Js(t,n,r*Math.pow(10,2*s))+Wt("%",s)}function H6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Js(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function $S(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+$S(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var HS=/# (\?+)( ?)\/( ?)(\d+)/;function W6(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?Wt(" ",t[1].length+1+t[4].length):bv(a,t[1].length)+t[2]+"/"+t[3]+ts(o,t[4].length))}function G6(t,e,r){return r+(e===0?"":""+e)+Wt(" ",t[1].length+2+t[4].length)}var WS=/^#*0*\.([0#]+)/,GS=/\).*[0#]/,KS=/\(###\) ###\\?-####/;function qr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Ly(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function jy(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function K6(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function q6(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Nn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(GS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Nn("n",n,r):"("+Nn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return H6(t,e,r);if(e.indexOf("%")!==-1)return $6(t,e,r);if(e.indexOf("E")!==-1)return $S(e,r);if(e.charCodeAt(0)===36)return"$"+Nn(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+po(l,e.length);if(e.match(/^[#?]+$/))return s=po(r,0),s==="0"&&(s=""),s.length>e.length?s:qr(e.substr(0,e.length-s.length))+s;if(i=e.match(HS))return W6(i,l,c);if(e.match(/^#+0+$/))return c+po(l,e.length-e.indexOf("0"));if(i=e.match(WS))return s=Ly(r,i[1].length).replace(/^([^\.]+)$/,"$1."+qr(i[1])).replace(/\.$/,"."+qr(i[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+Wt("0",qr(i[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+Ly(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Oi(po(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Nn(t,e,-r):Oi(""+(Math.floor(r)+K6(r,i[1].length)))+"."+ts(jy(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Nn(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=$o(Nn(t,e.replace(/[\\-]/g,""),r)),a=0,$o($o(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(e.match(KS))return s=Nn(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Wh(l,Math.pow(10,a)-1,!1),s=""+c,u=Js("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=$h(o[2],a),u.length<i[4].length&&(u=qr(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Wh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?bv(o[1],a)+i[2]+"/"+i[3]+$h(o[2],a):Wt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=po(r,0),e.length<=s.length?s:qr(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,p=e.length-s.length-h;return qr(e.substr(0,h)+s+e.substr(e.length-p))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=jy(r,i[1].length),r<0?"-"+Nn(t,e,-r):Oi(q6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ts(0,3-x.length):"")+x})+"."+ts(a,i[1].length);switch(e){case"###,##0.00":return Nn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Oi(po(l,0));return m!=="0"?c+m:"";case"###,###.00":return Nn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Nn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function X6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Js(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Y6(t,e,r){var n=e.replace(zS,""),s=e.length-n.length;return Js(t,n,r*Math.pow(10,2*s))+Wt("%",s)}function qS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+qS(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ms(t,e,r){if(t.charCodeAt(0)===40&&!e.match(GS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ms("n",n,r):"("+ms("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return X6(t,e,r);if(e.indexOf("%")!==-1)return Y6(t,e,r);if(e.indexOf("E")!==-1)return qS(e,r);if(e.charCodeAt(0)===36)return"$"+ms(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ts(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:qr(e.substr(0,e.length-s.length))+s;if(i=e.match(HS))return G6(i,l,c);if(e.match(/^#+0+$/))return c+ts(l,e.length-e.indexOf("0"));if(i=e.match(WS))return s=(""+r).replace(/^([^\.]+)$/,"$1."+qr(i[1])).replace(/\.$/,"."+qr(i[1])),s=s.replace(/\.(\d*)$/,function(x,v){return"."+v+Wt("0",qr(i[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Oi(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ms(t,e,-r):Oi(""+r)+"."+Wt("0",i[1].length);if(i=e.match(/^#,#*,#0/))return ms(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=$o(ms(t,e.replace(/[\\-]/g,""),r)),a=0,$o($o(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(e.match(KS))return s=ms(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Wh(l,Math.pow(10,a)-1,!1),s=""+c,u=Js("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=$h(o[2],a),u.length<i[4].length&&(u=qr(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Wh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?bv(o[1],a)+i[2]+"/"+i[3]+$h(o[2],a):Wt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:qr(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,p=e.length-s.length-h;return qr(e.substr(0,h)+s+e.substr(e.length-p))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ms(t,e,-r):Oi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ts(0,3-x.length):"")+x})+"."+ts(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Oi(""+l);return m!=="0"?c+m:"";default:if(e.match(/\.[0#?]*$/))return ms(t,e.slice(0,e.lastIndexOf(".")),r)+qr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Js(t,e,r){return(r|0)===r?ms(t,e,r):Nn(t,e,r)}function Q6(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var XS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yl(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Hh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(XS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function J6(t,e,r,n){for(var s=[],i="",a=0,o="",l="t",c,u,h,p="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Hh(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(h=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(h);s[s.length]={t:"t",v:i},++a;break;case"\\":var m=t.charAt(++a),x=m==="("||m===")"?m:"t";s[s.length]={t:x,v:m},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=ka(e,r,t.charAt(a+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=ka(e,r),c==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(c==null&&(c=ka(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(v.v=c.H>=12?"P":"A"),v.t="T",p="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(v.v=c.H>=12?"PM":"AM"),v.t="T",a+=5,p="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(v.v=c.H>=12?"":""),v.t="T",a+=5,p="h"):(v.t="t",++a),c==null&&v.t==="T")return"";s[s.length]=v,l=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(XS)){if(c==null&&(c=ka(e,r),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",yl(t)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var y=0,T=0,k;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=p,l="h",y<1&&(y=1);break;case"s":(k=s[a].v.match(/\.0+$/))&&(T=Math.max(T,k[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&s[a].v.match(/[Hh]/)&&(y=1),y<2&&s[a].v.match(/[Mm]/)&&(y=2),y<3&&s[a].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",D;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=z6(s[a].t.charCodeAt(0),s[a].v,c,T),s[a].t="t";break;case"n":case"?":for(D=a+1;s[D]!=null&&((o=s[D].t)==="?"||o==="D"||(o===" "||o==="t")&&s[D+1]!=null&&(s[D+1].t==="?"||s[D+1].t==="t"&&s[D+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[D].v==="/"||s[D].v===" "&&s[D+1]!=null&&s[D+1].t=="?"));)s[a].v+=s[D].v,s[D]={v:"",t:";"},++D;w+=s[a].v,a=D-1;break;case"G":s[a].t="t",s[a].v=za(e,r);break}var U="",V,g;if(w.length>0){w.charCodeAt(0)==40?(V=e<0&&w.charCodeAt(0)===45?-e:e,g=Js("n",w,V)):(V=e<0&&n>1?-e:e,g=Js("n",w,V),V<0&&s[0]&&s[0].t=="t"&&(g=g.substr(1),s[0].v="-"+s[0].v)),D=g.length-1;var E=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){E=a;break}var S=s.length;if(E===s.length&&g.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(D>=s[a].v.length-1?(D-=s[a].v.length,s[a].v=g.substr(D+1,s[a].v.length)):D<0?s[a].v="":(s[a].v=g.substr(0,D+1),D=-1),s[a].t="t",S=a);D>=0&&S<s.length&&(s[S].v=g.substr(0,D+1)+s[S].v)}else if(E!==s.length&&g.indexOf("E")===-1){for(D=g.indexOf(".")-1,a=E;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(u=s[a].v.indexOf(".")>-1&&a===E?s[a].v.indexOf(".")-1:s[a].v.length-1,U=s[a].v.substr(u+1);u>=0;--u)D>=0&&(s[a].v.charAt(u)==="0"||s[a].v.charAt(u)==="#")&&(U=g.charAt(D--)+U);s[a].v=U,s[a].t="t",S=a}for(D>=0&&S<s.length&&(s[S].v=g.substr(0,D+1)+s[S].v),D=g.indexOf(".")+1,a=E;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==E)){for(u=s[a].v.indexOf(".")>-1&&a===E?s[a].v.indexOf(".")+1:0,U=s[a].v.substr(0,u);u<s[a].v.length;++u)D<g.length&&(U+=g.charAt(D++));s[a].v=U,s[a].t="t",S=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(V=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=Js(s[a].t,s[a].v,V),s[a].t="t");var C="";for(a=0;a!==s.length;++a)s[a]!=null&&(C+=s[a].v);return C}var Vy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Uy(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function Z6(t,e){var r=Q6(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Vy),o=r[1].match(Vy);return Uy(e,a)?[n,r[0]]:Uy(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function Un(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Xe)[t],n==null&&(n=r.table&&r.table[My[t]]||Xe[My[t]]),n==null&&(n=O6[t]||"General");break}if(Hh(n,0))return za(e,r);e instanceof Date&&(e=BS(e,r.date1904));var s=Z6(n,e);if(Hh(s[1]))return za(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return J6(s[1],e,r,s[0])}function Ra(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Xe[r]==null){e<0&&(e=r);continue}if(Xe[r]==t){e=r;break}}e<0&&(e=391)}return Xe[e]=t,e}function YS(){Xe=b6()}var eL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},QS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function tL(t){var e=typeof t=="number"?Xe[t]:t;return e=e.replace(QS,"(\\d+)"),new RegExp("^"+e+"$")}function rL(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(e.match(QS)||[]).forEach(function(h,p){var m=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:s=m;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&i==-1?u:c+"T"+u}var nL=function(){var t={};t.version="1.2.0";function e(){for(var g=0,E=new Array(256),S=0;S!=256;++S)g=S,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,E[S]=g;return typeof Int32Array<"u"?new Int32Array(E):E}var r=e();function n(g){var E=0,S=0,C=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)P[C]=g[C];for(C=0;C!=256;++C)for(S=g[C],E=256+C;E<4096;E+=256)S=P[E]=S>>>8^g[S&255];var R=[];for(C=1;C!=16;++C)R[C-1]=typeof Int32Array<"u"?P.subarray(C*256,C*256+256):P.slice(C*256,C*256+256);return R}var s=n(r),i=s[0],a=s[1],o=s[2],l=s[3],c=s[4],u=s[5],h=s[6],p=s[7],m=s[8],x=s[9],v=s[10],y=s[11],T=s[12],k=s[13],w=s[14];function D(g,E){for(var S=E^-1,C=0,P=g.length;C<P;)S=S>>>8^r[(S^g.charCodeAt(C++))&255];return~S}function U(g,E){for(var S=E^-1,C=g.length-15,P=0;P<C;)S=w[g[P++]^S&255]^k[g[P++]^S>>8&255]^T[g[P++]^S>>16&255]^y[g[P++]^S>>>24]^v[g[P++]]^x[g[P++]]^m[g[P++]]^p[g[P++]]^h[g[P++]]^u[g[P++]]^c[g[P++]]^l[g[P++]]^o[g[P++]]^a[g[P++]]^i[g[P++]]^r[g[P++]];for(C+=15;P<C;)S=S>>>8^r[(S^g[P++])&255];return~S}function V(g,E){for(var S=E^-1,C=0,P=g.length,R=0,b=0;C<P;)R=g.charCodeAt(C++),R<128?S=S>>>8^r[(S^R)&255]:R<2048?(S=S>>>8^r[(S^(192|R>>6&31))&255],S=S>>>8^r[(S^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,b=g.charCodeAt(C++)&1023,S=S>>>8^r[(S^(240|R>>8&7))&255],S=S>>>8^r[(S^(128|R>>2&63))&255],S=S>>>8^r[(S^(128|b>>6&15|(R&3)<<4))&255],S=S>>>8^r[(S^(128|b&63))&255]):(S=S>>>8^r[(S^(224|R>>12&15))&255],S=S>>>8^r[(S^(128|R>>6&63))&255],S=S>>>8^r[(S^(128|R&63))&255]);return~S}return t.table=r,t.bstr=D,t.buf=U,t.str=V,t}(),dt=function(){var e={};e.version="1.2.1";function r(I,L){for(var N=I.split("/"),F=L.split("/"),O=0,M=0,G=Math.min(N.length,F.length);O<G;++O){if(M=N[O].length-F[O].length)return M;if(N[O]!=F[O])return N[O]<F[O]?-1:1}return N.length-F.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var L=I.lastIndexOf("/");return L===-1?I:I.slice(0,L+1)}function s(I){if(I.charAt(I.length-1)=="/")return s(I.slice(0,-1));var L=I.lastIndexOf("/");return L===-1?I:I.slice(L+1)}function i(I,L){typeof L=="string"&&(L=new Date(L));var N=L.getHours();N=N<<6|L.getMinutes(),N=N<<5|L.getSeconds()>>>1,I.write_shift(2,N);var F=L.getFullYear()-1980;F=F<<4|L.getMonth()+1,F=F<<5|L.getDate(),I.write_shift(2,F)}function a(I){var L=I.read_shift(2)&65535,N=I.read_shift(2)&65535,F=new Date,O=N&31;N>>>=5;var M=N&15;N>>>=4,F.setMilliseconds(0),F.setFullYear(N+1980),F.setMonth(M-1),F.setDate(O);var G=L&31;L>>>=5;var re=L&63;return L>>>=6,F.setHours(L),F.setMinutes(re),F.setSeconds(G<<1),F}function o(I){wr(I,0);for(var L={},N=0;I.l<=I.length-4;){var F=I.read_shift(2),O=I.read_shift(2),M=I.l+O,G={};switch(F){case 21589:N=I.read_shift(1),N&1&&(G.mtime=I.read_shift(4)),O>5&&(N&2&&(G.atime=I.read_shift(4)),N&4&&(G.ctime=I.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}I.l=M,L[F]=G}return L}var l;function c(){return l||(l={})}function u(I,L){if(I[0]==80&&I[1]==75)return mi(I,L);if((I[0]|32)==109&&(I[1]|32)==105)return oo(I,L);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var N=3,F=512,O=0,M=0,G=0,re=0,te=0,Z=[],Q=I.slice(0,512);wr(Q,0);var le=h(Q);switch(N=le[0],N){case 3:F=512;break;case 4:F=4096;break;case 0:if(le[1]==0)return mi(I,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}F!==512&&(Q=I.slice(0,F),wr(Q,28));var ye=I.slice(0,F);p(Q,N);var Re=Q.read_shift(4,"i");if(N===3&&Re!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Re);Q.l+=4,G=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),re=Q.read_shift(4,"i"),O=Q.read_shift(4,"i"),te=Q.read_shift(4,"i"),M=Q.read_shift(4,"i");for(var me=-1,we=0;we<109&&(me=Q.read_shift(4,"i"),!(me<0));++we)Z[we]=me;var Le=m(I,F);y(te,M,Le,F,Z);var gt=k(Le,G,Z,F);gt[G].name="!Directory",O>0&&re!==b&&(gt[re].name="!MiniFAT"),gt[Z[0]].name="!FAT",gt.fat_addrs=Z,gt.ssz=F;var nt={},St=[],nn=[],Ze=[];w(G,gt,Le,St,O,nt,nn,re),x(nn,Ze,St),St.shift();var Tt={FileIndex:nn,FullPaths:Ze};return L&&L.raw&&(Tt.raw={header:ye,sectors:Le}),Tt}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(ce,"Header Signature: "),I.l+=16;var L=I.read_shift(2,"u");return[I.read_shift(2,"u"),L]}function p(I,L){var N=9;switch(I.l+=2,N=I.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,L){for(var N=Math.ceil(I.length/L)-1,F=[],O=1;O<N;++O)F[O-1]=I.slice(O*L,(O+1)*L);return F[N-1]=I.slice(N*L),F}function x(I,L,N){for(var F=0,O=0,M=0,G=0,re=0,te=N.length,Z=[],Q=[];F<te;++F)Z[F]=Q[F]=F,L[F]=N[F];for(;re<Q.length;++re)F=Q[re],O=I[F].L,M=I[F].R,G=I[F].C,Z[F]===F&&(O!==-1&&Z[O]!==O&&(Z[F]=Z[O]),M!==-1&&Z[M]!==M&&(Z[F]=Z[M])),G!==-1&&(Z[G]=F),O!==-1&&F!=Z[F]&&(Z[O]=Z[F],Q.lastIndexOf(O)<re&&Q.push(O)),M!==-1&&F!=Z[F]&&(Z[M]=Z[F],Q.lastIndexOf(M)<re&&Q.push(M));for(F=1;F<te;++F)Z[F]===F&&(M!==-1&&Z[M]!==M?Z[F]=Z[M]:O!==-1&&Z[O]!==O&&(Z[F]=Z[O]));for(F=1;F<te;++F)if(I[F].type!==0){if(re=F,re!=Z[re])do re=Z[re],L[F]=L[re]+"/"+L[F];while(re!==0&&Z[re]!==-1&&re!=Z[re]);Z[F]=-1}for(L[0]+="/",F=1;F<te;++F)I[F].type!==2&&(L[F]+="/")}function v(I,L,N){for(var F=I.start,O=I.size,M=[],G=F;N&&O>0&&G>=0;)M.push(L.slice(G*R,G*R+R)),O-=R,G=ga(N,G*4);return M.length===0?ar(0):Ri(M).slice(0,I.size)}function y(I,L,N,F,O){var M=b;if(I===b){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var G=N[I],re=(F>>>2)-1;if(!G)return;for(var te=0;te<re&&(M=ga(G,te*4))!==b;++te)O.push(M);y(ga(G,F-4),L-1,N,F,O)}}function T(I,L,N,F,O){var M=[],G=[];O||(O=[]);var re=F-1,te=0,Z=0;for(te=L;te>=0;){O[te]=!0,M[M.length]=te,G.push(I[te]);var Q=N[Math.floor(te*4/F)];if(Z=te*4&re,F<4+Z)throw new Error("FAT boundary crossed: "+te+" 4 "+F);if(!I[Q])break;te=ga(I[Q],Z)}return{nodes:M,data:Yy([G])}}function k(I,L,N,F){var O=I.length,M=[],G=[],re=[],te=[],Z=F-1,Q=0,le=0,ye=0,Re=0;for(Q=0;Q<O;++Q)if(re=[],ye=Q+L,ye>=O&&(ye-=O),!G[ye]){te=[];var me=[];for(le=ye;le>=0;){me[le]=!0,G[le]=!0,re[re.length]=le,te.push(I[le]);var we=N[Math.floor(le*4/F)];if(Re=le*4&Z,F<4+Re)throw new Error("FAT boundary crossed: "+le+" 4 "+F);if(!I[we]||(le=ga(I[we],Re),me[le]))break}M[ye]={nodes:re,data:Yy([te])}}return M}function w(I,L,N,F,O,M,G,re){for(var te=0,Z=F.length?2:0,Q=L[I].data,le=0,ye=0,Re;le<Q.length;le+=128){var me=Q.slice(le,le+128);wr(me,64),ye=me.read_shift(2),Re=Uv(me,0,ye-Z),F.push(Re);var we={name:Re,type:me.read_shift(1),color:me.read_shift(1),L:me.read_shift(4,"i"),R:me.read_shift(4,"i"),C:me.read_shift(4,"i"),clsid:me.read_shift(16),state:me.read_shift(4,"i"),start:0,size:0},Le=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);Le!==0&&(we.ct=D(me,me.l-8));var gt=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);gt!==0&&(we.mt=D(me,me.l-8)),we.start=me.read_shift(4,"i"),we.size=me.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=b,we.name=""),we.type===5?(te=we.start,O>0&&te!==b&&(L[te].name="!StreamData")):we.size>=4096?(we.storage="fat",L[we.start]===void 0&&(L[we.start]=T(N,we.start,L.fat_addrs,L.ssz)),L[we.start].name=we.name,we.content=L[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:te!==b&&we.start!==b&&L[te]&&(we.content=v(we,L[te].data,(L[re]||{}).data))),we.content&&wr(we.content,0),M[Re]=we,G.push(we)}}function D(I,L){return new Date((vn(I,L+4)/1e7*Math.pow(2,32)+vn(I,L)/1e7-11644473600)*1e3)}function U(I,L){return c(),u(l.readFileSync(I),L)}function V(I,L){var N=L&&L.type;switch(N||lt&&Buffer.isBuffer(I)&&(N="buffer"),N||"base64"){case"file":return U(I,L);case"base64":return u(Jn(Tn(I)),L);case"binary":return u(Jn(I),L)}return u(I,L)}function g(I,L){var N=L||{},F=N.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=F+"/",I.FileIndex[0]={name:F,type:5}),N.CLSID&&(I.FileIndex[0].clsid=N.CLSID),E(I)}function E(I){var L="Sh33tJ5";if(!dt.find(I,"/"+L)){var N=ar(4);N[0]=55,N[1]=N[3]=50,N[2]=54,I.FileIndex.push({name:L,type:2,content:N,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+L),S(I)}}function S(I,L){g(I);for(var N=!1,F=!1,O=I.FullPaths.length-1;O>=0;--O){var M=I.FileIndex[O];switch(M.type){case 0:F?N=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(M.R*M.L*M.C)&&(N=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!L)){var G=new Date(1987,1,19),re=0,te=Object.create?Object.create(null):{},Z=[];for(O=0;O<I.FullPaths.length;++O)te[I.FullPaths[O]]=!0,I.FileIndex[O].type!==0&&Z.push([I.FullPaths[O],I.FileIndex[O]]);for(O=0;O<Z.length;++O){var Q=n(Z[O][0]);F=te[Q],F||(Z.push([Q,{name:s(Q).replace("/",""),type:1,clsid:Ae,ct:G,mt:G,content:null}]),te[Q]=!0)}for(Z.sort(function(Re,me){return r(Re[0],me[0])}),I.FullPaths=[],I.FileIndex=[],O=0;O<Z.length;++O)I.FullPaths[O]=Z[O][0],I.FileIndex[O]=Z[O][1];for(O=0;O<Z.length;++O){var le=I.FileIndex[O],ye=I.FullPaths[O];if(le.name=s(ye).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||Ae,O===0)le.C=Z.length>1?1:-1,le.size=0,le.type=5;else if(ye.slice(-1)=="/"){for(re=O+1;re<Z.length&&n(I.FullPaths[re])!=ye;++re);for(le.C=re>=Z.length?-1:re,re=O+1;re<Z.length&&n(I.FullPaths[re])!=n(ye);++re);le.R=re>=Z.length?-1:re,le.type=1}else n(I.FullPaths[O+1]||"")==n(ye)&&(le.R=O+1),le.type=2}}}function C(I,L){var N=L||{};if(N.fileType=="mad")return ir(I,N);switch(S(I),N.fileType){case"zip":return Os(I,N)}var F=function(Re){for(var me=0,we=0,Le=0;Le<Re.FileIndex.length;++Le){var gt=Re.FileIndex[Le];if(gt.content){var nt=gt.content.length;nt>0&&(nt<4096?me+=nt+63>>6:we+=nt+511>>9)}}for(var St=Re.FullPaths.length+3>>2,nn=me+7>>3,Ze=me+127>>7,Tt=nn+we+St+Ze,vr=Tt+127>>7,Cn=vr<=109?0:Math.ceil((vr-109)/127);Tt+vr+Cn+127>>7>vr;)Cn=++vr<=109?0:Math.ceil((vr-109)/127);var ft=[1,Cn,vr,Ze,St,we,me,0];return Re.FileIndex[0].size=me<<6,ft[7]=(Re.FileIndex[0].start=ft[0]+ft[1]+ft[2]+ft[3]+ft[4]+ft[5])+(ft[6]+7>>3),ft}(I),O=ar(F[7]<<9),M=0,G=0;{for(M=0;M<8;++M)O.write_shift(1,fe[M]);for(M=0;M<8;++M)O.write_shift(2,0);for(O.write_shift(2,62),O.write_shift(2,3),O.write_shift(2,65534),O.write_shift(2,9),O.write_shift(2,6),M=0;M<3;++M)O.write_shift(2,0);for(O.write_shift(4,0),O.write_shift(4,F[2]),O.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),O.write_shift(4,0),O.write_shift(4,4096),O.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:b),O.write_shift(4,F[3]),O.write_shift(-4,F[1]?F[0]-1:b),O.write_shift(4,F[1]),M=0;M<109;++M)O.write_shift(-4,M<F[2]?F[1]+M:-1)}if(F[1])for(G=0;G<F[1];++G){for(;M<236+G*127;++M)O.write_shift(-4,M<F[2]?F[1]+M:-1);O.write_shift(-4,G===F[1]-1?b:G+1)}var re=function(Re){for(G+=Re;M<G-1;++M)O.write_shift(-4,M+1);Re&&(++M,O.write_shift(-4,b))};for(G=M=0,G+=F[1];M<G;++M)O.write_shift(-4,_e.DIFSECT);for(G+=F[2];M<G;++M)O.write_shift(-4,_e.FATSECT);re(F[3]),re(F[4]);for(var te=0,Z=0,Q=I.FileIndex[0];te<I.FileIndex.length;++te)Q=I.FileIndex[te],Q.content&&(Z=Q.content.length,!(Z<4096)&&(Q.start=G,re(Z+511>>9)));for(re(F[6]+7>>3);O.l&511;)O.write_shift(-4,_e.ENDOFCHAIN);for(G=M=0,te=0;te<I.FileIndex.length;++te)Q=I.FileIndex[te],Q.content&&(Z=Q.content.length,!(!Z||Z>=4096)&&(Q.start=G,re(Z+63>>6)));for(;O.l&511;)O.write_shift(-4,_e.ENDOFCHAIN);for(M=0;M<F[4]<<2;++M){var le=I.FullPaths[M];if(!le||le.length===0){for(te=0;te<17;++te)O.write_shift(4,0);for(te=0;te<3;++te)O.write_shift(4,-1);for(te=0;te<12;++te)O.write_shift(4,0);continue}Q=I.FileIndex[M],M===0&&(Q.start=Q.size?Q.start-1:b);var ye=M===0&&N.root||Q.name;if(Z=2*(ye.length+1),O.write_shift(64,ye,"utf16le"),O.write_shift(2,Z),O.write_shift(1,Q.type),O.write_shift(1,Q.color),O.write_shift(-4,Q.L),O.write_shift(-4,Q.R),O.write_shift(-4,Q.C),Q.clsid)O.write_shift(16,Q.clsid,"hex");else for(te=0;te<4;++te)O.write_shift(4,0);O.write_shift(4,Q.state||0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,Q.start),O.write_shift(4,Q.size),O.write_shift(4,0)}for(M=1;M<I.FileIndex.length;++M)if(Q=I.FileIndex[M],Q.size>=4096)if(O.l=Q.start+1<<9,lt&&Buffer.isBuffer(Q.content))Q.content.copy(O,O.l,0,Q.size),O.l+=Q.size+511&-512;else{for(te=0;te<Q.size;++te)O.write_shift(1,Q.content[te]);for(;te&511;++te)O.write_shift(1,0)}for(M=1;M<I.FileIndex.length;++M)if(Q=I.FileIndex[M],Q.size>0&&Q.size<4096)if(lt&&Buffer.isBuffer(Q.content))Q.content.copy(O,O.l,0,Q.size),O.l+=Q.size+63&-64;else{for(te=0;te<Q.size;++te)O.write_shift(1,Q.content[te]);for(;te&63;++te)O.write_shift(1,0)}if(lt)O.l=O.length;else for(;O.l<O.length;)O.write_shift(1,0);return O}function P(I,L){var N=I.FullPaths.map(function(te){return te.toUpperCase()}),F=N.map(function(te){var Z=te.split("/");return Z[Z.length-(te.slice(-1)=="/"?2:1)]}),O=!1;L.charCodeAt(0)===47?(O=!0,L=N[0].slice(0,-1)+L):O=L.indexOf("/")!==-1;var M=L.toUpperCase(),G=O===!0?N.indexOf(M):F.indexOf(M);if(G!==-1)return I.FileIndex[G];var re=!M.match(ec);for(M=M.replace(Zr,""),re&&(M=M.replace(ec,"!")),G=0;G<N.length;++G)if((re?N[G].replace(ec,"!"):N[G]).replace(Zr,"")==M||(re?F[G].replace(ec,"!"):F[G]).replace(Zr,"")==M)return I.FileIndex[G];return null}var R=64,b=-2,ce="d0cf11e0a1b11ae1",fe=[208,207,17,224,161,177,26,225],Ae="00000000000000000000000000000000",_e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:b,FREESECT:-1,HEADER_SIGNATURE:ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(I,L,N){c();var F=C(I,N);l.writeFileSync(L,F)}function K(I){for(var L=new Array(I.length),N=0;N<I.length;++N)L[N]=String.fromCharCode(I[N]);return L.join("")}function de(I,L){var N=C(I,L);switch(L&&L.type||"buffer"){case"file":return c(),l.writeFileSync(L.filename,N),N;case"binary":return typeof N=="string"?N:K(N);case"base64":return Dy(typeof N=="string"?N:K(N));case"buffer":if(lt)return Buffer.isBuffer(N)?N:Za(N);case"array":return typeof N=="string"?Jn(N):N}return N}var Te;function B(I){try{var L=I.InflateRaw,N=new L;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)Te=I;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function ee(I,L){if(!Te)return bs(I,L);var N=Te.InflateRaw,F=new N,O=F._processChunk(I.slice(I.l),F._finishFlushFlag);return I.l+=F.bytesRead,O}function q(I){return Te?Te.deflateRawSync(I):Ve(I)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ve=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(I){var L=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(L>>16|L>>8|L)&255}for(var Ee=typeof Uint8Array<"u",pe=Ee?new Uint8Array(256):[],He=0;He<256;++He)pe[He]=Ce(He);function z(I,L){var N=pe[I&255];return L<=8?N>>>8-L:(N=N<<8|pe[I>>8&255],L<=16?N>>>16-L:(N=N<<8|pe[I>>16&255],N>>>24-L))}function ct(I,L){var N=L&7,F=L>>>3;return(I[F]|(N<=6?0:I[F+1]<<8))>>>N&3}function Ye(I,L){var N=L&7,F=L>>>3;return(I[F]|(N<=5?0:I[F+1]<<8))>>>N&7}function at(I,L){var N=L&7,F=L>>>3;return(I[F]|(N<=4?0:I[F+1]<<8))>>>N&15}function Me(I,L){var N=L&7,F=L>>>3;return(I[F]|(N<=3?0:I[F+1]<<8))>>>N&31}function Y(I,L){var N=L&7,F=L>>>3;return(I[F]|(N<=1?0:I[F+1]<<8))>>>N&127}function ke(I,L,N){var F=L&7,O=L>>>3,M=(1<<N)-1,G=I[O]>>>F;return N<8-F||(G|=I[O+1]<<8-F,N<16-F)||(G|=I[O+2]<<16-F,N<24-F)||(G|=I[O+3]<<24-F),G&M}function be(I,L,N){var F=L&7,O=L>>>3;return F<=5?I[O]|=(N&7)<<F:(I[O]|=N<<F&255,I[O+1]=(N&7)>>8-F),L+3}function je(I,L,N){var F=L&7,O=L>>>3;return N=(N&1)<<F,I[O]|=N,L+1}function tt(I,L,N){var F=L&7,O=L>>>3;return N<<=F,I[O]|=N&255,N>>>=8,I[O+1]=N,L+8}function mt(I,L,N){var F=L&7,O=L>>>3;return N<<=F,I[O]|=N&255,N>>>=8,I[O+1]=N&255,I[O+2]=N>>>8,L+16}function Je(I,L){var N=I.length,F=2*N>L?2*N:L+5,O=0;if(N>=L)return I;if(lt){var M=Fy(F);if(I.copy)I.copy(M);else for(;O<I.length;++O)M[O]=I[O];return M}else if(Ee){var G=new Uint8Array(F);if(G.set)G.set(I);else for(;O<N;++O)G[O]=I[O];return G}return I.length=F,I}function qe(I){for(var L=new Array(I),N=0;N<I;++N)L[N]=0;return L}function Qe(I,L,N){var F=1,O=0,M=0,G=0,re=0,te=I.length,Z=Ee?new Uint16Array(32):qe(32);for(M=0;M<32;++M)Z[M]=0;for(M=te;M<N;++M)I[M]=0;te=I.length;var Q=Ee?new Uint16Array(te):qe(te);for(M=0;M<te;++M)Z[O=I[M]]++,F<O&&(F=O),Q[M]=0;for(Z[0]=0,M=1;M<=F;++M)Z[M+16]=re=re+Z[M-1]<<1;for(M=0;M<te;++M)re=I[M],re!=0&&(Q[M]=Z[re+16]++);var le=0;for(M=0;M<te;++M)if(le=I[M],le!=0)for(re=z(Q[M],F)>>F-le,G=(1<<F+4-le)-1;G>=0;--G)L[re|G<<le]=le&15|M<<4;return F}var Fe=Ee?new Uint16Array(512):qe(512),ut=Ee?new Uint16Array(32):qe(32);if(!Ee){for(var rt=0;rt<512;++rt)Fe[rt]=0;for(rt=0;rt<32;++rt)ut[rt]=0}(function(){for(var I=[],L=0;L<32;L++)I.push(5);Qe(I,ut,32);var N=[];for(L=0;L<=143;L++)N.push(8);for(;L<=255;L++)N.push(9);for(;L<=279;L++)N.push(7);for(;L<=287;L++)N.push(8);Qe(N,Fe,288)})();var Be=function(){for(var L=Ee?new Uint8Array(32768):[],N=0,F=0;N<ve.length-1;++N)for(;F<ve[N+1];++F)L[F]=N;for(;F<32768;++F)L[F]=29;var O=Ee?new Uint8Array(259):[];for(N=0,F=0;N<ae.length-1;++N)for(;F<ae[N+1];++F)O[F]=N;function M(re,te){for(var Z=0;Z<re.length;){var Q=Math.min(65535,re.length-Z),le=Z+Q==re.length;for(te.write_shift(1,+le),te.write_shift(2,Q),te.write_shift(2,~Q&65535);Q-- >0;)te[te.l++]=re[Z++]}return te.l}function G(re,te){for(var Z=0,Q=0,le=Ee?new Uint16Array(32768):[];Q<re.length;){var ye=Math.min(65535,re.length-Q);if(ye<10){for(Z=be(te,Z,+(Q+ye==re.length)),Z&7&&(Z+=8-(Z&7)),te.l=Z/8|0,te.write_shift(2,ye),te.write_shift(2,~ye&65535);ye-- >0;)te[te.l++]=re[Q++];Z=te.l*8;continue}Z=be(te,Z,+(Q+ye==re.length)+2);for(var Re=0;ye-- >0;){var me=re[Q];Re=(Re<<5^me)&32767;var we=-1,Le=0;if((we=le[Re])&&(we|=Q&-32768,we>Q&&(we-=32768),we<Q))for(;re[we+Le]==re[Q+Le]&&Le<250;)++Le;if(Le>2){me=O[Le],me<=22?Z=tt(te,Z,pe[me+1]>>1)-1:(tt(te,Z,3),Z+=5,tt(te,Z,pe[me-23]>>5),Z+=3);var gt=me<8?0:me-4>>2;gt>0&&(mt(te,Z,Le-ae[me]),Z+=gt),me=L[Q-we],Z=tt(te,Z,pe[me]>>3),Z-=3;var nt=me<4?0:me-2>>1;nt>0&&(mt(te,Z,Q-we-ve[me]),Z+=nt);for(var St=0;St<Le;++St)le[Re]=Q&32767,Re=(Re<<5^re[Q])&32767,++Q;ye-=Le-1}else me<=143?me=me+48:Z=je(te,Z,1),Z=tt(te,Z,pe[me]),le[Re]=Q&32767,++Q}Z=tt(te,Z,0)-1}return te.l=(Z+7)/8|0,te.l}return function(te,Z){return te.length<8?M(te,Z):G(te,Z)}}();function Ve(I){var L=ar(50+Math.floor(I.length*1.1)),N=Be(I,L);return L.slice(0,N)}var kt=Ee?new Uint16Array(32768):qe(32768),Yt=Ee?new Uint16Array(32768):qe(32768),Et=Ee?new Uint16Array(128):qe(128),dn=1,Fs=1;function io(I,L){var N=Me(I,L)+257;L+=5;var F=Me(I,L)+1;L+=5;var O=at(I,L)+4;L+=4;for(var M=0,G=Ee?new Uint8Array(19):qe(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,Z=Ee?new Uint8Array(8):qe(8),Q=Ee?new Uint8Array(8):qe(8),le=G.length,ye=0;ye<O;++ye)G[W[ye]]=M=Ye(I,L),te<M&&(te=M),Z[M]++,L+=3;var Re=0;for(Z[0]=0,ye=1;ye<=te;++ye)Q[ye]=Re=Re+Z[ye-1]<<1;for(ye=0;ye<le;++ye)(Re=G[ye])!=0&&(re[ye]=Q[Re]++);var me=0;for(ye=0;ye<le;++ye)if(me=G[ye],me!=0){Re=pe[re[ye]]>>8-me;for(var we=(1<<7-me)-1;we>=0;--we)Et[Re|we<<me]=me&7|ye<<3}var Le=[];for(te=1;Le.length<N+F;)switch(Re=Et[Y(I,L)],L+=Re&7,Re>>>=3){case 16:for(M=3+ct(I,L),L+=2,Re=Le[Le.length-1];M-- >0;)Le.push(Re);break;case 17:for(M=3+Ye(I,L),L+=3;M-- >0;)Le.push(0);break;case 18:for(M=11+Y(I,L),L+=7;M-- >0;)Le.push(0);break;default:Le.push(Re),te<Re&&(te=Re);break}var gt=Le.slice(0,N),nt=Le.slice(N);for(ye=N;ye<286;++ye)gt[ye]=0;for(ye=F;ye<30;++ye)nt[ye]=0;return dn=Qe(gt,kt,286),Fs=Qe(nt,Yt,30),L}function Tl(I,L){if(I[0]==3&&!(I[1]&3))return[ea(L),2];for(var N=0,F=0,O=Fy(L||1<<18),M=0,G=O.length>>>0,re=0,te=0;!(F&1);){if(F=Ye(I,N),N+=3,F>>>1)F>>1==1?(re=9,te=5):(N=io(I,N),re=dn,te=Fs);else{N&7&&(N+=8-(N&7));var Z=I[N>>>3]|I[(N>>>3)+1]<<8;if(N+=32,Z>0)for(!L&&G<M+Z&&(O=Je(O,M+Z),G=O.length);Z-- >0;)O[M++]=I[N>>>3],N+=8;continue}for(;;){!L&&G<M+32767&&(O=Je(O,M+32767),G=O.length);var Q=ke(I,N,re),le=F>>>1==1?Fe[Q]:kt[Q];if(N+=le&15,le>>>=4,!(le>>>8&255))O[M++]=le;else{if(le==256)break;le-=257;var ye=le<8?0:le-4>>2;ye>5&&(ye=0);var Re=M+ae[le];ye>0&&(Re+=ke(I,N,ye),N+=ye),Q=ke(I,N,te),le=F>>>1==1?ut[Q]:Yt[Q],N+=le&15,le>>>=4;var me=le<4?0:le-2>>1,we=ve[le];for(me>0&&(we+=ke(I,N,me),N+=me),!L&&G<Re&&(O=Je(O,Re+100),G=O.length);M<Re;)O[M]=O[M-we],++M}}}return L?[O,N+7>>>3]:[O.slice(0,M),N+7>>>3]}function bs(I,L){var N=I.slice(I.l||0),F=Tl(N,L);return I.l+=F[1],F[0]}function us(I,L){if(I)typeof console<"u"&&console.error(L);else throw new Error(L)}function mi(I,L){var N=I;wr(N,0);var F=[],O=[],M={FileIndex:F,FullPaths:O};g(M,{root:L.root});for(var G=N.length-4;(N[G]!=80||N[G+1]!=75||N[G+2]!=5||N[G+3]!=6)&&G>=0;)--G;N.l=G+4,N.l+=4;var re=N.read_shift(2);N.l+=6;var te=N.read_shift(4);for(N.l=te,G=0;G<re;++G){N.l+=20;var Z=N.read_shift(4),Q=N.read_shift(4),le=N.read_shift(2),ye=N.read_shift(2),Re=N.read_shift(2);N.l+=8;var me=N.read_shift(4),we=o(N.slice(N.l+le,N.l+le+ye));N.l+=le+ye+Re;var Le=N.l;N.l=me+4,zn(N,Z,Q,M,we),N.l=Le}return M}function zn(I,L,N,F,O){I.l+=2;var M=I.read_shift(2),G=I.read_shift(2),re=a(I);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var te=I.read_shift(4),Z=I.read_shift(4),Q=I.read_shift(4),le=I.read_shift(2),ye=I.read_shift(2),Re="",me=0;me<le;++me)Re+=String.fromCharCode(I[I.l++]);if(ye){var we=o(I.slice(I.l,I.l+ye));(we[21589]||{}).mt&&(re=we[21589].mt),((O||{})[21589]||{}).mt&&(re=O[21589].mt)}I.l+=ye;var Le=I.slice(I.l,I.l+Z);switch(G){case 8:Le=ee(I,Q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var gt=!1;M&8&&(te=I.read_shift(4),te==134695760&&(te=I.read_shift(4),gt=!0),Z=I.read_shift(4),Q=I.read_shift(4)),Z!=L&&us(gt,"Bad compressed size: "+L+" != "+Z),Q!=N&&us(gt,"Bad uncompressed size: "+N+" != "+Q),J(F,Re,Le,{unsafe:!0,mt:re})}function Os(I,L){var N=L||{},F=[],O=[],M=ar(1),G=N.compression?8:0,re=0,te=0,Z=0,Q=0,le=0,ye=I.FullPaths[0],Re=ye,me=I.FileIndex[0],we=[],Le=0;for(te=1;te<I.FullPaths.length;++te)if(Re=I.FullPaths[te].slice(ye.length),me=I.FileIndex[te],!(!me.size||!me.content||Re=="Sh33tJ5")){var gt=Q,nt=ar(Re.length);for(Z=0;Z<Re.length;++Z)nt.write_shift(1,Re.charCodeAt(Z)&127);nt=nt.slice(0,nt.l),we[le]=nL.buf(me.content,0);var St=me.content;G==8&&(St=q(St)),M=ar(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,re),M.write_shift(2,G),me.mt?i(M,me.mt):M.write_shift(4,0),M.write_shift(-4,we[le]),M.write_shift(4,St.length),M.write_shift(4,me.content.length),M.write_shift(2,nt.length),M.write_shift(2,0),Q+=M.length,F.push(M),Q+=nt.length,F.push(nt),Q+=St.length,F.push(St),M=ar(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,re),M.write_shift(2,G),M.write_shift(4,0),M.write_shift(-4,we[le]),M.write_shift(4,St.length),M.write_shift(4,me.content.length),M.write_shift(2,nt.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,gt),Le+=M.l,O.push(M),Le+=nt.length,O.push(nt),++le}return M=ar(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,le),M.write_shift(2,le),M.write_shift(4,Le),M.write_shift(4,Q),M.write_shift(2,0),Ri([Ri(F),Ri(O),M])}var fs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function An(I,L){if(I.ctype)return I.ctype;var N=I.name||"",F=N.match(/\.([^\.]+)$/);return F&&fs[F[1]]||L&&(F=(N=L).match(/[\.\\]([^\.\\])+$/),F&&fs[F[1]])?fs[F[1]]:"application/octet-stream"}function ao(I){for(var L=Dy(I),N=[],F=0;F<L.length;F+=76)N.push(L.slice(F,F+76));return N.join(`\r
`)+`\r
`}function Ms(I){var L=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Z){var Q=Z.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],F=L.split(`\r
`),O=0;O<F.length;++O){var M=F[O];if(M.length==0){N.push("");continue}for(var G=0;G<M.length;){var re=76,te=M.slice(G,G+re);te.charAt(re-1)=="="?re--:te.charAt(re-2)=="="?re-=2:te.charAt(re-3)=="="&&(re-=3),te=M.slice(G,G+re),G+=re,G<M.length&&(te+="="),N.push(te)}}return N.join(`\r
`)}function Ls(I){for(var L=[],N=0;N<I.length;++N){for(var F=I[N];N<=I.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+I[++N];L.push(F)}for(var O=0;O<L.length;++O)L[O]=L[O].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return Jn(L.join(`\r
`))}function In(I,L,N){for(var F="",O="",M="",G,re=0;re<10;++re){var te=L[re];if(!te||te.match(/^\s*$/))break;var Z=te.match(/^(.*?):\s*([^\s].*)$/);if(Z)switch(Z[1].toLowerCase()){case"content-location":F=Z[2].trim();break;case"content-type":M=Z[2].trim();break;case"content-transfer-encoding":O=Z[2].trim();break}}switch(++re,O.toLowerCase()){case"base64":G=Jn(Tn(L.slice(re).join("")));break;case"quoted-printable":G=Ls(L.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+O)}var Q=J(I,F.slice(N.length),G,{unsafe:!0});M&&(Q.ctype=M)}function oo(I,L){if(K(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=L&&L.root||"",F=(lt&&Buffer.isBuffer(I)?I.toString("binary"):K(I)).split(`\r
`),O=0,M="";for(O=0;O<F.length;++O)if(M=F[O],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),N||(N=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),M.slice(0,N.length)!=N););var G=(F[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var re="--"+(G[1]||""),te=[],Z=[],Q={FileIndex:te,FullPaths:Z};g(Q);var le,ye=0;for(O=0;O<F.length;++O){var Re=F[O];Re!==re&&Re!==re+"--"||(ye++&&In(Q,F.slice(le,O),N),le=O)}return Q}function ir(I,L){var N=L||{},F=N.boundary||"SheetJS";F="------="+F;for(var O=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],M=I.FullPaths[0],G=M,re=I.FileIndex[0],te=1;te<I.FullPaths.length;++te)if(G=I.FullPaths[te].slice(M.length),re=I.FileIndex[te],!(!re.size||!re.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Le){return"_x"+Le.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Le){return"_u"+Le.charCodeAt(0).toString(16)+"_"});for(var Z=re.content,Q=lt&&Buffer.isBuffer(Z)?Z.toString("binary"):K(Z),le=0,ye=Math.min(1024,Q.length),Re=0,me=0;me<=ye;++me)(Re=Q.charCodeAt(me))>=32&&Re<128&&++le;var we=le>=ye*4/5;O.push(F),O.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+G),O.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),O.push("Content-Type: "+An(re,G)),O.push(""),O.push(we?Ms(Q):ao(Q))}return O.push(F+`--\r
`),O.join(`\r
`)}function H(I){var L={};return g(L,I),L}function J(I,L,N,F){var O=F&&F.unsafe;O||g(I);var M=!O&&dt.find(I,L);if(!M){var G=I.FullPaths[0];L.slice(0,G.length)==G?G=L:(G.slice(-1)!="/"&&(G+="/"),G=(G+L).replace("//","/")),M={name:s(L),type:2},I.FileIndex.push(M),I.FullPaths.push(G),O||dt.utils.cfb_gc(I)}return M.content=N,M.size=N?N.length:0,F&&(F.CLSID&&(M.clsid=F.CLSID),F.mt&&(M.mt=F.mt),F.ct&&(M.ct=F.ct)),M}function se(I,L){g(I);var N=dt.find(I,L);if(N){for(var F=0;F<I.FileIndex.length;++F)if(I.FileIndex[F]==N)return I.FileIndex.splice(F,1),I.FullPaths.splice(F,1),!0}return!1}function he(I,L,N){g(I);var F=dt.find(I,L);if(F){for(var O=0;O<I.FileIndex.length;++O)if(I.FileIndex[O]==F)return I.FileIndex[O].name=s(N),I.FullPaths[O]=N,!0}return!1}function Ie(I){S(I,!0)}return e.find=P,e.read=V,e.parse=u,e.write=de,e.writeFile=oe,e.utils={cfb_new:H,cfb_add:J,cfb_del:se,cfb_mov:he,cfb_gc:Ie,ReadShift:xc,CheckField:_A,prep_blob:wr,bconcat:Ri,use_zlib:B,_deflateRaw:Ve,_inflateRaw:bs,consts:_e},e}();function sL(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Is(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Mv(t){for(var e=[],r=Is(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var Gh=new Date(1899,11,30,0,0,0);function en(t,e){var r=t.getTime(),n=Gh.getTime()+(t.getTimezoneOffset()-Gh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var JS=new Date,iL=Gh.getTime()+(JS.getTimezoneOffset()-Gh.getTimezoneOffset())*6e4,By=JS.getTimezoneOffset();function Hd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+iL),e.getTimezoneOffset()!==By&&e.setTime(e.getTime()+(e.getTimezoneOffset()-By)*6e4),e}function aL(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var zy=new Date("2017-02-19T19:06:09.000Z"),ZS=isNaN(zy.getFullYear())?new Date("2/19/17"):zy,oL=ZS.getFullYear()==2017;function gr(t,e){var r=new Date(t);if(oL)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(ZS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function $a(t,e){if(lt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return rc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return rc(VS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return rc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return rc(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Ar(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Ar(t[r]));return e}function Wt(t,e){for(var r="";r.length<e;)r+=t;return r}function is(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var lL=["january","february","march","april","may","june","july","august","september","october","november","december"];function cl(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&lL.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var cL=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function eA(t){return t?t.content&&t.type?$a(t.content,!0):t.data?Zl(t.data):t.asNodeBuffer&&lt?Zl(t.asNodeBuffer().toString("binary")):t.asBinary?Zl(t.asBinary()):t._data&&t._data.getContent?Zl($a(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function tA(t){if(!t)return null;if(t.data)return Ny(t.data);if(t.asNodeBuffer&&lt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Ny(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function uL(t){return t&&t.name.slice(-4)===".bin"?tA(t):eA(t)}function Pn(t,e){for(var r=t.FullPaths||Is(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function Lv(t,e){var r=Pn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Zt(t,e,r){if(!r)return uL(Lv(t,e));if(!e)return null;try{return Zt(t,e)}catch{return null}}function xn(t,e,r){if(!r)return eA(Lv(t,e));if(!e)return null;try{return xn(t,e)}catch{return null}}function fL(t,e,r){return tA(Lv(t,e))}function $y(t){for(var e=t.FullPaths||Is(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function hL(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return lt?n=Za(r):n=P6(r),dt.utils.cfb_add(t,e,n)}dt.utils.cfb_add(t,e,r)}else t.file(e,r)}function rA(t,e){switch(e.type){case"base64":return dt.read(t,{type:"base64"});case"binary":return dt.read(t,{type:"binary"});case"buffer":case"array":return dt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function tc(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var nA=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,dL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Hy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,pL=/<[^>]*>/g,Gr=nA.match(Hy)?Hy:pL,mL=/<\w*:/,gL=/<(\/?)\w+:/;function Ue(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(dL),o=0,l="",c=0,u="",h="",p=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(u=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(p=(s=h.charCodeAt(i+1))==34||s==39?1:0,l=h.slice(i+1+p,h.length-p),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var m=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[m]&&u.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Ps(t){return t.replace(gL,"<$1")}var sA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},vL=Mv(sA),_t=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,l){return sA[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),xL=/[&<>'"]/g,_L=/[\u0000-\u001f]/g;function jv(t){var e=t+"";return e.replace(xL,function(r){return vL[r]}).replace(/\n/g,"<br/>").replace(_L,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Wy=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Lt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function W0(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Gy(t){var e=ea(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function Ky(t){return Za(t,"binary").toString("utf8")}var yf="foo bar baz",Pt=lt&&(Ky(yf)==W0(yf)&&Ky||Gy(yf)==W0(yf)&&Gy)||W0,rc=lt?function(t){return Za(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},nu=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),iA=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),yL=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),wL=/<\/?(?:vt:)?variant>/g,EL=/<(?:vt:)([^>]*)>([\s\S]*)</;function qy(t,e){var r=Ue(t),n=t.match(yL(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(wL,"").match(EL);a&&s.push({v:Pt(a[2]),t:a[1]})}),s}var TL=/(^\s|\s$|\n)/;function kL(t){return Is(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function SL(t,e,r){return"<"+t+(r!=null?kL(r):"")+(e!=null?(e.match(TL)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Vv(t){if(lt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Pt(eo(Fv(t)));throw new Error("Bad input format: expected Buffer or string")}var su=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,AL={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},IL=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function CL(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function RL(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var Xy=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},Yy=lt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Za(e)})):Xy(t)}:Xy,Qy=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(qs(t,s)));return n.join("").replace(Zr,"")},Uv=lt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Zr,""):Qy(t,e,r)}:Qy,Jy=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},aA=lt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Jy(t,e,r)}:Jy,Zy=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(xo(t,s)));return n.join("")},Nu=lt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Zy(e,r,n)}:Zy,oA=function(t,e){var r=vn(t,e);return r>0?Nu(t,e+4,e+4+r-1):""},lA=oA,cA=function(t,e){var r=vn(t,e);return r>0?Nu(t,e+4,e+4+r-1):""},uA=cA,fA=function(t,e){var r=2*vn(t,e);return r>0?Nu(t,e+4,e+4+r-1):""},hA=fA,dA=function(e,r){var n=vn(e,r);return n>0?Uv(e,r+4,r+4+n):""},pA=dA,mA=function(t,e){var r=vn(t,e);return r>0?Nu(t,e+4,e+4+r):""},gA=mA,vA=function(t,e){return CL(t,e)},Kh=vA,xA=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};lt&&(lA=function(e,r){if(!Buffer.isBuffer(e))return oA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},uA=function(e,r){if(!Buffer.isBuffer(e))return cA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},hA=function(e,r){if(!Buffer.isBuffer(e))return fA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},pA=function(e,r){if(!Buffer.isBuffer(e))return dA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},gA=function(e,r){if(!Buffer.isBuffer(e))return mA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Kh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):vA(e,r)},xA=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var xo=function(t,e){return t[e]},qs=function(t,e){return t[e+1]*256+t[e]},NL=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},vn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ga=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},PL=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function xc(t,e){var r="",n,s,i=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,lt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(qs(this,c)),c+=2;t*=2;break;case"utf8":r=Nu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Uv(this,this.l,this.l+t);break;case"wstr":return xc.call(this,t,"dbcs");case"lpstr-ansi":r=lA(this,this.l),t=4+vn(this,this.l);break;case"lpstr-cp":r=uA(this,this.l),t=4+vn(this,this.l);break;case"lpwstr":r=hA(this,this.l),t=4+2*vn(this,this.l);break;case"lpp4":t=4+vn(this,this.l),r=pA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+vn(this,this.l),r=gA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=xo(this,this.l+t++))!==0;)i.push(_f(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=qs(this,this.l+t))!==0;)i.push(_f(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=xo(this,c),this.l=c+1,o=xc.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(_f(qs(this,c))),c+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=xo(this,c),this.l=c+1,o=xc.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(_f(xo(this,c))),c+=1}r=i.join("");break;default:switch(t){case 1:return n=xo(this,this.l),this.l++,n;case 2:return n=(e==="i"?NL:qs)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?ga:PL)(this,this.l),this.l+=4,n):(s=vn(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=Kh(this,this.l):s=Kh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=aA(this,this.l,t);break}}return this.l+=t,r}var DL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},FL=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},bL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function OL(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)bL(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,DL(this,e,this.l);break;case 8:if(n=8,r==="f"){RL(this,e,this.l);break}case 16:break;case-4:n=4,FL(this,e,this.l);break}return this.l+=n,this}function _A(t,e){var r=aA(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function wr(t,e){t.l=e,t.read_shift=xc,t.chk=_A,t.write_shift=OL}function Wr(t,e){t.l+=e}function ar(t){var e=ea(t);return wr(e,0),e}function pi(t,e,r){if(t){var n,s,i;wr(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Zh[o]||Zh[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;l=t.l+i;var u=c.f&&c.f(t,i,r);if(t.l=l,e(u,c,o))return}}}function km(){var t=[],e=lt?256:2048,r=function(c){var u=ar(c);return wr(u,0),u},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,e)))},a=function(){return s(),Ri(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function _c(t,e,r){var n=Ar(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function ew(t,e,r){var n=Ar(t);return n.s=_c(n.s,e.s,r),n.e=_c(n.e,e.s,r),n}function yc(t,e){if(t.cRel&&t.c<0)for(t=Ar(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Ar(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Ge(t);return!t.cRel&&t.cRel!=null&&(r=jL(r)),!t.rRel&&t.rRel!=null&&(r=ML(r)),r}function G0(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+cr(t.s.c)+":"+(t.e.cRel?"":"$")+cr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ir(t.s.r)+":"+(t.e.rRel?"":"$")+Ir(t.e.r):yc(t.s,e.biff)+":"+yc(t.e,e.biff)}function Bv(t){return parseInt(LL(t),10)-1}function Ir(t){return""+(t+1)}function ML(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function LL(t){return t.replace(/\$(\d+)$/,"$1")}function zv(t){for(var e=VL(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function cr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function jL(t){return t.replace(/^([A-Z])/,"$$$1")}function VL(t){return t.replace(/^\$([A-Z])/,"$1")}function UL(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Yr(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Ge(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function wl(t){var e=t.indexOf(":");return e==-1?{s:Yr(t),e:Yr(t)}:{s:Yr(t.slice(0,e)),e:Yr(t.slice(e+1))}}function pt(t,e){return typeof e>"u"||typeof e=="number"?pt(t.s,t.e):(typeof t!="string"&&(t=Ge(t)),typeof e!="string"&&(e=Ge(e)),t==e?t:t+":"+e)}function Gt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function tw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Un(t.z,r?en(e):e)}catch{}try{return t.w=Un((t.XF||{}).numFmtId||(r?14:0),r?en(e):e)}catch{return""+e}}function ui(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?no[t.v]||t.v:e==null?tw(t,t.v):tw(t,e))}function oa(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function yA(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Yr(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Gt(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[h].length;++p)if(!(typeof e[h][p]>"u")){var m={v:e[h][p]},x=a+h,v=o+p;if(c.s.r>x&&(c.s.r=x),c.s.c>v&&(c.s.c=v),c.e.r<x&&(c.e.r=x),c.e.c<v&&(c.e.c=v),e[h][p]&&typeof e[h][p]=="object"&&!Array.isArray(e[h][p])&&!(e[h][p]instanceof Date))m=e[h][p];else if(Array.isArray(m.v)&&(m.f=e[h][p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||Xe[14],n.cellDates?(m.t="d",m.w=Un(m.z,en(m.v))):(m.t="n",m.v=en(m.v),m.w=Un(m.z,m.v))):m.t="s";if(s)i[x]||(i[x]=[]),i[x][v]&&i[x][v].z&&(m.z=i[x][v].z),i[x][v]=m;else{var y=Ge({c:v,r:x});i[y]&&i[y].z&&(m.z=i[y].z),i[y]=m}}}return c.s.c<1e7&&(i["!ref"]=pt(c)),i}function El(t,e){return yA(null,t,e)}function BL(t){return t.read_shift(4,"i")}function zr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function zL(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function $v(t,e){var r=t.l,n=t.read_shift(1),s=zr(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)i.push(zL(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var $L=$v;function Bn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function to(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var HL=zr;function Hv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var WL=zr,Sm=Hv;function Wv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?Kh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ga(e,0)>>2;return r?s/100:s}function wA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var ro=wA;function Ur(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function GL(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=Na[s];c&&(e.rgb=au(c));break;case 2:e.rgb=au([a,o,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function KL(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function EA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function qL(t){return EA(t,1)}function XL(t){return EA(t,2)}var Gv=2,an=3,wf=11,rw=12,qh=19,Ef=64,YL=65,QL=71,JL=4108,ZL=4126,dr=80,TA=81,e8=[dr,TA],t8={1:{n:"CodePage",t:Gv},2:{n:"Category",t:dr},3:{n:"PresentationFormat",t:dr},4:{n:"ByteCount",t:an},5:{n:"LineCount",t:an},6:{n:"ParagraphCount",t:an},7:{n:"SlideCount",t:an},8:{n:"NoteCount",t:an},9:{n:"HiddenCount",t:an},10:{n:"MultimediaClipCount",t:an},11:{n:"ScaleCrop",t:wf},12:{n:"HeadingPairs",t:JL},13:{n:"TitlesOfParts",t:ZL},14:{n:"Manager",t:dr},15:{n:"Company",t:dr},16:{n:"LinksUpToDate",t:wf},17:{n:"CharacterCount",t:an},19:{n:"SharedDoc",t:wf},22:{n:"HyperlinksChanged",t:wf},23:{n:"AppVersion",t:an,p:"version"},24:{n:"DigSig",t:YL},26:{n:"ContentType",t:dr},27:{n:"ContentStatus",t:dr},28:{n:"Language",t:dr},29:{n:"Version",t:dr},255:{},2147483648:{n:"Locale",t:qh},2147483651:{n:"Behavior",t:qh},1919054434:{}},r8={1:{n:"CodePage",t:Gv},2:{n:"Title",t:dr},3:{n:"Subject",t:dr},4:{n:"Author",t:dr},5:{n:"Keywords",t:dr},6:{n:"Comments",t:dr},7:{n:"Template",t:dr},8:{n:"LastAuthor",t:dr},9:{n:"RevNumber",t:dr},10:{n:"EditTime",t:Ef},11:{n:"LastPrinted",t:Ef},12:{n:"CreatedDate",t:Ef},13:{n:"ModifiedDate",t:Ef},14:{n:"PageCount",t:an},15:{n:"WordCount",t:an},16:{n:"CharCount",t:an},17:{n:"Thumbnail",t:QL},18:{n:"Application",t:dr},19:{n:"DocSecurity",t:an},255:{},2147483648:{n:"Locale",t:qh},2147483651:{n:"Behavior",t:qh},1919054434:{}},nw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},n8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function s8(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var i8=s8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Na=Ar(i8),no={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},kA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},sw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function a8(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function o8(t){var e=a8();if(!t||!t.match)return e;var r={};if((t.match(Gr)||[]).forEach(function(n){var s=Ue(n);switch(s[0].replace(mL,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[sw[s.ContentType]]!==void 0&&e[sw[s.ContentType]].push(s.PartName);break}}),e.xmlns!==AL.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Po={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Am(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function wc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Gr)||[]).forEach(function(s){var i=Ue(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:tc(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}var l8="application/vnd.oasis.opendocument.spreadsheet";function c8(t,e){for(var r=Vv(t),n,s;n=su.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Ue(n[0],!1),s.path=="/"&&s.type!==l8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Ec=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],u8=function(){for(var t=new Array(Ec.length),e=0;e<Ec.length;++e){var r=Ec[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function SA(t){var e={};t=Pt(t);for(var r=0;r<Ec.length;++r){var n=Ec[r],s=t.match(u8[r]);s!=null&&s.length>0&&(e[n[1]]=_t(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=gr(e[n[1]]))}return e}var f8=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function AA(t,e,r,n){var s=[];if(typeof t=="string")s=qy(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(u){return{v:u}}));var a=typeof e=="string"?qy(e,n).map(function(u){return u.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function h8(t,e,r){var n={};return e||(e={}),t=Pt(t),f8.forEach(function(s){var i=(t.match(nu(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=_t(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&AA(n.HeadingPairs,n.TitlesOfParts,e,r),e}var d8=/<[^>]+>[^<]*/g;function p8(t,e){var r={},n="",s=t.match(d8);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=Ue(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=_t(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=_t(u);break;case"bool":r[n]=Lt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=gr(u);break;case"cy":case"error":r[n]=_t(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var m8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},K0;function g8(t,e,r){K0||(K0=Mv(m8)),e=K0[e]||e,t[e]=r}function Kv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function IA(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function CA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function RA(t,e,r){return e===31?CA(t):IA(t,e,r)}function Im(t,e,r){return RA(t,e,r===!1?0:4)}function v8(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return RA(t,e,0)}function x8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Zr,""),t.l-s&2&&(t.l+=2)}return r}function _8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Zr,"");return r}function y8(t){var e=t.l,r=Xh(t,TA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Xh(t,an);return[r,n]}function w8(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(y8(t));return r}function iw(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Zr,"").replace(ec,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function NA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function E8(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Xh(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==rw&&n!==e&&e8.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===rw?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return IA(t,n,4).replace(Zr,"");case 31:return CA(t);case 64:return Kv(t);case 65:return NA(t);case 71:return E8(t);case 80:return Im(t,n,!i.raw).replace(Zr,"");case 81:return v8(t,n).replace(Zr,"");case 4108:return w8(t);case 4126:case 4127:return n==4127?x8(t):_8(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function aw(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,l=-1,c={};for(a=0;a!=s;++a){var u=t.read_shift(4),h=t.read_shift(4);i[a]=[u,h+r]}i.sort(function(k,w){return k[1]-w[1]});var p={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var m=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],m=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],m=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(m=!1,t.l=i[a][1]),m)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var x=e[i[a][0]];if(p[x.n]=Xh(t,x.t,{raw:!0}),x.p==="version"&&(p[x.n]=String(p[x.n]>>16)+"."+("0000"+String(p[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(p[x.n]){case 0:p[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:es(o=p[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[x.n])}}else if(i[a][0]===1){if(o=p.CodePage=Xh(t,Gv),es(o),l!==-1){var v=t.l;t.l=i[l][1],c=iw(t,o),t.l=v}}else if(i[a][0]===0){if(o===0){l=a,t.l=i[a+1][1];continue}c=iw(t,o)}else{var y=c[i[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=NA(t);break;case 30:t.l+=4,T=Im(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=Im(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=Kt(t,4);break;case 64:t.l+=4,T=gr(Kv(t));break;default:throw new Error("unparsed value: "+t[t.l])}p[y]=T}}return t.l=r+n,p}function ow(t,e,r){var n=t.content;if(!n)return{};wr(n,0);var s,i,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==dt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=aw(n,e),p={SystemIdentifier:c};for(var m in h)p[m]=h[m];if(p.FMTID=i,s===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=aw(n,null)}catch{}for(m in x)p[m]=x[m];return p.FMTID=[i,a],p}function yi(t,e){return t.read_shift(e),null}function T8(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Kt(t,e){return t.read_shift(e)===1}function er(t){return t.read_shift(2,"u")}function PA(t,e){return T8(t,e,er)}function k8(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Pu(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function S8(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,l={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return s&&(t.l+=4*a),n&&(t.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Ha(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Du(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ha(t,n,r)}function so(t,e,r){if(r.biff>5)return Du(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function A8(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function I8(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Zr,"");return n&&(t.l+=24),s}function C8(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(Zr,"");return r+a}function R8(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return I8(t);case"0303000000000000c000000000000046":return C8(t);default:throw new Error("Unsupported Moniker "+r)}}function Tf(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Zr,""):"";return r}function N8(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,l,c="",u,h;s&16&&(i=Tf(t,r-t.l)),s&128&&(a=Tf(t,r-t.l)),(s&257)===257&&(o=Tf(t,r-t.l)),(s&257)===1&&(l=R8(t,r-t.l)),s&8&&(c=Tf(t,r-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(h=Kv(t)),t.l=r;var p=a||o||l||"";p&&c&&(p+="#"+c),p||(p="#"+c),s&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var m={Target:p};return u&&(m.guid=u),h&&(m.time=h),i&&(m.Tooltip=i),m}function DA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function FA(t,e){var r=DA(t);return r[3]=0,r}function Ds(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function P8(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function D8(t,e,r){return e===0?"":so(t,e,r)}function F8(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function bA(t){var e=t.read_shift(2),r=Wv(t);return[e,r]}function b8(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Pu(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Wd(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function OA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var O8=OA;function MA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function M8(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function L8(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Or(t){t.l+=2,t.l+=t.read_shift(2)}var j8={0:Or,4:Or,5:Or,6:Or,7:L8,8:Or,9:Or,10:Or,11:Or,12:Or,13:M8,14:Or,15:Or,16:Or,17:Or,18:Or,19:Or,20:Or,21:MA};function V8(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(j8[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function kf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function U8(t,e){return e===0||t.read_shift(2),1200}function B8(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=so(t,0,r);return t.read_shift(e+n-t.l),s}function z8(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function $8(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=Pu(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function H8(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(S8(t));return i.Count=n,i.Unique=s,i}function W8(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function G8(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function K8(t){var e=P8(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function q8(t){return t.read_shift(2),t.read_shift(4)}function lw(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function X8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function Y8(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function Q8(){}function J8(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Pu(t,0,r),n}function Z8(t){var e=Ds(t);return e.isst=t.read_shift(4),e}function e5(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Ds(t);r.biff==2&&t.l++;var i=Du(t,n-t.l,r);return s.val=i,s}function t5(t,e,r){var n=t.read_shift(2),s=so(t,0,r);return[n,s]}var r5=so;function cw(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c:l}}}function n5(t){var e=t.read_shift(2),r=t.read_shift(2),n=bA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function s5(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(bA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function i5(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function a5(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=n8[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function o5(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=a5(t,e,n.fStyle,r),n}function l5(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function uw(t,e,r){var n=Ds(t);(r.biff==2||e==9)&&++t.l;var s=k8(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function c5(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ds(t),s=Ur(t);return n.val=s,n}var fw=D8;function u5(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=Ha(t,i),o=[];n>t.l;)o.push(Du(t));return[i,s,a,o]}function hw(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=b8(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var f5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function dw(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Ha(t,a,r);s&32&&(c=f5[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var h=n==t.l||o===0||!(u>0)?[]:GV(t,u,r,o);return{chKey:i,Name:c,itab:l,rgce:h}}function LA(t,e,r){if(r.biff<8)return h5(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(F8(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function h5(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Pu(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function d5(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=Ha(t,n,r),a=Ha(t,s,r);return[i,a]}function p5(t,e,r){var n=OA(t);t.l++;var s=t.read_shift(1);return e-=8,[KV(t,e,r),s,n]}function pw(t,e,r){var n=O8(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,HV(t,e,r)]}function m5(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function g5(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=so(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function v5(t,e,r){return g5(t,e,r)}function x5(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Wd(t));return r}function _5(t,e,r){if(r&&r.biff<8)return w5(t,e,r);var n=MA(t),s=V8(t,e-22,n[1]);return{cmo:n,ft:s}}var y5={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function w5(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((y5[n]||Wr)(t,e,r)),{cmo:[s,n,i],ft:a}}function E5(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=A8(t,6,r);var o=t.read_shift(2);t.read_shift(2),er(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],h=Ha(t,t.lens[c+1]-t.lens[c]-1);if(s+=h,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function T5(t,e){var r=Wd(t);t.l+=16;var n=N8(t,e-24);return[r,n]}function k5(t,e){t.read_shift(2);var r=Wd(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Zr,""),[r,n]}function S5(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=nw[r]||r,r=t.read_shift(2),e[1]=nw[r]||r,e}function A5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(FA(t));return r}function I5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(FA(t));return r}function C5(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function jA(t,e,r){if(!r.cellStyles)return Wr(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:i,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function R5(t,e){var r={};return e<32||(t.l+=16,r.header=Ur(t),r.footer=Ur(t),t.l+=2),r}function N5(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var P5=Ds,D5=PA,F5=Du;function b5(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function O5(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ds(t);++t.l;var s=so(t,e-7,r);return n.t="str",n.val=s,n}function M5(t){var e=Ds(t);++t.l;var r=Ur(t);return e.t="n",e.val=r,e}function L5(t){var e=Ds(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function j5(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function V5(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function U5(t,e,r){var n=t.l+e,s=Ds(t),i=t.read_shift(2),a=Ha(t,i,r);return t.l=n,s.t="str",s.val=a,s}var B5=[2,3,48,49,131,139,140,245],mw=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Mv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=ea(1);switch(l.type){case"base64":u=Jn(Tn(o));break;case"binary":u=Jn(o);break;case"buffer":case"array":u=o;break}wr(u,0);var h=u.read_shift(1),p=!!(h&136),m=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,p=!0;break;case 49:m=!0,p=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,y=521;h==2&&(v=u.read_shift(2)),u.l+=3,h!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(y=u.read_shift(2));var T=u.read_shift(2),k=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(k=t[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var w=[],D={},U=Math.min(u.length,h==2?521:y-10-(m?264:0)),V=x?32:11;u.l<U&&u[u.l]!=13;)switch(D={},D.name=tu.utils.decode(k,u.slice(u.l,u.l+V)).replace(/[\u0000\r\n].*$/g,""),u.l+=V,D.type=String.fromCharCode(u.read_shift(1)),h!=2&&!x&&(D.offset=u.read_shift(4)),D.len=u.read_shift(1),h==2&&(D.offset=u.read_shift(2)),D.dec=u.read_shift(1),D.name.length&&w.push(D),h!=2&&(u.l+=x?13:14),D.type){case"B":(!m||D.len!=8)&&l.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var g=0,E=0;for(c[0]=[],E=0;E!=w.length;++E)c[0][E]=w[E].name;for(;v-- >0;){if(u[u.l]===42){u.l+=T;continue}for(++u.l,c[++g]=[],E=0,E=0;E!=w.length;++E){var S=u.slice(u.l,u.l+w[E].len);u.l+=w[E].len,wr(S,0);var C=tu.utils.decode(k,S);switch(w[E].type){case"C":C.trim().length&&(c[g][E]=C.replace(/\s+$/,""));break;case"D":C.length===8?c[g][E]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):c[g][E]=C;break;case"F":c[g][E]=parseFloat(C.trim());break;case"+":case"I":c[g][E]=x?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":c[g][E]=!0;break;case"N":case"F":c[g][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[g][E]="##MEMO##"+(x?parseInt(C.trim(),10):S.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(c[g][E]=+C||0);break;case"@":c[g][E]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[g][E]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[g][E]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[g][E]=-S.read_shift(-8,"f");break;case"B":if(m&&w[E].len==8){c[g][E]=S.read_shift(8,"f");break}case"G":case"P":S.l+=w[E].len;break;case"0":if(w[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[E].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=El(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function s(o,l){try{return oa(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&es(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=km(),h=Fm(o,{header:1,raw:!0,cellDates:!0}),p=h[0],m=h.slice(1),x=o["!cols"]||[],v=0,y=0,T=0,k=1;for(v=0;v<p.length;++v){if(((x[v]||{}).DBF||{}).name){p[v]=x[v].DBF.name,++T;continue}if(p[v]!=null){if(++T,typeof p[v]=="number"&&(p[v]=p[v].toString(10)),typeof p[v]!="string")throw new Error("DBF Invalid column name "+p[v]+" |"+typeof p[v]+"|");if(p.indexOf(p[v])!==v){for(y=0;y<1024;++y)if(p.indexOf(p[v]+"_"+y)==-1){p[v]+="_"+y;break}}}}var w=Gt(o["!ref"]),D=[],U=[],V=[];for(v=0;v<=w.e.c-w.s.c;++v){var g="",E="",S=0,C=[];for(y=0;y<m.length;++y)m[y][v]!=null&&C.push(m[y][v]);if(C.length==0||p[v]==null){D[v]="?";continue}for(y=0;y<C.length;++y){switch(typeof C[y]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=C[y]instanceof Date?"D":"C";break;default:E="C"}S=Math.max(S,String(C[y]).length),g=g&&g!=E?"C":E}S>250&&(S=250),E=((x[v]||{}).DBF||{}).type,E=="C"&&x[v].DBF.len>S&&(S=x[v].DBF.len),g=="B"&&E=="N"&&(g="N",V[v]=x[v].DBF.dec,S=x[v].DBF.len),U[v]=g=="C"||E=="N"?S:i[g]||0,k+=U[v],D[v]=g}var P=u.next(32);for(P.write_shift(4,318902576),P.write_shift(4,m.length),P.write_shift(2,296+32*T),P.write_shift(2,k),v=0;v<4;++v)P.write_shift(4,0);for(P.write_shift(4,0|(+e[LS]||3)<<8),v=0,y=0;v<p.length;++v)if(p[v]!=null){var R=u.next(32),b=(p[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,b,"sbcs"),R.write_shift(1,D[v]=="?"?"C":D[v],"sbcs"),R.write_shift(4,y),R.write_shift(1,U[v]||i[D[v]]||0),R.write_shift(1,V[v]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),y+=U[v]||i[D[v]]||0}var ce=u.next(264);for(ce.write_shift(4,13),v=0;v<65;++v)ce.write_shift(4,0);for(v=0;v<m.length;++v){var fe=u.next(k);for(fe.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(D[y]){case"L":fe.write_shift(1,m[v][y]==null?63:m[v][y]?84:70);break;case"B":fe.write_shift(8,m[v][y]||0,"f");break;case"N":var Ae="0";for(typeof m[v][y]=="number"&&(Ae=m[v][y].toFixed(V[y]||0)),T=0;T<U[y]-Ae.length;++T)fe.write_shift(1,32);fe.write_shift(1,Ae,"sbcs");break;case"D":m[v][y]?(fe.write_shift(4,("0000"+m[v][y].getFullYear()).slice(-4),"sbcs"),fe.write_shift(2,("00"+(m[v][y].getMonth()+1)).slice(-2),"sbcs"),fe.write_shift(2,("00"+m[v][y].getDate()).slice(-2),"sbcs")):fe.write_shift(8,"00000000","sbcs");break;case"C":var _e=String(m[v][y]!=null?m[v][y]:"").slice(0,U[y]);for(fe.write_shift(1,_e,"sbcs"),T=0;T<U[y]-_e.length;++T)fe.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),z5=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Is(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,m){var x=t[m];return typeof x=="number"?Py(x):x},n=function(p,m,x){var v=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?p:Py(v)};t["|"]=254;function s(p,m){switch(m.type){case"base64":return i(Tn(p),m);case"binary":return i(p,m);case"buffer":return i(lt&&Buffer.isBuffer(p)?p.toString("binary"):eo(p),m);case"array":return i($a(p),m)}throw new Error("Unrecognized type "+m.type)}function i(p,m){var x=p.split(/[\n\r]+/),v=-1,y=-1,T=0,k=0,w=[],D=[],U=null,V={},g=[],E=[],S=[],C=0,P;for(+m.codepage>=0&&es(+m.codepage);T!==x.length;++T){C=0;var R=x[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),b=R.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),ce=b[0],fe;if(R.length>0)switch(ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":b[1].charAt(0)=="P"&&D.push(R.slice(3).replace(/;;/g,";"));break;case"C":var Ae=!1,_e=!1,oe=!1,K=!1,de=-1,Te=-1;for(k=1;k<b.length;++k)switch(b[k].charAt(0)){case"A":break;case"X":y=parseInt(b[k].slice(1))-1,_e=!0;break;case"Y":for(v=parseInt(b[k].slice(1))-1,_e||(y=0),P=w.length;P<=v;++P)w[P]=[];break;case"K":fe=b[k].slice(1),fe.charAt(0)==='"'?fe=fe.slice(1,fe.length-1):fe==="TRUE"?fe=!0:fe==="FALSE"?fe=!1:isNaN(is(fe))?isNaN(cl(fe).getDate())||(fe=gr(fe)):(fe=is(fe),U!==null&&yl(U)&&(fe=Hd(fe))),Ae=!0;break;case"E":K=!0;var B=Ho(b[k].slice(1),{r:v,c:y});w[v][y]=[w[v][y],B];break;case"S":oe=!0,w[v][y]=[w[v][y],"S5S"];break;case"G":break;case"R":de=parseInt(b[k].slice(1))-1;break;case"C":Te=parseInt(b[k].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+R)}if(Ae&&(w[v][y]&&w[v][y].length==2?w[v][y][0]=fe:w[v][y]=fe,U=null),oe){if(K)throw new Error("SYLK shared formula cannot have own formula");var ee=de>-1&&w[de][Te];if(!ee||!ee[1])throw new Error("SYLK shared formula cannot find base");w[v][y][1]=qA(ee[1],{r:v-de,c:y-Te})}break;case"F":var q=0;for(k=1;k<b.length;++k)switch(b[k].charAt(0)){case"X":y=parseInt(b[k].slice(1))-1,++q;break;case"Y":for(v=parseInt(b[k].slice(1))-1,P=w.length;P<=v;++P)w[P]=[];break;case"M":C=parseInt(b[k].slice(1))/20;break;case"F":break;case"G":break;case"P":U=D[parseInt(b[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=b[k].slice(1).split(" "),P=parseInt(S[0],10);P<=parseInt(S[1],10);++P)C=parseInt(S[2],10),E[P-1]=C===0?{hidden:!0}:{wch:C},ul(E[P-1]);break;case"C":y=parseInt(b[k].slice(1))-1,E[y]||(E[y]={});break;case"R":v=parseInt(b[k].slice(1))-1,g[v]||(g[v]={}),C>0?(g[v].hpt=C,g[v].hpx=ou(C)):C===0&&(g[v].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+R)}q<1&&(U=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+R)}}return g.length>0&&(V["!rows"]=g),E.length>0&&(V["!cols"]=E),m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),[w,V]}function a(p,m){var x=s(p,m),v=x[0],y=x[1],T=El(v,m);return Is(y).forEach(function(k){T[k]=y[k]}),T}function o(p,m){return oa(a(p,m),m)}function l(p,m,x,v){var y="C;Y"+(x+1)+";X"+(v+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+Cj(p.f,{r:x,c:v}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function c(p,m){m.forEach(function(x,v){var y="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?y+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Qh(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Jh(x.wpx)),typeof x.wch=="number"&&(y+=Math.round(x.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function u(p,m){m.forEach(function(x,v){var y="F;";x.hidden?y+="M0;":x.hpt?y+="M"+20*x.hpt+";":x.hpx&&(y+="M"+20*WA(x.hpx)+";"),y.length>2&&p.push(y+"R"+(v+1))})}function h(p,m){var x=["ID;PWXL;N;E"],v=[],y=Gt(p["!ref"]),T,k=Array.isArray(p),w=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),p["!cols"]&&c(x,p["!cols"]),p["!rows"]&&u(x,p["!rows"]),x.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var D=y.s.r;D<=y.e.r;++D)for(var U=y.s.c;U<=y.e.c;++U){var V=Ge({r:D,c:U});T=k?(p[D]||[])[U]:p[V],!(!T||T.v==null&&(!T.f||T.F))&&v.push(l(T,p,D,U))}return x.join(w)+w+v.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),$5=function(){function t(i,a){switch(a.type){case"base64":return e(Tn(i),a);case"binary":return e(i,a);case"buffer":return e(lt&&Buffer.isBuffer(i)?i.toString("binary"):eo(i),a);case"array":return e($a(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var p=o[u].trim().split(","),m=p[0],x=p[1];++u;for(var v=o[u]||"";(v.match(/["]/g)||[]).length&1&&u<o.length-1;)v+=`
`+o[++u];switch(v=v.trim(),+m){case-1:if(v==="BOT"){h[++l]=[],c=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[l][c]=!0:v==="FALSE"?h[l][c]=!1:isNaN(is(x))?isNaN(cl(x).getDate())?h[l][c]=x:h[l][c]=gr(x):h[l][c]=is(x),++c;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[l][c++]=v!==""?v:null;break}if(v==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(i,a){return El(t(i,a),a)}function n(i,a){return oa(r(i,a),a)}var s=function(){var i=function(l,c,u,h,p){l.push(c),l.push(u+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},a=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=Gt(l["!ref"]),h,p=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){a(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var v=Ge({r:m,c:x});if(h=p?(l[m]||[])[x]:l[v],!h){a(c,1,0,"");continue}switch(h.t){case"n":var y=h.w;!y&&h.v!=null&&(y=h.v),y==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,y,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Un(h.z||Xe[14],en(gr(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,k=c.join(T);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),H5=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var m=h.split(`
`),x=-1,v=-1,y=0,T=[];y!==m.length;++y){var k=m[y].trim().split(":");if(k[0]==="cell"){var w=Yr(k[1]);if(T.length<=w.r)for(x=T.length;x<=w.r;++x)T[x]||(T[x]=[]);switch(x=w.r,v=w.c,k[2]){case"t":T[x][v]=t(k[3]);break;case"v":T[x][v]=+k[3];break;case"vtf":var D=k[k.length-1];case"vtc":switch(k[3]){case"nl":T[x][v]=!!+k[4];break;default:T[x][v]=+k[4];break}k[2]=="vtf"&&(T[x][v]=[T[x][v],D])}}}return p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),T}function n(h,p){return El(r(h,p),p)}function s(h,p){return oa(n(h,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var p=[],m=[],x,v="",y=wl(h["!ref"]),T=Array.isArray(h),k=y.s.r;k<=y.e.r;++k)for(var w=y.s.c;w<=y.e.c;++w)if(v=Ge({r:k,c:w}),x=T?(h[k]||[])[w]:h[v],!(!x||x.v==null||x.t==="z")){switch(m=["cell",v,"t"],x.t){case"s":case"str":m.push(e(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=e(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var D=en(gr(x.v));m[2]="vtc",m[3]="nd",m[4]=""+D,m[5]=x.w||Un(x.z||Xe[14],D);break;case"e":continue}p.push(m.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function u(h){return[i,a,o,a,c(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),iu=function(){function t(u,h,p,m,x){x.raw?h[p][m]=u:u===""||(u==="TRUE"?h[p][m]=!0:u==="FALSE"?h[p][m]=!1:isNaN(is(u))?isNaN(cl(u).getDate())?h[p][m]=u:h[p][m]=gr(u):h[p][m]=is(u))}function e(u,h){var p=h||{},m=[];if(!u||u.length===0)return m;for(var x=u.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var y=10,T=0,k=0;k<=v;++k)T=x[k].indexOf(" "),T==-1?T=x[k].length:T++,y=Math.max(y,T);for(k=0;k<=v;++k){m[k]=[];var w=0;for(t(x[k].slice(0,y).trim(),m,k,w,p),w=1;w<=(x[k].length-y)/10+1;++w)t(x[k].slice(y+(w-1)*10,y+w*10).trim(),m,k,w,p)}return p.sheetRows&&(m=m.slice(0,p.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var h={},p=!1,m=0,x=0;m<u.length;++m)(x=u.charCodeAt(m))==34?p=!p:!p&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&x.push([h[m],m]);if(!x.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&x.push([h[m],m])}return x.sort(function(v,y){return v[0]-y[0]||n[v[1]]-n[y[1]]}),r[x.pop()[1]]||44}function i(u,h){var p=h||{},m="",x=p.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=s(u.slice(0,1024)):p&&p.FS?m=p.FS:m=s(u.slice(0,1024));var y=0,T=0,k=0,w=0,D=0,U=m.charCodeAt(0),V=!1,g=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var S=p.dateNF!=null?tL(p.dateNF):null;function C(){var P=u.slice(w,D),R={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)R.t="z";else if(p.raw)R.t="s",R.v=P;else if(P.trim().length===0)R.t="s",R.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(R.t="s",R.v=P.slice(2,-1).replace(/""/g,'"')):Nj(P)?(R.t="n",R.f=P.slice(1)):(R.t="s",R.v=P);else if(P=="TRUE")R.t="b",R.v=!0;else if(P=="FALSE")R.t="b",R.v=!1;else if(!isNaN(k=is(P)))R.t="n",p.cellText!==!1&&(R.w=P),R.v=k;else if(!isNaN(cl(P).getDate())||S&&P.match(S)){R.z=p.dateNF||Xe[14];var b=0;S&&P.match(S)&&(P=rL(P,p.dateNF,P.match(S)||[]),b=1),p.cellDates?(R.t="d",R.v=gr(P,b)):(R.t="n",R.v=en(gr(P,b))),p.cellText!==!1&&(R.w=Un(R.z,R.v instanceof Date?en(R.v):R.v)),p.cellNF||delete R.z}else R.t="s",R.v=P;if(R.t=="z"||(p.dense?(x[y]||(x[y]=[]),x[y][T]=R):x[Ge({c:T,r:y})]=R),w=D+1,E=u.charCodeAt(w),v.e.c<T&&(v.e.c=T),v.e.r<y&&(v.e.r=y),g==U)++T;else if(T=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;D<u.length;++D)switch(g=u.charCodeAt(D)){case 34:E===34&&(V=!V);break;case U:case 10:case 13:if(!V&&C())break e;break}return D-w>0&&C(),x["!ref"]=pt(v),x}function a(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,h):El(e(u,h),h)}function o(u,h){var p="",m=h.type=="string"?[0,0,0,0]:tx(u,h);switch(h.type){case"base64":p=Tn(u);break;case"binary":p=u;break;case"buffer":h.codepage==65001?p=u.toString("utf8"):h.codepage&&typeof tu<"u"||(p=lt&&Buffer.isBuffer(u)?u.toString("binary"):eo(u));break;case"array":p=$a(u);break;case"string":p=u;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?p=Pt(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=Pt(p):h.type=="binary"&&typeof tu<"u",p.slice(0,19)=="socialcalc:version:"?H5.to_sheet(h.type=="string"?p:Pt(p),h):a(p,h)}function l(u,h){return oa(o(u,h),h)}function c(u){for(var h=[],p=Gt(u["!ref"]),m,x=Array.isArray(u),v=p.s.r;v<=p.e.r;++v){for(var y=[],T=p.s.c;T<=p.e.c;++T){var k=Ge({r:v,c:T});if(m=x?(u[v]||[])[T]:u[k],!m||m.v==null){y.push("          ");continue}for(var w=(m.w||(ui(m),m.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(T===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function W5(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=z5.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return iu.to_workbook(t,e)}}var Tc=function(){function t(B,ee,q){if(B){wr(B,B.l||0);for(var W=q.Enum||de;B.l<B.length;){var ae=B.read_shift(2),ve=W[ae]||W[65535],Ce=B.read_shift(2),Ee=B.l+Ce,pe=ve.f&&ve.f(B,Ce,q);if(B.l=Ee,ee(pe,ve,ae))return}}}function e(B,ee){switch(ee.type){case"base64":return r(Jn(Tn(B)),ee);case"binary":return r(Jn(B),ee);case"buffer":case"array":return r(B,ee)}throw"Unsupported type "+ee.type}function r(B,ee){if(!B)return B;var q=ee||{},W=q.dense?[]:{},ae="Sheet1",ve="",Ce=0,Ee={},pe=[],He=[],z={s:{r:0,c:0},e:{r:0,c:0}},ct=q.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)q.Enum=de,t(B,function(Y,ke,be){switch(be){case 0:q.vers=Y,Y>=4096&&(q.qpro=!0);break;case 6:z=Y;break;case 204:Y&&(ve=Y);break;case 222:ve=Y;break;case 15:case 51:q.qpro||(Y[1].v=Y[1].v.slice(1));case 13:case 14:case 16:be==14&&(Y[2]&112)==112&&(Y[2]&15)>1&&(Y[2]&15)<15&&(Y[1].z=q.dateNF||Xe[14],q.cellDates&&(Y[1].t="d",Y[1].v=Hd(Y[1].v))),q.qpro&&Y[3]>Ce&&(W["!ref"]=pt(z),Ee[ae]=W,pe.push(ae),W=q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Ce=Y[3],ae=ve||"Sheet"+(Ce+1),ve="");var je=q.dense?(W[Y[0].r]||[])[Y[0].c]:W[Ge(Y[0])];if(je){je.t=Y[1].t,je.v=Y[1].v,Y[1].z!=null&&(je.z=Y[1].z),Y[1].f!=null&&(je.f=Y[1].f);break}q.dense?(W[Y[0].r]||(W[Y[0].r]=[]),W[Y[0].r][Y[0].c]=Y[1]):W[Ge(Y[0])]=Y[1];break}},q);else if(B[2]==26||B[2]==14)q.Enum=Te,B[2]==14&&(q.qpro=!0,B.l=0),t(B,function(Y,ke,be){switch(be){case 204:ae=Y;break;case 22:Y[1].v=Y[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Y[3]>Ce&&(W["!ref"]=pt(z),Ee[ae]=W,pe.push(ae),W=q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Ce=Y[3],ae="Sheet"+(Ce+1)),ct>0&&Y[0].r>=ct)break;q.dense?(W[Y[0].r]||(W[Y[0].r]=[]),W[Y[0].r][Y[0].c]=Y[1]):W[Ge(Y[0])]=Y[1],z.e.c<Y[0].c&&(z.e.c=Y[0].c),z.e.r<Y[0].r&&(z.e.r=Y[0].r);break;case 27:Y[14e3]&&(He[Y[14e3][0]]=Y[14e3][1]);break;case 1537:He[Y[0]]=Y[1],Y[0]==Ce&&(ae=Y[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(W["!ref"]=pt(z),Ee[ve||ae]=W,pe.push(ve||ae),!He.length)return{SheetNames:pe,Sheets:Ee};for(var Ye={},at=[],Me=0;Me<He.length;++Me)Ee[pe[Me]]?(at.push(He[Me]||pe[Me]),Ye[He[Me]]=Ee[He[Me]]||Ee[pe[Me]]):(at.push(He[Me]),Ye[He[Me]]={"!ref":"A1"});return{SheetNames:at,Sheets:Ye}}function n(B,ee){var q=ee||{};if(+q.codepage>=0&&es(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var W=km(),ae=Gt(B["!ref"]),ve=Array.isArray(B),Ce=[];Gn(W,0,i(1030)),Gn(W,6,l(ae));for(var Ee=Math.min(ae.e.r,8191),pe=ae.s.r;pe<=Ee;++pe)for(var He=Ir(pe),z=ae.s.c;z<=ae.e.c;++z){pe===ae.s.r&&(Ce[z]=cr(z));var ct=Ce[z]+He,Ye=ve?(B[pe]||[])[z]:B[ct];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")(Ye.v|0)==Ye.v&&Ye.v>=-32768&&Ye.v<=32767?Gn(W,13,m(pe,z,Ye.v)):Gn(W,14,v(pe,z,Ye.v));else{var at=ui(Ye);Gn(W,15,h(pe,z,at.slice(0,239)))}}return Gn(W,1),W.end()}function s(B,ee){var q=ee||{};if(+q.codepage>=0&&es(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var W=km();Gn(W,0,a(B));for(var ae=0,ve=0;ae<B.SheetNames.length;++ae)(B.Sheets[B.SheetNames[ae]]||{})["!ref"]&&Gn(W,27,K(B.SheetNames[ae],ve++));var Ce=0;for(ae=0;ae<B.SheetNames.length;++ae){var Ee=B.Sheets[B.SheetNames[ae]];if(!(!Ee||!Ee["!ref"])){for(var pe=Gt(Ee["!ref"]),He=Array.isArray(Ee),z=[],ct=Math.min(pe.e.r,8191),Ye=pe.s.r;Ye<=ct;++Ye)for(var at=Ir(Ye),Me=pe.s.c;Me<=pe.e.c;++Me){Ye===pe.s.r&&(z[Me]=cr(Me));var Y=z[Me]+at,ke=He?(Ee[Ye]||[])[Me]:Ee[Y];if(!(!ke||ke.t=="z"))if(ke.t=="n")Gn(W,23,C(Ye,Me,Ce,ke.v));else{var be=ui(ke);Gn(W,22,g(Ye,Me,Ce,be.slice(0,239)))}}++Ce}}return Gn(W,1),W.end()}function i(B){var ee=ar(2);return ee.write_shift(2,B),ee}function a(B){var ee=ar(26);ee.write_shift(2,4096),ee.write_shift(2,4),ee.write_shift(4,0);for(var q=0,W=0,ae=0,ve=0;ve<B.SheetNames.length;++ve){var Ce=B.SheetNames[ve],Ee=B.Sheets[Ce];if(!(!Ee||!Ee["!ref"])){++ae;var pe=wl(Ee["!ref"]);q<pe.e.r&&(q=pe.e.r),W<pe.e.c&&(W=pe.e.c)}}return q>8191&&(q=8191),ee.write_shift(2,q),ee.write_shift(1,ae),ee.write_shift(1,W),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(1,1),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(4,0),ee}function o(B,ee,q){var W={s:{c:0,r:0},e:{c:0,r:0}};return ee==8&&q.qpro?(W.s.c=B.read_shift(1),B.l++,W.s.r=B.read_shift(2),W.e.c=B.read_shift(1),B.l++,W.e.r=B.read_shift(2),W):(W.s.c=B.read_shift(2),W.s.r=B.read_shift(2),ee==12&&q.qpro&&(B.l+=2),W.e.c=B.read_shift(2),W.e.r=B.read_shift(2),ee==12&&q.qpro&&(B.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function l(B){var ee=ar(8);return ee.write_shift(2,B.s.c),ee.write_shift(2,B.s.r),ee.write_shift(2,B.e.c),ee.write_shift(2,B.e.r),ee}function c(B,ee,q){var W=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(W[0].c=B.read_shift(1),W[3]=B.read_shift(1),W[0].r=B.read_shift(2),B.l+=2):(W[2]=B.read_shift(1),W[0].c=B.read_shift(2),W[0].r=B.read_shift(2)),W}function u(B,ee,q){var W=B.l+ee,ae=c(B,ee,q);if(ae[1].t="s",q.vers==20768){B.l++;var ve=B.read_shift(1);return ae[1].v=B.read_shift(ve,"utf8"),ae}return q.qpro&&B.l++,ae[1].v=B.read_shift(W-B.l,"cstr"),ae}function h(B,ee,q){var W=ar(7+q.length);W.write_shift(1,255),W.write_shift(2,ee),W.write_shift(2,B),W.write_shift(1,39);for(var ae=0;ae<W.length;++ae){var ve=q.charCodeAt(ae);W.write_shift(1,ve>=128?95:ve)}return W.write_shift(1,0),W}function p(B,ee,q){var W=c(B,ee,q);return W[1].v=B.read_shift(2,"i"),W}function m(B,ee,q){var W=ar(7);return W.write_shift(1,255),W.write_shift(2,ee),W.write_shift(2,B),W.write_shift(2,q,"i"),W}function x(B,ee,q){var W=c(B,ee,q);return W[1].v=B.read_shift(8,"f"),W}function v(B,ee,q){var W=ar(13);return W.write_shift(1,255),W.write_shift(2,ee),W.write_shift(2,B),W.write_shift(8,q,"f"),W}function y(B,ee,q){var W=B.l+ee,ae=c(B,ee,q);if(ae[1].v=B.read_shift(8,"f"),q.qpro)B.l=W;else{var ve=B.read_shift(2);D(B.slice(B.l,B.l+ve),ae),B.l+=ve}return ae}function T(B,ee,q){var W=ee&32768;return ee&=-32769,ee=(W?B:0)+(ee>=8192?ee-16384:ee),(W?"":"$")+(q?cr(ee):Ir(ee))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(B,ee){wr(B,0);for(var q=[],W=0,ae="",ve="",Ce="",Ee="";B.l<B.length;){var pe=B[B.l++];switch(pe){case 0:q.push(B.read_shift(8,"f"));break;case 1:ve=T(ee[0].c,B.read_shift(2),!0),ae=T(ee[0].r,B.read_shift(2),!1),q.push(ve+ae);break;case 2:{var He=T(ee[0].c,B.read_shift(2),!0),z=T(ee[0].r,B.read_shift(2),!1);ve=T(ee[0].c,B.read_shift(2),!0),ae=T(ee[0].r,B.read_shift(2),!1),q.push(He+z+":"+ve+ae)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(B.read_shift(2));break;case 6:{for(var ct="";pe=B[B.l++];)ct+=String.fromCharCode(pe);q.push('"'+ct.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:Ee=q.pop(),Ce=q.pop(),q.push(["AND","OR"][pe-20]+"("+Ce+","+Ee+")");break;default:if(pe<32&&w[pe])Ee=q.pop(),Ce=q.pop(),q.push(Ce+w[pe]+Ee);else if(k[pe]){if(W=k[pe][1],W==69&&(W=B[B.l++]),W>q.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+q.join("|")+"|");return}var Ye=q.slice(-W);q.length-=W,q.push(k[pe][0]+"("+Ye.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}q.length==1?ee[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function U(B){var ee=[{c:0,r:0},{t:"n",v:0},0];return ee[0].r=B.read_shift(2),ee[3]=B[B.l++],ee[0].c=B[B.l++],ee}function V(B,ee){var q=U(B);return q[1].t="s",q[1].v=B.read_shift(ee-4,"cstr"),q}function g(B,ee,q,W){var ae=ar(6+W.length);ae.write_shift(2,B),ae.write_shift(1,q),ae.write_shift(1,ee),ae.write_shift(1,39);for(var ve=0;ve<W.length;++ve){var Ce=W.charCodeAt(ve);ae.write_shift(1,Ce>=128?95:Ce)}return ae.write_shift(1,0),ae}function E(B,ee){var q=U(B);q[1].v=B.read_shift(2);var W=q[1].v>>1;if(q[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return q[1].v=W,q}function S(B,ee){var q=U(B),W=B.read_shift(4),ae=B.read_shift(4),ve=B.read_shift(2);if(ve==65535)return W===0&&ae===3221225472?(q[1].t="e",q[1].v=15):W===0&&ae===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Ce=ve&32768;return ve=(ve&32767)-16446,q[1].v=(1-Ce*2)*(ae*Math.pow(2,ve+32)+W*Math.pow(2,ve)),q}function C(B,ee,q,W){var ae=ar(14);if(ae.write_shift(2,B),ae.write_shift(1,q),ae.write_shift(1,ee),W==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var ve=0,Ce=0,Ee=0,pe=0;return W<0&&(ve=1,W=-W),Ce=Math.log2(W)|0,W/=Math.pow(2,Ce-31),pe=W>>>0,pe&2147483648||(W/=2,++Ce,pe=W>>>0),W-=pe,pe|=2147483648,pe>>>=0,W*=Math.pow(2,32),Ee=W>>>0,ae.write_shift(4,Ee),ae.write_shift(4,pe),Ce+=16383+(ve?32768:0),ae.write_shift(2,Ce),ae}function P(B,ee){var q=S(B);return B.l+=ee-14,q}function R(B,ee){var q=U(B),W=B.read_shift(4);return q[1].v=W>>6,q}function b(B,ee){var q=U(B),W=B.read_shift(8,"f");return q[1].v=W,q}function ce(B,ee){var q=b(B);return B.l+=ee-10,q}function fe(B,ee){return B[B.l+ee-1]==0?B.read_shift(ee,"cstr"):""}function Ae(B,ee){var q=B[B.l++];q>ee-1&&(q=ee-1);for(var W="";W.length<q;)W+=String.fromCharCode(B[B.l++]);return W}function _e(B,ee,q){if(!(!q.qpro||ee<21)){var W=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var ae=B.read_shift(ee-21,"cstr");return[W,ae]}}function oe(B,ee){for(var q={},W=B.l+ee;B.l<W;){var ae=B.read_shift(2);if(ae==14e3){for(q[ae]=[0,""],q[ae][0]=B.read_shift(2);B[B.l];)q[ae][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return q}function K(B,ee){var q=ar(5+B.length);q.write_shift(2,14e3),q.write_shift(2,ee);for(var W=0;W<B.length;++W){var ae=B.charCodeAt(W);q[q.l++]=ae>127?95:ae}return q[q.l++]=0,q}var de={0:{n:"BOF",f:er},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:fe},222:{n:"SHEETNAMELP",f:Ae},65535:{n:""}},Te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:b},40:{n:"FORMULA28",f:ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:fe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_e},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function G5(t){var e={},r=t.match(Gr),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=Ue(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=Pv[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var K5=function(){var t=nu("t"),e=nu("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:_t(a[1])},l=i.match(e);return l&&(o.s=G5(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),q5=function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),X5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Y5=/<(?:\w+:)?r>/,Q5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function qv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=_t(Pt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Pt(t),r&&(n.h=jv(n.t))):t.match(Y5)&&(n.r=Pt(t),n.t=_t(Pt((t.replace(Q5,"").match(X5)||[]).join("").replace(Gr,""))),r&&(n.h=q5(K5(n.r)))),n):{t:""}}var J5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Z5=/<(?:\w+:)?(?:si|sstItem)>/g,e9=/<\/(?:\w+:)?(?:si|sstItem)>/;function t9(t,e){var r=[],n="";if(!t)return r;var s=t.match(J5);if(s){n=s[2].replace(Z5,"").split(e9);for(var i=0;i!=n.length;++i){var a=qv(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=Ue(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function r9(t){return[t.read_shift(4),t.read_shift(4)]}function n9(t,e){var r=[],n=!1;return pi(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function VA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Zs(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function s9(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Zs(t,4),e.U=Zs(t,4),e.W=Zs(t,4),e}function i9(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function a9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(i9(t));return e}function o9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function l9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Zs(t,4),e.U=Zs(t,4),e.W=Zs(t,4),e}function c9(t){var e=l9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function UA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function BA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function u9(t){var e=Zs(t);switch(e.Minor){case 2:return[e.Minor,f9(t)];case 3:return[e.Minor,h9()];case 4:return[e.Minor,d9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function f9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=UA(t,r),s=BA(t,t.length-t.l);return{t:"Std",h:n,v:s}}function h9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function d9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Gr,function(i){var a=Ue(i);switch(Ps(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function p9(t,e){var r={},n=r.EncryptionVersionInfo=Zs(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=UA(t,s),e-=s,r.EncryptionVerifier=BA(t,e),r}function m9(t){var e={},r=e.EncryptionVersionInfo=Zs(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function g9(t){var e=0,r,n=VA(t),s=n.length+1,i,a,o,l,c;for(r=ea(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var zA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=VA(a),l=i(o),c=o.length,u=ea(16),h=0;h!=16;++h)u[h]=0;var p,m,x;for((c&1)===1&&(p=l>>8,u[c]=s(t[0],p),--c,p=l&255,m=o[o.length-1],u[c]=s(m,p));c>0;)--c,p=l>>8,u[c]=s(o[c],p),--c,p=l&255,u[c]=s(o[c],p);for(c=15,x=15-o.length;x>0;)p=l>>8,u[c]=s(t[x],p),--c,--x,p=l&255,u[c]=s(o[c],p),--c,--x;return u}}(),v9=function(t,e,r,n,s){s||(s=e),n||(n=zA(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},x9=function(t){var e=0,r=zA(t);return function(n){var s=v9("",n,e,r);return e=s[1],s[0]}};function _9(t,e,r,n){var s={key:er(t),verificationBytes:er(t)};return r.password&&(s.verifier=g9(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=x9(r.password)),s}function y9(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=m9(t):n.Data=p9(t,e),n}function w9(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?y9(t,e-2,n):_9(t,r.biff>=8?e:e-2,r,n),n}var E9=function(){function t(s,i){switch(i.type){case"base64":return e(Tn(s),i);case"binary":return e(s,i);case"buffer":return e(lt&&Buffer.isBuffer(s)?s.toString("binary"):eo(s),i);case"array":return e($a(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,m=0,x,v=-1;x=p.exec(u);){switch(x[0]){case"\\cell":var y=u.slice(m,p.lastIndex-x[0].length);if(y[0]==" "&&(y=y.slice(1)),++v,y.length){var T={v:y,t:"s"};Array.isArray(o)?o[h][v]=T:o[Ge({r:h,c:v})]=T}break}m=p.lastIndex}v>c.e.c&&(c.e.c=v)}),o["!ref"]=pt(c),o}function r(s,i){return oa(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=Gt(s["!ref"]),o,l=Array.isArray(s),c=a.s.r;c<=a.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var h=Ge({r:c,c:u});o=l?(s[c]||[])[u]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(ui(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function T9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function au(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function k9(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,l=0,c=s+i;switch(l=a/(c>1?2-c:c),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function S9(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,a[0]+=s,a[1]+=l;break;case 1:l=s*(2-o),a[0]+=l,a[1]+=s;break;case 2:l=s*(o-2),a[1]+=s,a[2]+=l;break;case 3:l=s*(4-o),a[1]+=l,a[2]+=s;break;case 4:l=s*(o-4),a[2]+=s,a[0]+=l;break;case 5:l=s*(6-o),a[2]+=l,a[0]+=s;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function Yh(t,e){if(e===0)return t;var r=k9(T9(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),au(S9(r))}var $A=6,A9=15,I9=1,Xr=$A;function Qh(t){return Math.floor((t+Math.round(128/Xr)/256)*Xr)}function Jh(t){return Math.floor((t-5)/Xr*100+.5)/100}function Cm(t){return Math.round((t*Xr+5)/Xr*256)/256}function q0(t){return Cm(Jh(Qh(t)))}function Xv(t){var e=Math.abs(t-q0(t)),r=Xr;if(e>.005)for(Xr=I9;Xr<A9;++Xr)Math.abs(t-q0(t))<=e&&(e=Math.abs(t-q0(t)),r=Xr);Xr=r}function ul(t){t.width?(t.wpx=Qh(t.width),t.wch=Jh(t.wpx),t.MDW=Xr):t.wpx?(t.wch=Jh(t.wpx),t.width=Cm(t.wch),t.MDW=Xr):typeof t.wch=="number"&&(t.width=Cm(t.wch),t.wpx=Qh(t.width),t.MDW=Xr),t.customWidth&&delete t.customWidth}var C9=96,HA=C9;function WA(t){return t*96/HA}function ou(t){return t*HA/96}var R9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function N9(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(Gr)||[]).forEach(function(a){var o=Ue(a);switch(Ps(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Lt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Lt(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function P9(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(Gr)||[]).forEach(function(a){var o=Ue(a);switch(Ps(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function D9(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(Gr)||[]).forEach(function(a){var o=Ue(a);switch(Ps(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Pt(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Lt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Lt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Lt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Lt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Lt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Lt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Lt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Pv[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Lt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Na[s.color.index];s.color.index==81&&(l=Na[1]),l||(l=Na[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Yh(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function F9(t,e,r){e.NumberFmt=[];for(var n=Is(Xe),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Xe[n[s]];var i=t[0].match(Gr);if(i)for(s=0;s<i.length;++s){var a=Ue(i[s]);switch(Ps(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=_t(Pt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Ra(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Sf=["numFmtId","fillId","fontId","borderId","xfId"],Af=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function b9(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Gr)||[]).forEach(function(i){var a=Ue(i),o=0;switch(Ps(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Sf.length;++o)n[Sf[o]]&&(n[Sf[o]]=parseInt(n[Sf[o]],10));for(o=0;o<Af.length;++o)n[Af[o]]&&(n[Af[o]]=Lt(n[Af[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Lt(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var O9=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&F9(h,u,c),(h=o.match(s))&&D9(h,u,l,c),(h=o.match(n))&&P9(h,u,l,c),(h=o.match(i))&&N9(h,u,l,c),(h=o.match(r))&&b9(h,u,c),u}}();function M9(t,e){var r=t.read_shift(2),n=zr(t);return[r,n]}function L9(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=KL(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=GL(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=zr(t),n}var j9=Wr;function V9(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var U9=Wr;function B9(t,e,r){var n={};n.NumberFmt=[];for(var s in Xe)n.NumberFmt[s]=Xe[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return pi(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Ra(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Yh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(u),a=!0;break;case 38:i.pop(),a=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var z9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $9(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Gr)||[]).forEach(function(s){var i=Ue(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[z9.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function H9(){}function W9(){}var G9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,K9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,q9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function X9(t,e,r){e.themeElements={};var n;[["clrScheme",G9,$9],["fontScheme",K9,H9],["fmtScheme",q9,W9]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var Y9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function GA(t,e){(!t||t.length===0)&&(t=Q9());var r,n={};if(!(r=t.match(Y9)))throw new Error("themeElements not found in theme");return X9(r[0],n,e),n.raw=t,n}function Q9(t,e){var r=[nA];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function J9(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=rA(i,{type:"array"})}catch{return}var o=xn(a,"theme/theme/theme1.xml",!0);if(o)return GA(o,r)}}function Z9(t){return t.read_shift(4)}function ej(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=tj(t,4);break;case 2:e.xclrValue=DA(t);break;case 3:e.xclrValue=Z9(t);break;case 4:t.l+=4;break}return t.l+=8,e}function tj(t,e){return Wr(t,e)}function rj(t,e){return Wr(t,e)}function nj(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=ej(t);break;case 6:n[1]=rj(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function sj(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(nj(t,r-t.l));return{ixfe:n,ext:i}}function ij(t,e){e.forEach(function(r){switch(r[0]){}})}function aj(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:zr(t)}}function oj(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function lj(t){return t.l+=4,t.read_shift(4)!=0}function cj(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return pi(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!c.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function uj(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace(Gr,function(o){var l=Ue(o);switch(Ps(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function fj(t){var e=[];if(!t)return e;var r=1;return(t.match(Gr)||[]).forEach(function(n){var s=Ue(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function hj(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Ge(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function dj(t,e,r){var n=[];return pi(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function pj(t,e,r,n){if(!t)return t;var s=n||{},i=!1;pi(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function mj(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function gw(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=Yr(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var l=Gt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=pt(l);c!==t["!ref"]&&(t["!ref"]=c)}i.c||(i.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}i.c.push(u)})}function gj(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ue(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Yr(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!h&&!!h[1]&&qv(h[1])||{r:"",t:"",h:""};c.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),c.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=p.h),n.push(c)}}}}),n}function vj(t,e){var r=[],n=!1,s={},i=0;return t.replace(Gr,function(o,l){var c=Ue(o);switch(Ps(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":s.t=t.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function xj(t,e){var r=[],n=!1;return t.replace(Gr,function(i){var a=Ue(i);switch(Ps(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function _j(t){var e={};e.iauthor=t.read_shift(4);var r=ro(t);return e.rfx=r.s,e.ref=Ge(r.s),t.l+=16,e}var yj=zr;function wj(t,e){var r=[],n=[],s={},i=!1;return pi(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var Ej="application/vnd.ms-office.vbaProject";function Tj(t){var e=dt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");dt.utils.cfb_add(e,s,t.FileIndex[n].content)}}),dt.write(e)}function kj(){return{"!type":"dialog"}}function Sj(){return{"!type":"dialog"}}function Aj(){return{"!type":"macro"}}function Ij(){return{"!type":"macro"}}var Ho=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,s+(o?"":"$")+cr(u)+(l?"":"$")+Ir(c)}return function(s,i){return e=i,s.replace(t,r)}}(),KA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Cj=function(){return function(e,r){return e.replace(KA,function(n,s,i,a,o,l){var c=zv(a)-(i?0:r.c),u=Bv(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",p=c==0?"":i?c+1:"["+c+"]";return s+"R"+h+"C"+p})}}();function qA(t,e){return t.replace(KA,function(r,n,s,i,a,o){return n+(s=="$"?s+i:cr(zv(i)+e.c))+(a=="$"?a+o:Ir(Bv(o)+e.r))})}function Rj(t,e,r){var n=wl(e),s=n.s,i=Yr(r),a={r:i.r-s.r,c:i.c-s.c};return qA(t,a)}function Nj(t){return t.length!=1}function vw(t){return t.replace(/_xlfn\./g,"")}function Qt(t){t.l+=1}function ta(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function XA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return YA(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=ta(t),o=ta(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function YA(t){var e=ta(t),r=ta(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Pj(t,e,r){if(r.biff<8)return YA(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=ta(t),a=ta(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function QA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Dj(t);var n=t.read_shift(r&&r.biff==12?4:2),s=ta(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Dj(t){var e=ta(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Fj(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function bj(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Oj(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function Oj(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function Mj(t,e,r){var n=(t[t.l++]&96)>>5,s=XA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Lj(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=XA(t,i,r);return[n,s,a]}function jj(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Vj(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function Uj(t,e,r){var n=(t[t.l++]&96)>>5,s=Pj(t,e-1,r);return[n,s]}function Bj(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function xw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function zj(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function $j(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Hj(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Wj(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Gj(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function JA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Kj(t){return t.read_shift(2),JA(t)}function qj(t){return t.read_shift(2),JA(t)}function Xj(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=QA(t,0,r);return[n,s]}function Yj(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=bj(t,0,r);return[n,s]}function Qj(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=QA(t,0,r);return[n,s,i]}function Jj(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[ZV[s],tI[s],n]}function Zj(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:eV(t);return[s,(i[0]===0?tI:JV)[i[1]]]}function eV(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function tV(t,e,r){t.l+=r&&r.biff==2?3:4}function rV(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function nV(t){return t.l++,no[t.read_shift(1)]}function sV(t){return t.l++,t.read_shift(2)}function iV(t){return t.l++,t.read_shift(1)!==0}function aV(t){return t.l++,Ur(t)}function oV(t,e,r){return t.l++,Pu(t,e-1,r)}function lV(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Kt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=no[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ur(t);break;case 2:r[1]=so(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function cV(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?ro:Wd)(t));return s}function uV(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=lV(t,r.biff);return a}function fV(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function hV(t,e,r){if(r.biff==5)return dV(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function dV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function pV(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function mV(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function gV(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function vV(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var xV=Wr,_V=Wr,yV=Wr;function Fu(t,e,r){return t.l+=2,[Fj(t)]}function Yv(t){return t.l+=6,[]}var wV=Fu,EV=Yv,TV=Yv,kV=Fu;function ZA(t){return t.l+=2,[er(t),t.read_shift(2)&1]}var SV=Fu,AV=ZA,IV=Yv,CV=Fu,RV=Fu,NV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function PV(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=NV[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function DV(t){return t.l+=2,[t.read_shift(4)]}function FV(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function bV(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function OV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function MV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function LV(t){return t.l+=4,[0,0]}var _w={1:{n:"PtgExp",f:rV},2:{n:"PtgTbl",f:yV},3:{n:"PtgAdd",f:Qt},4:{n:"PtgSub",f:Qt},5:{n:"PtgMul",f:Qt},6:{n:"PtgDiv",f:Qt},7:{n:"PtgPower",f:Qt},8:{n:"PtgConcat",f:Qt},9:{n:"PtgLt",f:Qt},10:{n:"PtgLe",f:Qt},11:{n:"PtgEq",f:Qt},12:{n:"PtgGe",f:Qt},13:{n:"PtgGt",f:Qt},14:{n:"PtgNe",f:Qt},15:{n:"PtgIsect",f:Qt},16:{n:"PtgUnion",f:Qt},17:{n:"PtgRange",f:Qt},18:{n:"PtgUplus",f:Qt},19:{n:"PtgUminus",f:Qt},20:{n:"PtgPercent",f:Qt},21:{n:"PtgParen",f:Qt},22:{n:"PtgMissArg",f:Qt},23:{n:"PtgStr",f:oV},26:{n:"PtgSheet",f:FV},27:{n:"PtgEndSheet",f:bV},28:{n:"PtgErr",f:nV},29:{n:"PtgBool",f:iV},30:{n:"PtgInt",f:sV},31:{n:"PtgNum",f:aV},32:{n:"PtgArray",f:Bj},33:{n:"PtgFunc",f:Jj},34:{n:"PtgFuncVar",f:Zj},35:{n:"PtgName",f:fV},36:{n:"PtgRef",f:Xj},37:{n:"PtgArea",f:Mj},38:{n:"PtgMemArea",f:pV},39:{n:"PtgMemErr",f:xV},40:{n:"PtgMemNoMem",f:_V},41:{n:"PtgMemFunc",f:mV},42:{n:"PtgRefErr",f:gV},43:{n:"PtgAreaErr",f:jj},44:{n:"PtgRefN",f:Yj},45:{n:"PtgAreaN",f:Uj},46:{n:"PtgMemAreaN",f:OV},47:{n:"PtgMemNoMemN",f:MV},57:{n:"PtgNameX",f:hV},58:{n:"PtgRef3d",f:Qj},59:{n:"PtgArea3d",f:Lj},60:{n:"PtgRefErr3d",f:vV},61:{n:"PtgAreaErr3d",f:Vj},255:{}},jV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},VV={1:{n:"PtgElfLel",f:ZA},2:{n:"PtgElfRw",f:CV},3:{n:"PtgElfCol",f:wV},6:{n:"PtgElfRwV",f:RV},7:{n:"PtgElfColV",f:kV},10:{n:"PtgElfRadical",f:SV},11:{n:"PtgElfRadicalS",f:IV},13:{n:"PtgElfColS",f:EV},15:{n:"PtgElfColSV",f:TV},16:{n:"PtgElfRadicalLel",f:AV},25:{n:"PtgList",f:PV},29:{n:"PtgSxName",f:DV},255:{}},UV={0:{n:"PtgAttrNoop",f:LV},1:{n:"PtgAttrSemi",f:Gj},2:{n:"PtgAttrIf",f:Hj},4:{n:"PtgAttrChoose",f:zj},8:{n:"PtgAttrGoto",f:$j},16:{n:"PtgAttrSum",f:tV},32:{n:"PtgAttrBaxcel",f:xw},33:{n:"PtgAttrBaxcel",f:xw},64:{n:"PtgAttrSpace",f:Kj},65:{n:"PtgAttrSpaceSemi",f:qj},128:{n:"PtgAttrIfError",f:Wj},255:{}};function bu(t,e,r,n){if(n.biff<8)return Wr(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=uV(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=cV(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(Wr(t,e)),i}function Ou(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=_w[i]||_w[jV[i]],(i===24||i===25)&&(s=(i===24?VV:UV)[t[t.l+1]]),!s||!s.f?Wr(t,e):a.push([s.n,s.f(t,e,r)]);return a}function BV(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var zV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $V(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function eI(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function yw(t,e,r){var n=eI(t,e,r);return n=="#REF"?n:$V(n,r)}function Lr(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,h=0,p=0,m,x="";if(!t[0]||!t[0][0])return"";for(var v=-1,y="",T=0,k=t[0].length;T<k;++T){var w=t[0][T];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),v>=0){switch(t[0][v][1][0]){case 0:y=Wt(" ",t[0][v][1][1]);break;case 1:y=Wt("\r",t[0][v][1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}c=c+y,v=-1}o.push(c+zV[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=_c(w[1][1],a,s),o.push(yc(u,i));break;case"PtgRefN":u=r?_c(w[1][1],r,s):w[1][1],o.push(yc(u,i));break;case"PtgRef3d":h=w[1][1],u=_c(w[1][2],a,s),x=yw(n,h,s),o.push(x+"!"+yc(u,i));break;case"PtgFunc":case"PtgFuncVar":var D=w[1][0],U=w[1][1];D||(D=0),D&=127;var V=D==0?[]:o.slice(-D);o.length-=D,U==="User"&&(U=V.shift()),o.push(U+"("+V.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":m=ew(w[1][1],r?{s:r}:a,s),o.push(G0(m,s));break;case"PtgArea":m=ew(w[1][1],a,s),o.push(G0(m,s));break;case"PtgArea3d":h=w[1][1],m=w[1][2],x=yw(n,h,s),o.push(x+"!"+G0(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=w[1][2];var g=(n.names||[])[p-1]||(n[0]||[])[p],E=g?g.Name:"SH33TJSNAME"+String(p);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var S=w[1][1];p=w[1][2];var C;if(s.biff<=5)S<0&&(S=-S),n[S]&&(C=n[S][p]);else{var P="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][p]&&n[S][p].itab>0&&(P=n.SheetNames[n[S][p].itab-1]+"!"):P=n.SheetNames[p-1]+"!"),n[S]&&n[S][p])P+=n[S][p].Name;else if(n[0]&&n[0][p])P+=n[0][p].Name;else{var R=(eI(n,S,s)||"").split(";;");R[p-1]?P=R[p-1]:P+="SH33TJSERRX"}o.push(P);break}C||(C={Name:"SH33TJSERRY"}),o.push(C.Name);break;case"PtgParen":var b="(",ce=")";if(v>=0){switch(y="",t[0][v][1][0]){case 2:b=Wt(" ",t[0][v][1][1])+b;break;case 3:b=Wt("\r",t[0][v][1][1])+b;break;case 4:ce=Wt(" ",t[0][v][1][1])+ce;break;case 5:ce=Wt("\r",t[0][v][1][1])+ce;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}v=-1}o.push(b+o.pop()+ce);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var fe={c:r.c,r:r.r};if(n.sharedf[Ge(u)]){var Ae=n.sharedf[Ge(u)];o.push(Lr(Ae,a,fe,n,s))}else{var _e=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Lr(c[1],a,fe,n,s)),_e=!0;break}_e||o.push(w[1])}break;case"PtgArray":o.push("{"+BV(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&oe.indexOf(t[0][T][0])==-1){w=t[0][v];var K=!0;switch(w[1][0]){case 4:K=!1;case 0:y=Wt(" ",w[1][1]);break;case 5:K=!1;case 1:y=Wt("\r",w[1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((K?y:"")+o.pop()+(K?"":y)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function HV(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Wr(t,e-2)];var o=Ou(t,a,r);return e!==a+s&&(i=bu(t,e-a-s,o,r)),t.l=n,[o,i]}function WV(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Wr(t,e-2)];var o=Ou(t,a,r);return e!==a+s&&(i=bu(t,e-a-s,o,r)),t.l=n,[o,i]}function GV(t,e,r,n){var s=t.l+e,i=Ou(t,n,r),a;return s!==t.l&&(a=bu(t,s-t.l,i,r)),[i,a]}function KV(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=Ou(t,i,r);return i==65535?[[],Wr(t,e-2)]:(e!==i+2&&(s=bu(t,n-i-2,a,r)),[a,s])}function qV(t){var e;if(qs(t,t.l+6)!==65535)return[Ur(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function X0(t,e,r){var n=t.l+e,s=Ds(t);r.biff==2&&++t.l;var i=qV(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=WV(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function Gd(t,e,r){var n=t.read_shift(4),s=Ou(t,n,r),i=t.read_shift(4),a=i>0?bu(t,i,s,r):null;return[s,a]}var XV=Gd,Kd=Gd,YV=Gd,QV=Gd,JV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},tI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ZV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ww(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Y0(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var kc={},Wo={};function Sc(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function rI(t,e,r,n,s,i){try{n.cellNF&&(t.z=Xe[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=gr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Xe[e]==null&&Ra(eL[e]||"General",e),t.t==="e")t.w=t.w||no[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ru(t.v);else if(t.t==="d"){var a=en(t.v);(a|0)===a?t.w=a.toString(10):t.w=ru(a)}else{if(t.v===void 0)return"";t.w=za(t.v,Wo)}else t.t==="d"?t.w=Un(e,en(t.v),Wo):t.w=Un(e,t.v,Wo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Yh(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Yh(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function eU(t,e){var r=Gt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=pt(r))}var tU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,rU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,nU=/<(?:\w:)?hyperlink [^>]*>/mg,sU=/"(\w*:\w*)"/,iU=/<(?:\w:)?col\b[^>]*[\/]?>/g,aU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,oU=/<(?:\w:)?pageMargins[^>]*\/>/g,nI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,lU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,cU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function uU(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=t.match(rU);h?(c=t.slice(0,h.index),u=t.slice(h.index+h[0].length)):c=u=t;var p=c.match(nI);p?Qv(p[0],o,s,r):(p=c.match(lU))&&fU(p[0],p[1]||"",o,s,r);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=c.slice(m,m+50).match(sU);x&&eU(o,x[1])}var v=c.match(cU);v&&v[1]&&vU(v[1],s);var y=[];if(e.cellStyles){var T=c.match(iU);T&&pU(y,T)}h&&xU(h[1],o,e,l,i,a);var k=u.match(aU);k&&(o["!autofilter"]=mU(k[0]));var w=[],D=u.match(tU);if(D)for(m=0;m!=D.length;++m)w[m]=Gt(D[m].slice(D[m].indexOf('"')+1));var U=u.match(nU);U&&hU(o,U,n);var V=u.match(oU);if(V&&(o["!margins"]=dU(Ue(V[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=pt(l)),e.sheetRows>0&&o["!ref"]){var g=Gt(o["!ref"]);e.sheetRows<=+g.e.r&&(g.e.r=e.sheetRows-1,g.e.r>l.e.r&&(g.e.r=l.e.r),g.e.r<g.s.r&&(g.s.r=g.e.r),g.e.c>l.e.c&&(g.e.c=l.e.c),g.e.c<g.s.c&&(g.s.c=g.e.c),o["!fullref"]=o["!ref"],o["!ref"]=pt(g))}return y.length>0&&(o["!cols"]=y),w.length>0&&(o["!merges"]=w),o}function Qv(t,e,r,n){var s=Ue(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=_t(Pt(s.codeName)))}function fU(t,e,r,n,s){Qv(t.slice(0,t.indexOf(">")),r,n,s)}function hU(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=Ue(Pt(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+_t(i.location))):(i.Target="#"+_t(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Gt(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Ge({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=i):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=i)}}}function dU(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function pU(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Ue(e[n],!0);s.hidden&&(s.hidden=Lt(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Xv(s.width)),ul(s);i<=a;)t[i++]=Ar(s)}}function mU(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var gU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function vU(t,e){e.Views||(e.Views=[{}]),(t.match(gU)||[]).forEach(function(r,n){var s=Ue(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Lt(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var xU=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=nu("v"),a=nu("f");return function(l,c,u,h,p,m){for(var x=0,v="",y=[],T=[],k=0,w=0,D=0,U="",V,g,E=0,S=0,C,P,R=0,b=0,ce=Array.isArray(m.CellXf),fe,Ae=[],_e=[],oe=Array.isArray(c),K=[],de={},Te=!1,B=!!u.sheetStubs,ee=l.split(e),q=0,W=ee.length;q!=W;++q){v=ee[q].trim();var ae=v.length;if(ae!==0){var ve=0;e:for(x=0;x<ae;++x)switch(v[x]){case">":if(v[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(g=Ue(v.slice(ve,x),!0),E=g.r!=null?parseInt(g.r,10):E+1,S=-1,u.sheetRows&&u.sheetRows<E)continue;de={},Te=!1,g.ht&&(Te=!0,de.hpt=parseFloat(g.ht),de.hpx=ou(de.hpt)),g.hidden=="1"&&(Te=!0,de.hidden=!0),g.outlineLevel!=null&&(Te=!0,de.level=+g.outlineLevel),Te&&(K[E-1]=de)}break;case"<":ve=x;break}if(ve>=x)break;if(g=Ue(v.slice(ve,x),!0),E=g.r!=null?parseInt(g.r,10):E+1,S=-1,!(u.sheetRows&&u.sheetRows<E)){h.s.r>E-1&&(h.s.r=E-1),h.e.r<E-1&&(h.e.r=E-1),u&&u.cellStyles&&(de={},Te=!1,g.ht&&(Te=!0,de.hpt=parseFloat(g.ht),de.hpx=ou(de.hpt)),g.hidden=="1"&&(Te=!0,de.hidden=!0),g.outlineLevel!=null&&(Te=!0,de.level=+g.outlineLevel),Te&&(K[E-1]=de)),y=v.slice(x).split(t);for(var Ce=0;Ce!=y.length&&y[Ce].trim().charAt(0)=="<";++Ce);for(y=y.slice(Ce),x=0;x!=y.length;++x)if(v=y[x].trim(),v.length!==0){if(T=v.match(r),k=x,w=0,D=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,T!=null&&T.length===2){for(k=0,U=T[1],w=0;w!=U.length&&!((D=U.charCodeAt(w)-64)<1||D>26);++w)k=26*k+D;--k,S=k}else++S;for(w=0;w!=v.length&&v.charCodeAt(w)!==62;++w);if(++w,g=Ue(v.slice(0,w),!0),g.r||(g.r=Ge({r:E-1,c:S})),U=v.slice(w),V={t:""},(T=U.match(i))!=null&&T[1]!==""&&(V.v=_t(T[1])),u.cellFormula){if((T=U.match(a))!=null&&T[1]!==""){if(V.f=_t(Pt(T[1])).replace(/\r\n/g,`
`),u.xlfn||(V.f=vw(V.f)),T[0].indexOf('t="array"')>-1)V.F=(U.match(s)||[])[1],V.F.indexOf(":")>-1&&Ae.push([Gt(V.F),V.F]);else if(T[0].indexOf('t="shared"')>-1){P=Ue(T[0]);var Ee=_t(Pt(T[1]));u.xlfn||(Ee=vw(Ee)),_e[parseInt(P.si,10)]=[P,Ee,g.r]}}else(T=U.match(/<f[^>]*\/>/))&&(P=Ue(T[0]),_e[P.si]&&(V.f=Rj(_e[P.si][1],_e[P.si][2],g.r)));var pe=Yr(g.r);for(w=0;w<Ae.length;++w)pe.r>=Ae[w][0].s.r&&pe.r<=Ae[w][0].e.r&&pe.c>=Ae[w][0].s.c&&pe.c<=Ae[w][0].e.c&&(V.F=Ae[w][1])}if(g.t==null&&V.v===void 0)if(V.f||V.F)V.v=0,V.t="n";else if(B)V.t="z";else continue;else V.t=g.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),V.t){case"n":if(V.v==""||V.v==null){if(!B)continue;V.t="z"}else V.v=parseFloat(V.v);break;case"s":if(typeof V.v>"u"){if(!B)continue;V.t="z"}else C=kc[parseInt(V.v,10)],V.v=C.t,V.r=C.r,u.cellHTML&&(V.h=C.h);break;case"str":V.t="s",V.v=V.v!=null?Pt(V.v):"",u.cellHTML&&(V.h=jv(V.v));break;case"inlineStr":T=U.match(n),V.t="s",T!=null&&(C=qv(T[1]))?(V.v=C.t,u.cellHTML&&(V.h=C.h)):V.v="";break;case"b":V.v=Lt(V.v);break;case"d":u.cellDates?V.v=gr(V.v,1):(V.v=en(gr(V.v,1)),V.t="n");break;case"e":(!u||u.cellText!==!1)&&(V.w=V.v),V.v=kA[V.v];break}if(R=b=0,fe=null,ce&&g.s!==void 0&&(fe=m.CellXf[g.s],fe!=null&&(fe.numFmtId!=null&&(R=fe.numFmtId),u.cellStyles&&fe.fillId!=null&&(b=fe.fillId))),rI(V,R,b,u,p,m),u.cellDates&&ce&&V.t=="n"&&yl(Xe[R])&&(V.t="d",V.v=Hd(V.v)),g.cm&&u.xlmeta){var He=(u.xlmeta.Cell||[])[+g.cm-1];He&&He.type=="XLDAPR"&&(V.D=!0)}if(oe){var z=Yr(g.r);c[z.r]||(c[z.r]=[]),c[z.r][z.c]=V}else c[g.r]=V}}}}K.length>0&&(c["!rows"]=K)}}();function _U(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}var yU=ro;function wU(){}function EU(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=HL(t),r}function TU(t){var e=Bn(t);return[e]}function kU(t){var e=to(t);return[e]}function SU(t){var e=Bn(t),r=t.read_shift(1);return[e,r,"b"]}function AU(t){var e=to(t),r=t.read_shift(1);return[e,r,"b"]}function IU(t){var e=Bn(t),r=t.read_shift(1);return[e,r,"e"]}function CU(t){var e=to(t),r=t.read_shift(1);return[e,r,"e"]}function RU(t){var e=Bn(t),r=t.read_shift(4);return[e,r,"s"]}function NU(t){var e=to(t),r=t.read_shift(4);return[e,r,"s"]}function PU(t){var e=Bn(t),r=Ur(t);return[e,r,"n"]}function sI(t){var e=to(t),r=Ur(t);return[e,r,"n"]}function DU(t){var e=Bn(t),r=Wv(t);return[e,r,"n"]}function FU(t){var e=to(t),r=Wv(t);return[e,r,"n"]}function bU(t){var e=Bn(t),r=$v(t);return[e,r,"is"]}function OU(t){var e=Bn(t),r=zr(t);return[e,r,"str"]}function MU(t){var e=to(t),r=zr(t);return[e,r,"str"]}function LU(t,e,r){var n=t.l+e,s=Bn(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=Kd(t,n-t.l,r);a[3]=Lr(o,null,s,r.supbooks,r)}else t.l=n;return a}function jU(t,e,r){var n=t.l+e,s=Bn(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=Kd(t,n-t.l,r);a[3]=Lr(o,null,s,r.supbooks,r)}else t.l=n;return a}function VU(t,e,r){var n=t.l+e,s=Bn(t);s.r=r["!row"];var i=Ur(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=Kd(t,n-t.l,r);a[3]=Lr(o,null,s,r.supbooks,r)}else t.l=n;return a}function UU(t,e,r){var n=t.l+e,s=Bn(t);s.r=r["!row"];var i=zr(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=Kd(t,n-t.l,r);a[3]=Lr(o,null,s,r.supbooks,r)}else t.l=n;return a}var BU=ro;function zU(t,e){var r=t.l+e,n=ro(t),s=Hv(t),i=zr(t),a=zr(t),o=zr(t);t.l=r;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function $U(){}function HU(t,e,r){var n=t.l+e,s=wA(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=XV(t,n-t.l,r);a[1]=o}else t.l=n;return a}function WU(t,e,r){var n=t.l+e,s=ro(t),i=[s];if(r.cellFormula){var a=QV(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}var GU=["left","right","top","bottom","header","footer"];function KU(t){var e={};return GU.forEach(function(r){e[r]=Ur(t)}),e}function qU(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function XU(){}function YU(){}function QU(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,p=!1,m,x,v,y,T,k,w,D,U,V=[];o.biff=12,o["!row"]=0;var g=0,E=!1,S=[],C={},P=o.supbooks||s.supbooks||[[]];if(P.sharedf=C,P.arrayf=S,P.SheetNames=s.SheetNames||s.Sheets.map(function(oe){return oe.name}),!o.supbooks&&(o.supbooks=P,s.Names))for(var R=0;R<s.Names.length;++R)P[0][R+1]=s.Names[R];var b=[],ce=[],fe=!1;Zh[16]={n:"BrtShortReal",f:sI};var Ae;if(pi(t,function(K,de,Te){if(!p)switch(Te){case 148:c=K;break;case 0:m=K,o.sheetRows&&o.sheetRows<=m.r&&(p=!0),D=Ir(y=m.r),o["!row"]=m.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=ou(K.hpt)),ce[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:K[2]},K[2]){case"n":x.v=K[1];break;case"s":w=kc[K[1]],x.v=w.t,x.r=w.r;break;case"b":x.v=!!K[1];break;case"e":x.v=K[1],o.cellText!==!1&&(x.w=no[x.v]);break;case"str":x.t="s",x.v=K[1];break;case"is":x.t="s",x.v=K[1].t;break}if((v=a.CellXf[K[0].iStyleRef])&&rI(x,v.numFmtId,null,o,i,a),T=K[0].c==-1?T+1:K[0].c,o.dense?(l[y]||(l[y]=[]),l[y][T]=x):l[cr(T)+D]=x,o.cellFormula){for(E=!1,g=0;g<S.length;++g){var B=S[g];m.r>=B[0].s.r&&m.r<=B[0].e.r&&T>=B[0].s.c&&T<=B[0].e.c&&(x.F=pt(B[0]),E=!0)}!E&&K.length>3&&(x.f=K[3])}if(u.s.r>m.r&&(u.s.r=m.r),u.s.c>T&&(u.s.c=T),u.e.r<m.r&&(u.e.r=m.r),u.e.c<T&&(u.e.c=T),o.cellDates&&v&&x.t=="n"&&yl(Xe[v.numFmtId])){var ee=ka(x.v);ee&&(x.t="d",x.v=new Date(ee.y,ee.m-1,ee.d,ee.H,ee.M,ee.S,ee.u))}Ae&&(Ae.type=="XLDAPR"&&(x.D=!0),Ae=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},T=K[0].c==-1?T+1:K[0].c,o.dense?(l[y]||(l[y]=[]),l[y][T]=x):l[cr(T)+D]=x,u.s.r>m.r&&(u.s.r=m.r),u.s.c>T&&(u.s.c=T),u.e.r<m.r&&(u.e.r=m.r),u.e.c<T&&(u.e.c=T),Ae&&(Ae.type=="XLDAPR"&&(x.D=!0),Ae=void 0);break;case 176:V.push(K);break;case 49:Ae=((o.xlmeta||{}).Cell||[])[K-1];break;case 494:var q=n["!id"][K.relId];for(q?(K.Target=q.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=q):K.relId==""&&(K.Target="#"+K.loc),y=K.rfx.s.r;y<=K.rfx.e.r;++y)for(T=K.rfx.s.c;T<=K.rfx.e.c;++T)o.dense?(l[y]||(l[y]=[]),l[y][T]||(l[y][T]={t:"z",v:void 0}),l[y][T].l=K):(k=Ge({c:T,r:y}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=K);break;case 426:if(!o.cellFormula)break;S.push(K),U=o.dense?l[y][T]:l[cr(T)+D],U.f=Lr(K[1],u,{r:m.r,c:T},P,o),U.F=pt(K[0]);break;case 427:if(!o.cellFormula)break;C[Ge(K[0].s)]=K[1],U=o.dense?l[y][T]:l[cr(T)+D],U.f=Lr(K[1],u,{r:m.r,c:T},P,o);break;case 60:if(!o.cellStyles)break;for(;K.e>=K.s;)b[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},fe||(fe=!0,Xv(K.w/256)),ul(b[K.e+1]);break;case 161:l["!autofilter"]={ref:pt(K)};break;case 476:l["!margins"]=K;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),K.name&&(s.Sheets[r].CodeName=K.name),(K.above||K.left)&&(l["!outline"]={above:K.above,left:K.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),K.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!de.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Te.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=pt(c||u)),o.sheetRows&&l["!ref"]){var _e=Gt(l["!ref"]);o.sheetRows<=+_e.e.r&&(_e.e.r=o.sheetRows-1,_e.e.r>u.e.r&&(_e.e.r=u.e.r),_e.e.r<_e.s.r&&(_e.s.r=_e.e.r),_e.e.c>u.e.c&&(_e.e.c=u.e.c),_e.e.c<_e.s.c&&(_e.s.c=_e.e.c),l["!fullref"]=l["!ref"],l["!ref"]=pt(_e))}return V.length>0&&(l["!merges"]=V),b.length>0&&(l["!cols"]=b),ce.length>0&&(l["!rows"]=ce),l}function JU(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=_t((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function ZU(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var p=JU(h);u.s.r=u.s.c=0,u.e.c=o,c=cr(o),p[0].forEach(function(m,x){a[c+Ir(x)]={t:"n",v:m,z:p[1]},l=x}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=pt(u)),a}function eB(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(nI);return o&&Qv(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function tB(t,e){t.l+=10;var r=zr(t);return{name:r}}function rB(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return pi(t,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var iI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],nB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],sB=[],iB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ew(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Lt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Tw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Lt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function aI(t){Tw(t.WBProps,iI),Tw(t.CalcPr,iB),Ew(t.WBView,nB),Ew(t.Sheets,sB),Wo.date1904=Lt(t.WBProps.date1904)}var aB="][*?/\\".split("");function oB(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return aB.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var lB=/<\w+:workbook/;function cB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace(Gr,function(l,c){var u=Ue(l);switch(Ps(u[0])){case"<?xml":break;case"<workbook":l.match(lB)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":iI.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Lt(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=Pt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=_t(Pt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Pt(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Lt(u.hidden||"0")&&(i.Hidden=!0),a=c+l.length;break;case"</definedName>":i.Ref=_t(Pt(t.slice(a,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),IL.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return aI(r),r}function uB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Sm(t),r.name=zr(t),r}function fB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?zr(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function hB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function dB(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=WL(t),a=YV(t,0,r),o=Hv(t);t.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function pB(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],Zh[16]={n:"BrtFRTArchID$",f:hB},pi(t,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Lr(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),aI(r),r.Names=i,r.supbooks=a,r}function mB(t,e,r){return e.slice(-4)===".bin"?pB(t,r):cB(t,r)}function gB(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?QU(t,n,r,s,i,a,o):uU(t,n,r,s,i,a,o)}function vB(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?rB(t,n,r,s,i):eB(t,n,r,s,i)}function xB(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?Aj():Ij()}function _B(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?kj():Sj()}function yB(t,e,r,n){return e.slice(-4)===".bin"?B9(t,r,n):O9(t,r,n)}function wB(t,e,r){return GA(t,r)}function EB(t,e,r){return e.slice(-4)===".bin"?n9(t,r):t9(t,r)}function TB(t,e,r){return e.slice(-4)===".bin"?wj(t,r):gj(t,r)}function kB(t,e,r){return e.slice(-4)===".bin"?dj(t):fj(t)}function SB(t,e,r,n){return r.slice(-4)===".bin"?pj(t,e,r,n):void 0}function AB(t,e,r){return e.slice(-4)===".bin"?cj(t,e,r):uj(t,e,r)}var oI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,lI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Wn(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(oI),i,a,o,l;if(s)for(l=0;l!=s.length;++l)i=s[l].match(lI),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function IB(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(oI),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(lI),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var Ac;function CB(t,e){var r=Ac[t]||_t(t);return r==="General"?za(e):Un(r,e)}function RB(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Lt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=gr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[_t(e)]=s}function NB(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||no[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ru(t.v):t.w=za(t.v):t.w=CB(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=Ac[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&yl(n)){var s=ka(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function PB(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=R9[n.Pattern]||n.Pattern)}t[e.ID]=e}function DB(t,e,r,n,s,i,a,o,l,c){var u="General",h=n.StyleID,p={};c=c||{};var m=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);i[h]!==void 0&&(i[h].nf&&(u=i[h].nf),i[h].Interior&&m.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Lt(t);break;case"String":n.t="s",n.r=Wy(_t(t)),n.v=t.indexOf("<")>-1?_t(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(gr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=_t(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=kA[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Wy(e||t));break}if(NB(n,u,c),c.cellFormula!==!1)if(n.Formula){var v=_t(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Ho(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Ho("RC:RC",s):n.ArrayRange&&(n.F=Ho(n.ArrayRange,s),l.push([Gt(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(m.forEach(function(y){!p.patternType&&y.patternType&&(p.patternType=y.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function FB(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Q0(t,e){var r=e||{};YS();var n=Zl(Vv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Pt(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=Ar(r);return a.type="string",iu.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ke){s.indexOf("<"+ke)>=0&&(i=!0)}),i)return zB(n,r);Ac={"General Number":"General","General Date":Xe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Xe[15],"Short Date":Xe[14],"Long Time":Xe[19],"Medium Time":Xe[18],"Short Time":Xe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Xe[2],Standard:Xe[4],Percent:Xe[10],Scientific:Xe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],p=r.dense?[]:{},m="",x={},v={},y=Wn('<Data ss:Type="String">'),T=0,k=0,w=0,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},U={},V={},g="",E=0,S=[],C={},P={},R=0,b=[],ce=[],fe={},Ae=[],_e,oe=!1,K=[],de=[],Te={},B=0,ee=0,q={Sheets:[],WBProps:{date1904:!1}},W={};su.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";o=su.exec(n);)switch(o[3]=(ae=o[3]).toLowerCase()){case"data":if(ae=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?DB(n.slice(T,o.index),g,y,l[l.length-1][0]=="comment"?fe:x,{c:k,r:w},U,Ae[k],v,K,r):(g="",y=Wn(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ce.length>0&&(x.c=ce),(!r.sheetRows||r.sheetRows>w)&&x.v!==void 0&&(r.dense?(p[w]||(p[w]=[]),p[w][k]=x):p[cr(k)+Ir(w)]=x),x.HRef&&(x.l={Target:_t(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(B=k+(parseInt(x.MergeAcross,10)|0),ee=w+(parseInt(x.MergeDown,10)|0),S.push({s:{c:k,r:w},e:{c:B,r:ee}})),!r.sheetStubs)x.MergeAcross?k=B+1:++k;else if(x.MergeAcross||x.MergeDown){for(var ve=k;ve<=B;++ve)for(var Ce=w;Ce<=ee;++Ce)(ve>k||Ce>w)&&(r.dense?(p[Ce]||(p[Ce]=[]),p[Ce][ve]={t:"z"}):p[cr(ve)+Ir(Ce)]={t:"z"});k=B+1}else++k;else x=IB(o[0]),x.Index&&(k=+x.Index-1),k<D.s.c&&(D.s.c=k),k>D.e.c&&(D.e.c=k),o[0].slice(-2)==="/>"&&++k,ce=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<D.s.r&&(D.s.r=w),w>D.e.r&&(D.e.r=w),o[0].slice(-2)==="/>"&&(v=Wn(o[0]),v.Index&&(w=+v.Index-1)),k=0,++w):(v=Wn(o[0]),v.Index&&(w=+v.Index-1),Te={},(v.AutoFitHeight=="0"||v.Height)&&(Te.hpx=parseInt(v.Height,10),Te.hpt=WA(Te.hpx),de[w]=Te),v.Hidden=="1"&&(Te.hidden=!0,de[w]=Te));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(m),D.s.r<=D.e.r&&D.s.c<=D.e.c&&(p["!ref"]=pt(D),r.sheetRows&&r.sheetRows<=D.e.r&&(p["!fullref"]=p["!ref"],D.e.r=r.sheetRows-1,p["!ref"]=pt(D))),S.length&&(p["!merges"]=S),Ae.length>0&&(p["!cols"]=Ae),de.length>0&&(p["!rows"]=de),u[m]=p}else D={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=k=0,l.push([o[3],!1]),c=Wn(o[0]),m=_t(c.Name),p=r.dense?[]:{},S=[],K=[],de=[],W={name:m,Hidden:0},q.Sheets.push(W);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Ae=[],oe=!1}break;case"style":o[1]==="/"?PB(U,V,r):V=Wn(o[0]);break;case"numberformat":V.nf=_t(Wn(o[0]).Format||"General"),Ac[V.nf]&&(V.nf=Ac[V.nf]);for(var Ee=0;Ee!=392&&Xe[Ee]!=V.nf;++Ee);if(Ee==392){for(Ee=57;Ee!=392;++Ee)if(Xe[Ee]==null){Ra(V.nf,Ee);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(_e=Wn(o[0]),_e.Hidden&&(_e.hidden=!0,delete _e.Hidden),_e.Width&&(_e.wpx=parseInt(_e.Width,10)),!oe&&_e.wpx>10){oe=!0,Xr=$A;for(var pe=0;pe<Ae.length;++pe)Ae[pe]&&ul(Ae[pe])}oe&&ul(_e),Ae[_e.Index-1||Ae.length]=_e;for(var He=0;He<+_e.Span;++He)Ae[Ae.length]=Ar(_e);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var z=Ue(o[0]),ct={Name:z.Name,Ref:Ho(z.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(ct.Sheet=q.Sheets.length-1),q.Names.push(ct);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?g+=n.slice(E,o.index):E=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;V.Interior=Wn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?g8(C,ae,n.slice(R,o.index)):R=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));FB(fe),ce.push(fe)}else l.push([o[3],!1]),c=Wn(o[0]),fe={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ye=Wn(o[0]);p["!autofilter"]={ref:Ho(Ye.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Rw(n,r);var at=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:at=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:at=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:at=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:at=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(R,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else R=o.index+o[0].length;break;case"header":p["!margins"]||Sc(p["!margins"]={},"xlml"),isNaN(+Ue(o[0]).Margin)||(p["!margins"].header=+Ue(o[0]).Margin);break;case"footer":p["!margins"]||Sc(p["!margins"]={},"xlml"),isNaN(+Ue(o[0]).Margin)||(p["!margins"].footer=+Ue(o[0]).Margin);break;case"pagemargins":var Me=Ue(o[0]);p["!margins"]||Sc(p["!margins"]={},"xlml"),isNaN(+Me.Top)||(p["!margins"].top=+Me.Top),isNaN(+Me.Left)||(p["!margins"].left=+Me.Left),isNaN(+Me.Right)||(p["!margins"].right=+Me.Right),isNaN(+Me.Bottom)||(p["!margins"].bottom=+Me.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:at=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:at=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:at=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:at=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:at=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:at=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:at=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:at=!1}break;case"smarttags":break;default:at=!1;break}if(at||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?RB(P,ae,b,n.slice(R,o.index)):(b=o,R=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Y={};return!r.bookSheets&&!r.bookProps&&(Y.Sheets=u),Y.SheetNames=h,Y.Workbook=q,Y.SSF=Ar(Xe),Y.Props=C,Y.Custprops=P,Y}function Rm(t,e){switch(ex(e=e||{}),e.type||"base64"){case"base64":return Q0(Tn(t),e);case"binary":case"buffer":case"file":return Q0(t,e);case"array":return Q0(eo(t),e)}}function bB(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=qL(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=XL(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var OB=[60,1084,2066,2165,2175];function MB(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var l=qs(r,r.l),c=Nm[l],u=0;c!=null&&OB.indexOf(l)>-1;)i=qs(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),a.push(o),r.l+=4+i,c=Nm[l=qs(r,r.l)];var h=Ri(a);wr(h,0);var p=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(p),p+=a[m].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,s)}function ps(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Xe[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||no[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ru(t.v):t.w=za(t.v):t.w=Un(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&yl(Xe[n]||String(n))){var s=ka(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function If(t,e,r){return{v:t,ixfe:e,t:r}}function LB(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,l=[],c="",u={},h,p="",m,x,v,y,T={},k=[],w,D,U=[],V=[],g={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},S=function(Ve){return Ve<8?Na[Ve]:Ve<64&&V[Ve-8]||Na[Ve]},C=function(Ve,kt,Yt){var Et=kt.XF.data;if(!(!Et||!Et.patternType||!Yt||!Yt.cellStyles)){kt.s={},kt.s.patternType=Et.patternType;var dn;(dn=au(S(Et.icvFore)))&&(kt.s.fgColor={rgb:dn}),(dn=au(S(Et.icvBack)))&&(kt.s.bgColor={rgb:dn})}},P=function(Ve,kt,Yt){if(!(Te>1)&&!(Yt.sheetRows&&Ve.r>=Yt.sheetRows)){if(Yt.cellStyles&&kt.XF&&kt.XF.data&&C(Ve,kt,Yt),delete kt.ixfe,delete kt.XF,h=Ve,p=Ge(Ve),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ve.r<a.s.r&&(a.s.r=Ve.r),Ve.c<a.s.c&&(a.s.c=Ve.c),Ve.r+1>a.e.r&&(a.e.r=Ve.r+1),Ve.c+1>a.e.c&&(a.e.c=Ve.c+1),Yt.cellFormula&&kt.f){for(var Et=0;Et<k.length;++Et)if(!(k[Et][0].s.c>Ve.c||k[Et][0].s.r>Ve.r)&&!(k[Et][0].e.c<Ve.c||k[Et][0].e.r<Ve.r)){kt.F=pt(k[Et][0]),(k[Et][0].s.c!=Ve.c||k[Et][0].s.r!=Ve.r)&&delete kt.f,kt.f&&(kt.f=""+Lr(k[Et][1],a,Ve,K,R));break}}Yt.dense?(s[Ve.r]||(s[Ve.r]=[]),s[Ve.r][Ve.c]=kt):s[p]=kt}},R={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(R.password=e.password);var b,ce=[],fe=[],Ae=[],_e=[],oe=!1,K=[];K.SheetNames=R.snames,K.sharedf=R.sharedf,K.arrayf=R.arrayf,K.names=[],K.XTI=[];var de=0,Te=0,B=0,ee=[],q=[],W;R.codepage=1200,es(1200);for(var ae=!1;t.l<t.length-1;){var ve=t.l,Ce=t.read_shift(2);if(Ce===0&&de===10)break;var Ee=t.l===t.length?0:t.read_shift(2),pe=Nm[Ce];if(pe&&pe.f){if(e.bookSheets&&de===133&&Ce!==133)break;if(de=Ce,pe.r===2||pe.r==12){var He=t.read_shift(2);if(Ee-=2,!R.enc&&He!==Ce&&((He&255)<<8|He>>8)!==Ce)throw new Error("rt mismatch: "+He+"!="+Ce);pe.r==12&&(t.l+=10,Ee-=10)}var z={};if(Ce===10?z=pe.f(t,Ee,R):z=MB(Ce,pe,t,Ee,R),Te==0&&[9,521,1033,2057].indexOf(de)===-1)continue;switch(Ce){case 34:r.opts.Date1904=g.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(R.enc||(t.l=0),R.enc=z,!e.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:R.lastuser=z;break;case 66:var ct=Number(z);switch(ct){case 21010:ct=1200;break;case 32768:ct=1e4;break;case 32769:ct=1252;break}es(R.codepage=ct),ae=!0;break;case 317:R.rrtabid=z;break;case 25:R.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:R.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(s["!type"]="dialog"),z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:U.push(z);break;case 430:K.push([z]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(z);break;case 24:case 536:W={Name:z.Name,Ref:Lr(z.rgce,a,null,K,R)},z.itab>0&&(W.Sheet=z.itab-1),K.names.push(W),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(q[z.itab-1]={ref:pt(z.rgce[0][0][1][2])});break;case 22:R.ExternCount=z;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(z),K.XTI=K.XTI.concat(z);break;case 2196:if(R.biff<8)break;W!=null&&(W.Comment=z[1]);break;case 18:s["!protect"]=z;break;case 19:z!==0&&R.WTF&&console.error("Password verifier: "+z);break;case 133:i[z.pos]=z,R.snames.push(z.name);break;case 10:{if(--Te)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=pt(a),e.sheetRows&&e.sheetRows<=a.e.r){var Ye=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=pt(a),a.e.r=Ye}a.e.r++,a.e.c++}ce.length>0&&(s["!merges"]=ce),fe.length>0&&(s["!objects"]=fe),Ae.length>0&&(s["!cols"]=Ae),_e.length>0&&(s["!rows"]=_e),g.Sheets.push(E)}c===""?u=s:n[c]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(R.biff===8&&(R.biff={9:2,521:3,1033:4}[Ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),R.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(R.biff=5,ae=!0,es(R.codepage=28591)),R.biff==8&&z.BIFFVer==0&&z.dt==16&&(R.biff=2),Te++)break;if(s=e.dense?[]:{},R.biff<8&&!ae&&(ae=!0,es(R.codepage=e.codepage||1252)),R.biff<5||z.BIFFVer==0&&z.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var at={pos:t.l-Ee,name:c};i[at.pos]=at,R.snames.push(c)}else c=(i[ve]||{name:""}).name;z.dt==32&&(s["!type"]="chart"),z.dt==64&&(s["!type"]="macro"),ce=[],fe=[],R.arrayf=k=[],Ae=[],_e=[],oe=!1,E={Hidden:(i[ve]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[z.r]||[])[z.c]:s[Ge({c:z.c,r:z.r})])&&++z.c,w={ixfe:z.ixfe,XF:U[z.ixfe]||{},v:z.val,t:"n"},B>0&&(w.z=ee[w.ixfe>>8&63]),ps(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e);break;case 5:case 517:w={ixfe:z.ixfe,XF:U[z.ixfe],v:z.val,t:z.t},B>0&&(w.z=ee[w.ixfe>>8&63]),ps(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e);break;case 638:w={ixfe:z.ixfe,XF:U[z.ixfe],v:z.rknum,t:"n"},B>0&&(w.z=ee[w.ixfe>>8&63]),ps(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e);break;case 189:for(var Me=z.c;Me<=z.C;++Me){var Y=z.rkrec[Me-z.c][0];w={ixfe:Y,XF:U[Y],v:z.rkrec[Me-z.c][1],t:"n"},B>0&&(w.z=ee[w.ixfe>>8&63]),ps(w,e,r.opts.Date1904),P({c:Me,r:z.r},w,e)}break;case 6:case 518:case 1030:{if(z.val=="String"){o=z;break}if(w=If(z.val,z.cell.ixfe,z.tt),w.XF=U[w.ixfe],e.cellFormula){var ke=z.formula;if(ke&&ke[0]&&ke[0][0]&&ke[0][0][0]=="PtgExp"){var be=ke[0][0][1][0],je=ke[0][0][1][1],tt=Ge({r:be,c:je});T[tt]?w.f=""+Lr(z.formula,a,z.cell,K,R):w.F=((e.dense?(s[be]||[])[je]:s[tt])||{}).F}else w.f=""+Lr(z.formula,a,z.cell,K,R)}B>0&&(w.z=ee[w.ixfe>>8&63]),ps(w,e,r.opts.Date1904),P(z.cell,w,e),o=z}break;case 7:case 519:if(o)o.val=z,w=If(z,o.cell.ixfe,"s"),w.XF=U[w.ixfe],e.cellFormula&&(w.f=""+Lr(o.formula,a,o.cell,K,R)),B>0&&(w.z=ee[w.ixfe>>8&63]),ps(w,e,r.opts.Date1904),P(o.cell,w,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(z);var mt=Ge(z[0].s);if(m=e.dense?(s[z[0].s.r]||[])[z[0].s.c]:s[mt],e.cellFormula&&m){if(!o||!mt||!m)break;m.f=""+Lr(z[1],a,z[0],K,R),m.F=pt(z[0])}}break;case 1212:{if(!e.cellFormula)break;if(p){if(!o)break;T[Ge(o.cell)]=z[0],m=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Ge(o.cell)],(m||{}).f=""+Lr(z[0],a,h,K,R)}}break;case 253:w=If(l[z.isst].t,z.ixfe,"s"),l[z.isst].h&&(w.h=l[z.isst].h),w.XF=U[w.ixfe],B>0&&(w.z=ee[w.ixfe>>8&63]),ps(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e);break;case 513:e.sheetStubs&&(w={ixfe:z.ixfe,XF:U[z.ixfe],t:"z"},B>0&&(w.z=ee[w.ixfe>>8&63]),ps(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e));break;case 190:if(e.sheetStubs)for(var Je=z.c;Je<=z.C;++Je){var qe=z.ixfe[Je-z.c];w={ixfe:qe,XF:U[qe],t:"z"},B>0&&(w.z=ee[w.ixfe>>8&63]),ps(w,e,r.opts.Date1904),P({c:Je,r:z.r},w,e)}break;case 214:case 516:case 4:w=If(z.val,z.ixfe,"s"),w.XF=U[w.ixfe],B>0&&(w.z=ee[w.ixfe>>8&63]),ps(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e);break;case 0:case 512:Te===1&&(a=z);break;case 252:l=z;break;case 1054:if(R.biff==4){ee[B++]=z[1];for(var Qe=0;Qe<B+163&&Xe[Qe]!=z[1];++Qe);Qe>=163&&Ra(z[1],B+163)}else Ra(z[1],z[0]);break;case 30:{ee[B++]=z;for(var Fe=0;Fe<B+163&&Xe[Fe]!=z;++Fe);Fe>=163&&Ra(z,B+163)}break;case 229:ce=ce.concat(z);break;case 93:fe[z.cmo[0]]=R.lastobj=z;break;case 438:R.lastobj.TxO=z;break;case 127:R.lastobj.ImData=z;break;case 440:for(y=z[0].s.r;y<=z[0].e.r;++y)for(v=z[0].s.c;v<=z[0].e.c;++v)m=e.dense?(s[y]||[])[v]:s[Ge({c:v,r:y})],m&&(m.l=z[1]);break;case 2048:for(y=z[0].s.r;y<=z[0].e.r;++y)for(v=z[0].s.c;v<=z[0].e.c;++v)m=e.dense?(s[y]||[])[v]:s[Ge({c:v,r:y})],m&&m.l&&(m.l.Tooltip=z[1]);break;case 28:{if(R.biff<=5&&R.biff>=2)break;m=e.dense?(s[z[0].r]||[])[z[0].c]:s[Ge(z[0])];var ut=fe[z[2]];m||(e.dense?(s[z[0].r]||(s[z[0].r]=[]),m=s[z[0].r][z[0].c]={t:"z"}):m=s[Ge(z[0])]={t:"z"},a.e.r=Math.max(a.e.r,z[0].r),a.s.r=Math.min(a.s.r,z[0].r),a.e.c=Math.max(a.e.c,z[0].c),a.s.c=Math.min(a.s.c,z[0].c)),m.c||(m.c=[]),x={a:z[1],t:ut.TxO.t},m.c.push(x)}break;case 2173:ij(U[z.ixfe],z.ext);break;case 125:{if(!R.cellStyles)break;for(;z.e>=z.s;)Ae[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},oe||(oe=!0,Xv(z.w/256)),ul(Ae[z.e+1])}break;case 520:{var rt={};z.level!=null&&(_e[z.r]=rt,rt.level=z.level),z.hidden&&(_e[z.r]=rt,rt.hidden=!0),z.hpt&&(_e[z.r]=rt,rt.hpt=z.hpt,rt.hpx=ou(z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Sc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ce]]=z;break;case 161:s["!margins"]||Sc(s["!margins"]={}),s["!margins"].header=z.header,s["!margins"].footer=z.footer;break;case 574:z.RTL&&(g.Views[0].RTL=!0);break;case 146:V=z;break;case 2198:b=z;break;case 140:D=z;break;case 442:c?E.CodeName=z||E.name:g.WBProps.CodeName=z||"ThisWorkbook";break}}else pe||console.error("Missing Info for XLS Record 0x"+Ce.toString(16)),t.l+=Ee}return r.SheetNames=Is(i).sort(function(Be,Ve){return Number(Be)-Number(Ve)}).map(function(Be){return i[Be].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&q.forEach(function(Be,Ve){r.Sheets[r.SheetNames[Ve]]["!autofilter"]=Be}),r.Strings=l,r.SSF=Ar(Xe),R.enc&&(r.Encryption=R.enc),b&&(r.Themes=b),r.Metadata={},D!==void 0&&(r.Metadata.Country=D),K.names.length>0&&(g.Names=K.names),r.Workbook=g,r}var kw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function jB(t,e,r){var n=dt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=ow(n,t8,kw.DSI);for(var i in s)e[i]=s[i]}catch(c){if(r.WTF)throw c}var a=dt.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=ow(a,r8,kw.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(AA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function cI(t,e){e||(e={}),ex(e),jS(),e.codepage&&Dv(e.codepage);var r,n;if(t.FullPaths){if(dt.find(t,"/encryption"))throw new Error("File is password-protected");r=dt.find(t,"!CompObj"),n=dt.find(t,"/Workbook")||dt.find(t,"/Book")}else{switch(e.type){case"base64":t=Jn(Tn(t));break;case"binary":t=Jn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}wr(t,0),n={content:t}}var s,i;if(r&&bB(r),e.bookProps&&!e.bookSheets)s={};else{var a=lt?"buffer":"array";if(n&&n.content)s=LB(n.content,e);else if((i=dt.find(t,"PerfectOffice_MAIN"))&&i.content)s=Tc.to_workbook(i.content,(e.type=a,e));else if((i=dt.find(t,"NativeContent_MAIN"))&&i.content)s=Tc.to_workbook(i.content,(e.type=a,e));else throw(i=dt.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&dt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Tj(t))}var o={};return t.FullPaths&&jB(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var Zh={0:{f:_U},1:{f:TU},2:{f:DU},3:{f:IU},4:{f:SU},5:{f:PU},6:{f:OU},7:{f:RU},8:{f:UU},9:{f:VU},10:{f:LU},11:{f:jU},12:{f:kU},13:{f:FU},14:{f:CU},15:{f:AU},16:{f:sI},17:{f:MU},18:{f:NU},19:{f:$v},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:dB},40:{},42:{},43:{f:L9},44:{f:M9},45:{f:j9},46:{f:U9},47:{f:V9},48:{},49:{f:BL},50:{},51:{f:oj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jA},62:{f:bU},63:{f:hj},64:{f:XU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Wr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:qU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:EU},148:{f:yU,p:16},151:{f:$U},152:{},153:{f:fB},154:{},155:{},156:{f:uB},157:{},158:{},159:{T:1,f:r9},160:{T:-1},161:{T:1,f:ro},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:BU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:aj},336:{T:-1},337:{f:lj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Sm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:LA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:HU},427:{f:WU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:KU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:wU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:zU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Sm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yj},633:{T:1},634:{T:-1},635:{T:1,f:_j},636:{T:-1},637:{f:$L},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:tB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:YU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Nm={6:{f:X0},10:{f:yi},12:{f:er},13:{f:er},14:{f:Kt},15:{f:Kt},16:{f:Ur},17:{f:Kt},18:{f:Kt},19:{f:er},20:{f:fw},21:{f:fw},23:{f:LA},24:{f:dw},25:{f:Kt},26:{},27:{},28:{f:v5},29:{},34:{f:Kt},35:{f:hw},38:{f:Ur},39:{f:Ur},40:{f:Ur},41:{f:Ur},42:{f:Kt},43:{f:Kt},47:{f:w9},49:{f:J8},51:{f:er},60:{},61:{f:X8},64:{f:Kt},65:{f:Q8},66:{f:er},77:{},80:{},81:{},82:{},85:{f:er},89:{},90:{},91:{},92:{f:B8},93:{f:_5},94:{},95:{f:Kt},96:{},97:{},99:{f:Kt},125:{f:jA},128:{f:l5},129:{f:z8},130:{f:er},131:{f:Kt},132:{f:Kt},133:{f:$8},134:{},140:{f:S5},141:{f:er},144:{},146:{f:I5},151:{},152:{},153:{},154:{},155:{},156:{f:er},157:{},158:{},160:{f:D5},161:{f:R5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:s5},190:{f:i5},193:{f:yi},197:{},198:{},199:{},200:{},201:{},202:{f:Kt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:er},220:{},221:{f:Kt},222:{},224:{f:o5},225:{f:U8},226:{f:yi},227:{},229:{f:x5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:H8},253:{f:Z8},255:{f:W8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:PA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Kt},353:{f:yi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:u5},431:{f:Kt},432:{},433:{},434:{},437:{},438:{f:E5},439:{f:Kt},440:{f:T5},441:{},442:{f:Du},443:{},444:{f:er},445:{},446:{},448:{f:yi},449:{f:q8,r:2},450:{f:yi},512:{f:cw},513:{f:P5},515:{f:c5},516:{f:e5},517:{f:uw},519:{f:F5},520:{f:G8},523:{},545:{f:pw},549:{f:lw},566:{},574:{f:Y8},638:{f:n5},659:{},1048:{},1054:{f:t5},1084:{},1212:{f:p5},2048:{f:k5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:kf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:yi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:C5,r:12},2173:{f:sj,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Kt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:d5,r:12},2197:{},2198:{f:J9,r:12},2199:{},2200:{},2201:{},2202:{f:m5,r:12},2203:{f:yi},2204:{},2205:{},2206:{},2207:{},2211:{f:K8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:er},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:N5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:A5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:cw},1:{},2:{f:L5},3:{f:M5},4:{f:O5},5:{f:uw},7:{f:j5},8:{},9:{f:kf},11:{},22:{f:er},30:{f:r5},31:{},32:{},33:{f:pw},36:{},37:{f:lw},50:{f:V5},62:{},52:{},67:{},68:{f:er},69:{},86:{},126:{},127:{f:b5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:U5},223:{},234:{},354:{},421:{},518:{f:X0},521:{f:kf},536:{f:dw},547:{f:hw},561:{},579:{},1030:{f:X0},1033:{f:kf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Gn(t,e,r,n){var s=e;if(!isNaN(s)){var i=(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&xA(r)&&t.push(r)}}function Sw(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,l=cL(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,p=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(a=0;a<l.length;++a){var v=l[a].trim(),y=v.slice(0,3).toLowerCase();if(y=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(y!="<td"&&y!="<th")){var T=v.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var k=T[o].trim();if(k.match(/<t[dh]/i)){for(var w=k,D=0;w.charAt(0)=="<"&&(D=w.indexOf(">"))>-1;)w=w.slice(D+1);for(var U=0;U<x.length;++U){var V=x[U];V.s.c==u&&V.s.r<c&&c<=V.e.r&&(u=V.e.c+1,U=-1)}var g=Ue(k.slice(0,k.indexOf(">")));p=g.colspan?+g.colspan:1,((h=+g.rowspan)>1||p>1)&&x.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+p-1}});var E=g.t||g["data-t"]||"";if(!w.length){u+=p;continue}if(w=iA(w),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>u&&(m.s.c=u),m.e.c<u&&(m.e.c=u),!w.length){u+=p;continue}var S={t:"s",v:w};r.raw||!w.trim().length||E=="s"||(w==="TRUE"?S={t:"b",v:!0}:w==="FALSE"?S={t:"b",v:!1}:isNaN(is(w))?isNaN(cl(w).getDate())||(S={t:"d",v:gr(w)},r.cellDates||(S={t:"n",v:en(S.v)}),S.z=r.dateNF||Xe[14]):S={t:"n",v:is(w)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=S):n[Ge({r:c,c:u})]=S,u+=p}}}}return n["!ref"]=pt(m),x.length&&(n["!merges"]=x),n}function VB(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>a)&&!(s[c].e.r<r||s[c].e.c<a)){if(s[c].s.r<r||s[c].s.c<a){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=Ge({r,c:a}),h=n.dense?(t[r]||[])[a]:t[u],p=h&&h.v!=null&&(h.h||jv(h.w||(ui(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),m.id=(n.id||"sjs")+"-"+u,i.push(SL("td",p,m))}}var x="<tr>";return x+i.join("")+"</tr>"}var UB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',BB="</body></html>";function zB(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return oa(Sw(r[0],e),e);var n=rx();return r.forEach(function(s,i){nx(n,Sw(s,e),"Sheet"+(i+1))}),n}function $B(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function HB(t,e){var r=e||{},n=r.header!=null?r.header:UB,s=r.footer!=null?r.footer:BB,i=[n],a=wl(t["!ref"]);r.dense=Array.isArray(t),i.push($B(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(VB(t,a,o,r));return i.push("</table>"+s),i.join("")}function uI(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?Yr(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var u=wl(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var h=[],p=0,m=t["!rows"]||(t["!rows"]=[]),x=0,v=0,y=0,T=0,k=0,w=0;for(t["!cols"]||(t["!cols"]=[]);x<o.length&&v<l;++x){var D=o[x];if(Aw(D)){if(n.display)continue;m[v]={hidden:!0}}var U=D.children;for(y=T=0;y<U.length;++y){var V=U[y];if(!(n.display&&Aw(V))){var g=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):iA(V.innerHTML),E=V.getAttribute("data-z")||V.getAttribute("z");for(p=0;p<h.length;++p){var S=h[p];S.s.c==T+i&&S.s.r<v+s&&v+s<=S.e.r&&(T=S.e.c+1-i,p=-1)}w=+V.getAttribute("colspan")||1,((k=+V.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:v+s,c:T+i},e:{r:v+s+(k||1)-1,c:T+i+(w||1)-1}});var C={t:"s",v:g},P=V.getAttribute("data-t")||V.getAttribute("t")||"";g!=null&&(g.length==0?C.t=P||"z":n.raw||g.trim().length==0||P=="s"||(g==="TRUE"?C={t:"b",v:!0}:g==="FALSE"?C={t:"b",v:!1}:isNaN(is(g))?isNaN(cl(g).getDate())||(C={t:"d",v:gr(g)},n.cellDates||(C={t:"n",v:en(C.v)}),C.z=n.dateNF||Xe[14]):C={t:"n",v:is(g)})),C.z===void 0&&E!=null&&(C.z=E);var R="",b=V.getElementsByTagName("A");if(b&&b.length)for(var ce=0;ce<b.length&&!(b[ce].hasAttribute("href")&&(R=b[ce].getAttribute("href"),R.charAt(0)!="#"));++ce);R&&R.charAt(0)!="#"&&(C.l={Target:R}),n.dense?(t[v+s]||(t[v+s]=[]),t[v+s][T+i]=C):t[Ge({c:T+i,r:v+s})]=C,c.e.c<T+i&&(c.e.c=T+i),T+=w}}++v}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,v-1+s),t["!ref"]=pt(c),v>=l&&(t["!fullref"]=pt((c.e.r=o.length-x+v-1+s,c))),t}function fI(t,e){var r=e||{},n=r.dense?[]:{};return uI(n,t,e)}function WB(t,e){return oa(fI(t,e),e)}function Aw(t){var e="",r=GB(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function GB(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function KB(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=_t(e.replace(/<[^>]*>/g,""));return[r]}var Iw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function hI(t,e){var r=e||{},n=Vv(t),s=[],i,a,o={name:""},l="",c=0,u,h,p={},m=[],x=r.dense?[]:{},v,y,T={value:""},k="",w=0,D=[],U=-1,V=-1,g={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,S={},C=[],P={},R=0,b=0,ce=[],fe=1,Ae=1,_e=[],oe={Names:[]},K={},de=["",""],Te=[],B={},ee="",q=0,W=!1,ae=!1,ve=0;for(su.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=su.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(g.e.c>=g.s.c&&g.e.r>=g.s.r?x["!ref"]=pt(g):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=g.e.r&&(x["!fullref"]=x["!ref"],g.e.r=r.sheetRows-1,x["!ref"]=pt(g)),C.length&&(x["!merges"]=C),ce.length&&(x["!rows"]=ce),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),m.push(u.name),p[u.name]=x,ae=!1):v[0].charAt(v[0].length-2)!=="/"&&(u=Ue(v[0],!1),U=V=-1,g.s.r=g.s.c=1e7,g.e.r=g.e.c=0,x=r.dense?[]:{},C=[],ce=[],ae=!0);break;case"table-row-group":v[1]==="/"?--E:++E;break;case"table-row":case"":if(v[1]==="/"){U+=fe,fe=1;break}if(h=Ue(v[0],!1),h.?U=h.-1:U==-1&&(U=0),fe=+h["number-rows-repeated"]||1,fe<10)for(ve=0;ve<fe;++ve)E>0&&(ce[U+ve]={level:E});V=-1;break;case"covered-table-cell":v[1]!=="/"&&++V,r.sheetStubs&&(r.dense?(x[U]||(x[U]=[]),x[U][V]={t:"z"}):x[Ge({r:U,c:V})]={t:"z"}),k="",D=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++V,T=Ue(v[0],!1),Ae=parseInt(T["number-columns-repeated"]||"1",10),y={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(y.f=ww(_t(T.formula))),(T.||T["value-type"])=="string"&&(y.t="s",y.v=_t(T["string-value"]||""),r.dense?(x[U]||(x[U]=[]),x[U][V]=y):x[Ge({r:U,c:V})]=y),V+=Ae-1;else if(v[1]!=="/"){++V,k="",w=0,D=[],Ae=1;var Ce=fe?U+fe-1:U;if(V>g.e.c&&(g.e.c=V),V<g.s.c&&(g.s.c=V),U<g.s.r&&(g.s.r=U),Ce>g.e.r&&(g.e.r=Ce),T=Ue(v[0],!1),Te=[],B={},y={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=_t(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(R=parseInt(T["number-matrix-rows-spanned"],10)||0,b=parseInt(T["number-matrix-columns-spanned"],10)||0,P={s:{r:U,c:V},e:{r:U+R-1,c:V+b-1}},y.F=pt(P),_e.push([P,y.F])),T.formula)y.f=ww(T.formula);else for(ve=0;ve<_e.length;++ve)U>=_e[ve][0].s.r&&U<=_e[ve][0].e.r&&V>=_e[ve][0].s.c&&V<=_e[ve][0].e.c&&(y.F=_e[ve][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(R=parseInt(T["number-rows-spanned"],10)||0,b=parseInt(T["number-columns-spanned"],10)||0,P={s:{r:U,c:V},e:{r:U+R-1,c:V+b-1}},C.push(P)),T["number-columns-repeated"]&&(Ae=parseInt(T["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Lt(T["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(T.value);break;case"percentage":y.t="n",y.v=parseFloat(T.value);break;case"currency":y.t="n",y.v=parseFloat(T.value);break;case"date":y.t="d",y.v=gr(T["date-value"]),r.cellDates||(y.t="n",y.v=en(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=aL(T["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Hd(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(T.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",T["string-value"]!=null&&(k=_t(T["string-value"]),D=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(W=!1,y.t==="s"&&(y.v=k||"",D.length&&(y.R=D),W=w==0),K.Target&&(y.l=K),Te.length>0&&(y.c=Te,Te=[]),k&&r.cellText!==!1&&(y.w=k),W&&(y.t="z",delete y.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=U))for(var Ee=0;Ee<fe;++Ee){if(Ae=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(x[U+Ee]||(x[U+Ee]=[]),x[U+Ee][V]=Ee==0?y:Ar(y);--Ae>0;)x[U+Ee][V+Ae]=Ar(y);else for(x[Ge({r:U+Ee,c:V})]=y;--Ae>0;)x[Ge({r:U+Ee,c:V+Ae})]=Ar(y);g.e.c<=V&&(g.e.c=V)}Ae=parseInt(T["number-columns-repeated"]||"1",10),V+=Ae-1,Ae=0,y={},k="",D=[]}K={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((i=s.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((i=s.pop())[0]!==v[3])throw"Bad state: "+i;B.t=k,D.length&&(B.R=D),B.a=ee,Te.push(B)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);ee="",q=0,k="",w=0,D=[];break;case"creator":v[1]==="/"?ee=n.slice(q,v.index):q=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((i=s.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);k="",w=0,D=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(S[o.name]=l,(i=s.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&(l="",o=Ue(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Ue(v[0],!1),l+=Iw[v[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Ue(v[0],!1),l+=Iw[v[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,v.index);break}else c=v.index+v[0].length;break;case"named-range":a=Ue(v[0],!1),de=Y0(a["cell-range-address"]);var pe={Name:a.name,Ref:de[0]+"!"+de[1]};ae&&(pe.Sheet=m.length),oe.Names.push(pe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!T||!T["string-value"])){var He=KB(n.slice(w,v.index));k=(k.length>0?k+`
`:"")+He[0]}else Ue(v[0],!1),w=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{de=Y0(Ue(v[0])["target-range-address"]),p[de[0]]["!autofilter"]={ref:de[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(K=Ue(v[0],!1),!K.href)break;K.Target=_t(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(de=Y0(K.Target.slice(1)),K.Target="#"+de[0]+"!"+de[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var z={Sheets:p,SheetNames:m,Workbook:oe};return r.bookSheets&&delete z.Sheets,z}function Cw(t,e){e=e||{},Pn(t,"META-INF/manifest.xml")&&c8(Zt(t,"META-INF/manifest.xml"),e);var r=xn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=hI(Pt(r),e);return Pn(t,"meta.xml")&&(n.Props=SA(Zt(t,"meta.xml"))),n}function Rw(t,e){return hI(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Jv(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Pm(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Pt(eo(t))}function Dm(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function Nw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function qB(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function lu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function fr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Br(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=lu(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=lu(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:i};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function Zv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function XB(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=lu(t,n),i=Br(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:fr(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=Br(o.data),c=fr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=i[3])!=null&&e[0]&&(a.merge=fr(i[3][0].data)>>>0>0),r.push(a)}return r}function YB(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=lu(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(i==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,i==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Dm(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=Dm(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function QB(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(YB(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Dm(e)}function JB(t,e,r,n){var s=Jv(t),i=s.getUint32(4,!0),a=(n>1?12:8)+Nw(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=Nw(i&(n>1?12288:4096))*4,i&16&&(l=s.getUint32(a,!0),a+=4),i&32&&(c=s.getFloat64(a,!0),a+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function ZB(t,e,r){var n=Jv(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=qB(t,i),i+=16),s&2&&(c=n.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return h}function e7(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return JB(t,e,r,t[0]);case 5:return ZB(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Ki(t){var e=Br(t);return lu(e[1][0].data)}function Pw(t,e){var r=Br(e.data),n=fr(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=Br(a.data),l=fr(o[1][0].data)>>>0;switch(n){case 1:i[l]=Pm(o[3][0].data);break;case 8:{var c=t[Ki(o[9][0].data)][0],u=Br(c.data),h=t[Ki(u[1][0].data)][0],p=fr(h.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var m=Br(h.data);i[l]=m[3].map(function(x){return Pm(x.data)}).join("")}break}}),i}function t7(t,e){var r,n,s,i,a,o,l,c,u,h,p,m,x,v,y=Br(t),T=fr(y[1][0].data)>>>0,k=fr(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&fr(y[8][0].data)>0||!1,D,U;if((i=(s=y[7])==null?void 0:s[0])!=null&&i.data&&e!=0)D=(o=(a=y[7])==null?void 0:a[0])==null?void 0:o.data,U=(c=(l=y[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=y[4])==null?void 0:u[0])!=null&&h.data&&e!=1)D=(m=(p=y[4])==null?void 0:p[0])==null?void 0:m.data,U=(v=(x=y[3])==null?void 0:x[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var V=w?4:1,g=Jv(D),E=[],S=0;S<D.length/2;++S){var C=g.getUint16(S*2,!0);C<65535&&E.push([S,C])}if(E.length!=k)throw"Expected ".concat(k," cells, found ").concat(E.length);var P=[];for(S=0;S<E.length-1;++S)P[E[S][0]]=U.subarray(E[S][1]*V,E[S+1][1]*V);return E.length>=1&&(P[E[E.length-1][0]]=U.subarray(E[E.length-1][1]*V)),{R:T,cells:P}}function r7(t,e){var r,n=Br(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?fr(n[7][0].data)>>>0>0?1:0:-1,i=Zv(n[5],function(a){return t7(a,s)});return{nrows:fr(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function n7(t,e,r){var n,s=Br(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(fr(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(fr(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=pt(i);var a=Br(s[4][0].data),o=Pw(t,t[Ki(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?Pw(t,t[Ki(a[17][0].data)][0]):[],c=Br(a[3][0].data),u=0;c[1].forEach(function(h){var p=Br(h.data),m=t[Ki(p[2][0].data)][0],x=fr(m.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var v=r7(t,m);v.data.forEach(function(y,T){y.forEach(function(k,w){var D=Ge({r:u+T,c:w}),U=e7(k,o,l);U&&(r[D]=U)})}),u+=v.nrows})}function s7(t,e){var r=Br(e.data),n={"!ref":"A1"},s=t[Ki(r[2][0].data)],i=fr(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return n7(t,s[0],n),n}function i7(t,e){var r,n=Br(e.data),s={name:(r=n[1])!=null&&r[0]?Pm(n[1][0].data):"",sheets:[]},i=Zv(n[2],Ki);return i.forEach(function(a){t[a].forEach(function(o){var l=fr(o.meta[1][0].data);l==6e3&&s.sheets.push(s7(t,o))})}),s}function a7(t,e){var r=rx(),n=Br(e.data),s=Zv(n[1],Ki);if(s.forEach(function(i){t[i].forEach(function(a){var o=fr(a.meta[1][0].data);if(o==2){var l=i7(t,a);l.sheets.forEach(function(c,u){nx(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function J0(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=QB(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=XB(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){i[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&fr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(l){i[l].forEach(function(c){var u=fr(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return a7(i,o)}function o7(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function ex(t){o7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function l7(t){return Po.WS.indexOf(t)>-1?"sheet":t==Po.CS?"chart":t==Po.DS?"dialog":t==Po.MS?"macro":t&&t.length?t:"sheet"}function c7(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,l7(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function u7(t,e,r,n,s,i,a,o,l,c,u,h){try{i[n]=wc(xn(t,r,!0),e);var p=Zt(t,e),m;switch(o){case"sheet":m=gB(p,e,s,l,i[n],c,u,h);break;case"chart":if(m=vB(p,e,s,l,i[n],c,u,h),!m||!m["!drawel"])break;var x=tc(m["!drawel"].Target,e),v=Am(x),y=mj(xn(t,x,!0),wc(xn(t,v,!0),x)),T=tc(y,x),k=Am(T);m=ZU(xn(t,T,!0),T,l,wc(xn(t,k,!0),T),c,m);break;case"macro":m=xB(p,e,s,l,i[n],c,u,h);break;case"dialog":m=_B(p,e,s,l,i[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var w=[];i&&i[n]&&Is(i[n]).forEach(function(D){var U="";if(i[n][D].Type==Po.CMNT){U=tc(i[n][D].Target,e);var V=TB(Zt(t,U,!0),U,l);if(!V||!V.length)return;gw(m,V,!1)}i[n][D].Type==Po.TCMNT&&(U=tc(i[n][D].Target,e),w=w.concat(vj(Zt(t,U,!0),l)))}),w&&w.length&&gw(m,w,!0,l.people||[])}catch(D){if(l.WTF)throw D}}function Rn(t){return t.charAt(0)=="/"?t.slice(1):t}function f7(t,e){if(YS(),e=e||{},ex(e),Pn(t,"META-INF/manifest.xml")||Pn(t,"objectdata.xml"))return Cw(t,e);if(Pn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof J0<"u"){if(t.FileIndex)return J0(t);var r=dt.utils.cfb_new();return $y(t).forEach(function(ce){hL(r,ce,fL(t,ce))}),J0(r)}throw new Error("Unsupported NUMBERS file")}if(!Pn(t,"[Content_Types].xml"))throw Pn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Pn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=$y(t),s=o8(xn(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Zt(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Zt(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(kc=[],s.sst)try{kc=EB(Zt(t,Rn(s.sst)),s.sst,e)}catch(ce){if(e.WTF)throw ce}e.cellStyles&&s.themes.length&&(l=wB(xn(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(c=yB(Zt(t,Rn(s.style)),s.style,l,e))}s.links.map(function(ce){try{var fe=wc(xn(t,Am(Rn(ce))),ce);return SB(Zt(t,Rn(ce)),fe,ce,e)}catch{}});var u=mB(Zt(t,Rn(s.workbooks[0])),s.workbooks[0],e),h={},p="";s.coreprops.length&&(p=Zt(t,Rn(s.coreprops[0]),!0),p&&(h=SA(p)),s.extprops.length!==0&&(p=Zt(t,Rn(s.extprops[0]),!0),p&&h8(p,h,e)));var m={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(p=xn(t,Rn(s.custprops[0]),!0),p&&(m=p8(p,e)));var x={};if((e.bookSheets||e.bookProps)&&(u.Sheets?a=u.Sheets.map(function(fe){return fe.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(x.Props=h,x.Custprops=m),e.bookSheets&&typeof a<"u"&&(x.SheetNames=a),e.bookSheets?x.SheetNames:e.bookProps))return x;a={};var v={};e.bookDeps&&s.calcchain&&(v=kB(Zt(t,Rn(s.calcchain)),s.calcchain));var y=0,T={},k,w;{var D=u.Sheets;h.Worksheets=D.length,h.SheetNames=[];for(var U=0;U!=D.length;++U)h.SheetNames[U]=D[U].name}var V=i?"bin":"xml",g=s.workbooks[0].lastIndexOf("/"),E=(s.workbooks[0].slice(0,g+1)+"_rels/"+s.workbooks[0].slice(g+1)+".rels").replace(/^\//,"");Pn(t,E)||(E="xl/_rels/workbook."+V+".rels");var S=wc(xn(t,E,!0),E.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=AB(Zt(t,Rn(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=xj(Zt(t,Rn(s.people[0])),e)),S&&(S=c7(S,u.Sheets));var C=Zt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var P="sheet";if(S&&S[y]?(k="xl/"+S[y][1].replace(/[\/]?xl\//,""),Pn(t,k)||(k=S[y][1]),Pn(t,k)||(k=E.replace(/_rels\/.*$/,"")+S[y][1]),P=S[y][2]):(k="xl/worksheets/sheet"+(y+1-C)+"."+V,k=k.replace(/sheet0\./,"sheet.")),w=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(y!=e.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var R=!1,b=0;b!=e.sheets.length;++b)typeof e.sheets[b]=="number"&&e.sheets[b]==y&&(R=1),typeof e.sheets[b]=="string"&&e.sheets[b].toLowerCase()==h.SheetNames[y].toLowerCase()&&(R=1);if(!R)continue e}}u7(t,k,w,h.SheetNames[y],y,T,a,P,e,u,l,c)}return x={Directory:s,Workbook:u,Props:h,Custprops:m,Deps:v,Sheets:a,SheetNames:h.SheetNames,Strings:kc,Styles:c,Themes:l,SSF:Ar(Xe)},e&&e.bookFiles&&(t.files?(x.keys=n,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(ce,fe){ce=ce.replace(/^Root Entry[\/]/,""),x.keys.push(ce),x.files[ce]=t.FileIndex[fe]}))),e&&e.bookVBA&&(s.vba.length>0?x.vbaraw=Zt(t,Rn(s.vba[0]),!0):s.defaults&&s.defaults.bin===Ej&&(x.vbaraw=Zt(t,"xl/vbaProject.bin",!0))),x}function h7(t,e){var r=e||{},n="Workbook",s=dt.find(t,n);try{if(n="/!DataSpaces/Version",s=dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(s9(s.content),n="/!DataSpaces/DataSpaceMap",s=dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=a9(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=o9(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);c9(s.content)}catch{}if(n="/EncryptionInfo",s=dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=u9(s.content);if(n="/EncryptedPackage",s=dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function tx(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Tn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function d7(t,e){return dt.find(t,"EncryptedPackage")?h7(t,e):cI(t,e)}function p7(t,e){var r,n=t,s=e||{};return s.type||(s.type=lt&&Buffer.isBuffer(t)?"buffer":"base64"),r=rA(n,s),f7(r,s)}function dI(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Rm(t.slice(r),e);default:break e}return iu.to_workbook(t,e)}function m7(t,e){var r="",n=tx(t,e);switch(e.type){case"base64":r=Tn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=$a(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Pt(r)),e.type="binary",dI(r,e)}function g7(t,e){var r=t;return e.type=="base64"&&(r=Tn(r)),r=tu.utils.decode(1200,r.slice(2),"str"),e.type="binary",dI(r,e)}function v7(t){return t.match(/[^\x00-\x7F]/)?rc(t):t}function Z0(t,e,r,n){return n?(r.type="string",iu.to_workbook(t,r)):iu.to_workbook(e,r)}function ed(t,e){jS();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return ed(new Uint8Array(t),(r=Ar(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Wo={},r.dateNF&&(Wo.dateNF=r.dateNF),r.type||(r.type=lt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=lt?"buffer":"binary",n=sL(t),typeof Uint8Array<"u"&&!lt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=v7(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Ar(r),r.type="array",ed(Fv(n),r)}switch((s=tx(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return d7(dt.read(n,r),r);break;case 9:if(s[1]<=8)return cI(n,r);break;case 60:return Rm(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return W5(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return $5.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?p7(n,r):Z0(t,n,r,i);case 239:return s[3]===60?Rm(n,r):Z0(t,n,r,i);case 255:if(s[1]===254)return g7(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Tc.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Tc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return mw.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return E9.to_workbook(n,r);break;case 10:case 13:case 32:return m7(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return B5.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?mw.to_workbook(n,r):Z0(t,n,r,i)}function x7(t,e,r,n,s,i,a,o){var l=Ir(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var x=a?t[r][m]:t[n[m]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;i[m]!=null&&(p[i[m]]=c);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[m]!=null){if(v==null)if(x.t=="e"&&v===null)p[i[m]]=null;else if(c!==void 0)p[i[m]]=c;else if(u&&v===null)p[i[m]]=null;else continue;else p[i[m]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:ui(x,v,o);v!=null&&(h=!1)}}return{row:p,isempty:h}}function Fm(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Gt(u);break;case"number":l=Gt(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var h=Ir(l.s.r),p=[],m=[],x=0,v=0,y=Array.isArray(t),T=l.s.r,k=0,w={};y&&!t[T]&&(t[T]=[]);var D=c.skipHidden&&t["!cols"]||[],U=c.skipHidden&&t["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(D[k]||{}).hidden)switch(p[k]=cr(k),r=y?t[T][k]:t[p[k]+h],n){case 1:i[k]=k-l.s.c;break;case 2:i[k]=p[k];break;case 3:i[k]=c.header[k-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=ui(r,null,c),v=w[a]||0,!v)w[a]=1;else{do o=a+"_"+v++;while(w[o]);w[a]=v,w[o]=1}i[k]=o}for(T=l.s.r+s;T<=l.e.r;++T)if(!(U[T]||{}).hidden){var V=x7(t,l,T,p,n,i,y,c);(V.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[x++]=V.row)}return m.length=x,m}var Dw=/"/g;function _7(t,e,r,n,s,i,a,o){for(var l=!0,c=[],u="",h=Ir(r),p=e.s.c;p<=e.e.c;++p)if(n[p]){var m=o.dense?(t[r]||[])[p]:t[n[p]+h];if(m==null)u="";else if(m.v!=null){l=!1,u=""+(o.rawNumbers&&m.t=="n"?m.v:ui(m,null,o));for(var x=0,v=0;x!==u.length;++x)if((v=u.charCodeAt(x))===s||v===i||v===34||o.forceQuotes){u='"'+u.replace(Dw,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(l=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(Dw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function pI(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Gt(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",h=[];n.dense=Array.isArray(t);for(var p=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(p[x]||{}).hidden||(h[x]=cr(x));for(var v=0,y=s.s.r;y<=s.e.r;++y)(m[y]||{}).hidden||(u=_7(t,s,y,h,a,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((v++?o:"")+u)));return delete n.dense,r.join("")}function y7(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=pI(t,e);return r}function w7(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Gt(t["!ref"]),i="",a=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=cr(o);for(var u=s.s.r;u<=s.e.r;++u)for(i=Ir(u),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function mI(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Yr(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var h=Gt(i["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(a=h.e.r+1,u.e.r=a+e.length-1+s)}else a==-1&&(a=0,u.e.r=e.length-1+s);var p=n.header||[],m=0;e.forEach(function(v,y){Is(v).forEach(function(T){(m=p.indexOf(T))==-1&&(p[m=p.length]=T);var k=v[T],w="z",D="",U=Ge({c:o+m,r:a+y+s});c=cu(i,U),k&&typeof k=="object"&&!(k instanceof Date)?i[U]=k:(typeof k=="number"?w="n":typeof k=="boolean"?w="b":typeof k=="string"?w="s":k instanceof Date?(w="d",n.cellDates||(w="n",k=en(k)),D=n.dateNF||Xe[14]):k===null&&n.nullError&&(w="e",k=0),c?(c.t=w,c.v=k,delete c.w,delete c.R,D&&(c.z=D)):i[U]=c={t:w,v:k},D&&(c.z=D))})}),u.e.c=Math.max(u.e.c,o+p.length-1);var x=Ir(a);if(s)for(m=0;m<p.length;++m)i[cr(m+o)+x]={t:"s",v:p[m]};return i["!ref"]=pt(u),i}function E7(t,e){return mI(null,t,e)}function cu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Yr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?cu(t,Ge(e)):cu(t,Ge({r:e,c:r||0}))}function T7(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function rx(){return{SheetNames:[],Sheets:{}}}function nx(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(oB(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function k7(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=T7(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function S7(t,e){return t.z=e,t}function gI(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function A7(t,e,r){return gI(t,"#"+e,r)}function I7(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function C7(t,e,r,n){for(var s=typeof e!="string"?e:Gt(e),i=typeof e=="string"?e:pt(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=cu(t,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Fw={encode_col:cr,encode_row:Ir,encode_cell:Ge,encode_range:pt,decode_col:zv,decode_row:Bv,split_cell:UL,decode_cell:Yr,decode_range:wl,format_cell:ui,sheet_add_aoa:yA,sheet_add_json:mI,sheet_add_dom:uI,aoa_to_sheet:El,json_to_sheet:E7,table_to_sheet:fI,table_to_book:WB,sheet_to_csv:pI,sheet_to_txt:y7,sheet_to_json:Fm,sheet_to_html:HB,sheet_to_formulae:w7,sheet_to_row_object_array:Fm,sheet_get_cell:cu,book_new:rx,book_append_sheet:nx,book_set_sheet_visibility:k7,cell_set_number_format:S7,cell_set_hyperlink:gI,cell_set_internal_link:A7,cell_add_comment:I7,sheet_set_array_formula:C7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const R7=()=>{var Me;const t=qa(),{currentUser:e,userProfile:r}=di(),[n,s]=X.useState("tmdb"),[i,a]=X.useState(!1),[o,l]=X.useState(null),[c,u]=X.useState(null),[h,p]=X.useState(""),[m,x]=X.useState([]),[v,y]=X.useState(null),[T,k]=X.useState(""),[w,D]=X.useState(null),[U,V]=X.useState([]),[g,E]=X.useState(0),[S,C]=X.useState(0),[P,R]=X.useState("upload"),[b,ce]=X.useState([]),[fe,Ae]=X.useState(0),[_e,oe]=X.useState(null),[K,de]=X.useState([]),[Te,B]=X.useState(!1),[ee,q]=X.useState(0);X.useEffect(()=>{r!=null&&r.tmdbApiKey&&k(r.tmdbApiKey)},[r]);const W=async()=>{if(!(!h.trim()||!T))try{a(!0),l(null),y(null);const Y=await z0(h,T);x(Y.results)}catch(Y){console.error("Search error:",Y),l(Y.message||"Failed to search movies")}finally{a(!1)}},ae=async Y=>{try{a(!0),l(null);const ke=await $0(Y.id,T);y(ke)}catch(ke){console.error("Error fetching movie details:",ke),l(ke.message||"Failed to fetch movie details")}finally{a(!1)}},ve=async()=>{if(!(!e||!v))try{a(!0),l(null);const Y=Ta(Tr,"movies"),ke=V0(Y,U0("tmdbId","==",v.id)),be=await zo(ke);let je;if(be.empty){const tt={...Ry(v),addedAt:new Date,updatedAt:new Date};je=(await yy(Y,tt)).id}else je=be.docs[0].id;if(await Em(e.uid,je,{userId:e.uid,movieId:je,watched:!1,favorite:!1}),u("Movie added to your collection!"),y(null),x([]),p(""),T&&T!==(r==null?void 0:r.tmdbApiKey)){const tt=cs(Tr,"users",e.uid);await Uh(tt,{tmdbApiKey:T},{merge:!0})}setTimeout(()=>{t(`/movies/${je}`)},1500)}catch(Y){console.error("Error adding movie:",Y),l(Y.message||"Failed to add movie to collection")}finally{a(!1)}},Ce=Y=>{var je;const ke=(je=Y.target.files)==null?void 0:je[0];if(!ke)return;console.log("Excel file selected:",ke.name),D(ke),R("upload"),ce([]),l(null);const be=new FileReader;be.onload=tt=>{var mt;try{const Je=(mt=tt.target)==null?void 0:mt.result;console.log("File read complete, parsing Excel data...");const qe=ed(Je,{type:"binary"}),Qe=qe.SheetNames[0];console.log("Sheet found:",Qe);const Fe=qe.Sheets[Qe],ut=Fw.sheet_to_json(Fe);console.log("Excel data parsed:",ut.length,"rows found"),console.log("First row sample:",ut.length>0?ut[0]:"No data");const rt=ut.map(Be=>({title:Be.title||Be.Title||Be.name||Be.Name||"",releaseDate:Be.releaseDate||Be.ReleaseDate||Be.release_date||Be.year||Be.Year||"",watched:Be.watched||Be.Watched||!1,rating:Be.rating||Be.Rating||null,review:Be.review||Be.Review||Be.notes||Be.Notes||""})).filter(Be=>Be.title);console.log("Mapped movie data:",rt.length,"valid movies found"),V(rt),C(rt.length)}catch(Je){console.error("Error parsing Excel file:",Je),l("Failed to parse Excel file. Please check the format.")}},be.onerror=()=>{console.error("FileReader error"),l("Failed to read Excel file")},be.readAsBinaryString(ke)},Ee=(Y,ke)=>{let be=0;const je=Y.title.toLowerCase(),tt=ke.title.toLowerCase();if(je===tt)be+=60;else if(tt.includes(je)||je.includes(tt))be+=40;else{const mt=je.split(" "),Je=tt.split(" "),qe=mt.filter(Qe=>Je.includes(Qe));be+=qe.length/Math.max(mt.length,Je.length)*40}if(Y.releaseDate&&ke.release_date){const mt=Y.releaseDate.substring(0,4),Je=ke.release_date.substring(0,4);mt===Je?be+=40:Math.abs(parseInt(mt)-parseInt(Je))<=1&&(be+=20)}return Math.min(Math.round(be),100)},pe=async()=>{if(console.log("handleExcelScan called",{currentUser:e,excelDataLength:U.length,tmdbApiKey:!!T}),!e||!U.length||!T){console.log("Validation failed",{currentUser:!!e,excelDataLength:U.length,tmdbApiKey:!!T}),T?U.length?e||l("You must be logged in to import movies"):l("No movie data found in the Excel file"):l("TMDB API key is required for Excel import to match movies");return}try{a(!0),l(null),Ae(0),ce([]);const Y=Ta(Tr,"movies"),ke=[];for(let be=0;be<U.length;be++){const je=U[be];try{const tt=`${je.title} ${je.releaseDate||""}`,mt=await z0(tt.trim(),T);let Je;if(mt.results.length===0)Je={excelData:je,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1};else{const qe=mt.results[0],Qe=await $0(qe.id,T),Fe=Ee(je,Qe),ut=V0(Y,U0("tmdbId","==",Qe.id)),rt=await zo(ut);let Be,Ve=!1;rt.empty||(Be=rt.docs[0].id,Ve=await Tm(e.uid,Be)!==null),Je={excelData:je,tmdbMatch:Qe,confidence:Fe,status:Ve?"duplicate":Fe>=70?"matched":"manual",userMovieExists:Ve,movieId:Be,selected:!Ve}}ke.push(Je)}catch(tt){console.error(`Error scanning movie ${je.title}:`,tt),ke.push({excelData:je,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1})}Ae(Math.round((be+1)/U.length*100))}ce(ke),q(ke.filter(be=>be.selected).length),R("review")}catch(Y){console.error("Error scanning movies:",Y),l(Y.message||"Failed to scan movies")}finally{a(!1)}},He=async(Y,ke)=>{if(T)try{B(!0),l(null);const be=ke||Y.manualSearchQuery||Y.excelData.title,je=await z0(be,T);oe(Y),de(je.results)}catch(be){console.error("Manual search error:",be),l(be.message||"Failed to search movies")}finally{B(!1)}},z=async Y=>{if(!(!_e||!T))try{a(!0);const ke=await $0(Y.id,T),be=Ta(Tr,"movies"),je=V0(be,U0("tmdbId","==",ke.id)),tt=await zo(je);let mt,Je=!1;tt.empty||(mt=tt.docs[0].id,Je=await Tm(e.uid,mt)!==null);const qe=b.map(Qe=>Qe===_e?{...Qe,tmdbMatch:ke,confidence:Ee(Qe.excelData,ke),status:Je?"duplicate":"matched",userMovieExists:Je,movieId:mt,selected:!Je}:Qe);ce(qe),q(qe.filter(Qe=>Qe.selected).length),oe(null),de([])}catch(ke){console.error("Error selecting manual match:",ke),l(ke.message||"Failed to select movie")}finally{a(!1)}},ct=Y=>{const ke=[...b];ke[Y].selected=!ke[Y].selected,ce(ke),q(ke.filter(be=>be.selected).length)},Ye=async()=>{if(!e||!b.length)return;const Y=b.filter(ke=>ke.selected&&ke.tmdbMatch);if(Y.length===0){l("No movies selected for import");return}try{a(!0),l(null),E(0),R("import");const ke=Ta(Tr,"movies");let be=0,je=0;for(let mt=0;mt<Y.length;mt++){const Je=Y[mt],qe=Je.excelData,Qe=Je.tmdbMatch;try{let Fe;if(Je.movieId)Fe=Je.movieId;else{const ut={...Ry(Qe),addedAt:new Date,updatedAt:new Date};Fe=(await yy(ke,ut)).id}await Em(e.uid,Fe,{userId:e.uid,movieId:Fe,watched:qe.watched||!1,rating:qe.rating||null,review:qe.review||"",favorite:!1}),be++}catch(Fe){console.error(`Error importing movie ${qe.title}:`,Fe),je++}E(Math.round((mt+1)/Y.length*100))}const tt=`Import complete: ${be} movies imported, ${je} errors.`;u(tt),V([]),D(null),ce([]),setTimeout(()=>{t("/movies")},2e3)}catch(ke){console.error("Error importing movies:",ke),l(ke.message||"Failed to import movies")}finally{a(!1)}},at=()=>{if(console.log("Direct scan button clicked"),!e){console.log("No user logged in"),l("You must be logged in to import movies");return}if(!T){console.log("No TMDB API key"),l("TMDB API key is required for Excel import to match movies");return}if(!w){console.log("No Excel file selected"),l("Please select an Excel file first");return}if(U.length===0){console.log("File selected but no data parsed yet, trying to parse again");const Y=new FileReader;Y.onload=ke=>{var be;try{const je=(be=ke.target)==null?void 0:be.result;console.log("Re-reading file data...");const tt=ed(je,{type:"binary"}),mt=tt.SheetNames[0],Je=tt.Sheets[mt],qe=Fw.sheet_to_json(Je);console.log("Excel data parsed:",qe.length,"rows found");const Qe=qe.map(Fe=>({title:Fe.title||Fe.Title||Fe.name||Fe.Name||"",releaseDate:Fe.releaseDate||Fe.ReleaseDate||Fe.release_date||Fe.year||Fe.Year||"",watched:Fe.watched||Fe.Watched||!1,rating:Fe.rating||Fe.Rating||null,review:Fe.review||Fe.Review||Fe.notes||Fe.Notes||""})).filter(Fe=>Fe.title);V(Qe),C(Qe.length),Qe.length>0?(console.log("Data parsed successfully, calling handleExcelScan"),setTimeout(()=>pe(),100)):l("No valid movie data found in the Excel file")}catch(je){console.error("Error parsing Excel file:",je),l("Failed to parse Excel file. Please check the format.")}},Y.onerror=()=>{console.error("FileReader error"),l("Failed to read Excel file")},Y.readAsBinaryString(w)}else console.log("Calling handleExcelScan with existing data"),pe()};return d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-3 mb-6",children:[d.jsxs(vt,{to:"/movies",className:"btn btn-ghost w-full sm:w-auto",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]}),d.jsxs(vt,{to:"/profile",className:"btn btn-outline btn-primary w-full sm:w-auto",children:[d.jsx("i",{className:"fas fa-user-cog mr-2"})," Profile Settings"]})]}),d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Import Movies"}),o&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:o})]}),c&&d.jsxs("div",{className:"alert alert-success mb-6",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:c})]}),d.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[d.jsxs("button",{className:`tab ${n==="tmdb"?"tab-active":""}`,onClick:()=>s("tmdb"),children:[d.jsx("i",{className:"fas fa-search mr-2"})," Search TMDB"]}),d.jsxs("button",{className:`tab ${n==="excel"?"tab-active":""}`,onClick:()=>s("excel"),children:[d.jsx("i",{className:"fas fa-file-excel mr-2"})," Import Excel"]})]}),n==="tmdb"&&d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[T?null:d.jsxs("div",{className:"alert alert-warning mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"font-bold",children:"TMDB API Key Required"}),d.jsx("p",{className:"text-sm",children:"You need to set your TMDB API key in your profile settings to search for movies."})]}),d.jsxs(vt,{to:"/profile",className:"btn btn-sm btn-primary",children:[d.jsx("i",{className:"fas fa-user-cog mr-2"})," Set API Key"]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[d.jsx("input",{type:"text",className:"input input-bordered flex-1 h-12 text-lg",placeholder:"Search for a Christmas movie...",value:h,onChange:Y=>p(Y.target.value),onKeyDown:Y=>Y.key==="Enter"&&W()}),d.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:W,disabled:i||!T,children:i?d.jsx("span",{className:"loading loading-spinner loading-sm"}):d.jsx("i",{className:"fas fa-search"})})]}),m.length>0&&!v&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-4",children:"Search Results"}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:m.map(Y=>{var ke;return d.jsxs("div",{className:"card bg-base-100 shadow-xl cursor-pointer hover:shadow-2xl transition-shadow",onClick:()=>ae(Y),children:[d.jsx("figure",{children:Y.poster_path?d.jsx("img",{src:`https://image.tmdb.org/t/p/w500${Y.poster_path}`,alt:Y.title,className:"w-full object-contain"}):d.jsx("div",{className:"w-full h-96 flex items-center justify-center bg-gray-800",children:d.jsx("i",{className:"fas fa-film text-4xl text-gray-500"})})}),d.jsxs("div",{className:"card-body p-4",children:[d.jsx("h3",{className:"card-title text-lg",children:Y.title}),d.jsx("p",{className:"text-sm text-gray-400",children:(ke=Y.release_date)==null?void 0:ke.substring(0,4)})]})]},Y.id)})})]}),v&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-4",children:"Selected Movie"}),d.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[d.jsx("div",{className:"md:w-1/3",children:v.poster_path?d.jsx("img",{src:`https://image.tmdb.org/t/p/w500${v.poster_path}`,alt:v.title,className:"w-full rounded-lg shadow-lg"}):d.jsx("div",{className:"w-full h-96 flex items-center justify-center bg-gray-800 rounded-lg",children:d.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),d.jsxs("div",{className:"md:w-2/3",children:[d.jsx("h3",{className:"text-2xl font-bold mb-2",children:v.title}),d.jsx("p",{className:"text-gray-400 mb-4",children:(Me=v.release_date)==null?void 0:Me.substring(0,4)}),v.genres&&d.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:v.genres.map(Y=>d.jsx("span",{className:"badge badge-outline",children:Y.name},Y.id))}),d.jsx("p",{className:"mb-6",children:v.overview}),d.jsx("button",{className:"btn btn-primary",onClick:ve,disabled:i,children:i?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Adding..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-plus mr-2"}),"Add to Collection"]})}),d.jsx("button",{className:"btn btn-ghost ml-2",onClick:()=>y(null),disabled:i,children:"Cancel"})]})]})]})]}),n==="excel"&&w&&d.jsx("div",{className:"mb-6 flex justify-end",children:d.jsx("button",{className:"btn btn-primary",onClick:at,disabled:i||!T,children:i?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Scanning..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-search mr-2"}),"Scan Movies"]})})}),n==="excel"&&d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[T?null:d.jsxs("div",{className:"alert alert-warning mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"font-bold",children:"TMDB API Key Required"}),d.jsx("p",{className:"text-sm",children:"You need to set your TMDB API key in your profile settings to import movies from Excel."})]}),d.jsxs(vt,{to:"/profile",className:"btn btn-sm btn-primary",children:[d.jsx("i",{className:"fas fa-user-cog mr-2"})," Set API Key"]})]}),P==="upload"&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-4",children:"Import Excel"}),d.jsx("p",{className:"mb-4",children:"Upload an Excel file with your Christmas movie list. The file should have columns for:"}),d.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[d.jsx("li",{children:"Title (required)"}),d.jsx("li",{children:"Release Date/Year (optional)"}),d.jsx("li",{children:"Watched (optional, true/false)"}),d.jsx("li",{children:"Rating (optional, 1-10)"}),d.jsx("li",{children:"Review/Notes (optional)"})]})]}),d.jsx("div",{className:"mb-6",children:d.jsx("input",{type:"file",className:"file-input file-input-bordered w-full",accept:".xlsx,.xls",onChange:Ce,disabled:i})}),w&&d.jsx("div",{className:"mb-6 flex justify-end",children:d.jsx("button",{className:"btn btn-primary",onClick:pe,disabled:i||!T,children:i?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Scanning..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-search mr-2"}),"Scan Movies"]})})}),U.length>0&&d.jsxs("div",{className:"mb-6",children:[d.jsxs("h3",{className:"text-lg font-bold mb-2",children:["Preview (",U.length," movies found)"]}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"table table-zebra w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Title"}),d.jsx("th",{children:"Year"}),d.jsx("th",{children:"Watched"}),d.jsx("th",{children:"Rating"})]})}),d.jsxs("tbody",{children:[U.slice(0,10).map((Y,ke)=>d.jsxs("tr",{children:[d.jsx("td",{children:Y.title}),d.jsx("td",{children:Y.releaseDate}),d.jsx("td",{children:Y.watched?"Yes":"No"}),d.jsx("td",{children:Y.rating||"-"})]},ke)),U.length>10&&d.jsx("tr",{children:d.jsxs("td",{colSpan:4,className:"text-center",children:["...and ",U.length-10," more"]})})]})]})}),fe>0&&fe<100&&d.jsxs("div",{className:"mt-4",children:[d.jsx("progress",{className:"progress progress-primary w-full",value:fe,max:"100"}),d.jsxs("p",{className:"text-center mt-2",children:["Scanning ",fe,"% complete"]})]})]})]}),P==="review"&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"mb-6",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h2",{className:"text-xl font-bold",children:"Review Matches"}),d.jsxs("button",{className:"btn btn-outline btn-sm",onClick:()=>R("upload"),disabled:i,children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Upload"]})]}),d.jsx("p",{className:"mt-2",children:"Review the TMDB matches for your movies. You can manually search for better matches if needed."}),d.jsxs("div",{className:"stats shadow mt-4",children:[d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"Total Movies"}),d.jsx("div",{className:"stat-value",children:b.length})]}),d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"Selected"}),d.jsx("div",{className:"stat-value text-primary",children:ee})]}),d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"Duplicates"}),d.jsx("div",{className:"stat-value text-warning",children:b.filter(Y=>Y.userMovieExists).length})]}),d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"Unmatched"}),d.jsx("div",{className:"stat-value text-error",children:b.filter(Y=>Y.status==="unmatched").length})]})]})]}),_e&&d.jsx("div",{className:"modal modal-open",children:d.jsxs("div",{className:"modal-box max-w-4xl",children:[d.jsxs("h3",{className:"font-bold text-lg mb-4",children:['Search for "',_e.excelData.title,'"']}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[d.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a movie...",defaultValue:_e.manualSearchQuery||_e.excelData.title,onKeyDown:Y=>Y.key==="Enter"&&He(_e,Y.target.value)}),d.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:()=>{var Y;return He(_e,(Y=document.querySelector(".modal input"))==null?void 0:Y.value)},disabled:Te,children:Te?d.jsx("span",{className:"loading loading-spinner loading-sm"}):d.jsx("i",{className:"fas fa-search"})})]}),K.length>0?d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 max-h-96 overflow-y-auto",children:K.map(Y=>{var ke;return d.jsxs("div",{className:"card bg-base-100 shadow-xl cursor-pointer hover:shadow-2xl transition-shadow",onClick:()=>z(Y),children:[d.jsx("figure",{children:Y.poster_path?d.jsx("img",{src:`https://image.tmdb.org/t/p/w500${Y.poster_path}`,alt:Y.title,className:"w-full object-contain"}):d.jsx("div",{className:"w-full h-80 flex items-center justify-center bg-gray-800",children:d.jsx("i",{className:"fas fa-film text-4xl text-gray-500"})})}),d.jsxs("div",{className:"card-body p-3",children:[d.jsx("h3",{className:"card-title text-sm",children:Y.title}),d.jsx("p",{className:"text-xs text-gray-400",children:(ke=Y.release_date)==null?void 0:ke.substring(0,4)})]})]},Y.id)})}):d.jsxs("div",{className:"alert alert-info",children:[d.jsx("i",{className:"fas fa-info-circle mr-2"}),d.jsx("span",{children:"Search for a movie to see results"})]}),d.jsx("div",{className:"modal-action",children:d.jsx("button",{className:"btn",onClick:()=>{oe(null),de([])},children:"Cancel"})})]})}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"table table-zebra w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{}),d.jsx("th",{children:"Excel Data"}),d.jsx("th",{children:"TMDB Match"}),d.jsx("th",{children:"Confidence"}),d.jsx("th",{children:"Status"}),d.jsx("th",{children:"Actions"})]})}),d.jsx("tbody",{children:b.map((Y,ke)=>{var be;return d.jsxs("tr",{className:Y.userMovieExists?"bg-warning bg-opacity-20":"",children:[d.jsx("td",{children:d.jsx("input",{type:"checkbox",className:"checkbox",checked:Y.selected,onChange:()=>ct(ke),disabled:!Y.tmdbMatch})}),d.jsxs("td",{children:[d.jsx("div",{className:"font-bold",children:Y.excelData.title}),d.jsx("div",{className:"text-sm opacity-70",children:Y.excelData.releaseDate||"No year"}),Y.excelData.watched&&d.jsx("div",{className:"badge badge-sm",children:"Watched"}),Y.excelData.rating&&d.jsxs("div",{className:"badge badge-sm badge-primary ml-1",children:["Rating: ",Y.excelData.rating]})]}),d.jsx("td",{children:Y.tmdbMatch?d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"avatar",children:d.jsx("div",{className:"w-16 h-24 rounded",children:Y.tmdbMatch.poster_path?d.jsx("img",{src:`https://image.tmdb.org/t/p/w500${Y.tmdbMatch.poster_path}`,alt:Y.tmdbMatch.title,className:"object-cover"}):d.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800",children:d.jsx("i",{className:"fas fa-film text-gray-500"})})})}),d.jsxs("div",{children:[d.jsx("div",{className:"font-bold",children:Y.tmdbMatch.title}),d.jsx("div",{className:"text-sm opacity-70",children:(be=Y.tmdbMatch.release_date)==null?void 0:be.substring(0,4)})]})]}):d.jsx("span",{className:"text-error",children:"No match found"})}),d.jsx("td",{children:Y.tmdbMatch?d.jsxs("div",{className:"flex items-center",children:[d.jsx("progress",{className:`progress ${Y.confidence>=70?"progress-success":Y.confidence>=40?"progress-warning":"progress-error"}`,value:Y.confidence,max:"100"}),d.jsxs("span",{className:"ml-2",children:[Y.confidence,"%"]})]}):"-"}),d.jsxs("td",{children:[Y.status==="matched"&&d.jsx("div",{className:"badge badge-success",children:"Matched"}),Y.status==="unmatched"&&d.jsx("div",{className:"badge badge-error",children:"Unmatched"}),Y.status==="duplicate"&&d.jsx("div",{className:"badge badge-warning",children:"Duplicate"}),Y.status==="manual"&&d.jsx("div",{className:"badge badge-info",children:"Manual Review"})]}),d.jsx("td",{children:d.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>He(Y),children:d.jsx("i",{className:"fas fa-search"})})})]},ke)})})]})}),d.jsx("div",{className:"mt-6 flex justify-end",children:d.jsx("button",{className:"btn btn-primary",onClick:Ye,disabled:i||ee===0,children:i?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Importing..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-file-import mr-2"}),"Import ",ee," Movies"]})})})]}),P==="import"&&d.jsxs("div",{className:"text-center py-10",children:[d.jsx("h2",{className:"text-xl font-bold mb-6",children:"Importing Movies"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("progress",{className:"progress progress-primary w-full",value:g,max:"100"}),d.jsxs("p",{className:"text-center mt-2",children:[g,"% complete"]})]}),c&&d.jsxs("div",{className:"alert alert-success",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:c})]})]})]})]})},N7=()=>{var y,T,k;const{currentUser:t}=di(),[e,r]=X.useState([]),[n,s]=X.useState({}),[i,a]=X.useState(!0),[o,l]=X.useState(null),[c,u]=X.useState(null),[h,p]=X.useState(!1),[m,x]=X.useState(!1);X.useEffect(()=>{(async()=>{if(t)try{a(!0);const{userMovies:D,movies:U}=await Nv(t.uid);s(D),r(U)}catch(D){console.error("Error fetching movies:",D),l("Failed to load movies")}finally{a(!1)}})()},[t]);const v=()=>{if(e.length===0)return;x(!0),u(null);const w=e.filter(g=>{const E=n[g.id];return h||!E||!E.watched});if(w.length===0){l("No eligible movies found. Try including watched movies."),x(!1);return}let D=0;const U=20,V=setInterval(()=>{const g=Math.floor(Math.random()*w.length);u(w[g]),D++,D>=U&&(clearInterval(V),x(!1))},100)};return i?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"mb-4",children:d.jsxs(vt,{to:"/movies",className:"btn btn-ghost",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Christmas Movie Picker"}),o&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:o})]}),e.length===0?d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[d.jsx("h3",{className:"text-xl mb-4",children:"No movies in your collection"}),d.jsx("p",{className:"mb-4",children:"Add some Christmas movies to use the random movie picker!"}),d.jsxs(vt,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg shadow-lg",children:[d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Can't decide what Christmas movie to watch? Let us pick one for you!"}),d.jsx("div",{className:"form-control mb-6",children:d.jsxs("label",{className:"label cursor-pointer justify-center",children:[d.jsx("span",{className:"label-text mr-2",children:"Include watched movies"}),d.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:h,onChange:()=>p(!h)})]})}),d.jsx("button",{className:"btn btn-primary btn-lg",onClick:v,disabled:m,children:m?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-md mr-2"}),"Picking a movie..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-random mr-2"}),"Pick a Random Movie"]})})]}),c&&d.jsx("div",{className:"mt-8 flex flex-col items-center",children:d.jsx("div",{className:"w-full max-w-md",children:d.jsxs("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:[d.jsxs("figure",{className:"relative",children:[c.posterUrl?d.jsx("img",{src:c.posterUrl,alt:c.title,className:"w-full object-contain",style:{aspectRatio:"2/3",maxHeight:"500px"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3",maxHeight:"500px"},children:d.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})}),((y=n[c.id])==null?void 0:y.watched)&&d.jsx("div",{className:"absolute top-4 left-4 badge badge-lg badge-success",children:"Already Watched"}),((T=n[c.id])==null?void 0:T.rating)&&d.jsxs("div",{className:"absolute top-4 right-4 badge badge-lg badge-warning",children:[d.jsx("i",{className:"fas fa-star mr-1"}),n[c.id].rating,"/10"]})]}),d.jsxs("div",{className:"card-body",children:[d.jsx("h2",{className:"card-title text-2xl font-christmas",children:c.title}),d.jsx("p",{className:"text-gray-400",children:(k=c.releaseDate)==null?void 0:k.substring(0,4)}),c.overview&&d.jsx("p",{className:"mt-2",children:c.overview}),d.jsxs("div",{className:"card-actions justify-end mt-4",children:[d.jsx(vt,{to:`/movies/${c.id}`,className:"btn btn-primary",children:"View Details"}),d.jsx("button",{className:"btn btn-outline",onClick:v,disabled:m,children:"Pick Another"})]})]})]})})})]})]})},P7=(t,e)=>{const r=["Title","TMDB ID","Release Year","Watched","Watched Date","Rating","Review","Favorite","Date Added"].join(","),n=t.map(s=>{const i=e[s.id];if(!i)return null;const a=s.releaseDate?s.releaseDate.substring(0,4):"",o=i.watchedDate?bm(i.watchedDate):"",l=i.addedAt?bm(i.addedAt):"",c=bw(s.title),u=i.review?bw(i.review):"";return[c,s.tmdbId||"",a,i.watched?"Yes":"No",o,i.rating!==null&&i.rating!==void 0?i.rating:"",u,i.favorite?"Yes":"No",l].join(",")}).filter(Boolean);return[r,...n].join(`
`)},bm=t=>{if(!(t instanceof Date))try{t&&typeof t.toDate=="function"?t=t.toDate():t=new Date(t)}catch{return""}return t.toISOString().split("T")[0]},bw=t=>t?t.includes(",")||t.includes('"')||t.includes(`
`)?`"${t.replace(/"/g,'""')}"`:t:"",D7=(t,e,r)=>{const n=document.createElement("a"),s=new Blob([t],{type:r});n.href=URL.createObjectURL(s),n.download=e,n.click(),URL.revokeObjectURL(n.href)},F7=async(t,e,r)=>{const n=P7(t,e),s=`${r.replace(/\s+/g,"_")}_christmas_movies_${bm(new Date)}.csv`;D7(n,s,"text/csv;charset=utf-8;")},vI=async()=>{const t=Ta(Tr,"movies"),e=await zo(t);let r=0;const n=e.size;for(const s of e.docs){const i=s.data();if(i.sortTitle)continue;const a=OS(i.title);a!==i.title&&(await Rv(cs(Tr,"movies",s.id),{sortTitle:a,updatedAt:new Date}),r++)}return{updated:r,total:n}},b7=()=>{const{currentUser:t,userProfile:e,signOut:r}=di(),{isAdmin:n}=$d(),[s,i]=X.useState(""),[a,o]=X.useState(!1),[l,c]=X.useState(!1),[u,h]=X.useState(!1),[p,m]=X.useState(null),[x,v]=X.useState(null),[y,T]=X.useState({totalMovies:0,watchedMovies:0,unwatchedMovies:0,averageRating:0,favoriteMovies:0});X.useEffect(()=>{e!=null&&e.tmdbApiKey&&i(e.tmdbApiKey),(async()=>{if(t)try{const g=await bS(t.uid),E=g.length,S=g.filter(ce=>ce.watched).length,C=E-S,P=g.filter(ce=>ce.favorite).length,R=g.filter(ce=>ce.rating!==void 0&&ce.rating!==null),b=R.length>0?R.reduce((ce,fe)=>ce+(fe.rating||0),0)/R.length:0;T({totalMovies:E,watchedMovies:S,unwatchedMovies:C,averageRating:b,favoriteMovies:P})}catch(g){console.error("Error fetching user stats:",g)}})()},[t,e]);const k=async()=>{if(t)try{o(!0),m(null);const V=cs(Tr,"users",t.uid);await Rv(V,{tmdbApiKey:s}),v("TMDB API key saved successfully!"),setTimeout(()=>{v(null)},3e3)}catch(V){console.error("Error saving API key:",V),m(V.message||"Failed to save API key")}finally{o(!1)}},w=async()=>{try{await r()}catch(V){console.error("Error signing out:",V)}},D=async()=>{if(t)try{c(!0),m(null);const{userMovies:V,movies:g}=await Nv(t.uid);await F7(g,V,e.displayName||"User"),v("Movies exported successfully!"),setTimeout(()=>{v(null)},3e3)}catch(V){console.error("Error exporting movies:",V),m(V.message||"Failed to export movies")}finally{c(!1)}},U=async()=>{try{h(!0),m(null);const V=await vI();v(`Sort titles updated for ${V.updated} out of ${V.total} movies.`),setTimeout(()=>{v(null)},5e3)}catch(V){console.error("Error updating sort titles:",V),m(V.message||"Failed to update sort titles")}finally{h(!1)}};return!t||!e?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Your Profile"}),p&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:p})]}),x&&d.jsxs("div",{className:"alert alert-success mb-6",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:x})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[d.jsx("div",{className:"md:col-span-1",children:d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[d.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.photoURL?d.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-24 h-24 rounded-full mb-4"}):d.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-700 flex items-center justify-center mb-4",children:d.jsx("i",{className:"fas fa-user text-4xl text-gray-400"})}),d.jsx("h2",{className:"text-xl font-bold",children:e.displayName}),d.jsx("p",{className:"text-gray-400",children:e.email})]}),d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your Stats"}),d.jsxs("ul",{className:"space-y-2",children:[d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Total Movies:"}),d.jsx("span",{className:"font-bold",children:y.totalMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Watched:"}),d.jsx("span",{className:"font-bold",children:y.watchedMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Unwatched:"}),d.jsx("span",{className:"font-bold",children:y.unwatchedMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Favorites:"}),d.jsx("span",{className:"font-bold",children:y.favoriteMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Average Rating:"}),d.jsxs("span",{className:"font-bold",children:[y.averageRating.toFixed(1),"/10"]})]})]})]}),d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mt-6 space-y-3",children:[d.jsxs("button",{className:"btn btn-outline btn-primary w-full",onClick:D,disabled:l||y.totalMovies===0,children:[l?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-file-export mr-2"}),"Export Movie Data"]}),d.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:w,children:[d.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Sign Out"]})]})]})}),d.jsx("div",{className:"md:col-span-2",children:d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[d.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Settings"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"TMDB API Key"}),d.jsxs("p",{className:"mb-4",children:["Your TMDB API key is used to search for movies and fetch movie details. If you don't have one, you can get it for free from ",d.jsx("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",className:"link link-primary",children:"The Movie Database"}),"."]}),d.jsxs("div",{className:"form-control",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"API Key"})}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[d.jsx("input",{type:"text",className:"input input-bordered flex-1 h-12 text-lg",value:s,onChange:V=>i(V.target.value),placeholder:"Enter your TMDB API key"}),d.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:k,disabled:a,children:a?d.jsx("span",{className:"loading loading-spinner loading-sm"}):d.jsx("i",{className:"fas fa-save"})})]})]})]}),d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Links"}),d.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.jsxs(vt,{to:"/movies",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-film mr-2"}),"My Movies"]}),d.jsxs(vt,{to:"/import",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-file-import mr-2"}),"Import Movies"]}),d.jsxs(vt,{to:"/random",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-random mr-2"}),"Random Movie Picker"]})]})]}),n&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Admin Tools"}),d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{children:[d.jsx("h4",{className:"font-medium mb-1",children:"Sort Title Migration"}),d.jsx("p",{className:"text-sm mb-2",children:'Update all movies to include sort titles (e.g., "The Grinch"  "Grinch") for better alphabetical sorting.'}),d.jsxs("button",{className:"btn btn-outline btn-warning btn-sm",onClick:U,disabled:u,children:[u?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-sort-alpha-down mr-2"}),"Update Sort Titles"]})]})})]})]})]})})]})]})},O7=()=>{const t=qa(),{isAdmin:e,loading:r,currentUser:n}=$d(),[s,i]=X.useState(!1),[a,o]=X.useState(null),l=!1;X.useEffect(()=>{e&&!r&&t("/admin")},[e,r,t]);const c=async()=>{o(null),i(!0);try{await nk(vc,f6)}catch(u){console.error("Login error:",u),u.code==="auth/popup-closed-by-user"?o("Sign-in popup was closed. Please try again."):u.code==="auth/cancelled-popup-request"?o("Another popup is already open. Please try again."):u.code==="auth/unauthorized-domain"?(console.error("Unauthorized domain error:",window.location.hostname),o("This domain is not authorized for OAuth operations. Please add "+window.location.hostname+" to your Firebase authorized domains list in the Firebase console under Authentication > Sign-in method > Authorized domains.")):o("Failed to sign in. Please try again."),i(!1)}};return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsx("div",{className:"container mx-auto px-4 py-12",children:d.jsxs("div",{className:"max-w-md mx-auto",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Admin Login"}),d.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage the Christmas Quiz"})]}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[l,n&&d.jsxs("div",{className:"bg-info bg-opacity-10 border-l-4 border-info p-4 mb-6 rounded",children:[d.jsx("p",{className:"text-info font-bold mb-2",children:"User Authenticated"}),d.jsxs("p",{className:"text-info text-sm mb-1",children:["Email: ",n.email]}),d.jsxs("p",{className:"text-info text-sm mb-2",children:["UID: ",n.uid]}),d.jsxs("p",{className:"text-info text-sm",children:["To grant admin access, create a document in the ",d.jsx("code",{className:"bg-base-300 px-1 py-0.5 rounded",children:"admins"})," collection with this UID as the document ID."]}),l]}),a&&d.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:d.jsx("p",{className:"text-error",children:a})}),d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access the admin panel."}),d.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Only authorized administrators will be granted access."}),d.jsx("button",{onClick:c,className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:s,children:s?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm"}),"Signing in..."]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[d.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                      s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                      s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),d.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                      l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),d.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                      c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),d.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                      c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})})]})]}),d.jsx("div",{className:"text-center mt-6",children:d.jsx("button",{onClick:()=>t("/"),className:"btn btn-link text-xmas-mute",children:"Back to Home"})})]})})},M7=()=>{const t=qa(),{isAdmin:e,loading:r}=$d(),[n,s]=X.useState(!0),[i,a]=X.useState(null),[o,l]=X.useState(null),[c,u]=X.useState(!1),[h,p]=X.useState({totalMovies:0,moviesWithSortTitle:0});if(X.useEffect(()=>{!r&&!e&&t("/admin/login")},[e,r,t]),X.useEffect(()=>{e&&(async()=>{if(e){s(!0);try{const v=await zo(Ta(Tr,"movies")),y=v.size;let T=0;v.forEach(k=>{k.data().sortTitle&&T++}),p({totalMovies:y,moviesWithSortTitle:T})}catch(v){console.error("Error fetching movie data:",v),a("Failed to load movie data")}finally{s(!1)}}})()},[e]),r||n)return d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})});const m=async()=>{try{u(!0),a(null);const x=await vI();l(`Sort titles updated for ${x.updated} out of ${x.total} movies.`),p(v=>({...v,moviesWithSortTitle:v.moviesWithSortTitle+x.updated})),setTimeout(()=>{l(null)},5e3)}catch(x){console.error("Error updating sort titles:",x),a(x.message||"Failed to update sort titles")}finally{u(!1)}};return d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Dashboard"}),d.jsx("div",{className:"flex gap-2",children:d.jsxs(vt,{to:"/movies",className:"btn btn-outline",children:[d.jsx("i",{className:"fas fa-film mr-2"})," Movies"]})})]}),i&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:i})]}),o&&d.jsxs("div",{className:"alert alert-success mb-6",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:o})]}),d.jsxs("div",{className:"mb-8",children:[d.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Administration"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:d.jsx("div",{className:"card bg-xmas-card shadow-xl",children:d.jsxs("div",{className:"card-body",children:[d.jsxs("h2",{className:"card-title font-christmas",children:[d.jsx("i",{className:"fas fa-sort-alpha-down text-primary mr-2"})," Sort Title Migration"]}),d.jsx("p",{className:"mb-4",children:'Update all movies to include sort titles (e.g., "The Grinch"  "Grinch") for better alphabetical sorting.'}),d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsxs("div",{className:"stats bg-base-200 text-base-content",children:[d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"Total Movies"}),d.jsx("div",{className:"stat-value",children:h.totalMovies})]}),d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"With Sort Titles"}),d.jsx("div",{className:"stat-value",children:h.moviesWithSortTitle}),d.jsx("div",{className:"stat-desc",children:h.totalMovies>0?`${Math.round(h.moviesWithSortTitle/h.totalMovies*100)}%`:"0%"})]})]}),d.jsxs("button",{className:"btn btn-primary w-full",onClick:m,disabled:c||h.moviesWithSortTitle===h.totalMovies,children:[c?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-sync-alt mr-2"}),h.moviesWithSortTitle===h.totalMovies?"All Movies Updated":"Update Sort Titles"]})]})]})})})]})]})},L7=PN([{element:d.jsx(m6,{}),children:[{path:"/",element:d.jsx(g6,{})},{path:"/login",element:d.jsx(v6,{})},{element:d.jsx(Cy,{}),children:[{path:"/movies",element:d.jsx(k6,{})},{path:"/movies/:movieId",element:d.jsx(S6,{})},{path:"/import",element:d.jsx(R7,{})},{path:"/random",element:d.jsx(N7,{})},{path:"/profile",element:d.jsx(b7,{})}]},{path:"/admin/login",element:d.jsx(O7,{})},{path:"/admin",element:d.jsx(Cy,{children:d.jsx(M7,{})})}]}]);ep.createRoot(document.getElementById("root")).render(d.jsx(Kw.StrictMode,{children:d.jsx(h6,{children:d.jsx(VN,{router:L7})})}));
